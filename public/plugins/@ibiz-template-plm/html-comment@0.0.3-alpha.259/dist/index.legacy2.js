!function(){var e=["children"],t=["withoutSavingOrigin","trackedOrigins"];function n(e){var t="function"==typeof Map?new Map:void 0;return n=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return i(e,arguments,c(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)},n(e)}function i(e,t,n){if(u())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,t);var r=new(e.bind.apply(e,i));return n&&f(r,n.prototype),r}function r(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o(e,t,n,i){var r=a(c(1&i?e.prototype:e),t,n);return 2&i&&"function"==typeof r?function(e){return r.apply(n,e)}:r}function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},a.apply(null,arguments)}function s(e,t,n){return t=c(t),l(e,u()?Reflect.construct(t,n||[],c(e).constructor):t.apply(e,n))}function l(e,t){if(t&&("object"==d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(u=function(){return!!e})()}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function v(e){return function(e){if(Array.isArray(e))return k(e)}(e)||g(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function p(e,t){return m(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,a,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(s.push(i.value),s.length!==t);l=!0);}catch(e){u=!0,r=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(e,t)||b(e,t)||y()}function y(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function m(e){if(Array.isArray(e))return e}function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=b(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function b(e,t){if(e){if("string"==typeof e)return k(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function x(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */x=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,i){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new L(i||[]);return r(a,"_invoke",{value:_(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var f="suspendedStart",v="suspendedYield",g="executing",p="completed",y={};function m(){}function w(){}function b(){}var k={};u(k,a,(function(){return this}));var C=Object.getPrototypeOf,E=C&&C(C(j([])));E&&E!==n&&i.call(E,a)&&(k=E);var S=b.prototype=m.prototype=Object.create(k);function M(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(r,o,a,s){var l=h(e[r],e,o);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==d(c)&&i.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return o=o?o.then(r,r):r()}})}function _(t,n,i){var r=f;return function(o,a){if(r===g)throw Error("Generator is already running");if(r===p){if("throw"===o)throw a;return{value:e,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var l=P(s,i);if(l){if(l===y)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===f)throw r=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=g;var u=h(t,n,i);if("normal"===u.type){if(r=i.done?p:v,u.arg===y)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=p,i.method="throw",i.arg=u.arg)}}}function P(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),y;var o=h(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(d(t)+" is not iterable")}return w.prototype=b,r(S,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:w,configurable:!0}),w.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},M(A.prototype),u(A.prototype,s,(function(){return this})),t.AsyncIterator=A,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new A(c(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},M(S),u(S,l,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=j,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:j(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},t}function C(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){C(o,i,r,a,s,"next",e)}function s(e){C(o,i,r,a,s,"throw",e)}a(void 0)}))}}function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,T(i.key),i)}}function P(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function O(e,t,n){return(t=T(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=d(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:t+""}System.register(["vue","@ibiz-template/runtime","@ibiz-template/vue3-util","@wangeditor/editor-for-vue","@wangeditor/editor","qx-util","ramda","@ibiz-template/core","element-plus","lodash-es","dayjs"],(function(a,u){"use strict";var c,f,k,C,S,_,T,L,j,N,D,I,R,B,z,F,V,H,U,q,G,J,W,Y,Z,K,X,$,Q,ee,te,ne,ie,re,oe,ae,se,le,ue,ce,he,fe,de,ve,ge,pe,ye,me,we,be,ke,xe,Ce,Ee,Se,Me,Ae,_e,Pe,Oe,Te,Le,je,Ne,De,Ie,Re,Be,ze,Fe,Ve,He,Ue,qe,Ge,Je,We,Ye,Ze,Ke,Xe,$e,Qe,et,tt,nt,it,rt,ot,at,st,lt,ut,ct,ht,ft,dt,vt;return{setters:[function(e){c=e.defineComponent,f=e.ref,k=e.shallowRef,C=e.watch,S=e.onBeforeUnmount,_=e.onMounted,T=e.nextTick,L=e.createVNode,j=e.resolveComponent,N=e.createTextVNode,D=e.computed,I=e.Fragment,R=e.onUnmounted,B=e.mergeProps,z=e.reactive,F=e.withDirectives,V=e.resolveDirective,H=e.vModelText,U=e.h,q=e.createApp,G=e.defineAsyncComponent},function(e){J=e.PluginStaticResource,W=e.ScriptFactory,Y=e.Srfuf,Z=e.ControllerEvent,K=e.convertNavData,X=e.OpenAppViewCommand,$=e.EditorController,Q=e.getDeACMode,ee=e.registerEditorProvider},function(e){te=e.getHtmlProps,ne=e.useNamespace,ie=e.useClickOutside,re=e.getEditorEmits,oe=e.withInstall},function(e){ae=e.Editor,se=e.Toolbar},function(e){le=e.SlateEditor,ue=e.SlateElement,ce=e.SlateText,he=e.SlateNode,fe=e.SlatePath,de=e.SlateTransforms,ve=e.SlateRange,ge=e.DomEditor,pe=e.SlatePoint,ye=e.Boot,me=e.createEditor},function(e){we=e.getCookie,be=e.createUUID,ke=e.QXEvent},function(e){xe=e.isNil,Ce=e.clone},function(e){Ee=e.CoreConst,Se=e.debounce,Me=e.getToken,Ae=e.awaitTimeout,_e=e.RuntimeError,Pe=e.listenJSEvent,Oe=e.NOOP,Te=e.strToBase64,Le=e.HttpError,je=e.base64ToStr,Ne=e.clone,De=e.downloadFileFromBlob},function(e){Ie=e.ElMessageBox,Re=e.default,Be=e.ElInput,ze=e.ElSlider,Fe=e.ElButton},function(e){Ve=e.debounce,He=e.startCase,Ue=e.camelCase,qe=e.isObject,Ge=e.clamp,Je=e.upperFirst,We=e.lowerFirst,Ye=e.isPlainObject,Ze=e.defaultsDeep,Ke=e.cloneDeep,Xe=e.sortedIndex,$e=e.merge,Qe=e.uniq,et=e.difference,tt=e.sortedIndexBy,nt=e.union,it=e.isEqual,rt=e.defaults,ot=e.isEmpty,at=e.sortBy,st=e.groupBy,lt=e.max,ut=e.has,ct=e.clone,ht=e.isNumber,ft=e.throttle,dt=e.toNumber},function(e){vt=e.default}],execute:function(){var gt=x().mark(Br);a("g",Jw);var pt=function(){return P((function e(t,n){A(this,e),O(this,"modalOrPanel",void 0),O(this,"htmlRef",void 0),this.modalOrPanel=t,this.htmlRef=n,this.calcModalPosition(),window.addEventListener("resize",this.handleResize.bind(this))}),[{key:"calcModalPosition",value:function(){if(["dropPanel","selectList"].includes(this.modalOrPanel.type)){var e=this.modalOrPanel.$elem[0],t=this.htmlRef.$el,n=t.querySelector(".w-e-bar"),i=e.previousElementSibling,r=i.getAttribute("data-menu-key"),o=e.parentNode.parentNode.parentNode;if(["bgColor","color","headerSelect"].includes(r)&&t&&n&&i&&"true"!==o.getAttribute("data-w-e-toolbar")){var a=e.clientWidth,s=e.clientHeight,l=n.clientHeight,u=i.getBoundingClientRect(),c=u.bottom,h=u.right,f=u.top,d=u.left,v="".concat(f+l,"px"),g="".concat(d,"px"),p="".concat(c-s-l,"px"),y="".concat(h-a,"px"),m={position:"fixed",left:g,top:v},w=window.innerWidth,b=window.innerHeight;w-d<a&&Object.assign(m,{left:y}),b-f-l<s&&Object.assign(m,{top:p}),Object.assign(e.style,{top:"",bottom:"",left:"",right:""}),Object.assign(e.style,m)}}}},{key:"handleResize",value:function(){this.calcModalPosition()}},{key:"destroy",value:function(){window.removeEventListener("resize",this.handleResize)}}])}(),yt=new J(u.meta.url),mt=c({name:"IBizHtmlContent",props:te(),emits:["change","blur","focus","enter","infoTextChange","link","itemClick"],setup:function(e,t){var n=t.emit,i=ne("html"),r=ne("html-comment"),o=e.controller,a=f(),s=f({}),l=0,c=f(),h=f(),d=k(),v=f(),g=f(""),y=f({Authorization:"Bearer ".concat(we(Ee.TOKEN))}),m=f(""),b=f(""),A=f(!0),P=f(!1),D=f(!1),I=f(!1),R=f(!1),B=f(""),z=f([]),F=f(!1),V=f([]),H="",U=o.model;U.editorParams&&(U.editorParams.enableEdit&&(P.value=!0,D.value=!0,A.value=o.toBoolean(U.editorParams.enableEdit)&&!e.readonly&&!e.disabled),U.editorParams.enableFullScreen&&(I.value=o.toBoolean(U.editorParams.enableFullScreen)));var q=function(e){if(d.value){var t=e.eventArg;t&&(d.value.setHtml(t),T((function(){d.value.focus(!0),n("focus")})))}},G=function(){d.value&&(d.value.blur(),d.value.setHtml(""))},J=function(){d.value&&(d.value.focus(!0),n("focus"))},Y=function(){d.value&&d.value.focus(!0)},Z=function(){d.value&&d.value.focus(!1)};o.evt.on("setHtml",q),o.evt.on("clear",G),o.evt.on("onSetReply",J),o.evt.on("focus",Y),o.evt.on("blur",Z);var K=function(e){var t=e.includes(".")?e.split(".").pop():"";return["jpeg","jpg","gif","png","bmp","svg"].includes(t)?"image":t};o.evt.on("fileChange",(function(e){var t=e.value,n=JSON.parse(t);V.value=n.map((function(e){return M(M({},e),{},{type:K(e.name)})})),o.hasFile.value=V.value.length>0}));var X=function(e){console.log("handleFileRemove"),V.value=V.value.filter((function(t){return t.id!==e})),o.hasFile.value=V.value.length>0;var t=V.value.map((function(e){return{name:e.name,id:e.id}})),n=t.length>0?JSON.stringify(t):"";o.parent.setDataValue(n,H)};C((function(){return e.data}),(function(t){if(t){var n=ibiz.util.file.calcFileUpDownUrl(o.context,o.params,t);m.value=n.uploadUrl,b.value=n.downloadUrl;var i=o.expFields.find((function(e){return"file"===e.name}));if(i){H=i.value;var r=e.data[H],a=r?JSON.parse(r):[];V.value=a.map((function(e){return M(M({},e),{},{type:K(e.name)})})),o.hasFile.value=V.value.length>0}}}),{immediate:!0,deep:!0});var $=function(e,t){if(t)return!0},Q=function(e){return e},ee={toolbarKeys:[{key:"group-add-style",title:"添加",iconSvg:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g id="arvaction/plus-circle-fill" stroke-width="1" fill-rule="evenodd"><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm-.6-8.6H4v1.2h3.4V12h1.2V8.6H12V7.4H8.6V4H7.4v3.4z" id="arv形状结合"></path></g></svg>',menuKeys:o.expMenuKeys.replace("file","attachments").replace("code","codesnippet").replace("page","page").split(";")},"|",{key:"group-inline-style",title:"文本格式",iconSvg:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g id="ahdeditor/color-tt" stroke-width="1" fill-rule="evenodd"><path id="ahdsecondary-color" d="M1.999 15.011h11.998V13.81H1.999z"></path><path d="M6.034 7.59h4.104L8.086 2.297 6.034 7.59zm-.465 1.2l-1.437 3.707H2.845L7.301 1h1.287l-.001.004h.286l4.454 11.492h-1.288L10.603 8.79H5.569z" id="ahd合并形状"></path></g></svg>',menuKeys:["bold","italic","underline","through","code","numberedList","bulletedList","insertLink"]},"codeBlock","mention","marker","emoji"]};o.chatCompletion&&ee.toolbarKeys.push("aichart");var te,ie={placeholder:o.placeHolder,readOnly:P.value?D.value:e.readonly,MENU_CONF:{uploadImage:{server:m.value,fieldName:"file",maxFileSize:10485760,maxNumberOfFiles:10,allowedFileTypes:[],headers:y.value,withCredentials:!0,onBeforeUpload:function(e){return e},onProgress:function(e){console.log("progress",e)},onSuccess:function(e,t){console.log("".concat(e.name," 上传成功"),t)},onFailed:function(e,t){console.log("".concat(e.name," 上传失败"),t)},onError:function(e,t,n){console.log("".concat(e.name," 上传出错"),t,n)},customInsert:function(e,t){return E(x().mark((function n(){var i,r;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=b.value.replace("%fileId%",e.id),r=e.filename,t(i,r,"");case 3:case"end":return n.stop()}}),n)})))()}},insertLink:{checkLink:$,parseLinkUrl:Q},editLink:{checkLink:$,parseLinkUrl:Q}},hoverbarKeys:{link:{menuKeys:["editLink","unLink","customViewLink"]}}},re=function(){var e=E(x().mark((function e(t){var n,i,r,o,a,s,l;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.src,D.value)ce(n);else if(i=le.nodes(d.value,{match:function(e){return!(!ue.isElement(e)||"image"!==e.type)},universal:!0}),i){r=w(i);try{for(r.s();!(o=r.n()).done;)a=o.value,s=p(a,1),"image"===(l=s[0]).type&&n.endsWith(l.src)&&ce(l.src)}catch(u){r.e(u)}finally{r.f()}}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(e){o.handleClick(e),n("itemClick",e)},ce=function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B.value=t,z.value=[t],e.next=4,T();case 4:v.value&&(n=v.value.$refs.container)&&n.children[0].click();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(e){if(v.value){var t=v.value.$refs.container;if(t){var n=t.querySelector(".el-image-viewer__wrapper");null==n||n[e]("keydown",fe)}}},fe=function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Escape"!==t.key&&27!==t.keyCode){e.next=7;break}return t.stopPropagation(),t.preventDefault(),e.next=5,T();case 5:he("removeEventListener"),z.value=[];case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:he("addEventListener");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){var t=E(x().mark((function t(){var i,r,a,s,l;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.deService){t.next=11;break}return t.next=3,u.import("@ibiz-template-plugin/ai-chat");case 3:return r=t.sent,a=r.chat||r.default.chat,te=a,s=a.create({question:function(){var e=E(x().mark((function e(t){var n,i,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=be(),r=new AbortController,e.next=4,null===(n=o.deService)||void 0===n?void 0:n.aiChatSse((function(e){if(ibiz.log.info("aiChatSse",e),20===e.actionstate&&e.actionresult)s.addMessage({messageid:i,state:e.actionstate,type:"DEFAULT",role:"ASSISTANT",content:e.actionresult});else if(30===e.actionstate&&e.actionresult){var t=JSON.parse(e.actionresult).choices;t&&t.length>0&&s.replaceMessage({messageid:i,state:e.actionstate,type:"DEFAULT",role:"ASSISTANT",content:t[0].content||""})}else 40===e.actionstate&&s.replaceMessage({messageid:i,state:e.actionstate,type:"ERROR",role:"ASSISTANT",content:e.actionresult})}),r,o.context,{},{messages:t});case 4:return s.addMessage({messageid:i,state:10,type:"DEFAULT",role:"ASSISTANT",content:""}),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),action:function(e,t){"backfill"===e&&(n("change",t.content),F.value=!0)},closed:function(){d.value&&e.value&&d.value&&d.value.focus(!0)}}),t.next=9,null===(i=o.deService)||void 0===i?void 0:i.aiChatHistory(o.context,{});case 9:(l=t.sent).data&&Array.isArray(l.data)&&l.data.forEach((function(e){var t={messageid:be(),state:30,type:"DEFAULT",role:e.role,content:e.content};s.addMessage(t)}));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();S((function(){te&&te.close();var e=d.value;null!=e&&e.destroy()}));var ge=function(t){var n;d.value=t,t.on("modalOrPanelShow",(function(e){n=new pt(e,h.value)})),t.on("modalOrPanelHide",(function(){n&&n.destroy()})),t.setHtml(g.value),t.on("aiClick",(function(){ve()})),o.onCreated(d.value,e.data,ee)},pe=function(t){var i=t.getHtml();!function(e){var t=e.getEditableContainer();t&&t.querySelectorAll("img").forEach((function(e){e.onclick=function(e){var t=e.target;t&&re(t)}}))}(t);var r="<p><br></p>"===i?"":i;r===e.value||""===r&&xe(e.value)||P.value||(n("change",r),o.evt.emit("onChange",{eventArg:r}))},ye=function(e){o.evt.off("setHtml",q),o.evt.off("clear",G),o.evt.off("onSetReply",J),o.evt.off("focus",Y),o.evt.off("blur",Z)},me=function(){n("focus"),o.evt.emit("onFocus",{eventArg:e.value})},ke=function(){n("blur"),o.evt.emit("onBlur",{eventArg:e.value})},Ce=function(e,t){alert("【自定义提示】".concat(t," - ").concat(e))},Se=function(e,t,n){n(!0)},Me=function(){var e=d.value;null!=e&&e.disable()},Ae=function(){var e=d.value;null!=e&&e.enable()},_e=function(){D.value=!D.value,D.value?Me():(Ae(),d.value.focus(),function(){if(e.value){var t=e.value.indexOf("</p>");if(t>=0){var n,i,r=null===(n=d.value.selection.anchor)||void 0===n?void 0:n.offset,o=null===(i=d.value.selection.anchor)||void 0===i?void 0:i.path;0===r&&o.length>0&&0===o[0]&&d.value.move(t-3)}}}())},Pe=function(){R.value=!R.value,T((function(){D.value?Me():(Ae(),d.value.focus())}))},Oe=function(e){return L("div",{class:r.e("images")},[e.map((function(e){var t=b.value.replace("%fileId%",e.id);return L("div",{class:r.e("image")},[L(j("el-image"),{fit:"contain",src:t,"preview-src-list":[t]},null),L(j("ion-icon"),{name:"close-circle-outline",onClick:function(){return X(e.id)}},null)])}))])},Te=function(){if(o.reply.value){var e=W.execScriptFn({value:o.reply.value,controller:o},o.replyScript,{singleRowReturn:!0,isAsync:!1});return L("div",{class:i.b("reply")},[L("div",{class:i.be("reply","content"),innerHTML:e},null),L(j("ion-icon"),{name:"close-outline",onClick:function(){return o.removeReply()}},null)])}};return _((function(){!function(){if(a.value&&c.value){var e=a.value.offsetHeight;new ResizeObserver((function(t){var n=t[0].contentRect.height;if(n!==l){var r={height:"".concat(e-t[0].contentRect.height,"px")};s.value=i.cssVarBlock(r),l=n}})).observe(c.value.selector)}}(),C((function(){return e.value}),(function(t,n){t===n||"string"!=typeof e.value&&null!=t||(g.value=null==t?"":t,F.value&&(d.value&&T((function(){d.value.focus(!0)})),F.value=!1))}),{immediate:!0}),C((function(){return e.disabled}),(function(e,t){e!==t&&(!0===e?Me():Ae())}),{immediate:!0})})),{ns:i,editorRef:d,previewRef:v,mode:"default",valueHtml:g,toolbarConfig:ee,editorConfig:ie,handleCreated:ge,handleChange:pe,handleDestroyed:ye,handleFocus:me,handleBlur:ke,customAlert:Ce,customPaste:Se,insertText:function(e){var t=d.value;null!=t&&t.insertText(e)},printHtml:function(){var e=d.value;null!=e&&console.log(e.getHtml())},disable:Me,enable:Ae,renderHeaserToolbar:function(){return P.value||I.value?L("div",{class:i.b("custom-toolbar")},[P.value&&A.value&&D.value?L("i",{class:"fa fa-edit","aria-hidden":"true",title:"启用编辑",onClick:function(){return _e()}},null):null,I.value?R.value?L("i",{class:"fa fa-compress","aria-hidden":"true",title:"缩小",onClick:function(){return Pe()}},null):L("i",{class:"fa fa-expand","aria-hidden":"true",title:"放大",onClick:function(){return Pe()}},null):null]):null},renderEditorContent:function(){return o.hidden.value?null:L("div",{class:i.b("content"),ref:"htmlContent",style:s.value},[L(ae,{ref:"htmlRef",class:i.b("editor"),modelValue:g.value,"onUpdate:modelValue":function(e){return g.value=e},"default-config":ie,mode:"default",onClick:oe,onOnCreated:ge,onOnChange:pe,onOnDestroyed:ye,onOnFocus:me,onOnBlur:ke,oncustomAlert:Ce,oncustomPaste:Se},null),Te(),L(se,{ref:"toolbarRef",editor:d.value,"default-config":ee,mode:"default",class:i.b("toolbar")},null)])},renderFooter:function(){return P.value?L("div",{class:[i.b("footer"),O({},i.b("footer-dialog"),R.value)]},[L("div",{class:i.be("footer","cancel"),onClick:function(){e.value!==g.value?Ie({title:"确认取消",type:"warning",customClass:i.b("message"),message:L("div",{class:i.be("message","message-content")},[L("p",null,[N("确定要取消编辑吗？")]),L("p",{class:i.bem("message","message-content","message-tip")},[N("取消编辑将无法保存修改的内容，且不能找回。")])]),showCancelButton:!0,cancelButtonClass:i.be("message","message-cancel"),confirmButtonClass:i.be("message","message-comfire")}).then((function(){if(e.value){var t=o.parseNode(e.value);g.value=t}else g.value="";_e()})).catch((function(){d.value.focus()})):_e()}},[N("取消")]),L("div",{class:i.be("footer","save"),onClick:function(){return function(){D.value=!0,d.value.disable();var e=g.value;n("change",e),R.value&&(R.value=!1)}()}},[N("保存")])]):null},htmlContent:a,hasEnableEdit:P,cssVars:s,toolbarRef:c,htmlRef:h,isFullScreen:R,readonlyState:D,changeFullScreenState:Pe,renderPreview:function(){return L(j("el-image"),{class:i.e("preview"),ref:"previewRef","zoom-rate":1.1,src:B.value,"preview-src-list":z.value,"hide-on-click-modal":!0,onShow:de,fit:"cover"},null)},renderFileList:function(){if(V.value){var e=V.value.filter((function(e){return"image"===e.type})),t=V.value.filter((function(e){return"image"!==e.type}));return L("div",{class:r.e("file-container")},[Oe(e),L("div",{class:r.e("nodes")},[t.map((function(e){return function(e){return L("div",{class:r.e("node")},[L("img",{src:yt.dir("assets/images/".concat(e.type,".svg")),style:"margin-right:6px",alt:""},null),L("div",{class:r.e("node-right")},[L("div",{class:r.e("node-name")},[e.name]),L("div",{class:r.e("node-type")},[e.type.toUpperCase()])]),L("div",{class:r.e("node-toolbar"),onClick:function(){return X(e.id)}},[L(j("ion-icon"),{name:"trash-outline"},null)])])}(e)}))])])}}}},render:function(){var e=this;return this.isFullScreen?L(j("el-dialog"),{modelValue:this.isFullScreen,"onUpdate:modelValue":function(t){return e.isFullScreen=t},width:"80%",top:"10vh",class:this.ns.b("dialog-full-screen"),onClose:function(){return e.changeFullScreenState()}},{default:function(){return[L("div",{class:[e.ns.b(),O({},e.ns.b("editor-readonly"),e.readonlyState)]},[e.renderHeaserToolbar(),e.renderEditorContent(),e.renderFileList(),e.hasEnableEdit&&!e.readonlyState?e.renderFooter():null])]}}):L("div",{class:[this.ns.b(),O({},this.ns.b("editor-readonly"),this.readonlyState)]},[this.renderHeaserToolbar(),this.renderEditorContent(),this.renderFileList(),this.renderPreview(),this.hasEnableEdit&&!this.readonlyState?this.renderFooter():null])}}),wt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"})),bt=["insert","|","headerSelect","blockquote","|","bold","underline","italic",{key:"group-more-style",title:"更多",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M204.8 505.6m-76.8 0a76.8 76.8 0 1 0 153.6 0 76.8 76.8 0 1 0-153.6 0Z"></path><path d="M505.6 505.6m-76.8 0a76.8 76.8 0 1 0 153.6 0 76.8 76.8 0 1 0-153.6 0Z"></path><path d="M806.4 505.6m-76.8 0a76.8 76.8 0 1 0 153.6 0 76.8 76.8 0 1 0-153.6 0Z"></path></svg>',menuKeys:["through","code","sup","sub","clearStyle"]},"color","bgColor","|","fontSize","fontFamily","lineHeight","|","bulletedList","numberedList","todo",{key:"group-justify",title:"对齐",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M768 793.6v102.4H51.2v-102.4h716.8z m204.8-230.4v102.4H51.2v-102.4h921.6z m-204.8-230.4v102.4H51.2v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>',menuKeys:["justifyLeft","justifyRight","justifyCenter","justifyJustify"]},{key:"group-indent",title:"缩进",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M0 64h1024v128H0z m384 192h640v128H384z m0 192h640v128H384z m0 192h640v128H384zM0 832h1024v128H0z m0-128V320l256 192z"></path></svg>',menuKeys:["indent","delIndent"]},"|","emoji","insertLink",{key:"group-image",title:"图片",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M959.877 128l0.123 0.123v767.775l-0.123 0.122H64.102l-0.122-0.122V128.123l0.122-0.123h895.775zM960 64H64C28.795 64 0 92.795 0 128v768c0 35.205 28.795 64 64 64h896c35.205 0 64-28.795 64-64V128c0-35.205-28.795-64-64-64zM832 288.01c0 53.023-42.988 96.01-96.01 96.01s-96.01-42.987-96.01-96.01S682.967 192 735.99 192 832 234.988 832 288.01zM896 832H128V704l224.01-384 256 320h64l224.01-192z"></path></svg>',menuKeys:["insertImage","uploadImage"]},"files",{key:"group-video",title:"视频",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M981.184 160.096C837.568 139.456 678.848 128 512 128S186.432 139.456 42.816 160.096C15.296 267.808 0 386.848 0 512s15.264 244.16 42.816 351.904C186.464 884.544 345.152 896 512 896s325.568-11.456 469.184-32.096C1008.704 756.192 1024 637.152 1024 512s-15.264-244.16-42.816-351.904zM384 704V320l320 192-320 192z"></path></svg>',menuKeys:["insertVideo","uploadVideo"]},"insertTable","codeBlock","divider","|","undo","redo"],kt=function(){return new Map},xt=function(e){var t=kt();return e.forEach((function(e,n){t.set(n,e)})),t},Ct=function(e,t,n){var i=e.get(t);return void 0===i&&e.set(t,i=n()),i},Et=function(){return new Set},St=function(e){return e[e.length-1]},Mt=function(e,t){for(var n=0;n<t.length;n++)e.push(t[n])},At=Array.from,_t=Array.isArray,Pt=function(){return P((function e(){A(this,e),this._observers=kt()}),[{key:"on",value:function(e,t){return Ct(this._observers,e,Et).add(t),t}},{key:"once",value:function(e,t){var n=this,i=function(){n.off(e,i),t.apply(void 0,arguments)};this.on(e,i)}},{key:"off",value:function(e,t){var n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}},{key:"emit",value:function(e,t){return At((this._observers.get(e)||kt()).values()).forEach((function(e){return e.apply(void 0,v(t))}))}},{key:"destroy",value:function(){this._observers=kt()}}])}(),Ot=Math.floor,Tt=Math.abs,Lt=function(e,t){return e<t?e:t},jt=function(e,t){return e>t?e:t},Nt=function(e){return 0!==e?e<0:1/e<0},Dt=32,It=64,Rt=128,Bt=31,zt=127,Ft=Number.MAX_SAFE_INTEGER,Vt=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Ot(e)===e},Ht=/^\s*/g,Ut=/([A-Z])/g,qt=function(e,t){return function(e){return e.replace(Ht,"")}(e.replace(Ut,(function(e){return"".concat(t).concat(function(e){return e.toLowerCase()}(e))})))},Gt="undefined"!=typeof TextEncoder?new TextEncoder:null,Jt=Gt?function(e){return Gt.encode(e)}:function(e){for(var t=unescape(encodeURIComponent(e)),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.codePointAt(r);return i},Wt="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Wt&&1===Wt.decode(new Uint8Array).length&&(Wt=null);var Yt=P((function e(){A(this,e),this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]})),Zt=function(){return new Yt},Kt=function(e){for(var t=new Uint8Array(function(e){for(var t=e.cpos,n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t}(e)),n=0,i=0;i<e.bufs.length;i++){var r=e.bufs[i];t.set(r,n),n+=r.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},Xt=function(e,t){var n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},$t=Xt,Qt=function(e,t){for(;t>zt;)Xt(e,Rt|zt&t),t=Ot(t/128);Xt(e,zt&t)},en=function(e,t){var n=Nt(t);for(n&&(t=-t),Xt(e,(t>63?Rt:0)|(n?It:0)|63&t),t=Ot(t/64);t>0;)Xt(e,(t>zt?Rt:0)|zt&t),t=Ot(t/128)},tn=new Uint8Array(3e4),nn=tn.length/3,rn=Gt&&Gt.encodeInto?function(e,t){if(t.length<nn){var n=Gt.encodeInto(t,tn).written||0;Qt(e,n);for(var i=0;i<n;i++)Xt(e,tn[i])}else an(e,Jt(t))}:function(e,t){var n=unescape(encodeURIComponent(t)),i=n.length;Qt(e,i);for(var r=0;r<i;r++)Xt(e,n.codePointAt(r))},on=function(e,t){var n=e.cbuf.length,i=e.cpos,r=Lt(n-i,t.length),o=t.length-r;e.cbuf.set(t.subarray(0,r),i),e.cpos+=r,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(jt(2*n,o)),e.cbuf.set(t.subarray(r)),e.cpos=o)},an=function(e,t){Qt(e,t.byteLength),on(e,t)},sn=function(e,t){!function(e,t){var n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*jt(n,t)),e.cpos=0)}(e,t);var n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},ln=new DataView(new ArrayBuffer(4)),un=function(e,t){switch(d(t)){case"string":Xt(e,119),rn(e,t);break;case"number":Vt(t)&&Tt(t)<=2147483647?(Xt(e,125),en(e,t)):(a=t,ln.setFloat32(0,a),ln.getFloat32(0)===a?(Xt(e,124),function(e,t){sn(e,4).setFloat32(0,t,!1)}(e,t)):(Xt(e,123),function(e,t){sn(e,8).setFloat64(0,t,!1)}(e,t)));break;case"bigint":Xt(e,122),function(e,t){sn(e,8).setBigInt64(0,t,!1)}(e,t);break;case"object":if(null===t)Xt(e,126);else if(_t(t)){Xt(e,117),Qt(e,t.length);for(var n=0;n<t.length;n++)un(e,t[n])}else if(t instanceof Uint8Array)Xt(e,116),an(e,t);else{Xt(e,118);var i=Object.keys(t);Qt(e,i.length);for(var r=0;r<i.length;r++){var o=i[r];rn(e,o),un(e,t[o])}}break;case"boolean":Xt(e,t?120:121);break;default:Xt(e,127)}var a},cn=function(e){function t(e){var n;return A(this,t),(n=s(this,t)).w=e,n.s=null,n.count=0,n}return h(t,e),P(t,[{key:"write",value:function(e){this.s===e?this.count++:(this.count>0&&Qt(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}])}(Yt),hn=function(e){e.count>0&&(en(e.encoder,1===e.count?e.s:-e.s),e.count>1&&Qt(e.encoder,e.count-2))},fn=function(){return P((function e(){A(this,e),this.encoder=new Yt,this.s=0,this.count=0}),[{key:"write",value:function(e){this.s===e?this.count++:(hn(this),this.count=1,this.s=e)}},{key:"toUint8Array",value:function(){return hn(this),Kt(this.encoder)}}])}(),dn=function(e){if(e.count>0){var t=2*e.diff+(1===e.count?0:1);en(e.encoder,t),e.count>1&&Qt(e.encoder,e.count-2)}},vn=function(){return P((function e(){A(this,e),this.encoder=new Yt,this.s=0,this.count=0,this.diff=0}),[{key:"write",value:function(e){this.diff===e-this.s?(this.s=e,this.count++):(dn(this),this.count=1,this.diff=e-this.s,this.s=e)}},{key:"toUint8Array",value:function(){return dn(this),Kt(this.encoder)}}])}(),gn=function(){return P((function e(){A(this,e),this.sarr=[],this.s="",this.lensE=new fn}),[{key:"write",value:function(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}},{key:"toUint8Array",value:function(){var e=new Yt;return this.sarr.push(this.s),this.s="",rn(e,this.sarr.join("")),on(e,this.lensE.toUint8Array()),Kt(e)}}])}(),pn=function(e){return new Error(e)},yn=function(){throw pn("Method unimplemented")},mn=function(){throw pn("Unexpected case")},wn=pn("Unexpected end of array"),bn=pn("Integer out of Range"),kn=P((function e(t){A(this,e),this.arr=t,this.pos=0})),xn=function(e){return new kn(e)},Cn=function(e){return e.pos!==e.arr.length},En=function(e){return function(e,t){var n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n}(e,Mn(e))},Sn=function(e){return e.arr[e.pos++]},Mn=function(e){for(var t=0,n=1,i=e.arr.length;e.pos<i;){var r=e.arr[e.pos++];if(t+=(r&zt)*n,n*=128,r<Rt)return t;if(t>Ft)throw bn}throw wn},An=function(e){var t=e.arr[e.pos++],n=63&t,i=64,r=(t&It)>0?-1:1;if(0==(t&Rt))return r*n;for(var o=e.arr.length;e.pos<o;){if(n+=((t=e.arr[e.pos++])&zt)*i,i*=128,t<Rt)return r*n;if(n>Ft)throw bn}throw wn},_n=Wt?function(e){return Wt.decode(En(e))}:function(e){var t=Mn(e);if(0===t)return"";var n=String.fromCodePoint(Sn(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(Sn(e));else for(;t>0;){var i=t<1e4?t:1e4,r=e.arr.subarray(e.pos,e.pos+i);e.pos+=i,n+=String.fromCodePoint.apply(null,r),t-=i}return decodeURIComponent(escape(n))},Pn=function(e,t){var n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},On=[function(e){},function(e){return null},An,function(e){return Pn(e,4).getFloat32(0,!1)},function(e){return Pn(e,8).getFloat64(0,!1)},function(e){return Pn(e,8).getBigInt64(0,!1)},function(e){return!1},function(e){return!0},_n,function(e){for(var t=Mn(e),n={},i=0;i<t;i++){n[_n(e)]=Tn(e)}return n},function(e){for(var t=Mn(e),n=[],i=0;i<t;i++)n.push(Tn(e));return n},En],Tn=function(e){return On[127-Sn(e)](e)},Ln=function(e){function t(e,n){var i;return A(this,t),(i=s(this,t,[e])).reader=n,i.s=null,i.count=0,i}return h(t,e),P(t,[{key:"read",value:function(){return 0===this.count&&(this.s=this.reader(this),Cn(this)?this.count=Mn(this)+1:this.count=-1),this.count--,this.s}}])}(kn),jn=function(e){function t(e){var n;return A(this,t),(n=s(this,t,[e])).s=0,n.count=0,n}return h(t,e),P(t,[{key:"read",value:function(){if(0===this.count){this.s=An(this);var e=Nt(this.s);this.count=1,e&&(this.s=-this.s,this.count=Mn(this)+2)}return this.count--,this.s}}])}(kn),Nn=function(e){function t(e){var n;return A(this,t),(n=s(this,t,[e])).s=0,n.count=0,n.diff=0,n}return h(t,e),P(t,[{key:"read",value:function(){if(0===this.count){var e=An(this),t=1&e;this.diff=Ot(e/2),this.count=1,t&&(this.count=Mn(this)+2)}return this.s+=this.diff,this.count--,this.s}}])}(kn),Dn=function(){return P((function e(t){A(this,e),this.decoder=new jn(t),this.str=_n(this.decoder),this.spos=0}),[{key:"read",value:function(){var e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}])}(),In=crypto.getRandomValues.bind(crypto),Rn=function(){return In(new Uint32Array(1))[0]},Bn=[1e7]+-1e3+-4e3+-8e3+-1e11,zn=Date.now,Fn=function(e){return new Promise(e)};Promise.all.bind(Promise);var Vn=function(e){return void 0===e?null:e},Hn=function(){return P((function e(){A(this,e),this.map=new Map}),[{key:"setItem",value:function(e,t){this.map.set(e,t)}},{key:"getItem",value:function(e){return this.map.get(e)}}])}(),Un=new Hn;try{"undefined"!=typeof localStorage&&localStorage&&(Un=localStorage,!1)}catch(dx){}var qn,Gn=Un,Jn=Object.assign,Wn=Object.keys,Yn=function(e){return Wn(e).length},Zn=function(e,t){return e===t||Yn(e)===Yn(t)&&function(e,t){for(var n in e)if(!t(e[n],n))return!1;return!0}(e,(function(e,n){return(void 0!==e||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(t,n))&&t[n]===e}))},Kn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{for(;n<e.length;n++)e[n].apply(e,v(t))}finally{n<e.length&&Kn(e,t,n+1)}},Xn=function(e){return e},$n="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),Qn=function(e){return function(){if(void 0===qn)if($n){qn=kt();for(var e=process.argv,t=null,n=0;n<e.length;n++){var i=e[n];"-"===i[0]?(null!==t&&qn.set(t,""),t=i):null!==t&&(qn.set(t,i),t=null)}null!==t&&qn.set(t,"")}else"object"===("undefined"==typeof location?"undefined":d(location))?(qn=kt(),(location.search||"?").slice(1).split("&").forEach((function(e){if(0!==e.length){var t=p(e.split("="),2),n=t[0],i=t[1];qn.set("--".concat(qt(n,"-")),i),qn.set("-".concat(qt(n,"-")),i)}}))):qn=kt();return qn}().has(e)},ei=function(e){return Vn($n?process.env[e.toUpperCase().replaceAll("-","_")]:Gn.getItem(e))},ti=function(e){return Qn("--"+e)||null!==ei(e)};ti("production");var ni=$n&&function(e,t){return t.includes(e)}(process.env.FORCE_COLOR,["true","1","2"]),ii=ni||!Qn("--no-colors")&&!ti("no-color")&&(!$n||process.stdout.isTTY)&&(!$n||Qn("--color")||null!==ei("COLORTERM")||(ei("TERM")||"").includes("color")),ri=function(e){var t,n=(t=e.byteLength,new Uint8Array(t));return n.set(e),n},oi=P((function e(t,n){A(this,e),this.left=t,this.right=n})),ai=function(e,t){return new oi(e,t)};"undefined"!=typeof DOMParser&&new DOMParser;var si=function(e){return function(e,t){var n,i=[],r=w(e);try{for(r.s();!(n=r.n()).done;){var o=p(n.value,2),a=o[0],s=o[1];i.push(t(s,a))}}catch(l){r.e(l)}finally{r.f()}return i}(e,(function(e,t){return"".concat(t,":").concat(e,";")})).join("")},li=Symbol,ui=li(),ci=li(),hi=li(),fi=li(),di=li(),vi=li(),gi=li(),pi=li(),yi=li(),mi=O(O(O(O(O(O(O(O(O({},ui,ai("font-weight","bold")),ci,ai("font-weight","normal")),hi,ai("color","blue")),di,ai("color","green")),fi,ai("color","grey")),vi,ai("color","red")),gi,ai("color","purple")),pi,ai("color","orange")),yi,ai("color","black")),wi=ii?function(e){var t;1===e.length&&(null===(t=e[0])||void 0===t?void 0:t.constructor)===Function&&(e=e[0]());for(var n=[],i=[],r=kt(),o=[],a=0;a<e.length;a++){var s=e[a],l=mi[s];if(void 0!==l)r.set(l.left,l.right);else{if(void 0===s)break;if(s.constructor!==String&&s.constructor!==Number)break;var u=si(r);a>0||u.length>0?(n.push("%c"+s),i.push(u)):n.push(s)}}for(a>0&&(o=i).unshift(n.join(""));a<e.length;a++){var c=e[a];c instanceof Symbol||o.push(c)}return o}:function(e){var t;1===e.length&&(null===(t=e[0])||void 0===t?void 0:t.constructor)===Function&&(e=e[0]());for(var n=[],i=[],r=0;r<e.length;r++){var o=e[r];if(void 0===o)break;if(o.constructor===String||o.constructor===Number)n.push(o);else if(o.constructor===Object)break}for(r>0&&i.push(n.join(""));r<e.length;r++){var a=e[r];a instanceof Symbol||i.push(a)}return i},bi=Et(),ki=function(e){return O(O({},Symbol.iterator,(function(){return this})),"next",e)},xi=function(e,t){return ki((function(){var n=e.next(),i=n.done,r=n.value;return{done:i,value:i?void 0:t(r)}}))},Ci=P((function e(t,n){A(this,e),this.clock=t,this.len=n})),Ei=P((function e(){A(this,e),this.clients=new Map})),Si=function(e,t,n){return t.clients.forEach((function(t,i){for(var r=e.doc.store.clients.get(i),o=0;o<t.length;o++){var a=t[o];Ar(e,r,a.clock,a.len,n)}}))},Mi=function(e,t){var n=e.clients.get(t.client);return void 0!==n&&null!==function(e,t){for(var n=0,i=e.length-1;n<=i;){var r=Ot((n+i)/2),o=e[r],a=o.clock;if(a<=t){if(t<a+o.len)return r;n=r+1}else i=r-1}return null}(n,t.clock)},Ai=function(e){e.clients.forEach((function(e){var t,n;for(e.sort((function(e,t){return e.clock-t.clock})),t=1,n=1;t<e.length;t++){var i=e[n-1],r=e[t];i.clock+i.len>=r.clock?i.len=jt(i.len,r.clock+r.len-i.clock):(n<t&&(e[n]=r),n++)}e.length=n}))},_i=function(e){for(var t=new Ei,n=function(n){e[n].clients.forEach((function(i,r){if(!t.clients.has(r)){for(var o=i.slice(),a=n+1;a<e.length;a++)Mt(o,e[a].clients.get(r)||[]);t.clients.set(r,o)}}))},i=0;i<e.length;i++)n(i);return Ai(t),t},Pi=function(e,t,n,i){Ct(e.clients,t,(function(){return[]})).push(new Ci(n,i))},Oi=function(e){var t=new Ei;return e.clients.forEach((function(e,n){for(var i=[],r=0;r<e.length;r++){var o=e[r];if(o.deleted){var a=o.id.clock,s=o.length;if(r+1<e.length)for(var l=e[r+1];r+1<e.length&&l.deleted;l=e[1+ ++r])s+=l.length;i.push(new Ci(a,s))}}i.length>0&&t.clients.set(n,i)})),t},Ti=function(e,t){Qt(e.restEncoder,t.clients.size),At(t.clients.entries()).sort((function(e,t){return t[0]-e[0]})).forEach((function(t){var n=p(t,2),i=n[0],r=n[1];e.resetDsCurVal(),Qt(e.restEncoder,i);var o=r.length;Qt(e.restEncoder,o);for(var a=0;a<o;a++){var s=r[a];e.writeDsClock(s.clock),e.writeDsLen(s.len)}}))},Li=function(e){for(var t=new Ei,n=Mn(e.restDecoder),i=0;i<n;i++){e.resetDsCurVal();var r=Mn(e.restDecoder),o=Mn(e.restDecoder);if(o>0)for(var a=Ct(t.clients,r,(function(){return[]})),s=0;s<o;s++)a.push(new Ci(e.readDsClock(),e.readDsLen()))}return t},ji=function(e,t,n){for(var i=new Ei,r=Mn(e.restDecoder),o=0;o<r;o++){e.resetDsCurVal();for(var a=Mn(e.restDecoder),s=Mn(e.restDecoder),l=n.clients.get(a)||[],u=br(n,a),c=0;c<s;c++){var h=e.readDsClock(),f=h+e.readDsLen();if(h<u){u<f&&Pi(i,a,u,f-u);var d=xr(l,h),v=l[d];for(!v.deleted&&v.id.clock<h&&(l.splice(d+1,0,ga(t,v,h-v.id.clock)),d++);d<l.length&&(v=l[d++]).id.clock<f;)v.deleted||(f<v.id.clock+v.length&&l.splice(d,0,ga(t,v,f-v.id.clock)),v.delete(t))}else Pi(i,a,h,f-h)}}if(i.clients.size>0){var g=new Hi;return Qt(g.restEncoder,0),Ti(g,i),g.toUint8Array()}return null},Ni=Rn,Di=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.guid,r=void 0===i?Bn.replace(/[018]/g,(function(e){return(e^Rn()&15>>e/4).toString(16)})):i,o=n.collectionid,a=void 0===o?null:o,l=n.gc,u=void 0===l||l,c=n.gcFilter,h=void 0===c?function(){return!0}:c,f=n.meta,d=void 0===f?null:f,v=n.autoLoad,g=void 0!==v&&v,p=n.shouldLoad,y=void 0===p||p;A(this,t),(e=s(this,t)).gc=u,e.gcFilter=h,e.clientID=Ni(),e.guid=r,e.collectionid=a,e.share=new Map,e.store=new mr,e._transaction=null,e._transactionCleanups=[],e.subdocs=new Set,e._item=null,e.shouldLoad=y,e.autoLoad=g,e.meta=d,e.isLoaded=!1,e.isSynced=!1,e.whenLoaded=Fn((function(t){e.on("load",(function(){e.isLoaded=!0,t(e)}))}));var m=function(){return Fn((function(t){var n=function(i){void 0!==i&&!0!==i||(e.off("sync",n),t())};e.on("sync",n)}))};return e.on("sync",(function(t){!1===t&&e.isSynced&&(e.whenSynced=m()),e.isSynced=void 0===t||!0===t,e.isSynced&&!e.isLoaded&&e.emit("load",[e])})),e.whenSynced=m(),e}return h(t,e),P(t,[{key:"load",value:function(){var e=this,t=this._item;null===t||this.shouldLoad||jr(t.parent.doc,(function(t){t.subdocsLoaded.add(e)}),null,!0),this.shouldLoad=!0}},{key:"getSubdocs",value:function(){return this.subdocs}},{key:"getSubdocGuids",value:function(){return new Set(At(this.subdocs).map((function(e){return e.guid})))}},{key:"transact",value:function(e){return jr(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}},{key:"get",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ro,i=Ct(this.share,e,(function(){var e=new n;return e._integrate(t,null),e})),r=i.constructor;if(n!==ro&&r!==n){if(r===ro){var o=new n;o._map=i._map,i._map.forEach((function(e){for(;null!==e;e=e.left)e.parent=o})),o._start=i._start;for(var a=o._start;null!==a;a=a.right)a.parent=o;return o._length=i._length,this.share.set(e,o),o._integrate(this,null),o}throw new Error("Type with the name ".concat(e," has already been defined with a different constructor"))}return i}},{key:"getArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,xo)}},{key:"getText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,Fo)}},{key:"getMap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,Eo)}},{key:"getXmlElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,Uo)}},{key:"getXmlFragment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,Ho)}},{key:"toJSON",value:function(){var e={};return this.share.forEach((function(t,n){e[n]=t.toJSON()})),e}},{key:"destroy",value:function(){var e=this;At(this.subdocs).forEach((function(e){return e.destroy()}));var n=this._item;if(null!==n){this._item=null;var i=n.content;i.doc=new t(M(M({guid:this.guid},i.opts),{},{shouldLoad:!1})),i.doc._item=n,jr(n.parent.doc,(function(t){var r=i.doc;n.deleted||t.subdocsAdded.add(r),t.subdocsRemoved.add(e)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),o(t,"destroy",this,3)([])}}])}(Pt),Ii=function(){return P((function e(t){A(this,e),this.restDecoder=t}),[{key:"resetDsCurVal",value:function(){}},{key:"readDsClock",value:function(){return Mn(this.restDecoder)}},{key:"readDsLen",value:function(){return Mn(this.restDecoder)}}])}(),Ri=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"readLeftID",value:function(){return ir(Mn(this.restDecoder),Mn(this.restDecoder))}},{key:"readRightID",value:function(){return ir(Mn(this.restDecoder),Mn(this.restDecoder))}},{key:"readClient",value:function(){return Mn(this.restDecoder)}},{key:"readInfo",value:function(){return Sn(this.restDecoder)}},{key:"readString",value:function(){return _n(this.restDecoder)}},{key:"readParentInfo",value:function(){return 1===Mn(this.restDecoder)}},{key:"readTypeRef",value:function(){return Mn(this.restDecoder)}},{key:"readLen",value:function(){return Mn(this.restDecoder)}},{key:"readAny",value:function(){return Tn(this.restDecoder)}},{key:"readBuf",value:function(){return ri(En(this.restDecoder))}},{key:"readJSON",value:function(){return JSON.parse(_n(this.restDecoder))}},{key:"readKey",value:function(){return _n(this.restDecoder)}}])}(Ii),Bi=function(e){function t(e){var n;return A(this,t),(n=s(this,t,[e])).keys=[],Mn(e),n.keyClockDecoder=new Nn(En(e)),n.clientDecoder=new jn(En(e)),n.leftClockDecoder=new Nn(En(e)),n.rightClockDecoder=new Nn(En(e)),n.infoDecoder=new Ln(En(e),Sn),n.stringDecoder=new Dn(En(e)),n.parentInfoDecoder=new Ln(En(e),Sn),n.typeRefDecoder=new jn(En(e)),n.lenDecoder=new jn(En(e)),n}return h(t,e),P(t,[{key:"readLeftID",value:function(){return new tr(this.clientDecoder.read(),this.leftClockDecoder.read())}},{key:"readRightID",value:function(){return new tr(this.clientDecoder.read(),this.rightClockDecoder.read())}},{key:"readClient",value:function(){return this.clientDecoder.read()}},{key:"readInfo",value:function(){return this.infoDecoder.read()}},{key:"readString",value:function(){return this.stringDecoder.read()}},{key:"readParentInfo",value:function(){return 1===this.parentInfoDecoder.read()}},{key:"readTypeRef",value:function(){return this.typeRefDecoder.read()}},{key:"readLen",value:function(){return this.lenDecoder.read()}},{key:"readAny",value:function(){return Tn(this.restDecoder)}},{key:"readBuf",value:function(){return En(this.restDecoder)}},{key:"readJSON",value:function(){return Tn(this.restDecoder)}},{key:"readKey",value:function(){var e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];var t=this.stringDecoder.read();return this.keys.push(t),t}}])}(function(){return P((function e(t){A(this,e),this.dsCurrVal=0,this.restDecoder=t}),[{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"readDsClock",value:function(){return this.dsCurrVal+=Mn(this.restDecoder),this.dsCurrVal}},{key:"readDsLen",value:function(){var e=Mn(this.restDecoder)+1;return this.dsCurrVal+=e,e}}])}()),zi=function(){return P((function e(){A(this,e),this.restEncoder=Zt()}),[{key:"toUint8Array",value:function(){return Kt(this.restEncoder)}},{key:"resetDsCurVal",value:function(){}},{key:"writeDsClock",value:function(e){Qt(this.restEncoder,e)}},{key:"writeDsLen",value:function(e){Qt(this.restEncoder,e)}}])}(),Fi=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"writeLeftID",value:function(e){Qt(this.restEncoder,e.client),Qt(this.restEncoder,e.clock)}},{key:"writeRightID",value:function(e){Qt(this.restEncoder,e.client),Qt(this.restEncoder,e.clock)}},{key:"writeClient",value:function(e){Qt(this.restEncoder,e)}},{key:"writeInfo",value:function(e){$t(this.restEncoder,e)}},{key:"writeString",value:function(e){rn(this.restEncoder,e)}},{key:"writeParentInfo",value:function(e){Qt(this.restEncoder,e?1:0)}},{key:"writeTypeRef",value:function(e){Qt(this.restEncoder,e)}},{key:"writeLen",value:function(e){Qt(this.restEncoder,e)}},{key:"writeAny",value:function(e){un(this.restEncoder,e)}},{key:"writeBuf",value:function(e){an(this.restEncoder,e)}},{key:"writeJSON",value:function(e){rn(this.restEncoder,JSON.stringify(e))}},{key:"writeKey",value:function(e){rn(this.restEncoder,e)}}])}(zi),Vi=function(){return P((function e(){A(this,e),this.restEncoder=Zt(),this.dsCurrVal=0}),[{key:"toUint8Array",value:function(){return Kt(this.restEncoder)}},{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"writeDsClock",value:function(e){var t=e-this.dsCurrVal;this.dsCurrVal=e,Qt(this.restEncoder,t)}},{key:"writeDsLen",value:function(e){0===e&&mn(),Qt(this.restEncoder,e-1),this.dsCurrVal+=e}}])}(),Hi=function(e){function t(){var e;return A(this,t),(e=s(this,t)).keyMap=new Map,e.keyClock=0,e.keyClockEncoder=new vn,e.clientEncoder=new fn,e.leftClockEncoder=new vn,e.rightClockEncoder=new vn,e.infoEncoder=new cn($t),e.stringEncoder=new gn,e.parentInfoEncoder=new cn($t),e.typeRefEncoder=new fn,e.lenEncoder=new fn,e}return h(t,e),P(t,[{key:"toUint8Array",value:function(){var e=Zt();return Qt(e,0),an(e,this.keyClockEncoder.toUint8Array()),an(e,this.clientEncoder.toUint8Array()),an(e,this.leftClockEncoder.toUint8Array()),an(e,this.rightClockEncoder.toUint8Array()),an(e,Kt(this.infoEncoder)),an(e,this.stringEncoder.toUint8Array()),an(e,Kt(this.parentInfoEncoder)),an(e,this.typeRefEncoder.toUint8Array()),an(e,this.lenEncoder.toUint8Array()),on(e,Kt(this.restEncoder)),Kt(e)}},{key:"writeLeftID",value:function(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}},{key:"writeRightID",value:function(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}},{key:"writeClient",value:function(e){this.clientEncoder.write(e)}},{key:"writeInfo",value:function(e){this.infoEncoder.write(e)}},{key:"writeString",value:function(e){this.stringEncoder.write(e)}},{key:"writeParentInfo",value:function(e){this.parentInfoEncoder.write(e?1:0)}},{key:"writeTypeRef",value:function(e){this.typeRefEncoder.write(e)}},{key:"writeLen",value:function(e){this.lenEncoder.write(e)}},{key:"writeAny",value:function(e){un(this.restEncoder,e)}},{key:"writeBuf",value:function(e){an(this.restEncoder,e)}},{key:"writeJSON",value:function(e){un(this.restEncoder,e)}},{key:"writeKey",value:function(e){var t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}])}(Vi),Ui=function(e,t,n){var i=new Map;n.forEach((function(e,n){br(t,n)>e&&i.set(n,e)})),wr(t).forEach((function(e,t){n.has(t)||i.set(t,0)})),Qt(e.restEncoder,i.size),At(i.entries()).sort((function(e,t){return t[0]-e[0]})).forEach((function(n){var i=p(n,2),r=i[0],o=i[1];!function(e,t,n,i){i=jt(i,t[0].id.clock);var r=xr(t,i);Qt(e.restEncoder,t.length-r),e.writeClient(n),Qt(e.restEncoder,i);var o=t[r];o.write(e,i-o.id.clock);for(var a=r+1;a<t.length;a++)t[a].write(e,0)}(e,t.clients.get(r),r,o)}))},qi=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Bi(e);return jr(t,(function(e){e.local=!1;var t=!1,n=e.doc,r=n.store,o=function(e,t){for(var n=kt(),i=Mn(e.restDecoder),r=0;r<i;r++){var o=Mn(e.restDecoder),a=new Array(o),s=e.readClient(),l=Mn(e.restDecoder);n.set(s,{i:0,refs:a});for(var u=0;u<o;u++){var c=e.readInfo();switch(Bt&c){case 0:var h=e.readLen();a[u]=new Yo(ir(s,l),h),l+=h;break;case 10:var f=Mn(e.restDecoder);a[u]=new ka(ir(s,l),f),l+=f;break;default:var d=0==(c&(It|Rt)),v=new ma(ir(s,l),null,(c&Rt)===Rt?e.readLeftID():null,null,(c&It)===It?e.readRightID():null,d?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,d&&(c&Dt)===Dt?e.readString():null,wa(e,c));a[u]=v,l+=v.length}}}return n}(i,n),a=function(e,t,n){var i=[],r=At(n.keys()).sort((function(e,t){return e-t}));if(0===r.length)return null;var o=function(){if(0===r.length)return null;for(var e=n.get(r[r.length-1]);e.refs.length===e.i;){if(r.pop(),!(r.length>0))return null;e=n.get(r[r.length-1])}return e},a=o();if(null===a)return null;for(var s=new mr,l=new Map,u=function(e,t){var n=l.get(e);(null==n||n>t)&&l.set(e,t)},c=a.refs[a.i++],h=new Map,f=function(){for(var e=function(){var e=o[t],i=e.id.client,a=n.get(i);a?(a.i--,s.clients.set(i,a.refs.slice(a.i)),n.delete(i),a.i=0,a.refs=[]):s.clients.set(i,[e]),r=r.filter((function(e){return e!==i}))},t=0,o=i;t<o.length;t++)e();i.length=0};;){if(c.constructor!==ka){var d=Ct(h,c.id.client,(function(){return br(t,c.id.client)}))-c.id.clock;if(d<0)i.push(c),u(c.id.client,c.id.clock-1),f();else{var v=c.getMissing(e,t);if(null!==v){i.push(c);var g=n.get(v)||{refs:[],i:0};if(g.refs.length!==g.i){c=g.refs[g.i++];continue}u(v,br(t,v)),f()}else(0===d||d<c.length)&&(c.integrate(e,d),h.set(c.id.client,c.id.clock+c.length))}}if(i.length>0)c=i.pop();else if(null!==a&&a.i<a.refs.length)c=a.refs[a.i++];else{if(null===(a=o()))break;c=a.refs[a.i++]}}if(s.clients.size>0){var p=new Hi;return Ui(p,s,new Map),Qt(p.restEncoder,0),{missing:l,update:p.toUint8Array()}}return null}(e,r,o),s=r.pendingStructs;if(s){var l,u=w(s.missing);try{for(u.s();!(l=u.n()).done;){var c=p(l.value,2),h=c[0];if(c[1]<br(r,h)){t=!0;break}}}catch(E){u.e(E)}finally{u.f()}if(a){var f,d=w(a.missing);try{for(d.s();!(f=d.n()).done;){var v=p(f.value,2),g=v[0],y=v[1],m=s.missing.get(g);(null==m||m>y)&&s.missing.set(g,y)}}catch(E){d.e(E)}finally{d.f()}s.update=Ur([s.update,a.update])}}else r.pendingStructs=a;var b=ji(i,e,r);if(r.pendingDs){var k=new Bi(xn(r.pendingDs));Mn(k.restDecoder);var x=ji(k,e,r);r.pendingDs=b&&x?Ur([b,x]):b||x}else r.pendingDs=b;if(t){var C=r.pendingStructs.update;r.pendingStructs=null,Gi(e.doc,C)}}),n,!1)},Gi=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Bi,r=xn(t);qi(r,e,n,new i(r))},Ji=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint8Array([0]),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Hi;!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;Ui(e,t.store,n),Ti(e,Oi(t.store))}(n,e,Wi(t));var i=[n.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(qr(e.store.pendingStructs.update,t)),i.length>1){if(n.constructor===Fi)return Vr(i.map((function(e,t){return 0===t?e:Yr(e)})));if(n.constructor===Hi)return Ur(i)}return i[0]},Wi=function(e){return function(e){for(var t=new Map,n=Mn(e.restDecoder),i=0;i<n;i++){var r=Mn(e.restDecoder),o=Mn(e.restDecoder);t.set(r,o)}return t}(new Ii(xn(e)))},Yi=function(e,t){return Qt(e.restEncoder,t.size),At(t.entries()).sort((function(e,t){return t[0]-e[0]})).forEach((function(t){var n=p(t,2),i=n[0],r=n[1];Qt(e.restEncoder,i),Qt(e.restEncoder,r)})),e},Zi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Vi;return e instanceof Map?Yi(t,e):function(e,t){Yi(e,wr(t.store))}(t,e),t.toUint8Array()},Ki=P((function e(){A(this,e),this.l=[]})),Xi=function(){return new Ki},$i=function(e,t){return e.l.push(t)},Qi=function(e,t){var n=e.l,i=n.length;e.l=n.filter((function(e){return t!==e})),i===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},er=function(e,t,n){return Kn(e.l,[t,n])},tr=P((function e(t,n){A(this,e),this.client=t,this.clock=n})),nr=function(e,t){return e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock},ir=function(e,t){return new tr(e,t)},rr=function(e,t){Qt(e,t.client),Qt(e,t.clock)},or=function(e){return ir(Mn(e),Mn(e))},ar=function(e){var t,n=w(e.doc.share.entries());try{for(n.s();!(t=n.n()).done;){var i=p(t.value,2),r=i[0];if(i[1]===e)return r}}catch(o){n.e(o)}finally{n.f()}throw mn()},sr=function(e,t){for(;null!==t;){if(t.parent===e)return!0;t=t.parent._item}return!1},lr=P((function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;A(this,e),this.type=t,this.tname=n,this.item=i,this.assoc=r})),ur=P((function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;A(this,e),this.type=t,this.index=n,this.assoc=i})),cr=function(e,t,n){var i=null,r=null;return null===e._item?r=ar(e):i=ir(e._item.id.client,e._item.id.clock),new lr(i,r,t,n)},hr=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=e._start;if(n<0){if(0===t)return cr(e,null,n);t--}for(;null!==i;){if(!i.deleted&&i.countable){if(i.length>t)return cr(e,ir(i.id.client,i.id.clock+t),n);t-=i.length}if(null===i.right&&n<0)return cr(e,i.lastId,n);i=i.right}return cr(e,null,n)},fr=function(e){var t=Zt();return function(e,t){var n=t.type,i=t.tname,r=t.item,o=t.assoc;if(null!==r)Qt(e,0),rr(e,r);else if(null!==i)$t(e,1),rn(e,i);else{if(null===n)throw mn();$t(e,2),rr(e,n)}en(e,o)}(t,e),Kt(t)},dr=function(e){return function(e){var t=null,n=null,i=null;switch(Mn(e)){case 0:i=or(e);break;case 1:n=_n(e);break;case 2:t=or(e)}var r=Cn(e)?An(e):0;return new lr(t,n,i,r)}(xn(e))},vr=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.store,r=e.item,o=e.type,a=e.tname,s=e.assoc,l=null,u=0;if(null!==r){if(br(i,r.client)<=r.clock)return null;var c=n?da(i,r):{item:Cr(i,r),diff:0},h=c.item;if(!(h instanceof ma))return null;if(null===(l=h.parent)._item||!l._item.deleted){u=h.deleted||!h.countable?0:c.diff+(s>=0?0:1);for(var f=h.left;null!==f;)!f.deleted&&f.countable&&(u+=f.length),f=f.left}}else{if(null!==a)l=t.get(a);else{if(null===o)throw mn();if(br(i,o.client)<=o.clock)return null;var d=(n?da(i,o):{item:Cr(i,o)}).item;if(!(d instanceof ma&&d.content instanceof fa))return null;l=d.content.type}u=s>=0?l._length:0}return function(e,t){return new ur(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)}(l,u,e.assoc)},gr=function(e,t){return e===t||null!==e&&null!==t&&e.tname===t.tname&&nr(e.item,t.item)&&nr(e.type,t.type)&&e.assoc===t.assoc},pr=function(e,t){return void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!Mi(t.ds,e.id)},yr=function(e,t){var n=Ct(e.meta,yr,Et),i=e.doc.store;n.has(t)||(t.sv.forEach((function(t,n){t<br(i,n)&&Sr(e,ir(n,t))})),Si(e,t.ds,(function(e){})),n.add(t))},mr=P((function e(){A(this,e),this.clients=new Map,this.pendingStructs=null,this.pendingDs=null})),wr=function(e){var t=new Map;return e.clients.forEach((function(e,n){var i=e[e.length-1];t.set(n,i.id.clock+i.length)})),t},br=function(e,t){var n=e.clients.get(t);if(void 0===n)return 0;var i=n[n.length-1];return i.id.clock+i.length},kr=function(e,t){var n=e.clients.get(t.id.client);if(void 0===n)n=[],e.clients.set(t.id.client,n);else{var i=n[n.length-1];if(i.id.clock+i.length!==t.id.clock)throw mn()}n.push(t)},xr=function(e,t){var n=0,i=e.length-1,r=e[i],o=r.id.clock;if(o===t)return i;for(var a=Ot(t/(o+r.length-1)*i);n<=i;){if((o=(r=e[a]).id.clock)<=t){if(t<o+r.length)return a;n=a+1}else i=a-1;a=Ot((n+i)/2)}throw mn()},Cr=function(e,t){var n=e.clients.get(t.client);return n[xr(n,t.clock)]},Er=function(e,t,n){var i=xr(t,n),r=t[i];return r.id.clock<n&&r instanceof ma?(t.splice(i+1,0,ga(e,r,n-r.id.clock)),i+1):i},Sr=function(e,t){var n=e.doc.store.clients.get(t.client);return n[Er(e,n,t.clock)]},Mr=function(e,t,n){var i=t.clients.get(n.client),r=xr(i,n.clock),o=i[r];return n.clock!==o.id.clock+o.length-1&&o.constructor!==Yo&&i.splice(r+1,0,ga(e,o,n.clock-o.id.clock+1)),o},Ar=function(e,t,n,i,r){if(0!==i){var o,a=n+i,s=Er(e,t,n);do{a<(o=t[s++]).id.clock+o.length&&Er(e,t,a),r(o)}while(s<t.length&&t[s].id.clock<a)}},_r=P((function e(t,n,i){A(this,e),this.doc=t,this.deleteSet=new Ei,this.beforeState=wr(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1})),Pr=function(e,t){return!(0===t.deleteSet.clients.size&&!function(e,t){var n,i=w(e);try{for(i.s();!(n=i.n()).done;){var r=p(n.value,2),o=r[0];if(t(r[1],o))return!0}}catch(a){i.e(a)}finally{i.f()}return!1}(t.afterState,(function(e,n){return t.beforeState.get(n)!==e})))&&(Ai(t.deleteSet),function(e,t){Ui(e,t.doc.store,t.beforeState)}(e,t),Ti(e,t.deleteSet),!0)},Or=function(e,t,n){var i=t._item;(null===i||i.id.clock<(e.beforeState.get(i.id.client)||0)&&!i.deleted)&&Ct(e.changed,t,Et).add(n)},Tr=function(e,t){for(var n=e[t],i=e[t-1],r=t;r>0&&(i.deleted===n.deleted&&i.constructor===n.constructor&&i.mergeWith(n));n=i,i=e[--r-1])n instanceof ma&&null!==n.parentSub&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,i);var o=t-r;return o&&e.splice(t+1-o,o),o},Lr=function(e,t){if(t<e.length){var n=e[t],i=n.doc,r=i.store,o=n.deleteSet,a=n._mergeStructs;try{Ai(o),n.afterState=wr(n.doc.store),i.emit("beforeObserverCalls",[n,i]);var s=[];n.changed.forEach((function(e,t){return s.push((function(){null!==t._item&&t._item.deleted||t._callObserver(n,e)}))})),s.push((function(){n.changedParentTypes.forEach((function(e,t){t._dEH.l.length>0&&(null===t._item||!t._item.deleted)&&((e=e.filter((function(e){return null===e.target._item||!e.target._item.deleted}))).forEach((function(e){e.currentTarget=t,e._path=null})),e.sort((function(e,t){return e.path.length-t.path.length})),er(t._dEH,e,n))}))})),s.push((function(){return i.emit("afterTransaction",[n,i])})),Kn(s,[]),n._needFormattingCleanup&&Ro(n)}finally{i.gc&&function(e,t,n){var i,r=w(e.clients.entries());try{for(r.s();!(i=r.n()).done;)for(var o=p(i.value,2),a=o[0],s=o[1],l=t.clients.get(a),u=s.length-1;u>=0;u--)for(var c=s[u],h=c.clock+c.len,f=xr(l,c.clock),d=l[f];f<l.length&&d.id.clock<h;d=l[++f]){var v=l[f];if(c.clock+c.len<=v.id.clock)break;v instanceof ma&&v.deleted&&!v.keep&&n(v)&&v.gc(t,!1)}}catch(g){r.e(g)}finally{r.f()}}(o,r,i.gcFilter),function(e,t){e.clients.forEach((function(e,n){for(var i=t.clients.get(n),r=e.length-1;r>=0;r--)for(var o=e[r],a=Lt(i.length-1,1+xr(i,o.clock+o.len-1)),s=i[a];a>0&&s.id.clock>=o.clock;s=i[a])a-=1+Tr(i,a)}))}(o,r),n.afterState.forEach((function(e,t){var i=n.beforeState.get(t)||0;if(i!==e)for(var o=r.clients.get(t),a=jt(xr(o,i),1),s=o.length-1;s>=a;)s-=1+Tr(o,s)}));for(var l=a.length-1;l>=0;l--){var u=a[l].id,c=u.client,h=u.clock,f=r.clients.get(c),d=xr(f,h);d+1<f.length&&Tr(f,d+1)>1||d>0&&Tr(f,d)}if(n.local||n.afterState.get(i.clientID)===n.beforeState.get(i.clientID)||(!function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).log.apply(e,v(wi(n))),bi.forEach((function(e){return e.print(n)}))}(pi,ui,"[yjs] ",ci,vi,"Changed the client-id because another client seems to be using it."),i.clientID=Ni()),i.emit("afterTransactionCleanup",[n,i]),i._observers.has("update")){var g=new Fi;Pr(g,n)&&i.emit("update",[g.toUint8Array(),n.origin,i,n])}if(i._observers.has("updateV2")){var y=new Hi;Pr(y,n)&&i.emit("updateV2",[y.toUint8Array(),n.origin,i,n])}var m=n.subdocsAdded,b=n.subdocsLoaded,k=n.subdocsRemoved;(m.size>0||k.size>0||b.size>0)&&(m.forEach((function(e){e.clientID=i.clientID,null==e.collectionid&&(e.collectionid=i.collectionid),i.subdocs.add(e)})),k.forEach((function(e){return i.subdocs.delete(e)})),i.emit("subdocs",[{loaded:b,added:m,removed:k},i,n]),k.forEach((function(e){return e.destroy()}))),e.length<=t+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,e])):Lr(e,t+1)}}},jr=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=e._transactionCleanups,o=!1,a=null;null===e._transaction&&(o=!0,e._transaction=new _r(e,n,i),r.push(e._transaction),1===r.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{a=t(e._transaction)}finally{if(o){var s=e._transaction===r[0];e._transaction=null,s&&Lr(r,0)}}return a},Nr=P((function e(t,n){A(this,e),this.insertions=n,this.deletions=t,this.meta=new Map})),Dr=function(e,t,n){Si(e,n.deletions,(function(e){e instanceof ma&&t.scope.some((function(t){return sr(t,e)}))&&va(e,!1)}))},Ir=function(e,t,n){var i=null,r=e.doc,o=e.scope;jr(r,(function(n){for(var a=function(){var i=r.store,a=t.pop(),s=new Set,l=[],u=!1;Si(n,a.insertions,(function(e){if(e instanceof ma){if(null!==e.redone){var t=da(i,e.id),r=t.item,a=t.diff;a>0&&(r=Sr(n,ir(r.id.client,r.id.clock+a))),e=r}!e.deleted&&o.some((function(t){return sr(t,e)}))&&l.push(e)}})),Si(n,a.deletions,(function(e){e instanceof ma&&o.some((function(t){return sr(t,e)}))&&!Mi(a.insertions,e.id)&&s.add(e)})),s.forEach((function(t){u=null!==ya(n,t,s,a.insertions,e.ignoreRemoteMapChanges,e)||u}));for(var c=l.length-1;c>=0;c--){var h=l[c];e.deleteFilter(h)&&(h.delete(n),u=!0)}e.currStackItem=u?a:null};t.length>0&&null===e.currStackItem;)a();n.changed.forEach((function(e,t){e.has(null)&&t._searchMarker&&(t._searchMarker.length=0)})),i=n}),e);var a=e.currStackItem;if(null!=a){var s=i.changedParentTypes;e.emit("stack-item-popped",[{stackItem:a,type:n,changedParentTypes:s,origin:e},e]),e.currStackItem=null}return a},Rr=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.captureTimeout,o=void 0===r?500:r,a=i.captureTransaction,l=void 0===a?function(e){return!0}:a,u=i.deleteFilter,c=void 0===u?function(){return!0}:u,h=i.trackedOrigins,f=void 0===h?new Set([null]):h,d=i.ignoreRemoteMapChanges,v=void 0!==d&&d,g=i.doc,p=void 0===g?_t(e)?e[0].doc:e.doc:g;return A(this,t),(n=s(this,t)).scope=[],n.doc=p,n.addToScope(e),n.deleteFilter=c,f.add(n),n.trackedOrigins=f,n.captureTransaction=l,n.undoStack=[],n.redoStack=[],n.undoing=!1,n.redoing=!1,n.currStackItem=null,n.lastChange=0,n.ignoreRemoteMapChanges=v,n.captureTimeout=o,n.afterTransactionHandler=function(e){if(n.captureTransaction(e)&&n.scope.some((function(t){return e.changedParentTypes.has(t)}))&&(n.trackedOrigins.has(e.origin)||e.origin&&n.trackedOrigins.has(e.origin.constructor))){var t=n.undoing,i=n.redoing,r=t?n.redoStack:n.undoStack;t?n.stopCapturing():i||n.clear(!1,!0);var o=new Ei;e.afterState.forEach((function(t,n){var i=e.beforeState.get(n)||0,r=t-i;r>0&&Pi(o,n,i,r)}));var a=zn(),s=!1;if(n.lastChange>0&&a-n.lastChange<n.captureTimeout&&r.length>0&&!t&&!i){var l=r[r.length-1];l.deletions=_i([l.deletions,e.deleteSet]),l.insertions=_i([l.insertions,o])}else r.push(new Nr(e.deleteSet,o)),s=!0;t||i||(n.lastChange=a),Si(e,e.deleteSet,(function(e){e instanceof ma&&n.scope.some((function(t){return sr(t,e)}))&&va(e,!0)}));var u=[{stackItem:r[r.length-1],origin:e.origin,type:t?"redo":"undo",changedParentTypes:e.changedParentTypes},n];s?n.emit("stack-item-added",u):n.emit("stack-item-updated",u)}},n.doc.on("afterTransaction",n.afterTransactionHandler),n.doc.on("destroy",(function(){n.destroy()})),n}return h(t,e),P(t,[{key:"addToScope",value:function(e){var t=this;(e=_t(e)?e:[e]).forEach((function(e){t.scope.every((function(t){return t!==e}))&&(e.doc!==t.doc&&function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=console).warn.apply(e,v(wi(n))),n.unshift(pi),bi.forEach((function(e){return e.print(n)}))}("[yjs#509] Not same Y.Doc"),t.scope.push(e))}))}},{key:"addTrackedOrigin",value:function(e){this.trackedOrigins.add(e)}},{key:"removeTrackedOrigin",value:function(e){this.trackedOrigins.delete(e)}},{key:"clear",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(t&&this.canUndo()||n&&this.canRedo())&&this.doc.transact((function(i){t&&(e.undoStack.forEach((function(t){return Dr(i,e,t)})),e.undoStack=[]),n&&(e.redoStack.forEach((function(t){return Dr(i,e,t)})),e.redoStack=[]),e.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:n}])}))}},{key:"stopCapturing",value:function(){this.lastChange=0}},{key:"undo",value:function(){var e;this.undoing=!0;try{e=Ir(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}},{key:"redo",value:function(){var e;this.redoing=!0;try{e=Ir(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}},{key:"canUndo",value:function(){return this.undoStack.length>0}},{key:"canRedo",value:function(){return this.redoStack.length>0}},{key:"destroy",value:function(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),o(t,"destroy",this,3)([])}}])}(Pt);function Br(e){var t,n,i,r,o,a,s,l,u,c,h;return x().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:t=Mn(e.restDecoder),n=0;case 2:if(!(n<t)){f.next=34;break}i=Mn(e.restDecoder),r=e.readClient(),o=Mn(e.restDecoder),a=0;case 7:if(!(a<i)){f.next=31;break}if(10!==(s=e.readInfo())){f.next=16;break}return l=Mn(e.restDecoder),f.next=13,new ka(ir(r,o),l);case 13:o+=l,f.next=28;break;case 16:if(0==(Bt&s)){f.next=24;break}return u=0==(s&(It|Rt)),c=new ma(ir(r,o),null,(s&Rt)===Rt?e.readLeftID():null,null,(s&It)===It?e.readRightID():null,u?e.readParentInfo()?e.readString():e.readLeftID():null,u&&(s&Dt)===Dt?e.readString():null,wa(e,s)),f.next=21,c;case 21:o+=c.length,f.next=28;break;case 24:return h=e.readLen(),f.next=27,new Yo(ir(r,o),h);case 27:o+=h;case 28:a++,f.next=7;break;case 31:n++,f.next=2;break;case 34:case"end":return f.stop()}}),gt)}var zr=function(){return P((function e(t,n){A(this,e),this.gen=Br(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}),[{key:"next",value:function(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===ka);return this.curr}}])}(),Fr=P((function e(t){A(this,e),this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]})),Vr=function(e){return Ur(e,Ri,Fi)},Hr=function(e,t){if(e.constructor===Yo){var n=e.id,i=n.client,r=n.clock;return new Yo(ir(i,r+t),e.length-t)}if(e.constructor===ka){var o=e.id,a=o.client,s=o.clock;return new ka(ir(a,s+t),e.length-t)}var l=e,u=l.id,c=u.client,h=u.clock;return new ma(ir(c,h+t),null,ir(c,h+t-1),null,l.rightOrigin,l.parent,l.parentSub,l.content.splice(t))},Ur=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bi,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hi;if(1===e.length)return e[0];for(var i=e.map((function(e){return new t(xn(e))})),r=i.map((function(e){return new zr(e,!0)})),o=null,a=new n,s=new Fr(a);(r=r.filter((function(e){return null!==e.curr}))).sort((function(e,t){if(e.curr.id.client===t.curr.id.client){var n=e.curr.id.clock-t.curr.id.clock;return 0===n?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===ka?1:-1:n}return t.curr.id.client-e.curr.id.client})),0!==r.length;){var l=r[0],u=l.curr.id.client;if(null!==o){for(var c=l.curr,h=!1;null!==c&&c.id.clock+c.length<=o.struct.id.clock+o.struct.length&&c.id.client>=o.struct.id.client;)c=l.next(),h=!0;if(null===c||c.id.client!==u||h&&c.id.clock>o.struct.id.clock+o.struct.length)continue;if(u!==o.struct.id.client)Jr(s,o.struct,o.offset),o={struct:c,offset:0},l.next();else if(o.struct.id.clock+o.struct.length<c.id.clock)if(o.struct.constructor===ka)o.struct.length=c.id.clock+c.length-o.struct.id.clock;else{Jr(s,o.struct,o.offset);var f=c.id.clock-o.struct.id.clock-o.struct.length;o={struct:new ka(ir(u,o.struct.id.clock+o.struct.length),f),offset:0}}else{var d=o.struct.id.clock+o.struct.length-c.id.clock;d>0&&(o.struct.constructor===ka?o.struct.length-=d:c=Hr(c,d)),o.struct.mergeWith(c)||(Jr(s,o.struct,o.offset),o={struct:c,offset:0},l.next())}}else o={struct:l.curr,offset:0},l.next();for(var v=l.curr;null!==v&&v.id.client===u&&v.id.clock===o.struct.id.clock+o.struct.length&&v.constructor!==ka;v=l.next())Jr(s,o.struct,o.offset),o={struct:v,offset:0}}null!==o&&(Jr(s,o.struct,o.offset),o=null),Wr(s);var g=i.map((function(e){return Li(e)})),p=_i(g);return Ti(a,p),a.toUint8Array()},qr=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bi,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hi,r=Wi(t),o=new i,a=new Fr(o),s=new n(xn(e)),l=new zr(s,!1);l.curr;){var u=l.curr,c=u.id.client,h=r.get(c)||0;if(l.curr.constructor!==ka)if(u.id.clock+u.length>h)for(Jr(a,u,jt(h-u.id.clock,0)),l.next();l.curr&&l.curr.id.client===c;)Jr(a,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===c&&l.curr.id.clock+l.curr.length<=h;)l.next();else l.next()}Wr(a);var f=Li(s);return Ti(o,f),o.toUint8Array()},Gr=function(e){e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:Kt(e.encoder.restEncoder)}),e.encoder.restEncoder=Zt(),e.written=0)},Jr=function(e,t,n){e.written>0&&e.currClient!==t.id.client&&Gr(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),Qt(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},Wr=function(e){Gr(e);var t=e.encoder.restEncoder;Qt(t,e.clientStructs.length);for(var n=0;n<e.clientStructs.length;n++){var i=e.clientStructs[n];Qt(t,i.written),on(t,i.restEncoder)}},Yr=function(e){return function(e,t,n,i){for(var r=new n(xn(e)),o=new zr(r,!1),a=new i,s=new Fr(a),l=o.curr;null!==l;l=o.next())Jr(s,t(l),0);Wr(s);var u=Li(r);return Ti(a,u),a.toUint8Array()}(e,Xn,Bi,Fi)},Zr="You must not compute changes after the event-handler fired.",Kr=function(){return P((function e(t,n){A(this,e),this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}),[{key:"path",get:function(){return this._path||(this._path=Xr(this.currentTarget,this.target))}},{key:"deletes",value:function(e){return Mi(this.transaction.deleteSet,e.id)}},{key:"keys",get:function(){var e=this;if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw pn(Zr);var t=new Map,n=this.target;this.transaction.changed.get(n).forEach((function(i){if(null!==i){var r,o,a=n._map.get(i);if(e.adds(a)){for(var s=a.left;null!==s&&e.adds(s);)s=s.left;if(e.deletes(a)){if(null===s||!e.deletes(s))return;r="delete",o=St(s.content.getContent())}else null!==s&&e.deletes(s)?(r="update",o=St(s.content.getContent())):(r="add",o=void 0)}else{if(!e.deletes(a))return;r="delete",o=St(a.content.getContent())}t.set(i,{action:r,oldValue:o})}})),this._keys=t}return this._keys}},{key:"delta",get:function(){return this.changes.delta}},{key:"adds",value:function(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}},{key:"changes",get:function(){var e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw pn(Zr);var t=this.target,n=Et(),i=Et(),r=[];if(e={added:n,deleted:i,delta:r,keys:this.keys},this.transaction.changed.get(t).has(null)){for(var o=null,a=function(){o&&r.push(o)},s=t._start;null!==s;s=s.right)s.deleted?this.deletes(s)&&!this.adds(s)&&(null!==o&&void 0!==o.delete||(a(),o={delete:0}),o.delete+=s.length,i.add(s)):this.adds(s)?(null!==o&&void 0!==o.insert||(a(),o={insert:[]}),o.insert=o.insert.concat(s.content.getContent()),n.add(s)):(null!==o&&void 0!==o.retain||(a(),o={retain:0}),o.retain+=s.length);null!==o&&void 0===o.retain&&a()}this._changes=e}return e}}])}(),Xr=function(e,t){for(var n=[];null!==t._item&&t!==e;){if(null!==t._item.parentSub)n.unshift(t._item.parentSub);else{for(var i=0,r=t._item.parent._start;r!==t._item&&null!==r;)!r.deleted&&r.countable&&(i+=r.length),r=r.right;n.unshift(i)}t=t._item.parent}return n},$r=0,Qr=P((function e(t,n){A(this,e),t.marker=!0,this.p=t,this.index=n,this.timestamp=$r++})),eo=function(e,t,n){e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=$r++},to=function(e,t){if(null===e._start||0===t||null===e._searchMarker)return null;var n=0===e._searchMarker.length?null:e._searchMarker.reduce((function(e,n){return Tt(t-e.index)<Tt(t-n.index)?e:n})),i=e._start,r=0;for(null!==n&&(i=n.p,r=n.index,function(e){e.timestamp=$r++}(n));null!==i.right&&r<t;){if(!i.deleted&&i.countable){if(t<r+i.length)break;r+=i.length}i=i.right}for(;null!==i.left&&r>t;)!(i=i.left).deleted&&i.countable&&(r-=i.length);for(;null!==i.left&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)!(i=i.left).deleted&&i.countable&&(r-=i.length);return null!==n&&Tt(n.index-r)<i.parent.length/80?(eo(n,i,r),n):function(e,t,n){if(e.length>=80){var i=e.reduce((function(e,t){return e.timestamp<t.timestamp?e:t}));return eo(i,t,n),i}var r=new Qr(t,n);return e.push(r),r}(e._searchMarker,i,r)},no=function(e,t,n){for(var i=e.length-1;i>=0;i--){var r=e[i];if(n>0){var o=r.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)(o=o.left)&&!o.deleted&&o.countable&&(r.index-=o.length);if(null===o||!0===o.marker){e.splice(i,1);continue}r.p=o,o.marker=!0}(t<r.index||n>0&&t===r.index)&&(r.index=jt(t,r.index+n))}},io=function(e,t,n){for(var i=e,r=t.changedParentTypes;Ct(r,e,(function(){return[]})).push(n),null!==e._item;)e=e._item.parent;er(i._eH,n,t)},ro=function(){return P((function e(){A(this,e),this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Xi(),this._dEH=Xi(),this._searchMarker=null}),[{key:"parent",get:function(){return this._item?this._item.parent:null}},{key:"_integrate",value:function(e,t){this.doc=e,this._item=t}},{key:"_copy",value:function(){throw yn()}},{key:"clone",value:function(){throw yn()}},{key:"_write",value:function(e){}},{key:"_first",get:function(){for(var e=this._start;null!==e&&e.deleted;)e=e.right;return e}},{key:"_callObserver",value:function(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}},{key:"observe",value:function(e){$i(this._eH,e)}},{key:"observeDeep",value:function(e){$i(this._dEH,e)}},{key:"unobserve",value:function(e){Qi(this._eH,e)}},{key:"unobserveDeep",value:function(e){Qi(this._dEH,e)}},{key:"toJSON",value:function(){}}])}(),oo=function(e,t,n){t<0&&(t=e._length+t),n<0&&(n=e._length+n);for(var i=n-t,r=[],o=e._start;null!==o&&i>0;){if(o.countable&&!o.deleted){var a=o.content.getContent();if(a.length<=t)t-=a.length;else{for(var s=t;s<a.length&&i>0;s++)r.push(a[s]),i--;t=0}}o=o.right}return r},ao=function(e){for(var t=[],n=e._start;null!==n;){if(n.countable&&!n.deleted)for(var i=n.content.getContent(),r=0;r<i.length;r++)t.push(i[r]);n=n.right}return t},so=function(e,t){for(var n=0,i=e._start;null!==i;){if(i.countable&&!i.deleted)for(var r=i.content.getContent(),o=0;o<r.length;o++)t(r[o],n++,e);i=i.right}},lo=function(e,t){var n=[];return so(e,(function(i,r){n.push(t(i,r,e))})),n},uo=function(e,t){var n=to(e,t),i=e._start;for(null!==n&&(i=n.p,t-=n.index);null!==i;i=i.right)if(!i.deleted&&i.countable){if(t<i.length)return i.content.getContent()[t];t-=i.length}},co=function(e,t,n,i){var r=n,o=e.doc,a=o.clientID,s=o.store,l=null===n?t._start:n.right,u=[],c=function(){u.length>0&&((r=new ma(ir(a,br(s,a)),r,r&&r.lastId,l,l&&l.id,t,null,new na(u))).integrate(e,0),u=[])};i.forEach((function(n){if(null===n)u.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:u.push(n);break;default:switch(c(),n.constructor){case Uint8Array:case ArrayBuffer:(r=new ma(ir(a,br(s,a)),r,r&&r.lastId,l,l&&l.id,t,null,new Zo(new Uint8Array(n)))).integrate(e,0);break;case Di:(r=new ma(ir(a,br(s,a)),r,r&&r.lastId,l,l&&l.id,t,null,new $o(n))).integrate(e,0);break;default:if(!(n instanceof ro))throw new Error("Unexpected content type in insert operation");(r=new ma(ir(a,br(s,a)),r,r&&r.lastId,l,l&&l.id,t,null,new fa(n))).integrate(e,0)}}})),c()},ho=function(){return pn("Length exceeded!")},fo=function(e,t,n,i){if(n>t._length)throw ho();if(0===n)return t._searchMarker&&no(t._searchMarker,n,i.length),co(e,t,null,i);var r=n,o=to(t,n),a=t._start;for(null!==o&&(a=o.p,0===(n-=o.index)&&(n+=(a=a.prev)&&a.countable&&!a.deleted?a.length:0));null!==a;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&Sr(e,ir(a.id.client,a.id.clock+n));break}n-=a.length}return t._searchMarker&&no(t._searchMarker,r,i.length),co(e,t,a,i)},vo=function(e,t,n,i){if(0!==i){var r=n,o=i,a=to(t,n),s=t._start;for(null!==a&&(s=a.p,n-=a.index);null!==s&&n>0;s=s.right)!s.deleted&&s.countable&&(n<s.length&&Sr(e,ir(s.id.client,s.id.clock+n)),n-=s.length);for(;i>0&&null!==s;)s.deleted||(i<s.length&&Sr(e,ir(s.id.client,s.id.clock+i)),s.delete(e),i-=s.length),s=s.right;if(i>0)throw ho();t._searchMarker&&no(t._searchMarker,r,-o+i)}},go=function(e,t,n){var i=t._map.get(n);void 0!==i&&i.delete(e)},po=function(e,t,n,i){var r,o=t._map.get(n)||null,a=e.doc,s=a.clientID;if(null==i)r=new na([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:r=new na([i]);break;case Uint8Array:r=new Zo(i);break;case Di:r=new $o(i);break;default:if(!(i instanceof ro))throw new Error("Unexpected content type");r=new fa(i)}new ma(ir(s,br(a.store,s)),o,o&&o.lastId,null,null,t,n,r).integrate(e,0)},yo=function(e,t){var n=e._map.get(t);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},mo=function(e){var t={};return e._map.forEach((function(e,n){e.deleted||(t[n]=e.content.getContent()[e.length-1])})),t},wo=function(e,t){var n=e._map.get(t);return void 0!==n&&!n.deleted},bo=function(e){return function(e,t){return ki((function(){var n;do{n=e.next()}while(!n.done&&!t(n.value));return n}))}(e.entries(),(function(e){return!e[1].deleted}))},ko=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t)}(Kr),xo=function(e){function t(){var e;return A(this,t),(e=s(this,t))._prelimContent=[],e._searchMarker=[],e}return h(t,e),P(t,[{key:"_integrate",value:function(e,n){o(t,"_integrate",this,3)([e,n]),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new t}},{key:"clone",value:function(){var e=new t;return e.insert(0,this.toArray().map((function(e){return e instanceof ro?e.clone():e}))),e}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}},{key:"_callObserver",value:function(e,n){o(t,"_callObserver",this,3)([e,n]),io(this,e,new ko(this,e))}},{key:"insert",value:function(e,t){var n,i=this;null!==this.doc?jr(this.doc,(function(n){fo(n,i,e,t)})):(n=this._prelimContent).splice.apply(n,[e,0].concat(v(t)))}},{key:"push",value:function(e){var t,n=this;null!==this.doc?jr(this.doc,(function(t){!function(e,t,n){var i=(t._searchMarker||[]).reduce((function(e,t){return t.index>e.index?t:e}),{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;co(e,t,i,n)}(t,n,e)})):(t=this._prelimContent).push.apply(t,v(e))}},{key:"unshift",value:function(e){this.insert(0,e)}},{key:"delete",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;null!==this.doc?jr(this.doc,(function(i){vo(i,t,e,n)})):this._prelimContent.splice(e,n)}},{key:"get",value:function(e){return uo(this,e)}},{key:"toArray",value:function(){return ao(this)}},{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return oo(this,e,t)}},{key:"toJSON",value:function(){return this.map((function(e){return e instanceof ro?e.toJSON():e}))}},{key:"map",value:function(e){return lo(this,e)}},{key:"forEach",value:function(e){so(this,e)}},{key:Symbol.iterator,value:function(){return e=this._start,t=null,n=0,O(O({},Symbol.iterator,(function(){return this})),"next",(function(){if(null===t){for(;null!==e&&e.deleted;)e=e.right;if(null===e)return{done:!0,value:void 0};t=e.content.getContent(),n=0,e=e.right}var i=t[n++];return t.length<=n&&(t=null),{done:!1,value:i}}));var e,t,n}},{key:"_write",value:function(e){e.writeTypeRef(oa)}}],[{key:"from",value:function(e){var n=new t;return n.push(e),n}}])}(ro),Co=function(e){function t(e,n,i){var r;return A(this,t),(r=s(this,t,[e,n])).keysChanged=i,r}return h(t,e),P(t)}(Kr),Eo=function(e){function t(e){var n;return A(this,t),(n=s(this,t))._prelimContent=null,n._prelimContent=void 0===e?new Map:new Map(e),n}return h(t,e),P(t,[{key:"_integrate",value:function(e,n){var i=this;o(t,"_integrate",this,3)([e,n]),this._prelimContent.forEach((function(e,t){i.set(t,e)})),this._prelimContent=null}},{key:"_copy",value:function(){return new t}},{key:"clone",value:function(){var e=new t;return this.forEach((function(t,n){e.set(n,t instanceof ro?t.clone():t)})),e}},{key:"_callObserver",value:function(e,t){io(this,e,new Co(this,e,t))}},{key:"toJSON",value:function(){var e={};return this._map.forEach((function(t,n){if(!t.deleted){var i=t.content.getContent()[t.length-1];e[n]=i instanceof ro?i.toJSON():i}})),e}},{key:"size",get:function(){return v(bo(this._map)).length}},{key:"keys",value:function(){return xi(bo(this._map),(function(e){return e[0]}))}},{key:"values",value:function(){return xi(bo(this._map),(function(e){return e[1].content.getContent()[e[1].length-1]}))}},{key:"entries",value:function(){return xi(bo(this._map),(function(e){return[e[0],e[1].content.getContent()[e[1].length-1]]}))}},{key:"forEach",value:function(e){var t=this;this._map.forEach((function(n,i){n.deleted||e(n.content.getContent()[n.length-1],i,t)}))}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"delete",value:function(e){var t=this;null!==this.doc?jr(this.doc,(function(n){go(n,t,e)})):this._prelimContent.delete(e)}},{key:"set",value:function(e,t){var n=this;return null!==this.doc?jr(this.doc,(function(i){po(i,n,e,t)})):this._prelimContent.set(e,t),t}},{key:"get",value:function(e){return yo(this,e)}},{key:"has",value:function(e){return wo(this,e)}},{key:"clear",value:function(){var e=this;null!==this.doc?jr(this.doc,(function(t){e.forEach((function(e,n,i){go(t,i,n)}))})):this._prelimContent.clear()}},{key:"_write",value:function(e){e.writeTypeRef(aa)}}])}(ro),So=function(e,t){return e===t||"object"===d(e)&&"object"===d(t)&&e&&t&&Zn(e,t)},Mo=function(){return P((function e(t,n,i,r){A(this,e),this.left=t,this.right=n,this.index=i,this.currentAttributes=r}),[{key:"forward",value:function(){if(null===this.right&&mn(),this.right.content.constructor===ea)this.right.deleted||Oo(this.currentAttributes,this.right.content);else this.right.deleted||(this.index+=this.right.length);this.left=this.right,this.right=this.right.right}}])}(),Ao=function(e,t,n){for(;null!==t.right&&n>0;){if(t.right.content.constructor===ea)t.right.deleted||Oo(t.currentAttributes,t.right.content);else t.right.deleted||(n<t.right.length&&Sr(e,ir(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);t.left=t.right,t.right=t.right.right}return t},_o=function(e,t,n,i){var r=new Map,o=i?to(t,n):null;if(o){var a=new Mo(o.p.left,o.p,o.index,r);return Ao(e,a,n-o.index)}var s=new Mo(null,t._start,0,r);return Ao(e,s,n)},Po=function(e,t,n,i){for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===ea&&So(i.get(n.right.content.key),n.right.content.value));)n.right.deleted||i.delete(n.right.content.key),n.forward();var r=e.doc,o=r.clientID;i.forEach((function(i,a){var s=n.left,l=n.right,u=new ma(ir(o,br(r.store,o)),s,s&&s.lastId,l,l&&l.id,t,null,new ea(a,i));u.integrate(e,0),n.right=u,n.forward()}))},Oo=function(e,t){var n=t.key,i=t.value;null===i?e.delete(n):e.set(n,i)},To=function(e,t){for(;;){var n;if(null===e.right)break;if(!(e.right.deleted||e.right.content.constructor===ea&&So(null!==(n=t[e.right.content.key])&&void 0!==n?n:null,e.right.content.value)))break;e.forward()}},Lo=function(e,t,n,i){var r=e.doc,o=r.clientID,a=new Map;for(var s in i){var l,u=i[s],c=null!==(l=n.currentAttributes.get(s))&&void 0!==l?l:null;if(!So(c,u)){a.set(s,c);var h=n.left,f=n.right;n.right=new ma(ir(o,br(r.store,o)),h,h&&h.lastId,f,f&&f.id,t,null,new ea(s,u)),n.right.integrate(e,0),n.forward()}}return a},jo=function(e,t,n,i,r){n.currentAttributes.forEach((function(e,t){void 0===r[t]&&(r[t]=null)}));var o=e.doc,a=o.clientID;To(n,r);var s=Lo(e,t,n,r),l=i.constructor===String?new ia(i):i instanceof ro?new fa(i):new Qo(i),u=n.left,c=n.right,h=n.index;t._searchMarker&&no(t._searchMarker,n.index,l.getLength()),(c=new ma(ir(a,br(o.store,a)),u,u&&u.lastId,c,c&&c.id,t,null,l)).integrate(e,0),n.right=c,n.index=h,n.forward(),Po(e,t,n,s)},No=function(e,t,n,i,r){var o=e.doc,a=o.clientID;To(n,r);var s=Lo(e,t,n,r);e:for(;null!==n.right&&(i>0||s.size>0&&(n.right.deleted||n.right.content.constructor===ea));){if(!n.right.deleted)if(n.right.content.constructor===ea){var l=n.right.content,u=l.key,c=l.value,h=r[u];if(void 0!==h){if(So(h,c))s.delete(u);else{if(0===i)break e;s.set(u,c)}n.right.delete(e)}else n.currentAttributes.set(u,c)}else i<n.right.length&&Sr(e,ir(n.right.id.client,n.right.id.clock+i)),i-=n.right.length;n.forward()}if(i>0){for(var f="";i>0;i--)f+="\n";n.right=new ma(ir(a,br(o.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new ia(f)),n.right.integrate(e,0),n.forward()}Po(e,t,n,s)},Do=function(e,t,n,i,r){for(var o=t,a=kt();o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===ea){var s=o.content;a.set(s.key,s)}o=o.right}for(var l=0,u=!1;t!==o;){if(n===t&&(u=!0),!t.deleted){var c=t.content;if(c.constructor===ea){var h,f,d=c.key,v=c.value,g=null!==(h=i.get(d))&&void 0!==h?h:null;a.get(d)===c&&g!==v||(t.delete(e),l++,u||(null!==(f=r.get(d))&&void 0!==f?f:null)!==v||g===v||(null===g?r.delete(d):r.set(d,g))),u||t.deleted||Oo(r,c)}}t=t.right}return l},Io=function(e){var t=0;return jr(e.doc,(function(n){for(var i=e._start,r=e._start,o=kt(),a=xt(o);r;){if(!1===r.deleted)if(r.content.constructor===ea)Oo(a,r.content);else t+=Do(n,i,r,o,a),o=xt(a),i=r;r=r.right}})),t},Ro=function(e){var t,n=new Set,i=e.doc,r=w(e.afterState.entries());try{for(r.s();!(t=r.n()).done;){var o=p(t.value,2),a=o[0],s=o[1],l=e.beforeState.get(a)||0;s!==l&&Ar(e,i.store.clients.get(a),l,s,(function(e){e.deleted||e.content.constructor!==ea||e.constructor===Yo||n.add(e.parent)}))}}catch(u){r.e(u)}finally{r.f()}jr(i,(function(t){Si(e,e.deleteSet,(function(e){if(!(e instanceof Yo||!e.parent._hasFormatting||n.has(e.parent))){var i=e.parent;e.content.constructor===ea?n.add(i):function(e,t){for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;for(var n=new Set;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===ea){var i=t.content.key;n.has(i)?t.delete(e):n.add(i)}t=t.left}}(t,e)}}));var i,r=w(n);try{for(r.s();!(i=r.n()).done;){var o=i.value;Io(o)}}catch(u){r.e(u)}finally{r.f()}}))},Bo=function(e,t,n){for(var i=n,r=xt(t.currentAttributes),o=t.right;n>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case fa:case Qo:case ia:n<t.right.length&&Sr(e,ir(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e)}t.forward()}o&&Do(e,o,t.right,r,t.currentAttributes);var a=(t.left||t.right).parent;return a._searchMarker&&no(a._searchMarker,t.index,-i+n),t},zo=function(e){function t(e,n,i){var r;return A(this,t),(r=s(this,t,[e,n])).childListChanged=!1,r.keysChanged=new Set,i.forEach((function(e){null===e?r.childListChanged=!0:r.keysChanged.add(e)})),r}return h(t,e),P(t,[{key:"changes",get:function(){if(null===this._changes){var e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}},{key:"delta",get:function(){var e=this;if(null===this._delta){var t=this.target.doc,n=[];jr(t,(function(t){for(var i=new Map,r=new Map,o=e.target._start,a=null,s={},l="",u=0,c=0,h=function(){if(null!==a){var e=null;switch(a){case"delete":c>0&&(e={delete:c}),c=0;break;case"insert":("object"===d(l)||l.length>0)&&(e={insert:l},i.size>0&&(e.attributes={},i.forEach((function(t,n){null!==t&&(e.attributes[n]=t)})))),l="";break;case"retain":u>0&&(e={retain:u},function(e){for(var t in e)return!1;return!0}(s)||(e.attributes=Jn({},s))),u=0}e&&n.push(e),a=null}};null!==o;){switch(o.content.constructor){case fa:case Qo:e.adds(o)?e.deletes(o)||(h(),a="insert",l=o.content.getContent()[0],h()):e.deletes(o)?("delete"!==a&&(h(),a="delete"),c+=1):o.deleted||("retain"!==a&&(h(),a="retain"),u+=1);break;case ia:e.adds(o)?e.deletes(o)||("insert"!==a&&(h(),a="insert"),l+=o.content.str):e.deletes(o)?("delete"!==a&&(h(),a="delete"),c+=o.length):o.deleted||("retain"!==a&&(h(),a="retain"),u+=o.length);break;case ea:var f=o.content,v=f.key,g=f.value;if(e.adds(o)){if(!e.deletes(o)){var p,y,m=null!==(p=i.get(v))&&void 0!==p?p:null;if(So(m,g))null!==g&&o.delete(t);else"retain"===a&&h(),So(g,null!==(y=r.get(v))&&void 0!==y?y:null)?delete s[v]:s[v]=g}}else if(e.deletes(o)){var w;r.set(v,g);var b=null!==(w=i.get(v))&&void 0!==w?w:null;So(b,g)||("retain"===a&&h(),s[v]=b)}else if(!o.deleted){r.set(v,g);var k=s[v];void 0!==k&&(So(k,g)?null!==k&&o.delete(t):("retain"===a&&h(),null===g?delete s[v]:s[v]=g))}o.deleted||("insert"===a&&h(),Oo(i,o.content))}o=o.right}for(h();n.length>0;){var x=n[n.length-1];if(void 0===x.retain||void 0!==x.attributes)break;n.pop()}})),this._delta=n}return this._delta}}])}(Kr),Fo=function(e){function t(e){var n;return A(this,t),(n=s(this,t))._pending=void 0!==e?[function(){return n.insert(0,e)}]:[],n._searchMarker=[],n._hasFormatting=!1,n}return h(t,e),P(t,[{key:"length",get:function(){return this._length}},{key:"_integrate",value:function(e,n){o(t,"_integrate",this,3)([e,n]);try{this._pending.forEach((function(e){return e()}))}catch(dx){console.error(dx)}this._pending=null}},{key:"_copy",value:function(){return new t}},{key:"clone",value:function(){var e=new t;return e.applyDelta(this.toDelta()),e}},{key:"_callObserver",value:function(e,n){o(t,"_callObserver",this,3)([e,n]);var i=new zo(this,e,n);io(this,e,i),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}},{key:"toString",value:function(){for(var e="",t=this._start;null!==t;)!t.deleted&&t.countable&&t.content.constructor===ia&&(e+=t.content.str),t=t.right;return e}},{key:"toJSON",value:function(){return this.toString()}},{key:"applyDelta",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).sanitize,i=void 0===n||n;null!==this.doc?jr(this.doc,(function(n){for(var r=new Mo(null,t._start,0,new Map),o=0;o<e.length;o++){var a=e[o];if(void 0!==a.insert){var s=i||"string"!=typeof a.insert||o!==e.length-1||null!==r.right||"\n"!==a.insert.slice(-1)?a.insert:a.insert.slice(0,-1);("string"!=typeof s||s.length>0)&&jo(n,t,r,s,a.attributes||{})}else void 0!==a.retain?No(n,t,r,a.retain,a.attributes||{}):void 0!==a.delete&&Bo(n,r,a.delete)}})):this._pending.push((function(){return t.applyDelta(e)}))}},{key:"toDelta",value:function(e,t,n){var i=[],r=new Map,o=this.doc,a="",s=this._start;function l(){if(a.length>0){var e={},t=!1;r.forEach((function(n,i){t=!0,e[i]=n}));var n={insert:a};t&&(n.attributes=e),i.push(n),a=""}}var u=function(){for(var o=function(){if(pr(s,e)||void 0!==t&&pr(s,t))switch(s.content.constructor){case ia:var o=r.get("ychange");void 0===e||pr(s,e)?void 0===t||pr(s,t)?void 0!==o&&(l(),r.delete("ychange")):void 0!==o&&o.user===s.id.client&&"added"===o.type||(l(),r.set("ychange",n?n("added",s.id):{type:"added"})):void 0!==o&&o.user===s.id.client&&"removed"===o.type||(l(),r.set("ychange",n?n("removed",s.id):{type:"removed"})),a+=s.content.str;break;case fa:case Qo:l();var u={insert:s.content.getContent()[0]};if(r.size>0){var c={};u.attributes=c,r.forEach((function(e,t){c[t]=e}))}i.push(u);break;case ea:pr(s,e)&&(l(),Oo(r,s.content))}s=s.right};null!==s;)o();l()};return e||t?jr(o,(function(n){e&&yr(n,e),t&&yr(n,t),u()}),"cleanup"):u(),i}},{key:"insert",value:function(e,t,n){var i=this;if(!(t.length<=0)){var r=this.doc;null!==r?jr(r,(function(r){var o=_o(r,i,e,!n);n||(n={},o.currentAttributes.forEach((function(e,t){n[t]=e}))),jo(r,i,o,t,n)})):this._pending.push((function(){return i.insert(e,t,n)}))}}},{key:"insertEmbed",value:function(e,t,n){var i=this,r=this.doc;null!==r?jr(r,(function(r){var o=_o(r,i,e,!n);jo(r,i,o,t,n||{})})):this._pending.push((function(){return i.insertEmbed(e,t,n||{})}))}},{key:"delete",value:function(e,t){var n=this;if(0!==t){var i=this.doc;null!==i?jr(i,(function(i){Bo(i,_o(i,n,e,!0),t)})):this._pending.push((function(){return n.delete(e,t)}))}}},{key:"format",value:function(e,t,n){var i=this;if(0!==t){var r=this.doc;null!==r?jr(r,(function(r){var o=_o(r,i,e,!1);null!==o.right&&No(r,i,o,t,n)})):this._pending.push((function(){return i.format(e,t,n)}))}}},{key:"removeAttribute",value:function(e){var t=this;null!==this.doc?jr(this.doc,(function(n){go(n,t,e)})):this._pending.push((function(){return t.removeAttribute(e)}))}},{key:"setAttribute",value:function(e,t){var n=this;null!==this.doc?jr(this.doc,(function(i){po(i,n,e,t)})):this._pending.push((function(){return n.setAttribute(e,t)}))}},{key:"getAttribute",value:function(e){return yo(this,e)}},{key:"getAttributes",value:function(){return mo(this)}},{key:"_write",value:function(e){e.writeTypeRef(sa)}}])}(ro),Vo=function(){return P((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};A(this,e),this._filter=n,this._root=t,this._currentNode=t._start,this._firstCall=!0}),[{key:Symbol.iterator,value:function(){return this}},{key:"next",value:function(){var e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do{if(t=e.content.type,e.deleted||t.constructor!==Uo&&t.constructor!==Ho||null===t._start)for(;null!==e;){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=t._start}while(null!==e&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,null===e?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}])}(),Ho=function(e){function t(){var e;return A(this,t),(e=s(this,t))._prelimContent=[],e}return h(t,e),P(t,[{key:"firstChild",get:function(){var e=this._first;return e?e.content.getContent()[0]:null}},{key:"_integrate",value:function(e,n){o(t,"_integrate",this,3)([e,n]),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new t}},{key:"clone",value:function(){var e=new t;return e.insert(0,this.toArray().map((function(e){return e instanceof ro?e.clone():e}))),e}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}},{key:"createTreeWalker",value:function(e){return new Vo(this,e)}},{key:"querySelector",value:function(e){e=e.toUpperCase();var t=new Vo(this,(function(t){return t.nodeName&&t.nodeName.toUpperCase()===e})).next();return t.done?null:t.value}},{key:"querySelectorAll",value:function(e){return e=e.toUpperCase(),At(new Vo(this,(function(t){return t.nodeName&&t.nodeName.toUpperCase()===e})))}},{key:"_callObserver",value:function(e,t){io(this,e,new qo(this,t,e))}},{key:"toString",value:function(){return lo(this,(function(e){return e.toString()})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"toDOM",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=e.createDocumentFragment();return void 0!==n&&n._createAssociation(i,this),so(this,(function(r){i.insertBefore(r.toDOM(e,t,n),null)})),i}},{key:"insert",value:function(e,t){var n,i=this;null!==this.doc?jr(this.doc,(function(n){fo(n,i,e,t)})):(n=this._prelimContent).splice.apply(n,[e,0].concat(v(t)))}},{key:"insertAfter",value:function(e,t){var n=this;if(null!==this.doc)jr(this.doc,(function(i){var r=e&&e instanceof ro?e._item:e;co(i,n,r,t)}));else{var i=this._prelimContent,r=null===e?0:i.findIndex((function(t){return t===e}))+1;if(0===r&&null!==e)throw pn("Reference item not found");i.splice.apply(i,[r,0].concat(v(t)))}}},{key:"delete",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;null!==this.doc?jr(this.doc,(function(i){vo(i,t,e,n)})):this._prelimContent.splice(e,n)}},{key:"toArray",value:function(){return ao(this)}},{key:"push",value:function(e){this.insert(this.length,e)}},{key:"unshift",value:function(e){this.insert(0,e)}},{key:"get",value:function(e){return uo(this,e)}},{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return oo(this,e,t)}},{key:"forEach",value:function(e){so(this,e)}},{key:"_write",value:function(e){e.writeTypeRef(ua)}}])}(ro),Uo=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"UNDEFINED";return A(this,t),(e=s(this,t)).nodeName=n,e._prelimAttrs=new Map,e}return h(t,e),P(t,[{key:"nextSibling",get:function(){var e=this._item?this._item.next:null;return e?e.content.type:null}},{key:"prevSibling",get:function(){var e=this._item?this._item.prev:null;return e?e.content.type:null}},{key:"_integrate",value:function(e,n){var i=this;o(t,"_integrate",this,3)([e,n]),this._prelimAttrs.forEach((function(e,t){i.setAttribute(t,e)})),this._prelimAttrs=null}},{key:"_copy",value:function(){return new t(this.nodeName)}},{key:"clone",value:function(){var e=new t(this.nodeName);return function(e,t){for(var n in e)t(e[n],n)}(this.getAttributes(),(function(t,n){"string"==typeof t&&e.setAttribute(n,t)})),e.insert(0,this.toArray().map((function(e){return e instanceof ro?e.clone():e}))),e}},{key:"toString",value:function(){var e=this.getAttributes(),n=[],i=[];for(var r in e)i.push(r);i.sort();for(var a=i.length,s=0;s<a;s++){var l=i[s];n.push(l+'="'+e[l]+'"')}var u=this.nodeName.toLocaleLowerCase(),c=n.length>0?" "+n.join(" "):"";return"<".concat(u).concat(c,">").concat(o(t,"toString",this,3)([]),"</").concat(u,">")}},{key:"removeAttribute",value:function(e){var t=this;null!==this.doc?jr(this.doc,(function(n){go(n,t,e)})):this._prelimAttrs.delete(e)}},{key:"setAttribute",value:function(e,t){var n=this;null!==this.doc?jr(this.doc,(function(i){po(i,n,e,t)})):this._prelimAttrs.set(e,t)}},{key:"getAttribute",value:function(e){return yo(this,e)}},{key:"hasAttribute",value:function(e){return wo(this,e)}},{key:"getAttributes",value:function(e){return e?function(e,t){var n={};return e._map.forEach((function(e,i){for(var r=e;null!==r&&(!t.sv.has(r.id.client)||r.id.clock>=(t.sv.get(r.id.client)||0));)r=r.left;null!==r&&pr(r,t)&&(n[i]=r.content.getContent()[r.length-1])})),n}(this,e):mo(this)}},{key:"toDOM",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=e.createElement(this.nodeName),r=this.getAttributes();for(var o in r){var a=r[o];"string"==typeof a&&i.setAttribute(o,a)}return so(this,(function(r){i.appendChild(r.toDOM(e,t,n))})),void 0!==n&&n._createAssociation(i,this),i}},{key:"_write",value:function(e){e.writeTypeRef(la),e.writeKey(this.nodeName)}}])}(Ho),qo=function(e){function t(e,n,i){var r;return A(this,t),(r=s(this,t,[e,i])).childListChanged=!1,r.attributesChanged=new Set,n.forEach((function(e){null===e?r.childListChanged=!0:r.attributesChanged.add(e)})),r}return h(t,e),P(t)}(Kr),Go=function(e){function t(e){var n;return A(this,t),(n=s(this,t)).hookName=e,n}return h(t,e),P(t,[{key:"_copy",value:function(){return new t(this.hookName)}},{key:"clone",value:function(){var e=new t(this.hookName);return this.forEach((function(t,n){e.set(n,t)})),e}},{key:"toDOM",value:function(){arguments.length>0&&void 0!==arguments[0]||document;var e,t=arguments.length>2?arguments[2]:void 0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})[this.hookName];return(e=void 0!==n?n.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==t&&t._createAssociation(e,this),e}},{key:"_write",value:function(e){e.writeTypeRef(ca),e.writeKey(this.hookName)}}])}(Eo),Jo=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"nextSibling",get:function(){var e=this._item?this._item.next:null;return e?e.content.type:null}},{key:"prevSibling",get:function(){var e=this._item?this._item.prev:null;return e?e.content.type:null}},{key:"_copy",value:function(){return new t}},{key:"clone",value:function(){var e=new t;return e.applyDelta(this.toDelta()),e}},{key:"toDOM",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>2?arguments[2]:void 0,n=e.createTextNode(this.toString());return void 0!==t&&t._createAssociation(n,this),n}},{key:"toString",value:function(){return this.toDelta().map((function(e){var t=[];for(var n in e.attributes){var i=[];for(var r in e.attributes[n])i.push({key:r,value:e.attributes[n][r]});i.sort((function(e,t){return e.key<t.key?-1:1})),t.push({nodeName:n,attrs:i})}t.sort((function(e,t){return e.nodeName<t.nodeName?-1:1}));for(var o="",a=0;a<t.length;a++){var s=t[a];o+="<".concat(s.nodeName);for(var l=0;l<s.attrs.length;l++){var u=s.attrs[l];o+=" ".concat(u.key,'="').concat(u.value,'"')}o+=">"}o+=e.insert;for(var c=t.length-1;c>=0;c--)o+="</".concat(t[c].nodeName,">");return o})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"_write",value:function(e){e.writeTypeRef(ha)}}])}(Fo),Wo=function(){return P((function e(t,n){A(this,e),this.id=t,this.length=n}),[{key:"deleted",get:function(){throw yn()}},{key:"mergeWith",value:function(e){return!1}},{key:"write",value:function(e,t,n){throw yn()}},{key:"integrate",value:function(e,t){throw yn()}}])}(),Yo=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"deleted",get:function(){return!0}},{key:"delete",value:function(){}},{key:"mergeWith",value:function(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}},{key:"integrate",value:function(e,t){t>0&&(this.id.clock+=t,this.length-=t),kr(e.doc.store,this)}},{key:"write",value:function(e,t){e.writeInfo(0),e.writeLen(this.length-t)}},{key:"getMissing",value:function(e,t){return null}}])}(Wo),Zo=function(){function e(t){A(this,e),this.content=t}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.content]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.content)}},{key:"splice",value:function(e){throw yn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeBuf(this.content)}},{key:"getRef",value:function(){return 3}}])}(),Ko=function(){function e(t){A(this,e),this.len=t}return P(e,[{key:"getLength",value:function(){return this.len}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new e(this.len)}},{key:"splice",value:function(t){var n=new e(this.len-t);return this.len=t,n}},{key:"mergeWith",value:function(e){return this.len+=e.len,!0}},{key:"integrate",value:function(e,t){Pi(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeLen(this.len-t)}},{key:"getRef",value:function(){return 1}}])}(),Xo=function(e,t){return new Di(M(M({guid:e},t),{},{shouldLoad:t.shouldLoad||t.autoLoad||!1}))},$o=function(){function e(t){A(this,e),t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;var n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),null!==t.meta&&(n.meta=t.meta)}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.doc]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(Xo(this.doc.guid,this.opts))}},{key:"splice",value:function(e){throw yn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}},{key:"delete",value:function(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}},{key:"getRef",value:function(){return 9}}])}(),Qo=function(){function e(t){A(this,e),this.embed=t}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.embed]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.embed)}},{key:"splice",value:function(e){throw yn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeJSON(this.embed)}},{key:"getRef",value:function(){return 5}}])}(),ea=function(){function e(t,n){A(this,e),this.key=t,this.value=n}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new e(this.key,this.value)}},{key:"splice",value:function(e){throw yn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){var n=t.parent;n._searchMarker=null,n._hasFormatting=!0}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeKey(this.key),e.writeJSON(this.value)}},{key:"getRef",value:function(){return 6}}])}(),ta=function(){function e(t){A(this,e),this.arr=t}return P(e,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.arr)}},{key:"splice",value:function(t){var n=new e(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}},{key:"mergeWith",value:function(e){return this.arr=this.arr.concat(e.arr),!0}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){var n=this.arr.length;e.writeLen(n-t);for(var i=t;i<n;i++){var r=this.arr[i];e.writeString(void 0===r?"undefined":JSON.stringify(r))}}},{key:"getRef",value:function(){return 2}}])}(),na=function(){function e(t){A(this,e),this.arr=t}return P(e,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.arr)}},{key:"splice",value:function(t){var n=new e(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}},{key:"mergeWith",value:function(e){return this.arr=this.arr.concat(e.arr),!0}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){var n=this.arr.length;e.writeLen(n-t);for(var i=t;i<n;i++){var r=this.arr[i];e.writeAny(r)}}},{key:"getRef",value:function(){return 8}}])}(),ia=function(){function e(t){A(this,e),this.str=t}return P(e,[{key:"getLength",value:function(){return this.str.length}},{key:"getContent",value:function(){return this.str.split("")}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.str)}},{key:"splice",value:function(t){var n=new e(this.str.slice(t));this.str=this.str.slice(0,t);var i=this.str.charCodeAt(t-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,t-1)+"�",n.str="�"+n.str.slice(1)),n}},{key:"mergeWith",value:function(e){return this.str+=e.str,!0}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeString(0===t?this.str:this.str.slice(t))}},{key:"getRef",value:function(){return 4}}])}(),ra=[function(e){return new xo},function(e){return new Eo},function(e){return new Fo},function(e){return new Uo(e.readKey())},function(e){return new Ho},function(e){return new Go(e.readKey())},function(e){return new Jo}],oa=0,aa=1,sa=2,la=3,ua=4,ca=5,ha=6,fa=function(){function e(t){A(this,e),this.type=t}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.type]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.type._copy())}},{key:"splice",value:function(e){throw yn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){this.type._integrate(e.doc,t)}},{key:"delete",value:function(e){for(var t=this.type._start;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach((function(t){t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)})),e.changed.delete(this.type)}},{key:"gc",value:function(e){for(var t=this.type._start;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach((function(t){for(;null!==t;)t.gc(e,!0),t=t.left})),this.type._map=new Map}},{key:"write",value:function(e,t){this.type._write(e)}},{key:"getRef",value:function(){return 7}}])}(),da=function(e,t){var n,i=t,r=0;do{r>0&&(i=ir(i.client,i.clock+r)),n=Cr(e,i),r=i.clock-n.id.clock,i=n.redone}while(null!==i&&n instanceof ma);return{item:n,diff:r}},va=function(e,t){for(;null!==e&&e.keep!==t;)e.keep=t,e=e.parent._item},ga=function(e,t,n){var i=t.id,r=i.client,o=i.clock,a=new ma(ir(r,o+n),t,ir(r,o+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&a.markDeleted(),t.keep&&(a.keep=!0),null!==t.redone&&(a.redone=ir(t.redone.client,t.redone.clock+n)),t.right=a,null!==a.right&&(a.right.left=a),e._mergeStructs.push(a),null!==a.parentSub&&null===a.right&&a.parent._map.set(a.parentSub,a),t.length=n,a},pa=function(e,t){return function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1}(e,(function(e){return Mi(e.deletions,t)}))},ya=function(e,t,n,i,r,o){var a=e.doc,s=a.store,l=a.clientID,u=t.redone;if(null!==u)return Sr(e,u);var c,h=t.parent._item,f=null;if(null!==h&&!0===h.deleted){if(null===h.redone&&(!n.has(h)||null===ya(e,h,n,i,r,o)))return null;for(;null!==h.redone;)h=Sr(e,h.redone)}var d=null===h?t.parent:h.content.type;if(null===t.parentSub){for(f=t.left,c=t;null!==f;){for(var v=f;null!==v&&v.parent._item!==h;)v=null===v.redone?null:Sr(e,v.redone);if(null!==v&&v.parent._item===h){f=v;break}f=f.left}for(;null!==c;){for(var g=c;null!==g&&g.parent._item!==h;)g=null===g.redone?null:Sr(e,g.redone);if(null!==g&&g.parent._item===h){c=g;break}c=c.right}}else if(c=null,t.right&&!r){for(f=t;null!==f&&null!==f.right&&(f.right.redone||Mi(i,f.right.id)||pa(o.undoStack,f.right.id)||pa(o.redoStack,f.right.id));)for(f=f.right;f.redone;)f=Sr(e,f.redone);if(f&&null!==f.right)return null}else f=d._map.get(t.parentSub)||null;var p=br(s,l),y=ir(l,p),m=new ma(y,f,f&&f.lastId,c,c&&c.id,d,t.parentSub,t.content.copy());return t.redone=y,va(m,!0),m.integrate(e,0),m},ma=function(e){function t(e,n,i,r,o,a,l,u){var c;return A(this,t),(c=s(this,t,[e,u.getLength()])).origin=i,c.left=n,c.right=r,c.rightOrigin=o,c.parent=a,c.parentSub=l,c.redone=null,c.content=u,c.info=c.content.isCountable()?2:0,c}return h(t,e),P(t,[{key:"marker",get:function(){return(8&this.info)>0},set:function(e){(8&this.info)>0!==e&&(this.info^=8)}},{key:"keep",get:function(){return(1&this.info)>0},set:function(e){this.keep!==e&&(this.info^=1)}},{key:"countable",get:function(){return(2&this.info)>0}},{key:"deleted",get:function(){return(4&this.info)>0},set:function(e){this.deleted!==e&&(this.info^=4)}},{key:"markDeleted",value:function(){this.info|=4}},{key:"getMissing",value:function(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=br(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=br(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===tr&&this.id.client!==this.parent.client&&this.parent.clock>=br(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Mr(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Sr(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Yo||this.right&&this.right.constructor===Yo)this.parent=null;else if(this.parent){if(this.parent.constructor===tr){var i=Cr(n,this.parent);i.constructor===Yo?this.parent=null:this.parent=i.content.type}}else this.left&&this.left.constructor===t&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===t&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}},{key:"integrate",value:function(e,t){if(t>0&&(this.id.clock+=t,this.left=Mr(e,e.doc.store,ir(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){var n,i=this.left;if(null!==i)n=i.right;else if(null!==this.parentSub)for(n=this.parent._map.get(this.parentSub)||null;null!==n&&null!==n.left;)n=n.left;else n=this.parent._start;for(var r=new Set,o=new Set;null!==n&&n!==this.right;){if(o.add(n),r.add(n),nr(this.origin,n.origin)){if(n.id.client<this.id.client)i=n,r.clear();else if(nr(this.rightOrigin,n.rightOrigin))break}else{if(null===n.origin||!o.has(Cr(e.doc.store,n.origin)))break;r.has(Cr(e.doc.store,n.origin))||(i=n,r.clear())}n=n.right}this.left=i}if(null!==this.left){var a=this.left.right;this.right=a,this.left.right=this}else{var s;if(null!==this.parentSub)for(s=this.parent._map.get(this.parentSub)||null;null!==s&&null!==s.left;)s=s.left;else s=this.parent._start,this.parent._start=this;this.right=s}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),kr(e.doc.store,this),this.content.integrate(e,this),Or(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new Yo(this.id,this.length).integrate(e,0)}},{key:"next",get:function(){for(var e=this.right;null!==e&&e.deleted;)e=e.right;return e}},{key:"prev",get:function(){for(var e=this.left;null!==e&&e.deleted;)e=e.left;return e}},{key:"lastId",get:function(){return 1===this.length?this.id:ir(this.id.client,this.id.clock+this.length-1)}},{key:"mergeWith",value:function(e){var t=this;if(this.constructor===e.constructor&&nr(e.origin,this.lastId)&&this.right===e&&nr(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){var n=this.parent._searchMarker;return n&&n.forEach((function(n){n.p===e&&(n.p=t,!t.deleted&&t.countable&&(n.index-=t.length))})),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}},{key:"delete",value:function(e){if(!this.deleted){var t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),Pi(e.deleteSet,this.id.client,this.id.clock,this.length),Or(e,t,this.parentSub),this.content.delete(e)}}},{key:"gc",value:function(e,t){if(!this.deleted)throw mn();this.content.gc(e),t?function(e,t,n){var i=e.clients.get(t.id.client);i[xr(i,t.id.clock)]=n}(e,this,new Yo(this.id,this.length)):this.content=new Ko(this.length)}},{key:"write",value:function(e,t){var n=t>0?ir(this.id.client,this.id.clock+t-1):this.origin,i=this.rightOrigin,r=this.parentSub,o=this.content.getRef()&Bt|(null===n?0:Rt)|(null===i?0:It)|(null===r?0:Dt);if(e.writeInfo(o),null!==n&&e.writeLeftID(n),null!==i&&e.writeRightID(i),null===n&&null===i){var a=this.parent;if(void 0!==a._item){var s=a._item;if(null===s){var l=ar(a);e.writeParentInfo(!0),e.writeString(l)}else e.writeParentInfo(!1),e.writeLeftID(s.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===tr?(e.writeParentInfo(!1),e.writeLeftID(a)):mn();null!==r&&e.writeString(r)}this.content.write(e,t)}}])}(Wo),wa=function(e,t){return ba[t&Bt](e)},ba=[function(){mn()},function(e){return new Ko(e.readLen())},function(e){for(var t=e.readLen(),n=[],i=0;i<t;i++){var r=e.readString();"undefined"===r?n.push(void 0):n.push(JSON.parse(r))}return new ta(n)},function(e){return new Zo(e.readBuf())},function(e){return new ia(e.readString())},function(e){return new Qo(e.readJSON())},function(e){return new ea(e.readKey(),e.readJSON())},function(e){return new fa(ra[e.readTypeRef()](e))},function(e){for(var t=e.readLen(),n=[],i=0;i<t;i++)n.push(e.readAny());return new na(n)},function(e){return new $o(Xo(e.readString(),e.readAny()))},function(){mn()}],ka=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"deleted",get:function(){return!0}},{key:"delete",value:function(){}},{key:"mergeWith",value:function(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}},{key:"integrate",value:function(e,t){mn()}},{key:"write",value:function(e,t){e.writeInfo(10),Qt(e.restEncoder,this.length-t)}},{key:"getMissing",value:function(e,t){return null}}])}(Wo),xa="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},Ca="__ $YJS$ __";function Ea(e){return"[object Object]"===Object.prototype.toString.call(e)}function Sa(e){if(!Ea(e))return!1;var t=e.constructor;if(void 0===t)return!0;var n=t.prototype;return!1!==Ea(n)&&!1!==n.hasOwnProperty("isPrototypeOf")}function Ma(e,t){for(var n in e){var i=e[n],r=t[n];if(Sa(i)&&Sa(r)){if(!Ma(i,r))return!1}else if(Array.isArray(i)&&Array.isArray(r)){if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++)if(i[o]!==r[o])return!1}else if(i!==r)return!1}for(var a in t)if(void 0===e[a]&&void 0!==t[a])return!1;return!0}function Aa(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Object.fromEntries(Object.entries(e).filter((function(e){var t=p(e,1)[0];return n.includes(t)})))}function _a(e){return function(e){var t,n=[],i=w(e);try{for(i.s();!(t=i.n()).done;){var r,o,a=t.value;if("string"!=typeof a.insert||0!==a.insert.length){var s=n[n.length-1];s&&"string"==typeof s.insert&&"string"==typeof a.insert&&(s.attributes===a.attributes||!s.attributes==!a.attributes&&Ma(null!==(r=s.attributes)&&void 0!==r?r:{},null!==(o=a.attributes)&&void 0!==o?o:{}))?s.insert+=a.insert:n.push(a)}}}catch(l){i.e(l)}finally{i.f()}return n}(e.toDelta())}function Pa(e){var t=e.insert;return"string"==typeof t?t.length:1}function Oa(e){return e.reduce((function(e,t){return e+Pa(t)}),0)}function Ta(e,t,n){if(n<1)return[];for(var i=0,r=[],o=t+n,a=0;a<e.length&&!(i>=o);a++){var s=e[a],l=Pa(s);if(i+l<=t)i+=l;else if("string"==typeof s.insert){var u=Math.max(0,t-i),c=Math.min(l,l-(i+l-o));r.push(M(M({},s),{},{insert:s.insert.slice(u,c)})),i+=l}else i+=l,r.push(s)}return r}function La(e){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Object.fromEntries(Object.entries(e).filter((function(e){var t=p(e,1)[0];return!n.includes(t)})))}(e,ce.isText(e)?"text":"children")}function ja(e){var t=_a(e),n=t.length>0?t.map(Na):[{text:""}];return M(M({},e.getAttributes()),{},{children:n})}function Na(e){return"string"==typeof e.insert?M(M({},e.attributes),{},{text:e.insert}):ja(e.insert)}function Da(e){return e.map((function(e){return ce.isText(e)?{insert:e.text,attributes:La(e)}:{insert:Ia(e)}}))}function Ia(t){var n=t.children,i=r(t,e),o=new Jo;return Object.entries(i).forEach((function(e){var t=p(e,2),n=t[0],i=t[1];o.setAttribute(n,i)})),o.applyDelta(Da(n),{sanitize:!1}),o}function Ra(e){return e?ce.isText(e)?e.text.length:1:0}function Ba(e,t,n){var i;if(0===n.length)throw new Error("Path has to a have a length >= 1");if(ce.isText(t))throw new Error("Cannot descent into slate text");var r,o=m(r=n)||g(r)||b(r)||y(),a=o[0],s=o.slice(1),l=function(e,t){return e.children.slice(0,t).reduce((function(e,t){return e+Ra(t)}),0)}(t,a),u=t.children[a],c=_a(e),h=Ra(u),f=Ta(c,l,h);if(f.length>1)throw new Error("Path doesn't match yText, yTarget spans multiple nodes");var d=null===(i=f[0])||void 0===i?void 0:i.insert;if(s.length>0){if(!(d instanceof Jo))throw new Error("Path doesn't match yText, cannot descent into non-yText");return Ba(d,u,s)}return{yParent:e,textRange:{start:l,end:l+h},yTarget:d instanceof Jo?d:void 0,slateParent:t,slateTarget:u,targetDelta:f}}function za(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.assoc,r=void 0===i?0:i,o=n.insert,a=void 0!==o&&o,s=0,l=0,u=0;u<e.children.length;u++){var c=e.children[u],h=ce.isText(c)?c.text.length:1;h>0&&(l=u);var f=s+h;if(h>0&&(r>=0?f>t:f>=t))return[u,t-s];s+=h}if(t>s+(a?1:0))throw new Error("yOffset out of bounds");if(a)return[e.children.length,0];var d=e.children[l];return[l,ce.isText(d)?d.text.length:1]}function Fa(e,t,n){for(var i=[n];i[0]!==e;){var r=i[0].parent;if(!r)throw new Error("yText isn't a descendant of root element");if(!(r instanceof Jo))throw new Error("Unexpected y parent type");i.unshift(r)}if(i.length<2)return[];var o=t;return i.reduce((function(e,t,n){var r=i[n+1];if(!r)return e;var a,s=0,l=w(_a(t));try{for(l.s();!(a=l.n()).done;){var u=a.value;if(u.insert===r)break;s+="string"==typeof u.insert?u.insert.length:1}}catch(h){l.e(h)}finally{l.f()}if(ce.isText(o))throw new Error("Cannot descent into slate text");var c=p(za(o,s),1)[0];return o=o.children[c],e.concat(c)}),[])}function Va(e){if(!e.doc)throw new Error("shared type isn't attached to a document")}!0===xa[Ca]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),xa[Ca]=!0;var Ha="__slateYjsStoredPosition_";function Ua(e,t,n){var i=Ba(e,t,n.path),r=i.yTarget,o=i.yParent,a=i.textRange;if(r)throw new Error("Slate point points to a non-text element inside sharedRoot");var s=a.start+n.offset;return hr(o,s,s===a.end?-1:0)}function qa(e,t,n){if(!e.doc)throw new Error("sharedRoot isn't attach to a yDoc");var i=vr(n,e.doc);return i&&function(e,t,n){var i=n.type,r=n.index,o=n.assoc;if(!(i instanceof Jo))throw new Error("Absolute position points to a non-XMLText");var a=Fa(e,t,i),s=he.get(t,a);if(ce.isText(s))throw new Error("Absolute position doesn't match slateRoot, cannot descent into text");var l=p(za(s,r,{assoc:o}),2),u=l[0],c=l[1],h=s.children[u];return ce.isText(h)?{path:[].concat(v(a),[u]),offset:c}:null}(e,t,i)}function Ga(e,t,n){e.setAttribute(Ha+t,fr(n))}function Ja(e,t,n){return Object.fromEntries(Object.entries(e).filter((function(e){var i=p(e,2)[1];return i.type===t&&(!n||(i.assoc>=0?i.index>=n.start&&i.index<n.end:i.index>n.start&&i.index>=n.end))})))}function Wa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=O({},n,Ja(e,t));return _a(t).forEach((function(t,r){var o=t.insert;o instanceof Jo&&Object.assign(i,Wa(e,o,n?"".concat(n,".").concat(r):r.toString()))})),i}function Ya(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=function(e){return Va(e),Object.fromEntries(Object.entries(e.getAttributes()).filter((function(e){return p(e,1)[0].startsWith(Ha)})).map((function(t){var n=p(t,2),i=n[0],r=n[1];return[i.slice(Ha.length),vr(dr(r),e.doc)]})).filter((function(e){return p(e,2)[1]})))}(e),o={"":Ja(r,t,{start:i,end:i+Oa(n)})};return n.forEach((function(e,t){var n=e.insert;n instanceof Jo&&Object.assign(o,Wa(r,n,t.toString()))})),o}function Za(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=n[a];s&&Object.entries(s).forEach((function(n){var i=p(n,2),a=i[0],s=i[1];Ga(e,a,hr(t,s.index-o+r,s.assoc))})),i.forEach((function(t,i){var r=t.insert;r instanceof Jo&&Za(e,r,n,_a(r),0,0,a?"".concat(a,".").concat(i):i.toString())}))}function Ka(e,t,n){return{anchor:Ua(e,t,n.anchor),focus:Ua(e,t,n.focus)}}function Xa(e,t,n){var i=qa(e,t,n.anchor);if(!i)return null;var r=qa(e,t,n.focus);return r?{anchor:i,focus:r}:null}function $a(e,t,n){var i=n.target,r=n.changes,o=n.delta;if(!(i instanceof Jo))throw new Error("Unexpected target node type");var a=[],s=Fa(e,t,i),l=he.get(t,s);if(ce.isText(l))throw new Error("Cannot apply yTextEvent to text node");var u=Array.from(r.keys.entries());if(s.length>0&&u.length>0){var c=Object.fromEntries(u.map((function(e){var t=p(e,2),n=t[0];return[n,"delete"===t[1].action?null:i.getAttribute(n)]}))),h=Object.fromEntries(u.map((function(e){var t=p(e,1)[0];return[t,l[t]]})));a.push({type:"set_node",newProperties:c,properties:h,path:s})}return o.length>0&&a.push.apply(a,v(function(e,t,n){var i=[],r=n.reduce((function(e,t){return"retain"in t?e+t.retain:"delete"in t?e+t.delete:e}),0);return n.reverse().forEach((function(n){if("attributes"in n&&"retain"in n)for(var o=p(za(e,r-n.retain),2),a=o[0],s=o[1],l=p(za(e,r,{assoc:-1}),2),u=l[0],c=l[1],h=u;h>=a;h--){var f=e.children[h],d=[].concat(v(t),[h]);if(ce.isText(f)){var g=n.attributes,y=Aa.apply(void 0,[e].concat(v(Object.keys(n.attributes))));if(h===a||h===u){var m=h===a?s:0,w=h===u?c:f.text.length;if(w!==f.text.length&&i.push({type:"split_node",path:d,position:w,properties:La(f)}),0!==m){i.push({type:"split_node",path:d,position:m,properties:(b=M(M({},La(f)),g),Object.fromEntries(Object.entries(b).filter((function(e){return null!==p(e,2)[1]}))))});continue}}i.push({type:"set_node",newProperties:g,path:d,properties:y})}}var b;if("retain"in n&&(r-=n.retain),"delete"in n)for(var k=p(za(e,r-n.delete),2),x=k[0],C=k[1],E=p(za(e,r,{assoc:-1}),2),S=E[0],A=E[1],_=0===A?S-1:S;_>=x;_--){var P=e.children[_],O=[].concat(v(t),[_]);if(!ce.isText(P)||_!==x&&_!==S)i.push({type:"remove_node",node:P,path:O}),r-=Ra(P);else{var T=_===x?C:0,L=_===S?A:P.text.length;i.push({type:"remove_text",offset:T,text:P.text.slice(T,L),path:O}),r-=L-T}}else if("insert"in n){var j=p(za(e,r,{insert:!0}),2),N=j[0],D=j[1],I=e.children[N],R=[].concat(v(t),[N]);if(ce.isText(I)){var B,z=i[i.length-1],F=null!=z&&"insert_node"===z.type?z.node:La(I),V=[];if(null==z||"insert_node"!==z.type&&"insert_text"!==z.type&&"split_node"!==z.type&&"set_node"!==z.type||(V=z.path),"string"==typeof n.insert&&Ma(null!==(B=n.attributes)&&void 0!==B?B:{},F)&&fe.equals(R,V))return i.push({type:"insert_text",offset:D,text:n.insert,path:R});var H=Na(n);return 0===D?i.push({type:"insert_node",path:R,node:H}):(D<I.text.length&&i.push({type:"split_node",path:R,position:D,properties:La(I)}),i.push({type:"insert_node",path:fe.next(R),node:H}))}return i.push({type:"insert_node",path:R,node:Na(n)})}})),i}(l,s,o))),a}function Qa(e,t,n){le.withoutNormalizing(t,(function(){n.forEach((function(n){(function(e,t,n){if(n instanceof zo)return $a(e,t,n);throw new Error("Unexpected Y event type")})(e,t,n).forEach((function(e){t.apply(e)}))}))}))}function es(e){var t=new Jo,n=e.getAttributes();return Object.entries(n).forEach((function(e){var n=p(e,2),i=n[0],r=n[1];t.setAttribute(i,r)})),t.applyDelta(ts(_a(e)),{sanitize:!1}),t}function ts(e){return e.map((function(e){return"string"==typeof e.insert?e:M(M({},e),{},{insert:es(e.insert)})}))}var ns={insert_node:function(e,t,n){var i=Ba(e,t,n.path),r=i.yParent,o=i.textRange;if(ce.isText(n.node))return r.insert(o.start,n.node.text,La(n.node));r.insertEmbed(o.start,Ia(n.node))},remove_node:function(e,t,n){var i=Ba(e,t,n.path),r=i.yParent,o=i.textRange;r.delete(o.start,o.end-o.start)},set_node:function(e,t,n){var i=Ba(e,t,n.path),r=i.yTarget,o=i.textRange,a=i.yParent;if(r)return Object.entries(n.newProperties).forEach((function(e){var t=p(e,2),n=t[0],i=t[1];if(null===i)return r.removeAttribute(n);r.setAttribute(n,i)})),Object.entries(n.properties).forEach((function(e){var t=p(e,1)[0];n.newProperties.hasOwnProperty(t)||r.removeAttribute(t)}));var s=M(M({},Object.fromEntries(Object.keys(n.properties).map((function(e){return[e,null]})))),n.newProperties);a.format(o.start,o.end-o.start,s)},merge_node:function(e,t,n){var i=Ba(e,t,n.path),r=Ba(i.yParent,i.slateParent,fe.previous(n.path.slice(-1)));if(!i.yTarget!=!r.yTarget)throw new Error("Cannot merge y text with y element");if(!r.yTarget||!i.yTarget){var o=i.yParent,a=i.textRange,s=i.slateTarget;if(!s)throw new Error("Expected Slate target node for merge op.");var l=he.get(t,fe.previous(n.path));if(!ce.isText(l))throw new Error("Path points to Y.Text but not a Slate text node.");var u=La(s),c=La(l),h=Object.keys(u).reduce((function(e,t){return t in c?e:M(M({},e),{},O({},t,null))}),{});return o.format(a.start,a.end-a.start,M(M({},h),c))}var f=r.yTarget.length,d=_a(i.yTarget),g=ts(d),p=Ya(e,i.yTarget,d,f),y=[{retain:f}].concat(v(g));r.yTarget.applyDelta(y,{sanitize:!1}),i.yParent.delete(i.textRange.start,i.textRange.end-i.textRange.start),Za(e,r.yTarget,p,g,f)},move_node:function(e,t,n){var i=fe.parent(n.newPath),r=n.newPath[n.newPath.length-1],o=he.get(t,i);if(ce.isText(o))throw new Error("Cannot move slate node into text element");var a=[].concat(v(i),[Math.min(r,o.children.length)]),s=Ba(e,t,n.path),l=Ba(e,t,a),u=ts(s.targetDelta),c=Ya(e,s.yParent,s.targetDelta);s.yParent.delete(s.textRange.start,s.textRange.end-s.textRange.start);var h=Oa(_a(l.yParent)),f=Math.min(l.textRange.start,h),d=[{retain:f}].concat(v(u));l.yParent.applyDelta(d,{sanitize:!1}),Za(e,l.yParent,c,u,f,s.textRange.start)},split_node:function(e,t,n){var i=Ba(e,t,n.path);if(!i.slateTarget)throw new Error("Y target without corresponding slate node");if(!i.yTarget){if(!ce.isText(i.slateTarget))throw new Error("Mismatch node type between y target and slate node");var r={};return i.targetDelta.forEach((function(e){e.attributes&&Object.keys(e.attributes).forEach((function(e){r[e]=null}))})),i.yParent.format(i.textRange.start,i.textRange.end-i.textRange.start,M(M({},r),n.properties))}if(ce.isText(i.slateTarget))throw new Error("Mismatch node type between y target and slate node");var o=Ba(i.yTarget,i.slateTarget,[n.position]),a=i.slateTarget.children.slice(0,n.position).reduce((function(e,t){return e+Ra(t)}),0),s=i.slateTarget.children.reduce((function(e,t){return e+Ra(t)}),0),l=Ta(_a(i.yTarget),a,s-a),u=ts(l),c=Ya(e,i.yTarget,l,a),h=new Jo;h.applyDelta(u,{sanitize:!1}),Object.entries(n.properties).forEach((function(e){var t=p(e,2),n=t[0],i=t[1];h.setAttribute(n,i)})),i.yTarget.delete(o.textRange.start,i.yTarget.length-o.textRange.start),i.yParent.insertEmbed(i.textRange.end,h),Za(e,h,c,u,0,a)}};var is=M(M(M({},{insert_text:function(e,t,n){var i=Ba(e,t,n.path),r=i.yParent,o=i.textRange,a=he.get(t,n.path);if(!ce.isText(a))throw new Error("Cannot insert text into non-text node");r.insert(o.start+n.offset,n.text,La(a))},remove_text:function(e,t,n){var i=Ba(e,t,n.path),r=i.yParent,o=i.textRange;r.delete(o.start+n.offset,n.text.length)}}),ns),{},{set_selection:function(){}});var rs=Symbol("slate-yjs-operation"),os=Symbol("slate-yjs-position-storage"),as=new WeakMap,ss=new WeakMap,ls=new WeakSet,us={isYjsEditor:function(e){return le.isEditor(e)&&e.sharedRoot instanceof Jo&&"localOrigin"in e&&"positionStorageOrigin"in e&&"function"==typeof e.applyRemoteEvents&&"function"==typeof e.storeLocalChange&&"function"==typeof e.flushLocalChanges&&"function"==typeof e.isLocalOrigin&&"function"==typeof e.connect&&"function"==typeof e.disconnect},localChanges:function(e){var t;return null!==(t=ss.get(e))&&void 0!==t?t:[]},applyRemoteEvents:function(e,t,n){e.applyRemoteEvents(t,n)},storeLocalChange:function(e,t){e.storeLocalChange(t)},flushLocalChanges:function(e){e.flushLocalChanges()},connected:function(e){return ls.has(e)},connect:function(e){e.connect()},disconnect:function(e){e.disconnect()},isLocal:function(e){return e.isLocalOrigin(us.origin(e))},origin:function(e){var t=as.get(e);return void 0!==t?t:e.localOrigin},withOrigin:function(e,t,n){var i=us.origin(e);as.set(e,t),n(),as.set(e,i)},storePosition:function(e,t,n){var i,r=e.sharedRoot,o=e.positionStorageOrigin;Va(r);var a=Ua(r,e,n);null===(i=r.doc)||void 0===i||i.transact((function(){Ga(r,t,a)}),o)},removeStoredPosition:function(e,t){var n,i=e.sharedRoot,r=e.positionStorageOrigin;Va(i),null===(n=i.doc)||void 0===n||n.transact((function(){!function(e,t){e.removeAttribute(Ha+t)}(i,t)}),r)},position:function(e,t){var n=function(e,t){var n=e.getAttribute(Ha+t);return n?dr(n):null}(e.sharedRoot,t);if(n)return qa(e.sharedRoot,e,n)},storedPositionsRelative:function(e){return t=e.sharedRoot,Object.fromEntries(Object.entries(t.getAttributes()).filter((function(e){return p(e,1)[0].startsWith(Ha)})).map((function(e){var t,n,i=p(e,2),r=i[0],o=i[1];return[r.slice(Ha.length),(t=o,new lr(null==t.type?null:ir(t.type.client,t.type.clock),null!==(n=t.tname)&&void 0!==n?n:null,null==t.item?null:ir(t.item.client,t.item.clock),null==t.assoc?0:t.assoc))]})));var t}};function cs(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=i.localOrigin,o=i.positionStorageOrigin,a=i.autoConnect,s=void 0!==a&&a,l=e;l.sharedRoot=t,l.editorWindow=n,l.localOrigin=null!=r?r:rs,l.positionStorageOrigin=null!=o?o:os,l.applyRemoteEvents=function(e,t){us.flushLocalChanges(l),le.withoutNormalizing(l,(function(){us.withOrigin(l,t,(function(){Qa(l.sharedRoot,l,e)}))}))},l.isLocalOrigin=function(e){return e===l.localOrigin};var u=function(e,t){l.isLocalOrigin(t.origin)||us.applyRemoteEvents(l,e,t.origin)},c=null;s&&(c=setTimeout((function(){c=null,us.connect(l)}))),l.connect=function(){if(us.connected(l))throw new Error("already connected");l.sharedRoot.observeDeep(u);var t=ja(l.sharedRoot);l.children=t.children,ls.add(l),le.normalize(e,{force:!0}),e.operations.length||e.onChange()},l.disconnect=function(){c&&clearTimeout(c),us.flushLocalChanges(l),l.sharedRoot.unobserveDeep(u),ls.delete(l)},l.storeLocalChange=function(t){ss.set(l,[].concat(v(us.localChanges(l)),[{op:t,doc:e.children,origin:us.origin(l)}]))},l.flushLocalChanges=function(){Va(l.sharedRoot);var e=us.localChanges(l);ss.delete(l);var t=[];e.forEach((function(e){var n=t[t.length-1];if(n&&n[0].origin===e.origin)return n.push(e);t.push([e])})),t.forEach((function(e){var t;Va(l.sharedRoot),null===(t=l.sharedRoot.doc)||void 0===t||t.transact((function(){e.forEach((function(e){Va(l.sharedRoot),function(e,t,n){var i=is[n.type];if(!i)throw new Error("Unknown operation: ".concat(n.type));i(e,t,n)}(l.sharedRoot,{children:e.doc},e.op)}))}),e[0].origin)}))};var h=l.apply,f=l.onChange;return l.apply=function(e){us.connected(l)&&us.isLocal(l)&&us.storeLocalChange(l,e),h(e)},l.onChange=function(){us.connected(l)&&us.flushLocalChanges(l),f()},l}var hs=new WeakMap,fs=Symbol("slate-yjs-history-without-saving");function ds(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.withoutSavingOrigin,o=void 0===i?fs:i,a=n.trackedOrigins,s=void 0===a?new Set([e.localOrigin]):a,l=r(n,t),u=e,c=new Rr(u.sharedRoot,M({trackedOrigins:s},l));u.undoManager=c,u.withoutSavingOrigin=o;var h=u.onChange,f=u.isLocalOrigin;u.onChange=function(){h(),hs.set(u,u.selection&&Ka(u.sharedRoot,u,u.selection))},u.isLocalOrigin=function(e){return e===u.withoutSavingOrigin||f(e)};var d=function(e){var t=e.stackItem;t.meta.set("selection",u.selection&&Ka(u.sharedRoot,u,u.selection)),t.meta.set("selectionBefore",hs.get(u))},v=function(e){e.stackItem.meta.set("selection",u.selection&&Ka(u.sharedRoot,u,u.selection))},g=function(e){var t=e.stackItem,n="undo"===e.type?u.undoManager.redoStack:u.undoManager.undoStack,i=n[n.length-1];i&&(i.meta.set("selection",t.meta.get("selectionBefore")),i.meta.set("selectionBefore",t.meta.get("selection")));var r=t.meta.get("selectionBefore");if(r){var o=Xa(u.sharedRoot,u,r);o&&de.select(u,o)}},p=u.connect,y=u.disconnect;return u.connect=function(){p(),u.undoManager.on("stack-item-added",d),u.undoManager.on("stack-item-popped",g),u.undoManager.on("stack-item-updated",v)},u.disconnect=function(){u.undoManager.off("stack-item-added",d),u.undoManager.off("stack-item-popped",g),u.undoManager.off("stack-item-updated",v),y()},u.undo=function(){us.connected(u)&&(us.flushLocalChanges(u),u.undoManager.undo())},u.redo=function(){us.connected(u)&&(us.flushLocalChanges(u),u.undoManager.redo())},u}var vs=new WeakMap,gs=new ke,ps=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.selection;e.sendCursorPosition(t)},ys=function(e,t){e.sendCursorData(t)},ms=function(e,t,n){var i;if("change"===t){var r=null!==(i=vs.get(e))&&void 0!==i?i:new Set;r.add(n),vs.set(e,r)}},ws=function(e,t,n){if("change"===t){var i=vs.get(e);i&&i.delete(n)}},bs=function(e,t){var n;if(t===e.awareness.clientID||!us.connected(e))return null;var i=e.awareness.getStates().get(t);return i?{relativeSelection:null!==(n=i[e.selectionStateField])&&void 0!==n?n:null,data:i[e.cursorDataField],clientId:t}:null},ks=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];gs.emit.apply(gs,[e].concat(n))},xs=function(e,t){gs.on(e,t)},Cs=function(){gs.reset()};function Es(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.cursorStateField,r=void 0===i?"selection":i,o=n.cursorDataField,a=void 0===o?"data":o,s=n.autoSend,l=void 0===s||s,u=n.data,c=e;c.awareness=t,c.cursorDataField=a,c.selectionStateField=r,c.sendCursorData=function(e){c.awareness.setLocalStateField(c.cursorDataField,e)},c.sendCursorPosition=function(e){var t=c.awareness.getLocalState(),n=null==t?void 0:t[r];if(e){var i=Ka(c.sharedRoot,c,e),o=i.anchor,a=i.focus;n&&gr(o,n)&&gr(a,n)||c.awareness.setLocalStateField(c.selectionStateField,{anchor:o,focus:a})}else n&&c.awareness.setLocalStateField(c.selectionStateField,null)};var h=function(e){var t=vs.get(c);if(t){var n=c.awareness.clientID,i={added:e.added.filter((function(e){return e!==n})),removed:e.removed.filter((function(e){return e!==n})),updated:e.updated.filter((function(e){return e!==n}))};(i.added.length>0||i.removed.length>0||i.updated.length>0)&&t.forEach((function(e){return e(i)}))}},f=c.connect,d=c.disconnect;return c.connect=function(){if(f(),c.awareness.on("change",h),h({removed:[],added:Array.from(c.awareness.getStates().keys()),updated:[]}),l){u&&ys(c,u);var e=c.onChange;c.onChange=function(){e(),us.connected(c)&&(ps(c),ks("updateCursor"))}}},c.disconnect=function(){c.awareness.off("change",h),Cs(),h({removed:Array.from(c.awareness.getStates().keys()),added:[],updated:[]}),d()},c}function Ss(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ms(e){var t=Ss(e);return new RegExp("(".concat(t,").+?(").concat(t,")$"))}function As(e){var t=Ss(e);return new RegExp("^(".concat(t,")$"))}function _s(e){return function(t,n){de.setNodes(t,{type:e},{match:function(e){return le.isBlock(t,e)},at:n})}}function Ps(e){return function(t,n){de.insertNodes(t,{text:" "},{match:ce.isText,at:ve.end(n),select:!0}),de.setNodes(t,O({},e,!0),{match:ce.isText,at:n,split:!0})}}var Os,Ts=[{trigger:As("#"),apply:_s("heading-one")},{trigger:As("##"),apply:_s("heading-two")},{trigger:As(">"),apply:_s("block-quote")},{trigger:Ms("`"),apply:(Os="inline-code",function(e,t){var n=le.rangeRef(e,t);de.unwrapNodes(e,{at:t,match:function(t){return le.isInline(e,t)},mode:"all",split:!0}),n.current&&de.insertNodes(e,{text:" "},{match:ce.isText,at:ve.end(n.current),select:!0});var i=n.unref();i&&de.wrapNodes(e,{type:Os,children:[]},{at:i,split:!0})})},{trigger:Ms("**"),apply:Ps("bold")},{trigger:Ms("__"),apply:Ps("bold")},{trigger:Ms("*"),apply:Ps("italic")},{trigger:Ms("_"),apply:Ps("italic")},{trigger:Ms("~~"),apply:Ps("strikethrough")}];function Ls(e,t,n){if(t.offset>=n)return{offset:t.offset-n,path:t.path};var i=le.previous(e,{at:t.path,match:ce.isText});if(i){var r=p(i,2),o=r[0],a=r[1];return Ls(e,{offset:o.text.length,path:a},n-t.offset)}}function js(e){var t=e.deleteBackward,n=e.insertText,i=e.isInline,r=e.insertBreak;return e.insertText=function(t){var i=e.selection;if(" "!==t||!i||!ve.isCollapsed(i))return n(t);for(var r,o=i.anchor,a=le.above(e,{match:function(t){return le.isBlock(e,t)}}),s=a?a[1]:[],l={anchor:o,focus:le.start(e,s)},u=le.string(e,l),c=function(){var t=f[h],n=t.trigger,i=t.apply,r=n.exec(u);if(!r)return 0;var a=p(r,3),s=a[0],l=a[1],c=a[2];return le.withoutNormalizing(e,(function(){var t=o,n=c&&Ls(e,t,c.length),r=l&&Ls(e,t,s.length-l.length),a=Ls(e,t,s.length);if(t&&a){var u=le.rangeRef(e,{anchor:a,focus:t});n&&de.delete(e,{at:{anchor:n,focus:t}}),r&&de.delete(e,{at:{anchor:a,focus:r}});var h=u.unref();h&&i(e,h)}})),{v:void 0}},h=0,f=Ts;h<f.length;h++)if(0!==(r=c())&&r)return r.v;n(t)},e.insertBreak=function(){var t=e.selection;if(ge.getSelectedNodeByType(e,"layout"))r();else if(t){var n=le.above(e,{match:function(t){return le.isBlock(e,t)}}),i=n?n[1]:[],o=le.end(e,i),a=pe.equals(o,ve.end(t));if(de.splitNodes(e,{always:!0}),a){var s;de.unwrapNodes(e,{match:function(t){return le.isInline(e,t)},mode:"all"}),de.setNodes(e,{type:"paragraph"},{match:function(t){return le.isBlock(e,t)}});var l=null!==(s=le.marks(e))&&void 0!==s?s:{};de.unsetNodes(e,Object.keys(l),{match:ce.isText})}}},e.deleteBackward=function(){if(ge.getSelectedNodeByType(e,"layout"))t.apply(void 0,arguments);else{var n=e.selection;if(n&&ve.isCollapsed(n)){var i=le.above(e,{match:function(t){return le.isBlock(e,t)}});if(i){var r=p(i,2),o=r[0],a=r[1],s=le.start(e,a);if(!le.isEditor(o)&&ue.isElement(o)&&"paragraph"!==o.type&&pe.equals(n.anchor,s)){return void de.setNodes(e,{type:"paragraph"})}}t.apply(void 0,arguments)}}},e.isInline=function(e){return ue.isElement(e)&&"inline-code"===e.type||i(e)},e}function Ns(e){var t=e.normalizeNode;return e.normalizeNode=function(n){var i=p(n,1)[0];if(!le.isEditor(i)||i.children.length>0)return t(n);de.insertNodes(e,{type:"paragraph",children:[{text:""}]},{at:[0]})},e}var Ds=function(){return P((function e(){A(this,e)}),null,[{key:"getThemeVar",value:function(){var e=document.documentElement;return e?getComputedStyle(e).getPropertyValue("--ibiz-color-primary"):null}},{key:"isChineseCharacter",value:function(e){return/[\u4e00-\u9fa5]/.test(e)}},{key:"hasChineseAndEnglish",value:function(e){return/[\u4e00-\u9fa5]+.*[a-zA-Z]+|[a-zA-Z]+.*[\u4e00-\u9fa5]+/.test(e)}},{key:"stringToHexColor",value:function(e){if(!e)return"";for(var t=0,n=0;n<e.length;n++){if(this.isChineseCharacter(e))t=e.charCodeAt(n)+((t<<5)-t),t&=t;else t+=e.charCodeAt(n).toString(16)}var i=String(t).substring(0,6),r=parseInt(i.substring(0,2),16),o=parseInt(i.substring(2,4),16),a=parseInt(i.substring(4,6),16);r<0&&(r=10),o<0&&(o=10),a<0&&(a=10);var s="#".concat(r.toString(16).padStart(2,"0")).concat(o.toString(16).padStart(2,"0")).concat(a.toString(16).padStart(2,"0"));return"#FFFFFF"===s&&this.getThemeVar()||s}},{key:"avatarName",value:function(e){if(e&&e.toString().length<2)return e;if(e&&e.toString().length>=2){if(this.hasChineseAndEnglish(e)){var t=e.split("").find((function(e){return/[a-zA-Z]/.test(e)}))||"",n=e.split("").find((function(e){return/[\u4E00-\u9FA5]/.test(e)}))||"";return"".concat(t).concat(n).toLowerCase()}return/[a-zA-Z]/.test(e)?e.split("").filter((function(e){return/[a-zA-Z]/.test(e)})).slice(0,2).join("").toUpperCase():/[\u4E00-\u9FA5]/.test(e)?e.split("").filter((function(e){return/[\u4E00-\u9FA5]/.test(e)})).slice(-2).join(""):e.replaceAll(" ","").substring(0,2)}}},{key:"getEmojiCustomHtml",value:function(e){return e.replaceAll(/{"emoji":"(.+?)"}/g,(function(e,t){var n=decodeURIComponent(atob(t));return'<span class="emoji-tag">'.concat(n,"</span>")})).replaceAll(/<span data-w-e-type="emoji" class='emoji'>(.+?)<\/span>/g,(function(e,t){var n=decodeURIComponent(atob(t));return"<span data-w-e-type=\"emoji\" class='emoji'>".concat(n,"</span>")}))}}])}();function Is(e,t){return e+Math.round(255*Math.min(Math.max(t,0),1)).toString(16).toUpperCase()}var Rs=globalThis.Text,Bs=function(e){var t,n;return null!==(t=null==e||null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView)&&void 0!==t?t:null},zs=function(e){return function(e){var t=Bs(e);return!!t&&e instanceof t.Node}(e)&&1===e.nodeType};function Fs(e,t){var n,i=p(le.node(e,t.path),1)[0],r=e.toDOMNode(i);le.void(e,{at:t})&&(t={path:t.path,offset:0});for(var o=Array.from(r.querySelectorAll("[data-slate-string], [data-slate-zero-width]")),a=0,s=0;s<o.length;s++){var l=o[s],u=l.childNodes[0];if(null!=u&&null!=u.textContent){var c=u.textContent.length,h=l.getAttribute("data-slate-length"),f=a+(null==h?c:parseInt(h,10)),d=o[s+1];if(t.offset===f&&null!=d&&d.hasAttribute("data-slate-mark-placeholder")){var v,g=d.childNodes[0];n=[g instanceof Rs?g:d,null!==(v=d.textContent)&&void 0!==v&&v.startsWith("\ufeff")?1:0];break}if(t.offset<=f){n=[u,Math.min(c,Math.max(0,t.offset-a))];break}a=f}}if(!n)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(JSON.stringify(t)));return n}function Vs(e,t){try{return function(e,t){var n=t.anchor,i=t.focus,r=ve.isBackward(t),o=Fs(e,n),a=ve.isCollapsed(t)?o:Fs(e,i),s=e.editorWindow.document.createRange(),l=p(r?a:o,2),u=l[0],c=l[1],h=p(r?o:a,2),f=h[0],d=h[1],v=!!(zs(u)?u:u.parentElement).getAttribute("data-slate-zero-width"),g=!!(zs(f)?f:f.parentElement).getAttribute("data-slate-zero-width");return s.setStart(u,v?1:c),s.setEnd(f,g?1:d),s}(e,t)}catch(dx){return null}}var Hs=new WeakMap;function Us(e,t){if(!t.relativeSelection||!e)return null;var n=Hs.get(e.children);n||(n=new WeakMap,Hs.set(e.children,n));var i=n.get(t);if(void 0===i)try{i=Xa(e.sharedRoot,e,t.relativeSelection),n.set(t,i)}catch(dx){return null}return i}var qs=c({name:"CursorCaret",props:{data:{type:Object,required:!0},caretPosition:Object},setup:function(e){return{ns:ne("cursor-caret"),caretStyle:D((function(){return M(M({},e.caretPosition),{},{background:e.data.color})})),labelStyle:D((function(){return{transform:"translateY(-100%)",background:e.data.color}}))}},render:function(){return L("div",{style:this.caretStyle,class:this.ns.b()},[L("div",{class:this.ns.e("text"),style:this.labelStyle},[this.data.name])])}}),Gs=c({name:"CursorSelection",props:{data:Object,selectionRects:Array,caretPosition:Object},setup:function(e){return{ns:ne("cursor-selection"),selectionStyle:D((function(){return{backgroundColor:Is(e.data.color,.5)}}))}},render:function(){var e,t=this;return this.data?L(I,null,[null===(e=this.selectionRects)||void 0===e?void 0:e.map((function(e,n){return L("div",{style:M(M({},t.selectionStyle),e),class:t.ns.b(),key:n},null)})),this.caretPosition&&L(qs,{caretPosition:this.caretPosition,data:this.data},null)]):null}});var Js=Object.freeze([]);function Ws(e){var t,n=e.slateYjs,i=e.containerRef,r=e.shouldGenerateOverlay,o=!("refreshOnResize"in e)||(null===(t=e.refreshOnResize)||void 0===t||t),a=new Map,s=f({}),l=function(){var e,t,o;if((!i||i.value)&&n.yjsEditor){var l=null==i||null===(e=i.value)||void 0===e?void 0:e.getBoundingClientRect(),u=null!==(t=null==l?void 0:l.x)&&void 0!==t?t:0,c=null!==(o=null==l?void 0:l.y)&&void 0!==o?o:0,h=Object.keys(s.value).length!==Object.keys(n.cursorStates).length,f=Object.fromEntries(Object.entries(n.cursorStates).map((function(e){var t=p(e,2),i=t[0],o=t[1],s=o.relativeSelection&&Us(n.yjsEditor,o);if(!s)return[i,Js];var l=a.get(s);if(l)return[i,l];var f=function(e,t,n){var i=n.yOffset,r=n.xOffset,o=n.shouldGenerateOverlay,a=p(ve.edges(t),2),s=a[0],l=a[1],u=Vs(e,t);if(!u)return{caretPosition:null,selectionRects:[]};var c,h=[],f=le.nodes(e,{at:t,match:function(e,t){return ce.isText(e)&&(!o||o(e,t))}}),d=null,v=ve.isBackward(t),g=w(f);try{for(g.s();!(c=g.n()).done;){var y=p(c.value,2),m=y[0],b=y[1],k=e.toDOMNode(m),x=fe.equals(b,s.path),C=fe.equals(b,l.path),E=null;if(x||C){var S=document.createRange();S.selectNode(k),x&&S.setStart(u.startContainer,u.startOffset),C&&S.setEnd(u.endContainer,u.endOffset),E=S.getClientRects()}else E=k.getClientRects();for(var M=v?x:C,A=0;A<E.length;A++){var _=E.item(A);if(_){var P=M&&(v?0===A:A===E.length-1),O=_.top-i,T=_.left-r;P&&(d={height:"".concat(_.height,"px"),top:"".concat(O,"px"),left:"".concat(T+(v||ve.isCollapsed(t)?0:_.width),"px")}),h.push({width:"".concat(_.width,"px"),height:"".concat(_.height,"px"),top:"".concat(O,"px"),left:"".concat(T,"px")})}}}}catch(L){g.e(L)}finally{g.f()}return{selectionRects:h,caretPosition:d}}(n.yjsEditor,s,{xOffset:u,yOffset:c,shouldGenerateOverlay:r});return h=!0,a.set(s,f),[i,f]})));h&&(s.value=f)}},u=function(){a.clear(),l()};return o&&function(e,t){var n=null;_((function(){e.value&&(n=new ResizeObserver((function(){t()}))).observe(e.value)})),R((function(){n&&e.value&&n.unobserve(e.value)}))}(i,u),xs("updateCursor",Se(l,0)),C((function(){return n.cursorStates}),(function(){return l()}),{deep:!0,immediate:!0}),{overlayData:D((function(){return Object.entries(n.cursorStates).map((function(e){var t,i,r=p(e,2),o=r[0],a=r[1],l=a.relativeSelection&&Us(n.yjsEditor,a),u=s.value[o];return M(M({},a),{},{range:l,caretPosition:null!==(t=null==u?void 0:u.caretPosition)&&void 0!==t?t:null,selectionRects:null!==(i=null==u?void 0:u.selectionRects)&&void 0!==i?i:Js})}))})),refresh:u}}var Ys=c({name:"CursorOverlay",props:{slateYjs:{type:Object,required:!0}},setup:function(e){var t=ne("cursor-overlay"),n=f();return{ns:t,overlayData:Ws({slateYjs:e.slateYjs,containerRef:n}).overlayData,containerRef:n}},render:function(){var e,t;return L("div",{class:this.ns.b(),ref:"containerRef"},[null===(e=(t=this.$slots).default)||void 0===e?void 0:e.call(t),this.overlayData.map((function(e){return L(Gs,B({key:e.clientId},e),null)}))])}}),Zs=function(){return P((function e(t,n,i,r){A(this,e),O(this,"collaborateUrl","/portal/collaborate"),O(this,"readyState",void 0),O(this,"evt",new ke),O(this,"client",void 0),O(this,"options",{connectTimeout:6e3,clientId:be(),username:"",password:"",keepalive:60,clean:!0}),this.id=t,this.mqttTopic=n,this.token=i,this.appId=r,this.options.username=n,this.options.password=i,this.readyState=0}),[{key:"send",value:function(e){ibiz.net.post("".concat(this.collaborateUrl,"/ROOM/").concat(this.id),{data:e})}},{key:"connect",value:(e=E(x().mark((function e(){var t,n,i,r,o=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.import("./mqtt.min.legacy.js").then((function(e){return e.m}));case 2:t=e.sent,n=t.default?t.default:t,i=window,r=i.location,this.client=n.connect("ws://".concat(r.host).concat(ibiz.env.baseUrl,"/").concat(this.appId).concat(ibiz.env.mqttUrl),this.options),this.client.on("connect",(function(){o.client.subscribe(o.mqttTopic),o.readyState=1,o.evt.emit("connect"),ibiz.log.debug("collaborate connect")})),this.client.on("error",(function(e){o.readyState=3,o.evt.emit("error",e),ibiz.log.debug("collaborate error")})),this.client.on("message",(function(e,t){var n=JSON.parse(t.toString());n&&n.data&&n.data.data&&n.data.data.data&&o.evt.emit("message",new Uint8Array(Object.values(n.data.data.data))),ibiz.log.debug("collaborate message")})),this.client.on("reconnect",(function(){o.readyState=0,o.evt.emit("reconnect")})),this.client.on("close",(function(){o.readyState=3,o.evt.emit("close"),ibiz.log.debug("collaborate close")}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"close",value:function(){var e;null===(e=this.client)||void 0===e||e.end(),this.evt.reset()}}]);var e}(),Ks=function(){return new Map},Xs=function(e,t,n){var i=e.get(t);return void 0===i&&e.set(t,i=n()),i},$s=String.fromCharCode,Qs=/^\s*/g,el=/([A-Z])/g,tl=function(e,t){return function(e){return e.replace(Qs,"")}(e.replace(el,(function(e){return"".concat(t).concat(function(e){return e.toLowerCase()}(e))})))},nl="undefined"!=typeof TextEncoder?new TextEncoder:null,il=nl?function(e){return nl.encode(e)}:function(e){for(var t=unescape(encodeURIComponent(e)),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.codePointAt(r);return i},rl="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});rl&&1===rl.decode(new Uint8Array).length&&(rl=null);var ol=function(e){return void 0===e?null:e},al=new(function(){return P((function e(){A(this,e),this.map=new Map}),[{key:"setItem",value:function(e,t){this.map.set(e,t)}},{key:"getItem",value:function(e){return this.map.get(e)}}])}()),sl=!0;try{"undefined"!=typeof localStorage&&(al=localStorage,sl=!1)}catch(dx){}var ll,ul,cl=al,hl="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name),fl="undefined"!=typeof window&&!hl,dl=function(e){return function(){if(void 0===ll)if(hl){ll=Ks();for(var e=process.argv,t=null,n=0;n<e.length;n++){var i=e[n];"-"===i[0]?(null!==t&&ll.set(t,""),t=i):null!==t&&(ll.set(t,i),t=null)}null!==t&&ll.set(t,"")}else"object"===("undefined"==typeof location?"undefined":d(location))?(ll=Ks(),(location.search||"?").slice(1).split("&").forEach((function(e){if(0!==e.length){var t=p(e.split("="),2),n=t[0],i=t[1];ll.set("--".concat(tl(n,"-")),i),ll.set("-".concat(tl(n,"-")),i)}}))):ll=Ks();return ll}().has(e)};dl("--"+(ul="production"))||function(e){ol(hl?process.env[e.toUpperCase()]:cl.getItem(e))}(ul);var vl=Math.floor,gl=function(e,t){return e<t?e:t},pl=Math.pow,yl=127,ml=Number.MAX_SAFE_INTEGER,wl=P((function e(){A(this,e),this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]})),bl=function(){return new wl},kl=function(e){for(var t=e.cpos,n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},xl=function(e){for(var t=new Uint8Array(kl(e)),n=0,i=0;i<e.bufs.length;i++){var r=e.bufs[i];t.set(r,n),n+=r.length}return t.set(Dl(e.cbuf.buffer,0,e.cpos),n),t},Cl=function(e,t){var n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},El=function(e,t){for(;t>yl;)Cl(e,128|yl&t),t=vl(t/128);Cl(e,yl&t)},Sl=new Uint8Array(3e4),Ml=Sl.length/3,Al=nl?function(e,t){if(t.length<Ml){var n=nl.encodeInto(t,Sl).written||0;El(e,n);for(var i=0;i<n;i++)Cl(e,Sl[i])}else _l(e,il(t))}:function(e,t){var n=unescape(encodeURIComponent(t)),i=n.length;El(e,i);for(var r=0;r<i;r++)Cl(e,n.codePointAt(r))},_l=function(e,t){El(e,t.byteLength),function(e,t){var n,i,r=e.cbuf.length,o=e.cpos,a=gl(r-o,t.length),s=t.length-a;e.cbuf.set(t.subarray(0,a),o),e.cpos+=a,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array((n=2*r)>(i=s)?n:i),e.cbuf.set(t.subarray(a)),e.cpos=s)}(e,t)},Pl=P((function e(t){A(this,e),this.arr=t,this.pos=0})),Ol=function(e){return new Pl(e)},Tl=function(e){return function(e,t){var n=Dl(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n}(e,jl(e))},Ll=function(e){return e.arr[e.pos++]},jl=function(e){for(var t=0,n=1;;){var i=e.arr[e.pos++];if(t+=(i&yl)*n,n*=128,i<128)return t;if(t>ml)throw new Error("Integer out of range!")}},Nl=rl?function(e){return rl.decode(Tl(e))}:function(e){var t=jl(e);if(0===t)return"";var n=String.fromCodePoint(Ll(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(Ll(e));else for(;t>0;){var i=t<1e4?t:1e4,r=e.arr.subarray(e.pos,e.pos+i);e.pos+=i,n+=String.fromCodePoint.apply(null,r),t-=i}return decodeURIComponent(escape(n))},Dl=function(e,t,n){return new Uint8Array(e,t,n)},Il=fl?function(e){for(var t="",n=0;n<e.byteLength;n++)t+=$s(e[n]);return btoa(t)}:function(e){return Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64")},Rl=fl?function(e){for(var t,n=atob(e),i=(t=n.length,new Uint8Array(t)),r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}:function(e){var t=Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},Bl=new Map,zl="undefined"==typeof BroadcastChannel?function(){return P((function e(t){var n,i=this;A(this,e),this.room=t,this.onmessage=null,n=function(e){return e.key===t&&null!==i.onmessage&&i.onmessage({data:Rl(e.newValue||"")})},sl||addEventListener("storage",n)}),[{key:"postMessage",value:function(e){cl.setItem(this.room,Il(new Uint8Array(e)))}}])}():BroadcastChannel,Fl=function(e){return Xs(Bl,e,(function(){var t=new Set,n=new zl(e);return n.onmessage=function(e){return t.forEach((function(t){return t(e.data,"broadcastchannel")}))},{bc:n,subs:t}}))},Vl=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=Fl(e);i.bc.postMessage(t),i.subs.forEach((function(e){return e(t,n)}))},Hl=Date.now,Ul=function(e,t){El(e,0);var n=function(e){return Zi(e,new zi)}(t);_l(e,n)},ql=function(e,t,n){El(e,1),_l(e,function(e,t){return Ji(e,t,new Fi)}(t,n))},Gl=function(e,t,n){try{!function(e,t,n){Gi(e,t,n,Ri)}(t,Tl(e),n)}catch(i){console.error("Caught error while handling a Yjs update",i)}},Jl=Gl,Wl=function(e,t,n,i){var r=jl(e);switch(r){case 0:!function(e,t,n){ql(t,n,Tl(e))}(e,t,n);break;case 1:Gl(e,n,i);break;case 2:Jl(e,n,i);break;default:throw new Error("Unknown message type")}return r},Yl=function(){return new Set},Zl=Array.from,Kl=function(){return P((function e(){A(this,e),this._observers=Ks()}),[{key:"on",value:function(e,t){Xs(this._observers,e,Yl).add(t)}},{key:"once",value:function(e,t){var n=this,i=function(){n.off(e,i),t.apply(void 0,arguments)};this.on(e,i)}},{key:"off",value:function(e,t){var n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}},{key:"emit",value:function(e,t){return Zl((this._observers.get(e)||Ks()).values()).forEach((function(e){return e.apply(void 0,v(t))}))}},{key:"destroy",value:function(){this._observers=Ks()}}])}(),Xl=Object.keys,$l=function(e){return Xl(e).length},Ql=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},eu=function(e,t){if(null==e||null==t)return function(e,t){return e===t}(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break;case Set:if(e.size!==t.size)return!1;var i,r=w(e);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(!t.has(o))return!1}}catch(h){r.e(h)}finally{r.f()}break;case Map:if(e.size!==t.size)return!1;var a,s=w(e.keys());try{for(s.s();!(a=s.n()).done;){var l=a.value;if(!t.has(l)||!eu(e.get(l),t.get(l)))return!1}}catch(h){s.e(h)}finally{s.f()}break;case Object:if($l(e)!==$l(t))return!1;for(var u in e)if(!Ql(e,u)||!eu(e[u],t[u]))return!1;break;case Array:if(e.length!==t.length)return!1;for(var c=0;c<e.length;c++)if(!eu(e[c],t[c]))return!1;break;default:return!1}return!0},tu=3e4,nu=function(e){function t(e){var n;return A(this,t),(n=s(this,t)).doc=e,n.clientID=e.clientID,n.states=new Map,n.meta=new Map,n._checkInterval=setInterval((function(){var e=Hl();null!==n.getLocalState()&&15e3<=e-n.meta.get(n.clientID).lastUpdated&&n.setLocalState(n.getLocalState());var t=[];n.meta.forEach((function(i,r){r!==n.clientID&&tu<=e-i.lastUpdated&&n.states.has(r)&&t.push(r)})),t.length>0&&iu(n,t,"timeout")}),vl(3e3)),e.on("destroy",(function(){n.destroy()})),n.setLocalState({}),n}return h(t,e),P(t,[{key:"destroy",value:function(){this.emit("destroy",[this]),this.setLocalState(null),o(t,"destroy",this,3)([]),clearInterval(this._checkInterval)}},{key:"getLocalState",value:function(){return this.states.get(this.clientID)||null}},{key:"setLocalState",value:function(e){var t=this.clientID,n=this.meta.get(t),i=void 0===n?0:n.clock+1,r=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:i,lastUpdated:Hl()});var o=[],a=[],s=[],l=[];null===e?l.push(t):null==r?null!=e&&o.push(t):(a.push(t),eu(r,e)||s.push(t)),(o.length>0||s.length>0||l.length>0)&&this.emit("change",[{added:o,updated:s,removed:l},"local"]),this.emit("update",[{added:o,updated:a,removed:l},"local"])}},{key:"setLocalStateField",value:function(e,t){var n=this.getLocalState();null!==n&&this.setLocalState(M(M({},n),{},O({},e,t)))}},{key:"getStates",value:function(){return this.states}}])}(Kl),iu=function(e,t,n){for(var i=[],r=0;r<t.length;r++){var o=t[r];if(e.states.has(o)){if(e.states.delete(o),o===e.clientID){var a=e.meta.get(o);e.meta.set(o,{clock:a.clock+1,lastUpdated:Hl()})}i.push(o)}}i.length>0&&(e.emit("change",[{added:[],updated:[],removed:i},n]),e.emit("update",[{added:[],updated:[],removed:i},n]))},ru=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.states,i=t.length,r=bl();El(r,i);for(var o=0;o<i;o++){var a=t[o],s=n.get(a)||null,l=e.meta.get(a).clock;El(r,a),El(r,l),Al(r,JSON.stringify(s))}return xl(r)},ou=[];ou[0]=function(e,t,n,i,r){El(e,0);var o=Wl(t,e,n.doc,n);i&&1===o&&!n.synced&&(n.synced=!0)},ou[3]=function(e,t,n,i,r){El(e,1),_l(e,ru(n.awareness,Array.from(n.awareness.getStates().keys())))},ou[1]=function(e,t,n,i,r){!function(e,t,n){for(var i=Ol(t),r=Hl(),o=[],a=[],s=[],l=[],u=jl(i),c=0;c<u;c++){var h=jl(i),f=jl(i),d=JSON.parse(Nl(i)),v=e.meta.get(h),g=e.states.get(h),p=void 0===v?0:v.clock;(p<f||p===f&&null===d&&e.states.has(h))&&(null===d?h===e.clientID&&null!=e.getLocalState()?f++:e.states.delete(h):e.states.set(h,d),e.meta.set(h,{clock:f,lastUpdated:r}),void 0===v&&null!==d?o.push(h):void 0!==v&&null===d?l.push(h):null!==d&&(eu(d,g)||s.push(h),a.push(h)))}(o.length>0||s.length>0||l.length>0)&&e.emit("change",[{added:o,updated:s,removed:l},n]),(o.length>0||a.length>0||l.length>0)&&e.emit("update",[{added:o,updated:a,removed:l},n])}(n.awareness,Tl(t),n)},ou[2]=function(e,t,n,i,r){!function(e,t,n){0===jl(e)&&n(t,Nl(e))}(t,n.doc,(function(e,t){return au(n,t)}))};var au=function(e,t){return console.warn("Permission denied to access ".concat(e.url,".\n").concat(t))},su=function(e,t,n){var i=Ol(t),r=bl(),o=jl(i),a=e.messageHandlers[o];return a?a(r,i,e,n,o):console.error("Unable to compute message"),r},lu=function(e){if(e.shouldConnect&&null===e.ws){var t=e._WS;e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.evt.on("message",(function(n){e.wsLastMessageReceived=Hl();var i=su(e,n,!0);kl(i)>1&&t.send(xl(i))})),t.evt.on("error",(function(t){e.emit("connection-error",[t,e])})),t.evt.on("close",(function(t){e.emit("connection-close",[t,e]),e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,iu(e.awareness,Array.from(e.awareness.getStates().keys()).filter((function(t){return t!==e.doc.clientID})),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(lu,gl(100*pl(2,e.wsUnsuccessfulReconnects),e.maxBackoffTime),e)})),t.evt.on("connect",(function(){e.wsLastMessageReceived=Hl(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);var n=bl();if(El(n,0),Ul(n,e.doc),t.send(xl(n)),null!==e.awareness.getLocalState()){var i=bl();El(i,1),_l(i,ru(e.awareness,[e.doc.clientID])),t.send(xl(i))}})),e.emit("status",[{status:"connecting"}])}},uu=function(e,t){var n=e.ws;e.wsconnected&&n&&1===n.readyState&&n.send(t),e.bcconnected&&Vl(e.bcChannel,t,e)},cu=function(e){function t(e,n,i){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=o.connect,l=void 0===a||a,u=o.awareness,c=void 0===u?new nu(i):u,h=o.params,f=void 0===h?{}:h,d=o.protocols,v=void 0===d?[]:d,g=o.WebSocketPolyfill,p=o.resyncInterval,y=void 0===p?-1:p,m=o.maxBackoffTime,w=void 0===m?2500:m,b=o.disableBc,k=void 0!==b&&b;for(A(this,t),r=s(this,t);"/"===e[e.length-1];)e=e.slice(0,e.length-1);return r.serverUrl=e,r.bcChannel=e+"/"+n,r.maxBackoffTime=w,r.params=f,r.protocols=v,r.roomname=n,r.doc=i,r._WS=g,r.awareness=c,r.wsconnected=!1,r.wsconnecting=!1,r.bcconnected=!1,r.disableBc=k,r.wsUnsuccessfulReconnects=0,r.messageHandlers=ou.slice(),r._synced=!1,r.ws=null,r.wsLastMessageReceived=0,r.shouldConnect=l,r._resyncInterval=0,y>0&&(r._resyncInterval=setInterval((function(){if(r.ws&&1===r.ws.readyState){var e=bl();El(e,0),Ul(e,i),r.ws.send(xl(e))}}),y)),r._bcSubscriber=function(e,t){if(t!==r){var n=su(r,new Uint8Array(e),!1);kl(n)>1&&Vl(r.bcChannel,xl(n),r)}},r._updateHandler=function(e,t){if(t!==r){var n=bl();El(n,0),function(e,t){El(e,2),_l(e,t)}(n,e),uu(r,xl(n))}},r.doc.on("update",r._updateHandler),r._awarenessUpdateHandler=function(e,t){var n=e.added,i=e.updated,o=e.removed,a=n.concat(i).concat(o),s=bl();El(s,1),_l(s,ru(c,a)),uu(r,xl(s))},r._exitHandler=function(){iu(r.awareness,[i.clientID],"app closed")},hl&&"undefined"!=typeof process&&process.on("exit",r._exitHandler),c.on("update",r._awarenessUpdateHandler),r._checkInterval=setInterval((function(){r.wsconnected&&3e4<Hl()-r.wsLastMessageReceived&&r.ws.close()}),3e3),l&&r.connect(),r}return h(t,e),P(t,[{key:"url",get:function(){var e=function(e){return function(e,t){var n=[];for(var i in e)n.push(t(e[i],i));return n}(e,(function(e,t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e))})).join("&")}(this.params);return this.serverUrl+"/"+this.roomname+(0===e.length?"":"?"+e)}},{key:"synced",get:function(){return this._synced},set:function(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}},{key:"destroy",value:function(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),hl&&"undefined"!=typeof process&&process.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),o(t,"destroy",this,3)([])}},{key:"connectBc",value:function(){if(!this.disableBc){var e,t;this.bcconnected||(e=this.bcChannel,t=this._bcSubscriber,Fl(e).subs.add(t),this.bcconnected=!0);var n=bl();El(n,0),Ul(n,this.doc),Vl(this.bcChannel,xl(n),this);var i=bl();El(i,0),ql(i,this.doc),Vl(this.bcChannel,xl(i),this);var r=bl();El(r,3),Vl(this.bcChannel,xl(r),this);var o=bl();El(o,1),_l(o,ru(this.awareness,[this.doc.clientID])),Vl(this.bcChannel,xl(o),this)}}},{key:"disconnectBc",value:function(){var e,t,n=bl();El(n,1),_l(n,ru(this.awareness,[this.doc.clientID],new Map)),uu(this,xl(n)),this.bcconnected&&(e=this.bcChannel,t=this._bcSubscriber,Fl(e).subs.delete(t),this.bcconnected=!1)}},{key:"disconnect",value:function(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}},{key:"connect",value:function(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(lu(this),this.connectBc())}}])}(Kl),hu=function(){return P((function e(t,n,i,r){A(this,e),O(this,"id",void 0),O(this,"name",void 0),O(this,"doc",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"connectionProvider",void 0),this.context=t,this.params=n,this.id=i,this.doc=r;var o=ibiz.appData.mqtttopic.split("/");this.name="/".concat(o[1],"/collaborate/ROOM/").concat(this.id)}),[{key:"created",value:(t=E(x().mark((function e(){var t,n,i,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ibiz.hub.getApp(this.context.srfappid),n=t.model.appId||ibiz.env.appId,i="ws://".concat(window.location.host).concat(ibiz.env.baseUrl,"/").concat(n).concat(ibiz.env.mqttUrl),r=new Zs(this.id,this.name,Me(),n),e.next=6,r.connect();case 6:this.connectionProvider=new cu(i,this.name,this.doc,{WebSocketPolyfill:r,resyncInterval:5e3});case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroy",value:(e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=this.connectionProvider)||void 0===t||t.destroy();case 1:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})}]);var e,t}(),fu=function(){return P((function e(){A(this,e),O(this,"collaborateMap",new Map)}),[{key:"getAppId",value:function(e){return ibiz.hub.getApp(e.srfappid).model.appId||ibiz.env.appId}},{key:"create",value:(n=E(x().mark((function e(t,n,i,r){var o,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new hu(t,n,i,r),e.next=3,o.created();case 3:return a=this.getAppId(t),this.collaborateMap.has(a)||this.collaborateMap.set(a,new Map),this.collaborateMap.get(a).set(o.id,o),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,i,r){return n.apply(this,arguments)})},{key:"get",value:(t=E(x().mark((function e(t,n,i){var r,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getAppId(t),this.collaborateMap.has(r)){e.next=3;break}throw new Error(ibiz.i18n.t("runtime.utils.collaborateManager.invalidCollaborateRoom",{id:i}));case 3:if(!(o=this.collaborateMap.get(r))||!o.has(i)){e.next=6;break}return e.abrupt("return",o.get(i));case 6:throw new Error(ibiz.i18n.t("runtime.utils.collaborateManager.invalidCollaborateRoom",{id:i}));case 7:case"end":return e.stop()}}),e,this)}))),function(e,n,i){return t.apply(this,arguments)})},{key:"destroy",value:(e=E(x().mark((function e(t,n,i){var r,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.getAppId(t),this.collaborateMap.has(r)&&(o=this.collaborateMap.get(r))&&o.has(i)&&(o.get(i).destroy(),o.delete(i));case 2:case"end":return e.stop()}}),e,this)}))),function(t,n,i){return e.apply(this,arguments)})}]);var e,t,n}(),du=function(){return P((function e(t){A(this,e),O(this,"yDoc",new Di),O(this,"collaborateManager",new fu),O(this,"wsProvider",void 0),O(this,"inited",f(!1)),O(this,"yjsEditor",void 0),O(this,"cursorStates",z({})),O(this,"cursorHandler",null),this.enableRealtime=t,this.inited.value=!t}),[{key:"initYjs",value:(e=E(x().mark((function e(t){var n,i,r,o,a=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inited.value){e.next=10;break}return i=v(t.editor.children),r=this.yDoc.get("content",Jo),e.next=5,this.collaborateManager.create(t.context,t.params,t.roomname,this.yDoc);case 5:o=e.sent,this.wsProvider=o.connectionProvider,this.wsProvider.on("status",(function(e){"connected"!==e.status||a.inited.value||setTimeout((function(){a.inited.value=!0,!r.toJSON()&&i.length>0&&r.applyDelta(Da(i))}),1e3)})),this.yjsEditor=js(Ns(ds(Es(cs(t.editor,r,Bs(null===(n=t.htmlRef)||void 0===n?void 0:n.$el),{autoConnect:!0}),this.wsProvider.awareness,{data:(s=t.context.srfusername,{color:Ds.stringToHexColor(s),name:"".concat(s)})})))),this.initCursorHandler();case 10:case"end":return e.stop()}var s}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"initCursorHandler",value:function(){var e=this;if(!this.cursorHandler&&this.yjsEditor){var t=new Set;this.cursorHandler=function(n){n.added.forEach((function(e){return t.add(e)})),n.removed.forEach((function(e){return t.add(e)})),n.updated.forEach((function(e){return t.add(e)})),t.forEach((function(t){var n=bs(e.yjsEditor,t);null===n?delete e.cursorStates[t.toString()]:e.cursorStates[t]=n}))},ms(this.yjsEditor,"change",this.cursorHandler)}}},{key:"destroy",value:function(){var e,t;null===(e=this.yjsEditor)||void 0===e||e.disconnect(),this.wsProvider.disconnect(),this.cursorHandler&&(ws(this.yjsEditor,"change",this.cursorHandler),this.cursorHandler=null),null===(t=this.yjsEditor)||void 0===t||t.destroy()}}]);var e}(),vu=c({name:"IBizHtmlCollapse",props:te(),emits:["change","blur","focus","enter","infoTextChange","link","itemClick"],setup:function(e,t){var n,i=t.emit,r=ne("html"),o=e.controller,a=f(),s=f({}),l=null,c=0,h=f(),d=k(),v=f(),g=f(),y=f(),m=f(""),b=f({Authorization:"Bearer ".concat(we(Ee.TOKEN))}),A=f(""),P=f(""),D=f(!0),I=f(!1),B=f(!1),z=f(!1),H=f(!1),U=f(!1),q=be(),G=f(!0),J=f(!1),W=f(""),Z=f(!1),K=f([]),X=new du(o.enableRealtime),$=o.model;$.editorParams&&($.editorParams.enableEdit&&(I.value=!0,B.value=!0,D.value=o.toBoolean($.editorParams.enableEdit)&&!e.readonly&&!e.disabled),$.editorParams.enableFullScreen&&(z.value=o.toBoolean($.editorParams.enableFullScreen)),$.editorParams.ISSHOWANCHOR&&(U.value=o.toBoolean($.editorParams.ISSHOWANCHOR))),e.readonly&&(I.value=!1,B.value=!0),C((function(){return e.data}),(function(e){if(e){var t=ibiz.util.file.calcFileUpDownUrl(o.context,o.params,e,o.editorParams);A.value=t.uploadUrl,P.value=t.downloadUrl}}),{immediate:!0,deep:!0});var Q,ee=function(e,t){if(t)return!0},te=function(e){return e},re=function(){var e=E(x().mark((function e(){var t,n,r,a,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.deService){e.next=11;break}return e.next=3,u.import("@ibiz-template-plugin/ai-chat");case 3:return n=e.sent,r=n.chat||n.default.chat,Q=r,a=r.create({question:function(){var e=E(x().mark((function e(t){var n,i,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=be(),r=new AbortController,e.next=4,null===(n=o.deService)||void 0===n?void 0:n.aiChatSse((function(e){if(ibiz.log.info("aiChatSse",e),20===e.actionstate&&e.actionresult)a.addMessage({messageid:i,state:e.actionstate,type:"DEFAULT",role:"ASSISTANT",content:e.actionresult});else if(30===e.actionstate&&e.actionresult){var t=JSON.parse(e.actionresult).choices;t&&t.length>0&&a.replaceMessage({messageid:i,state:e.actionstate,type:"DEFAULT",role:"ASSISTANT",content:t[0].content||""})}else 40===e.actionstate&&a.replaceMessage({messageid:i,state:e.actionstate,type:"ERROR",role:"ASSISTANT",content:e.actionresult})}),r,o.context,{},{messages:t});case 4:return a.addMessage({messageid:i,state:10,type:"DEFAULT",role:"ASSISTANT",content:""}),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),action:function(e,t){"backfill"===e&&(I.value?m.value=t.content:i("change",t.content),Z.value=!0)},closed:function(){d.value&&d.value.focus(!0)}}),e.next=9,null===(t=o.deService)||void 0===t?void 0:t.aiChatHistory(o.context,{});case 9:(s=e.sent).data&&Array.isArray(s.data)&&s.data.forEach((function(e){var t={messageid:be(),state:30,type:"DEFAULT",role:e.role,content:e.content};a.addMessage(t)}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe={toolbarKeys:bt};o.chatCompletion&&(oe.insertKeys={index:60,keys:["|","aichart"]}),o.insertKeys.length>0&&oe.toolbarKeys&&o.insertKeys.forEach((function(e){e.keys&&e.keys.forEach((function(t,n){oe.toolbarKeys.includes(t)||oe.toolbarKeys.splice(e.index+n,0,t)}))}));var ce={placeholder:o.placeHolder,readOnly:I.value?B.value:e.readonly,MENU_CONF:{uploadImage:{server:A.value,fieldName:"file",maxFileSize:10485760,maxNumberOfFiles:10,allowedFileTypes:[],headers:b.value,withCredentials:!0,onBeforeUpload:function(e){return e},onProgress:function(e){console.log("progress",e)},onSuccess:function(e,t){console.log("".concat(e.name," 上传成功"),t)},onFailed:function(e,t){console.log("".concat(e.name," 上传失败"),t)},onError:function(e,t,n){console.log("".concat(e.name," 上传出错"),t,n)},customInsert:function(e,t){return E(x().mark((function n(){var i,r;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=P.value.replace("%fileId%",e.id),r=e.filename,t(i,r,"");case 3:case"end":return n.stop()}}),n)})))()}},insertLink:{checkLink:ee,parseLinkUrl:te},editLink:{checkLink:ee,parseLinkUrl:te}},hoverbarKeys:{link:{menuKeys:["editLink","unLink","customViewLink"]}}};S((function(){var e=d.value;null!=e&&(o.enableRealtime?X.destroy():e.destroy())}));var he=function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.maxHeight&&(n=t.getEditableContainer(),J.value=n.offsetHeight>o.maxHeight);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=E(x().mark((function e(t){var n,i,r,o,a,s,l;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.src,B.value)de(n);else if(i=le.nodes(d.value,{match:function(e){return!(!ue.isElement(e)||"image"!==e.type)},universal:!0}),i){r=w(i);try{for(r.s();!(o=r.n()).done;)a=o.value,s=p(a,1),"image"===(l=s[0]).type&&n.endsWith(l.src)&&de(l.src)}catch(u){r.e(u)}finally{r.f()}}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W.value=t,K.value=[t],e.next=4,T();case 4:g.value&&(n=g.value.$refs.container)&&n.children[0].click();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(e){if(g.value){var t=g.value.$refs.container;if(t){var n=t.querySelector(".el-image-viewer__wrapper");null==n||n[e]("keydown",ge)}}},ge=function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Escape"!==t.key&&27!==t.keyCode){e.next=7;break}return t.stopPropagation(),t.preventDefault(),e.next=5,T();case 5:ve("removeEventListener"),K.value=[];case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:ve("addEventListener");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(e){o.handleClick(e),i("itemClick",e)},me=function(){var t=m.value;if("JSON"===o.renderMode){var n=d.value;t=o.toJson(n.children)}e.value!==t&&(i("change",t),o.evt.emit("onChange",{eventArg:t}))},ke=Se(me,o.saveInterval),xe=f(""),Ce=f([]),Me=[],_e=new IntersectionObserver((function(e){e.forEach((function(e){if(e.isIntersecting){if(e.target&&e.target.id){var t=Me[Me.length-1],n=Me[0],i=Ce.value.findIndex((function(t){return t.id===e.target.id})),r=Ce.value.findIndex((function(e){return e.id===t})),o=Ce.value.findIndex((function(e){return e.id===n}));i>r&&(Me.push(e.target.id),xe.value=Me[Me.length-1]),i<o&&(Me.unshift(e.target.id),xe.value=Me[0])}}else if(e.target&&e.target.id){var a=Me.indexOf(e.target.id);a>=0&&Me.splice(a,1)}if(0!==Me.length){var s=document.getElementById(q);if(s){var l=s.querySelector("#anchor_".concat(q,"_").concat(xe.value));l&&(function(e,t){var n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=n.top-i.top,o=n.bottom-i.top,a=n.left-i.left,s=n.right-i.left,l=i.height,u=i.width;return r>=0&&o<=l&&a>=0&&s<=u}(l,s)||l.scrollIntoView({behavior:"smooth",block:"nearest"}))}}}))})),Pe=function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _e.disconnect(),e.next=3,T();case 3:d.value&&(t=d.value.getEditableContainer())&&Ce.value.forEach((function(e){var n=t.querySelector("#".concat(e.id));n&&_e.observe(n)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oe=function(){if(Ce.value=[],d.value){var e=d.value.getEditableContainer();if(e){var t=e.querySelectorAll("h1, h2, h3, h4, h5, h6");Ce.value=Array.from(t).filter((function(e){return""!==e.innerText.trim()})).map((function(e){return{id:e.id,text:e.innerText.trim(),level:Number(e.tagName.substring(1))}}))}}Pe()},Te=function(){var t=E(x().mark((function t(n){var i,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d.value=n,t.next=3,o.onCreated(d.value,e.data,oe);case 3:i=o.parseNode(m.value),n.setHtml(i),a=void 0,s=void 0,s=e.data.srfuf===Y.CREATE?"draft":e.data.srfkey,null!==(a=e.controller.params)&&void 0!==a&&a.srfmarkopendatakey&&(s=e.controller.params.srfmarkopendatakey),e.controller.collaborateKey&&(s=e.controller.collaborateKey),X.initYjs({roomname:s,editor:d.value,context:o.context,params:o.params,htmlRef:v.value}),T((function(){Oe()})),n.on("modalOrPanelShow",(function(e){r=new pt(e,v.value)})),n.on("modalOrPanelHide",(function(){r&&r.destroy()})),n.on("aiClick",(function(){re()}));case 10:case"end":return t.stop()}var a,s}),t)})));return function(e){return t.apply(this,arguments)}}(),Le=function(e){he(e),function(e){var t=e.getEditableContainer();t&&t.querySelectorAll("img").forEach((function(t){t.onload=function(){he(e)},t.onclick=function(e){var t=e.target;t&&fe(t)}}))}(e),function(e){var t=e.getEditableContainer();if(t){var n=t.querySelector("table");n&&(n.onclick=function(e){var n=t.clientWidth-310,i=t.querySelector(".w-e-hover-bar.w-e-bar-show");i&&(i.style.left="".concat(Math.min(e.layerX,n),"px"),i.style.top="".concat(e.layerY+20,"px"),i.style.bottom="auto")})}}(e),!I.value&&e.isFocused()&&("AUTOMATIC"===o.emitMode?ke():me()),T((function(){Oe()}))},je=function(e){},Ne=function(t){i("focus"),o.evt.emit("onFocus",{eventArg:e.value})},De=function(t){i("blur"),o.evt.emit("onBlur",{eventArg:e.value})},Re=function(e,t){alert("【自定义提示】".concat(t," - ").concat(e))},Be=function(e,t,n){n(!0)},ze=function(){var e=d.value;null!=e&&e.disable()},Fe=function(){var e=d.value;null!=e&&e.enable()},Ve=function(){if(B.value=!B.value,B.value){if(v.value)v.value.$refs.box.scroll(0,0);ze()}else Fe(),d.value.focus(),function(){if(e.value){var t=e.value.indexOf("</p>");if(t>=0){var n,i,r=null===(n=d.value.selection.anchor)||void 0===n?void 0:n.offset,o=null===(i=d.value.selection.anchor)||void 0===i?void 0:i.path;0===r&&o.length>0&&0===o[0]&&d.value.move(t-3)}}}(),G.value=!0},He=function(){H.value=!H.value,G.value=!H.value,T((function(){B.value?ze():(Fe(),d.value.focus())}))};return _((function(){y.value&&(n=ie(y,E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.value&&d.value.emit("clickOutside");case 1:case"end":return e.stop()}}),e)}))))),Ae(0,(function(){if(a.value&&h.value){var e=a.value.$el.offsetHeight;(l=new ResizeObserver((function(t){var n=t[0].contentRect.height;if(n!==c){var i={height:"".concat(e-t[0].contentRect.height,"px")};s.value=r.cssVarBlock(i),c=n}}))).observe(h.value.selector)}})),C((function(){return e.value}),(function(t,n){if(t!==n&&("string"==typeof e.value||null==t)&&(null==t?m.value="":"JSON"===o.renderMode?m.value=o.jsonToHtml(t):m.value=t,Z.value&&(d.value&&T((function(){d.value.focus(!0)})),Z.value=!1),t)){var i=o.parseNode(t);m.value=i}T((function(){d.value&&Oe()}))}),{immediate:!0}),C((function(){return e.disabled}),(function(e,t){e!==t&&(!0===e?ze():Fe())}),{immediate:!0})})),R((function(){l&&l.disconnect(),n&&n.stop&&n.stop(),Q&&Q.close()})),{c:o,ns:r,editorRef:d,previewRef:g,containerRef:y,htmlRef:v,mode:"default",valueHtml:m,toolbarConfig:oe,editorConfig:ce,handleCreated:Te,handleChange:Le,handleDestroyed:je,handleFocus:Ne,handleBlur:De,customAlert:Re,customPaste:Be,insertText:function(e){var t=d.value;null!=t&&t.insertText(e)},printHtml:function(){d.value},disable:ze,enable:Fe,renderHeaserToolbar:function(){return I.value||z.value?L("div",{class:r.b("custom-toolbar")},[I.value&&D.value&&B.value?L("i",{class:"fa fa-edit","aria-hidden":"true",title:"编辑",onClick:function(){return Ve()}},null):null,z.value?H.value?L("i",{class:"fa fa-compress","aria-hidden":"true",title:"缩小",onClick:function(){return He()}},null):L("i",{class:"fa fa-expand","aria-hidden":"true",title:"放大",onClick:function(){return He()}},null):null]):null},renderEditorContent:function(){var e=M({},s.value);return G.value&&o.maxHeight&&Object.assign(e,{maxHeight:"".concat(o.maxHeight,"px")}),F(L(Ys,{ref:"htmlContent",style:e,slateYjs:X,"element-loading-text":"数据同步中...",class:[r.b("content"),r.is("readonly",B.value)]},{default:function(){return[L(se,{ref:"toolbarRef",editor:d.value,"default-config":oe,mode:"default",class:r.b("toolbar")},null),L(ae,{ref:"htmlRef",class:r.b("editor"),modelValue:m.value,"onUpdate:modelValue":function(e){return m.value=e},"default-config":ce,mode:"default",onClick:ye,onOnCreated:Te,onOnChange:Le,onOnDestroyed:je,onOnFocus:Ne,onOnBlur:De,oncustomAlert:Re,oncustomPaste:Be},null)]}}),[[V("loading"),!X.inited.value]])},renderToggle:function(){return J.value?G.value?L("div",{class:r.e("toggle"),onClick:function(){G.value=!G.value}},[N("展开更多 "),L(j("ion-icon"),{name:"arrow-down-outline"},null)]):L("div",{class:r.e("toggle"),onClick:function(){G.value=!G.value}},[N("收起更多 "),L(j("ion-icon"),{name:"arrow-up-outline"},null)]):null},renderFooter:function(){return I.value&&"AUTOMATIC"!==o.emitMode?L("div",{class:[r.b("footer"),O({},r.b("footer-dialog"),H.value)]},[L("div",{class:r.be("footer","cancel"),onClick:function(){e.value!==m.value?Ie({title:"确认取消",type:"warning",customClass:r.b("message"),message:L("div",{class:r.be("message","message-content")},[L("p",null,[N("确定要取消编辑吗？")]),L("p",{class:r.bem("message","message-content","message-tip")},[N("取消编辑将无法保存修改的内容，且不能找回。")])]),showCancelButton:!0,cancelButtonClass:r.be("message","message-cancel"),confirmButtonClass:r.be("message","message-comfire")}).then((function(){if(e.value){var t=o.parseNode(e.value);m.value=t}else m.value="";Ve()})).catch((function(){d.value.focus()})):Ve()}},[N("取消")]),L("div",{class:r.be("footer","save"),onClick:function(){return B.value=!0,d.value.disable(),"JSON"!==o.renderMode&&i("change",m.value),void(H.value&&(H.value=!1))}},[N("保存")])]):null},htmlContent:a,hasEnableEdit:I,cssVars:s,toolbarRef:h,isFullScreen:H,readonlyState:B,collapse:G,isShowAnchor:U,changeFullScreenState:He,renderPreview:function(){return L(j("el-image"),{class:r.e("preview"),ref:"previewRef","zoom-rate":1.1,src:W.value,"preview-src-list":K.value,"hide-on-click-modal":!0,onShow:pe,fit:"cover"},null)},renderAnchor:function(){return L("div",{id:q,class:r.b("anchor-list"),style:{height:"".concat(o.maxHeight,"px")}},[Ce.value.map((function(e){return L("div",{id:"anchor_".concat(q,"_").concat(e.id),class:[r.be("anchor-list","anchor-item"),r.is("selected",xe.value===e.id),"level".concat(e.level)],onClick:function(){return function(e){d.value&&d.value.scrollToElem(e)}(e.id)},title:e.text},[L("span",null,[e.text])])}))])}}},render:function(){var e=this;return this.isFullScreen?L(j("el-dialog"),{modelValue:this.isFullScreen,"onUpdate:modelValue":function(t){return e.isFullScreen=t},width:"80%",top:"10vh",class:[this.ns.b("dialog-full-screen")],onClose:function(){return e.changeFullScreenState()}},{default:function(){return[L("div",{ref:"containerRef",class:[e.ns.b(),e.ns.b("collapse"),O({},e.ns.b("editor-readonly"),e.readonlyState)]},[e.renderHeaserToolbar(),e.renderEditorContent(),e.hasEnableEdit&&!e.readonlyState?e.renderFooter():null])]}}):L("div",{ref:"containerRef",class:[this.ns.b(),this.ns.is("allow-collapse",!0),O({},this.ns.b("editor-readonly"),this.readonlyState)]},[this.renderHeaserToolbar(),this.isShowAnchor?L("div",{class:this.ns.b("anchor-editor-container"),style:{height:"".concat(this.c.maxHeight,"px")}},[this.renderEditorContent(),this.renderAnchor()]):this.renderEditorContent(),this.readonlyState?this.renderToggle():null,this.hasEnableEdit&&!this.readonlyState?this.renderFooter():null,this.renderPreview()])}}),gu=c({name:"HtmlComment",props:te(),emits:M(M({},re()),{},{click:function(e,t){return!0}}),setup:function(e,t){var n=t.emit,i=ne("html-comment"),r=e.controller,o=f(),a=f(),s=f(!1),l=function(){s.value=!0};return{ns:i,c:r,comment:o,editorRef:a,onChange:function(e){n("change",e),e&&r.collapsed.value&&(r.collapsed.value=!1)},onFocus:function(){r.collapsed.value=!1,n("focus")},onBlur:function(){if(n("blur"),e.value)return null;r.collapsed.value=!0},onClick:function(e){e.stopPropagation(),e.preventDefault();var t=e.target,i=t.nodeName,r=t.dataset;if(i&&"MENTION-ELEM"===i){var o=r.value||"",a=JSON.parse(o);n("click",e,{data:a})}},renderAvatar:function(){if(r.userAvatar&&!s.value){var t="";if(o=r.userAvatar,/^https?:|^http?:|^data:image|(\.png$|\.svg|\.jpg|\.png|\.gif|\.psd|\.tif|\.bmp|\.jpeg)$/.test(o))t=r.userAvatar;else{var n=[];try{n=JSON.parse(r.userAvatar)}catch(c){console.error("解析头像数据失败",c)}if(0===n.length)return null;t=ibiz.util.file.calcFileUpDownUrl(r.context,r.params,e.data,r.editorParams).downloadUrl.replace("%fileId%",n[0].id)}return L("div",{class:i.e("avatar-name")},[L("img",{src:t,alt:"",onError:l},null)])}var o,a=Ds.stringToHexColor(r.context.srfusername),u=Ds.avatarName(r.context.srfusername);return r.context.srfusername?L("div",{class:i.e("avatar-name"),style:"background: ".concat(a,";")},[u]):L(j("el-avatar"),{class:i.e("avatar"),src:"./assets/images/user-avatar.png"},null)}}},render:function(){if("default"===this.c.mode)return L(vu,{controller:this.c,data:this.data,value:this.value,readonly:this.readonly,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onItemClick:this.onClick},null);var e={height:"".concat((this.c.collapsed.value?this.c.minHeight:this.c.maxHeight)-16,"px")},t=this.ns.cssVarBlock(e);return L("div",{ref:"comment",class:[this.ns.b(),this.ns.is("collapse",this.c.collapsed.value),this.ns.is("has-file",this.c.hasFile.value)],style:t},[this.renderAvatar(),L(mt,{controller:this.c,data:this.data,value:this.value,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onItemClick:this.onClick},null)])}});function pu(e,t,n,i,r){return{sel:e,data:t,children:n,text:i,elm:r,key:void 0===t?void 0:t.key}}var yu=Array.isArray;function mu(e){return"string"==typeof e||"number"==typeof e||e instanceof String||e instanceof Number}function wu(e,t,n){if(e.ns="http://www.w3.org/2000/svg","foreignObject"!==n&&void 0!==t)for(var i=0;i<t.length;++i){var r=t[i];if("string"!=typeof r){var o=r.data;void 0!==o&&wu(o,r.children,r.sel)}}}function bu(e,t,n){var i,r,o,a={};if(void 0!==n?(null!==t&&(a=t),yu(n)?i=n:mu(n)?r=n.toString():n&&n.sel&&(i=[n])):null!=t&&(yu(t)?i=t:mu(t)?r=t.toString():t&&t.sel?i=[t]:a=t),void 0!==i)for(o=0;o<i.length;++o)mu(i[o])&&(i[o]=pu(void 0,void 0,void 0,i[o],void 0));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||wu(a,i,e),pu(e,a,i,r,void 0)}var ku={type:"attachments",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,i=e.data,r=void 0===i?{}:i,o=W.execScriptFn({data:r},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var xu={selector:'span[data-w-e-type="attachments"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"attachments",script:n.script,data:n,children:[{text:""}]}}};var Cu={type:"attachments",renderElem:function(e){var t=e.data,n=void 0===t?{}:t,i={name:"".concat(n.name),id:n.id};return bu("mention-elem",{dataset:{value:JSON.stringify(i)},props:{contentEditable:!1}},[])}},Eu=function(){return P((function e(){A(this,e),O(this,"title","本地文件"),O(this,"tag","button"),O(this,"iconSvg",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36px" height="36px" viewBox="0 0 36 36" version="1.1">\n    <title>附件</title>\n    <g id="附件" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="icon">\n            <rect id="矩形" stroke="#EEEEEE" fill="#FFFFFF" x="0.5" y="0.5" width="35" height="35" rx="4"/>\n            <g id="编组-28" transform="translate(2.997929, 8.001508)">\n                <path d="M13.9611058,12.6330155 C13.9611058,14.5460163 12.4108408,16.0968098 10.498492,16.0968098 C8.58614322,16.0968098 7.03587822,14.5460163 7.03590808,12.6393438 L7.03590808,12.6393438 L6.98338468,7.07669061 C6.97992133,6.70644889 7.27712693,6.40347538 7.64724246,6.39998034 C8.017358,6.39648531 8.32022824,6.69379224 8.32372209,7.06403396 L8.32372209,7.06403396 L8.37624485,12.6330155 C8.37624485,13.8054998 9.32640727,14.7559862 10.498492,14.7559862 C11.6705768,14.7559862 12.6207392,13.8054998 12.6207392,12.6330155 L12.6207392,12.6330155 L12.6207392,6.46506253 C12.6207392,4.69957562 11.0562006,3.24725012 9.10227678,3.24725012 C7.148353,3.24725012 5.58381437,4.69957562 5.58381437,6.46506253 L5.58381437,6.46506253 L5.58381437,12.8655397 C5.58381437,15.5621365 7.78332719,17.7497339 10.498492,17.7497339 C13.2136568,17.7497339 15.4131697,15.5621365 15.4131697,12.8655397 L15.4131697,12.8655397 L15.4131697,7.10001026 C15.4131697,6.72975204 15.713221,6.42959845 16.083353,6.42959845 C16.453485,6.42959845 16.7535363,6.72975204 16.7535363,7.10001026 L16.7535363,7.10001026 L16.7535363,12.8655397 C16.7535363,16.3043913 13.9521943,19.0905575 10.498492,19.0905575 C7.04478976,19.0905575 4.24344774,16.3043913 4.24344774,12.8655397 L4.24344774,12.8655397 L4.24344774,6.46506253 C4.24344774,3.93573556 6.42955024,1.90642651 9.10227678,1.90642651 C11.7750033,1.90642651 13.9611058,3.93573556 13.9611058,6.46506253 L13.9611058,6.46506253 Z" id="形状结合" fill="#DDDDDD" transform="translate(10.498492, 10.498492) rotate(-315.000000) translate(-10.498492, -10.498492) "/>\n                <path d="M21.6662931,9.87797441 L24.6096402,9.87797441 C24.9410111,9.87797441 25.2096402,10.1466036 25.2096402,10.4779744 C25.2096402,10.8093453 24.9410111,11.0779744 24.6096402,11.0779744 L21.6662931,11.0779744 C21.3349223,11.0779744 21.0662931,10.8093453 21.0662931,10.4779744 C21.0662931,10.1466036 21.3349223,9.87797441 21.6662931,9.87797441 Z" id="矩形备份-74" fill="#73D897"/>\n                <path d="M21.6662931,4.29120933 L27.4020707,4.29120933 C27.7334415,4.29120933 28.0020707,4.55983848 28.0020707,4.89120933 C28.0020707,5.22258018 27.7334415,5.49120933 27.4020707,5.49120933 L21.6662931,5.49120933 C21.3349223,5.49120933 21.0662931,5.22258018 21.0662931,4.89120933 C21.0662931,4.55983848 21.3349223,4.29120933 21.6662931,4.29120933 Z" id="矩形备份-75" fill="#6698FF"/>\n                <path d="M21.6662931,15.4647395 L27.4020707,15.4647395 C27.7334415,15.4647395 28.0020707,15.7333686 28.0020707,16.0647395 C28.0020707,16.3961103 27.7334415,16.6647395 27.4020707,16.6647395 L21.6662931,16.6647395 C21.3349223,16.6647395 21.0662931,16.3961103 21.0662931,16.0647395 C21.0662931,15.7333686 21.3349223,15.4647395 21.6662931,15.4647395 Z" id="矩形备份-77" fill="#FF7575"/>\n            </g>\n        </g>\n    </g>\n</svg>')}),[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){e.emit("attachmentClick")}}])}(),Su={renderElems:[Cu],elemsToHtml:[ku],parseElemsHtml:[xu],menus:[{key:"attachments",factory:function(){return new Eu}}]},Mu=function(){return P((function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"htmlController",void 0),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"evt",void 0),O(this,"execting",!1),O(this,"fileFieldValue",""),this.registerNode()}),[{key:"registerNode",value:function(){window.attachmentsIsRegiter||(ye.registerModule(Su),window.attachmentsIsRegiter=!0)}},{key:"init",value:(t=E(x().mark((function e(t,n){var i,r,o,a=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams,this.htmlController=n.controller,this.editorParams&&(i=this.editorParams.EXTFIELDVALUE)&&(r=i.split(";").map((function(e){var t=p(e.split(":"),2);return{name:t[0],value:t[1]}})),(o=r.find((function(e){return"file"===e.name})))&&(this.fileFieldValue=o.value)),t.on("attachmentClick",(function(){a.fileUpload()}));case 10:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"onDestroyed",value:function(){}},{key:"insertNode",value:function(e){}},{key:"parseNode",value:function(e){return e}},{key:"fileUpload",value:(e=E(x().mark((function e(){var t,n,i,r,o,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fileFieldValue){e.next=3;break}return ibiz.message.warning("请先配置本地文件额外属性"),e.abrupt("return");case 3:return e.next=5,ibiz.util.file.chooseFileAndUpload(this.context,this.params,this.data);case 5:t=e.sent,n=this.htmlController.parent,i=this.data[this.fileFieldValue]||"[]",r=JSON.parse(i),o=t.map((function(e){return{name:e.name,id:e.id}})),r.push.apply(r,v(o)),a=JSON.stringify(r),n.setDataValue(a,this.fileFieldValue),this.evt.emit("fileChange",{value:a}),this.editor.blur();case 15:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})}]);var e,t}();var Au={type:"codesnippet",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,i=e.data,r=void 0===i?{}:i,o=W.execScriptFn({data:r},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var _u={selector:'span[data-w-e-type="codesnippet"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"codesnippet",script:n.script,data:n,children:[{text:""}]}}};var Pu={type:"CodeSnippet",renderElem:function(e){var t=e.data,n=void 0===t?{}:t,i={name:"".concat(n.name),id:n.id};return bu("mention-elem",{dataset:{value:JSON.stringify(i)},props:{contentEditable:!1}},[])}},Ou=function(){return P((function e(){A(this,e),O(this,"title","代码段"),O(this,"tag","button"),O(this,"iconSvg",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36px" height="36px" viewBox="0 0 36 36" version="1.1">\n  <title>代码段</title>\n  <g id="代码段" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n      <g id="icon备份">\n          <rect id="矩形" stroke="#EEEEEE" fill="#FFFFFF" x="0.5" y="0.5" width="35" height="35" rx="4"/>\n          <path d="M24.6642225,18.8794824 L27.6075695,18.8794824 C27.9389404,18.8794824 28.2075695,19.1481115 28.2075695,19.4794824 C28.2075695,19.8108532 27.9389404,20.0794824 27.6075695,20.0794824 L24.6642225,20.0794824 C24.3328516,20.0794824 24.0642225,19.8108532 24.0642225,19.4794824 C24.0642225,19.1481115 24.3328516,18.8794824 24.6642225,18.8794824 Z" id="矩形备份-74" fill="#73D897"/>\n          <path d="M24.6642225,13.2927173 L30.4,13.2927173 C30.7313708,13.2927173 31,13.5613465 31,13.8927173 C31,14.2240882 30.7313708,14.4927173 30.4,14.4927173 L24.6642225,14.4927173 C24.3328516,14.4927173 24.0642225,14.2240882 24.0642225,13.8927173 C24.0642225,13.5613465 24.3328516,13.2927173 24.6642225,13.2927173 Z" id="矩形备份-75" fill="#6698FF"/>\n          <path d="M24.6642225,24.4662475 L30.4,24.4662475 C30.7313708,24.4662475 31,24.7348766 31,25.0662475 C31,25.3976183 30.7313708,25.6662475 30.4,25.6662475 L24.6642225,25.6662475 C24.3328516,25.6662475 24.0642225,25.3976183 24.0642225,25.0662475 C24.0642225,24.7348766 24.3328516,24.4662475 24.6642225,24.4662475 Z" id="矩形备份-77" fill="#FF7575"/>\n          <g id="1.Base基础/1.icon图标/11.editor/header-1" transform="translate(5.000000, 11.000000)" fill="#DDDDDD">\n              <path d="M4.68266589,2.39258039 L1.51032474,7.44797324 L5.01586095,12.7216272 L4.05994646,13.3212428 L0.126424153,7.40475416 L3.68603474,1.72997946 L4.68266589,2.39258039 Z M11.3173341,12.6697762 L14.4896753,7.61438339 L10.984139,2.34072939 L11.9400535,1.7411138 L15.8735758,7.65760247 L12.3139653,13.3323772 L11.3173341,12.6697762 Z M8.86596086,1.31248434 L10.0376294,1.55020137 L7.19605832,13.6243456 L6.0243898,13.3866286 L8.86596086,1.31248434 Z" id="形状结合"/>\n          </g>\n      </g>\n  </g>\n</svg>')}),[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){throw new _e("暂未支持上传代码段！")}}])}(),Tu={renderElems:[Pu],elemsToHtml:[Au],parseElemsHtml:[_u],menus:[{key:"codesnippet",factory:function(){return new Ou}}]},Lu=function(){return P((function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"evt",void 0),O(this,"execting",!1),this.registerNode()}),[{key:"registerNode",value:function(){window.codesnippetIsRegiter||(ye.registerModule(Tu),window.codesnippetIsRegiter=!0)}},{key:"init",value:(e=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams;case 7:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"onDestroyed",value:function(){}},{key:"insertNode",value:function(e){}},{key:"parseNode",value:function(e){return e}}]);var e}();var ju={type:"marker",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,i=e.data,r=void 0===i?{}:i,o=W.execScriptFn({data:r},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var Nu={selector:'span[data-w-e-type="marker"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"marker",script:n.script,data:n,children:[{text:""}]}}};var Du={type:"marker",renderElem:function(e){var t=e.data,n=void 0===t?{}:t;return bu("mention-elem",{dataset:{value:JSON.stringify(n)},props:{contentEditable:!1}},[])}},Iu=function(){return P((function e(){A(this,e),O(this,"title","提及项"),O(this,"tag","button"),O(this,"iconSvg",'<svg t="1706259772097" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6854" width="200" height="200"><path d="M929.28 625.664l-234.496 0.512 24.064-229.888 210.432-0.512c20.992 0 38.4-17.408 38.4-38.4s-17.408-38.4-38.4-38.4H727.04l29.184-275.456c2.048-20.992-13.312-39.936-34.304-41.984-20.992-2.048-39.936 13.312-41.984 34.304L650.24 318.976l-232.448 0.512 29.184-275.456c2.048-20.992-13.312-39.936-34.304-41.984-20.992-2.048-39.936 13.312-41.984 34.304l-29.696 283.648-246.272 0.512c-20.992 0-38.4 17.408-38.4 38.4s17.408 38.4 38.4 38.4l238.08-0.512-24.064 229.888-214.016 0.512c-20.992 0-38.4 17.408-38.4 38.4s17.408 38.4 38.4 38.4l205.824-0.512-29.184 276.992c-2.048 20.992 13.312 39.936 34.304 41.984h4.096c19.456 0 35.84-14.848 37.888-34.304l30.208-285.184 232.448-0.512-29.184 277.504c-2.048 20.992 13.312 39.936 34.304 41.984h4.096c19.456 0 35.84-14.848 38.4-34.304l30.208-285.184 242.688-0.512c20.992 0 38.4-17.408 38.4-38.4-1.536-20.992-18.944-37.888-39.936-37.888z m-544.256 0.512l24.064-229.888 232.448-0.512-24.064 229.888-232.448 0.512z" fill="#979797" p-id="6855"></path></svg>')}),[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){e.insertText("#")}}])}(),Ru={renderElems:[Du],elemsToHtml:[ju],parseElemsHtml:[Nu],menus:[{key:"marker",factory:function(){return new Iu}}]},Bu=c({name:"MenTion",props:{controller:{type:Object,required:!0},modal:{type:Object}},setup:function(e){var t=ne("mention"),n=e.controller,i=f(!1),r=f([]),o=Oe,a=f({}),s=f(0),l=f(""),u=f([]),c=function(e){var t=e.eventArg;if(t){l.value||(l.value=t),l.value.length>t.length&&n.overlay&&n.execting&&(l.value="",n.overlay.dismiss());var i=t.match(/(?<=\@)([^\@&^{]*?)(?=\<)/g)||[];n.execting&&(0===i.length&&(l.value="",n.overlay.dismiss()),n.query=i.pop()||"",n.query&&/\s$/.test(n.query)?(l.value="",n.overlay.dismiss()):n.query&&g({isInitialLoad:!0}))}else n.overlay&&n.execting&&(l.value="",n.overlay.dismiss())},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.value=!0,n.getUsers(e).then((function(t){var o;(200===t.status&&t.data||(i.value=!1),t.headers["x-total"]&&(s.value=Number(t.headers["x-total"])),!0===e.isLoadMore)?(o=r.value).push.apply(o,v(n.toUIData(t.data))):(r.value=n.toUIData(t.data),r.value.length>0&&(a.value=r.value[0]));i.value=!1})).catch((function(){i.value=!1}))},d=D((function(){return r.value.length>=s.value||i.value||s.value<=n.size})),g=Ve(h,300,{leading:!0});n.evt&&n.evt.on("onChange",c),h({isInitialLoad:!0});var p=function(t){var n=r.value.findIndex((function(e){return e.id===a.value.id}));switch(t){case"up":-1!==--n&&-2!==n||(n=r.value.length-1),a.value=r.value[n];break;case"down":++n===r.value.length&&(n=0),a.value=r.value[n];break;case"enter":var i;if(r.value.length>0)y(a.value);else l.value="",null===(i=e.modal)||void 0===i||i.dismiss({ok:!1,data:[]})}},y=function(t){if(e.modal){var n,i={ok:!0,data:[t]};l.value="",null===(n=e.modal)||void 0===n||n.dismiss(i)}};return _((function(){o=Pe(window,"keyup",(function(e){40===e.keyCode?p("down"):38===e.keyCode?p("up"):13===e.keyCode&&p("enter")}))})),S((function(){o!==Oe&&o(),n.evt.off("onChange",c)})),{ns:t,items:r,loading:i,isLodeMoreDisabled:d,renderItem:function(e){var i=e.name,r=Ds.stringToHexColor(i),o=Ds.avatarName(i),s=e.title,l="";if(n.operatorMap.has(e.id)){var c=n.operatorMap.get(e.id);c.data.iconurl&&(l=function(e){if(!e)return null;var t=JSON.parse(e);return 0===t.length?null:ibiz.util.file.calcFileUpDownUrl(n.context,n.params,n.editorParams).downloadUrl.replace("%fileId%",t[0].id)}(c.data.iconurl)||"")}return L("div",{class:[t.e("item"),t.is("active",e.id===a.value.id)],onClick:function(){return y(e)}},[L("div",{class:t.e("avatar"),style:"background: ".concat(r,";")},[l&&!u.value.includes(l)?L("img",{src:l,onError:function(){return function(e){u.value.push(e)}(l)}},null):o]),L("div",{class:t.e("name"),title:i},[i]),s&&L("div",{class:t.e("title-label")},[s])])},loadMore:function(){h({isLoadMore:!0})}}},render:function(){var e=this;return F(L("div",{"infinite-scroll-distance":10,"infinite-scroll-disabled":this.isLodeMoreDisabled,"infinite-scroll-immediate":!1,class:this.ns.b()},[this.items.map((function(t){return e.renderItem(t)})),0===this.items.length&&L(j("iBizNoData"),{text:"暂无用户数据"},null)]),[[V("infinite-scroll"),function(){return e.loadMore()}],[V("loading"),this.loading]])}}),zu=c({name:"Marker",props:{controller:{type:Object,required:!0},modal:{type:Object}},setup:function(e){var t=ne("marker"),n=e.controller,i=f(!1),r=f([]),o=Oe,a=f({}),s=f(0),l=f(""),u=function(e){var t=e.eventArg;if(t){l.value||(l.value=t),l.value.length>t.length&&n.overlay&&n.execting&&(l.value="",n.overlay.dismiss());var i=t.replace(/<svg((.|[\t\r\f\n\s])+?)<\/svg>/g,"").match(/(?<=\#)([^\#&^{]*?)(?=\<)/g)||[];n.execting&&(0===i.length&&(l.value="",n.overlay.dismiss()),n.query=i.pop()||"",n.query&&/\s$/.test(n.query)?(l.value="",n.overlay.dismiss()):n.query&&d({isInitialLoad:!0}))}else n.overlay&&n.execting&&(l.value="",n.overlay.dismiss())},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.value=!0,n.load(e).then((function(t){var o;(200===t.status&&t.data||(i.value=!1),t.headers["x-total"]&&(s.value=Number(t.headers["x-total"])),!0===e.isLoadMore)?(o=r.value).push.apply(o,v(n.toUIData(t.data))):(r.value=n.toUIData(t.data),r.value.length>0&&(a.value=r.value[0]));i.value=!1})).catch((function(){i.value=!1}))},h=D((function(){return r.value.length>=s.value||i.value||s.value<=n.size})),d=Ve(c,300,{leading:!0});n.evt&&n.evt.on("onChange",u),c({isInitialLoad:!0});var g=function(t){var n=r.value.findIndex((function(e){return e.id===a.value.id}));switch(t){case"up":-1!==--n&&-2!==n||(n=r.value.length-1),a.value=r.value[n];break;case"down":++n===r.value.length&&(n=0),a.value=r.value[n];break;case"enter":var i;if(r.value.length>0)p(a.value);else l.value="",null===(i=e.modal)||void 0===i||i.dismiss({ok:!1,data:[]})}},p=function(t){if(e.modal){var n,i={ok:!0,data:[t]};l.value="",null===(n=e.modal)||void 0===n||n.dismiss(i)}},y=function(e,t){if(n.quoteCodelistMap.has(e)){var i=n.quoteCodelistMap.get(e);return L(j("iBizCodeList"),{codeListItems:i.codeListItems,codeList:i.codeList,value:t},null)}return t};return _((function(){o=Pe(window,"keyup",(function(e){40===e.keyCode?g("down"):38===e.keyCode?g("up"):13===e.keyCode&&g("enter")}))})),S((function(){o!==Oe&&o(),n.evt.off("onChange",u)})),{ns:t,items:r,loading:i,isLodeMoreDisabled:h,renderItem:function(e){return L("div",{class:[t.e("item"),t.is("active",e.id===a.value.id)],onClick:function(){return p(e)}},[L("div",{class:t.e("type")},[y("type",e.owner_subtype)]),L("div",{class:t.e("identifier")},[y("identifier",e.identifier)]),L("div",{class:t.e("name"),title:e.name},[y("name",e.name)])])},loadMore:function(){c({isLoadMore:!0})}}},render:function(){var e=this;return F(L("div",{"infinite-scroll-distance":10,"infinite-scroll-disabled":this.isLodeMoreDisabled,"infinite-scroll-immediate":!1,class:this.ns.b()},[this.items.map((function(t){return e.renderItem(t)})),0===this.items.length&&L(j("iBizNoData"),{text:"暂无数据"},null)]),[[V("infinite-scroll"),function(){return e.loadMore()}],[V("loading"),this.loading]])}}),Fu=c({name:"IBizHtmlEmoji",props:{modal:{type:Object,required:!0}},setup:function(e){return{ns:ne("html-emoji"),onSelect:function(t){var n={ok:!0,data:[{emoji:Te(t.data)}]};e.modal.dismiss(n)}}},render:function(){return L("div",{class:this.ns.b()},[L(j("iBizEmojiSelect"),{dark:!0,continuousList:!0,onSelect:this.onSelect},null)])}}),Vu=function(){return P((function e(t,n,i){A(this,e),O(this,"name",void 0),O(this,"icon",void 0),O(this,"text",void 0),this.name=t,this.icon=n,this.text=i}),[{key:"label",get:function(){return this.name}}])}(),Hu=P((function e(t,n,i){A(this,e),O(this,"data",void 0),O(this,"category",void 0),O(this,"aliases",void 0),this.data=t,this.category=n,this.aliases=i})),Uu=[new Hu("😀","peoples",["grinning"]),new Hu("😃","peoples",["smiley"]),new Hu("😄","peoples",["smile"]),new Hu("😁","peoples",["grin"]),new Hu("😆","peoples",["laughing","satisfied"]),new Hu("😅","peoples",["sweat_smile"]),new Hu("😂","peoples",["joy"]),new Hu("🤣","peoples",["rofl"]),new Hu("😌","peoples",["relaxed"]),new Hu("😊","peoples",["blush"]),new Hu("😇","peoples",["innocent"]),new Hu("🙂","peoples",["slightly_smiling_face"]),new Hu("🙃","peoples",["upside_down_face"]),new Hu("😉","peoples",["wink"]),new Hu("😌","peoples",["relieved"]),new Hu("😍","peoples",["heart_eyes"]),new Hu("😘","peoples",["kissing_heart"]),new Hu("😗","peoples",["kissing"]),new Hu("😙","peoples",["kissing_smiling_eyes"]),new Hu("😚","peoples",["kissing_closed_eyes"]),new Hu("😋","peoples",["yum"]),new Hu("😜","peoples",["stuck_out_tongue_winking_eye"]),new Hu("😝","peoples",["stuck_out_tongue_closed_eyes"]),new Hu("😛","peoples",["stuck_out_tongue"]),new Hu("🤑","peoples",["money_mouth_face"]),new Hu("🤗","peoples",["hugs"]),new Hu("🤓","peoples",["nerd_face"]),new Hu("😎","peoples",["sunglasses"]),new Hu("🤡","peoples",["clown_face"]),new Hu("🤠","peoples",["cowboy_hat_face"]),new Hu("😏","peoples",["smirk"]),new Hu("😒","peoples",["unamused"]),new Hu("😞","peoples",["disappointed"]),new Hu("😔","peoples",["pensive"]),new Hu("😟","peoples",["worried"]),new Hu("😕","peoples",["confused"]),new Hu("🙁","peoples",["slightly_frowning_face"]),new Hu("☹️","peoples",["frowning_face"]),new Hu("😣","peoples",["persevere"]),new Hu("😖","peoples",["confounded"]),new Hu("😫","peoples",["tired_face"]),new Hu("😩","peoples",["weary"]),new Hu("😤","peoples",["triumph"]),new Hu("😠","peoples",["angry"]),new Hu("😡","peoples",["rage","pout"]),new Hu("😶","peoples",["no_mouth"]),new Hu("😐","peoples",["neutral_face"]),new Hu("😑","peoples",["expressionless"]),new Hu("😯","peoples",["hushed"]),new Hu("😦","peoples",["frowning"]),new Hu("😧","peoples",["anguished"]),new Hu("😮","peoples",["open_mouth"]),new Hu("😲","peoples",["astonished"]),new Hu("😵","peoples",["dizzy_face"]),new Hu("😳","peoples",["flushed"]),new Hu("😱","peoples",["scream"]),new Hu("😨","peoples",["fearful"]),new Hu("😰","peoples",["cold_sweat"]),new Hu("😢","peoples",["cry"]),new Hu("😥","peoples",["disappointed_relieved"]),new Hu("🤤","peoples",["drooling_face"]),new Hu("😭","peoples",["sob"]),new Hu("😓","peoples",["sweat"]),new Hu("😪","peoples",["sleepy"]),new Hu("😴","peoples",["sleeping"]),new Hu("🙄","peoples",["roll_eyes"]),new Hu("🤔","peoples",["thinking"]),new Hu("🤥","peoples",["lying_face"]),new Hu("😬","peoples",["grimacing"]),new Hu("🤐","peoples",["zipper_mouth_face"]),new Hu("🤢","peoples",["nauseated_face"]),new Hu("🤧","peoples",["sneezing_face"]),new Hu("😷","peoples",["mask"]),new Hu("🤒","peoples",["face_with_thermometer"]),new Hu("🤕","peoples",["face_with_head_bandage"]),new Hu("😈","peoples",["smiling_imp"]),new Hu("👿","peoples",["imp"]),new Hu("👹","peoples",["japanese_ogre"]),new Hu("👺","peoples",["japanese_goblin"]),new Hu("💩","peoples",["hankey","poop","shit"]),new Hu("👻","peoples",["ghost"]),new Hu("💀","peoples",["skull"]),new Hu("☠️","peoples",["skull_and_crossbones"]),new Hu("👽","peoples",["alien"]),new Hu("👾","peoples",["space_invader"]),new Hu("🤖","peoples",["robot"]),new Hu("🎃","peoples",["jack_o_lantern"]),new Hu("😺","peoples",["smiley_cat"]),new Hu("😸","peoples",["smile_cat"]),new Hu("😹","peoples",["joy_cat"]),new Hu("😻","peoples",["heart_eyes_cat"]),new Hu("😼","peoples",["smirk_cat"]),new Hu("😽","peoples",["kissing_cat"]),new Hu("🙀","peoples",["scream_cat"]),new Hu("😿","peoples",["crying_cat_face"]),new Hu("😾","peoples",["pouting_cat"]),new Hu("👐","peoples",["open_hands"]),new Hu("🙌","peoples",["raised_hands"]),new Hu("👏","peoples",["clap"]),new Hu("🙏","peoples",["pray"]),new Hu("🤝","peoples",["handshake"]),new Hu("👍","peoples",["+1","thumbsup"]),new Hu("👎","peoples",["-1","thumbsdown"]),new Hu("👊","peoples",["fist_oncoming","facepunch","punch"]),new Hu("✊","peoples",["fist_raised","fist"]),new Hu("🤛","peoples",["fist_left"]),new Hu("🤜","peoples",["fist_right"]),new Hu("🤞","peoples",["crossed_fingers"]),new Hu("✌️","peoples",["v"]),new Hu("🤘","peoples",["metal"]),new Hu("👌","peoples",["ok_hand"]),new Hu("👈","peoples",["point_left"]),new Hu("👉","peoples",["point_right"]),new Hu("👆","peoples",["point_up_2"]),new Hu("👇","peoples",["point_down"]),new Hu("☝️","peoples",["point_up"]),new Hu("✋","peoples",["hand","raised_hand"]),new Hu("🤚","peoples",["raised_back_of_hand"]),new Hu("🖐","peoples",["raised_hand_with_fingers_splayed"]),new Hu("🖖","peoples",["vulcan_salute"]),new Hu("👋","peoples",["wave"]),new Hu("🤙","peoples",["call_me_hand"]),new Hu("💪","peoples",["muscle"]),new Hu("🖕","peoples",["middle_finger","fu"]),new Hu("✍️","peoples",["writing_hand"]),new Hu("🤳","peoples",["selfie"]),new Hu("💅","peoples",["nail_care"]),new Hu("💍","peoples",["ring"]),new Hu("💄","peoples",["lipstick"]),new Hu("💋","peoples",["kiss"]),new Hu("👄","peoples",["lips"]),new Hu("👅","peoples",["tongue"]),new Hu("👂","peoples",["ear"]),new Hu("👃","peoples",["nose"]),new Hu("👣","peoples",["footprints"]),new Hu("👁","peoples",["eye"]),new Hu("👀","peoples",["eyes"]),new Hu("🗣","peoples",["speaking_head"]),new Hu("👤","peoples",["bust_in_silhouette"]),new Hu("👥","peoples",["busts_in_silhouette"]),new Hu("👶","peoples",["baby"]),new Hu("👦","peoples",["boy"]),new Hu("👧","peoples",["girl"]),new Hu("👨","peoples",["man"]),new Hu("👩","peoples",["woman"]),new Hu("👱‍♀","peoples",["blonde_woman"]),new Hu("👱","peoples",["blonde_man","person_with_blond_hair"]),new Hu("👴","peoples",["older_man"]),new Hu("👵","peoples",["older_woman"]),new Hu("👲","peoples",["man_with_gua_pi_mao"]),new Hu("👳‍♀","peoples",["woman_with_turban"]),new Hu("👳","peoples",["man_with_turban"]),new Hu("👮‍♀","peoples",["policewoman"]),new Hu("👮","peoples",["policeman","cop"]),new Hu("👷‍♀","peoples",["construction_worker_woman"]),new Hu("👷","peoples",["construction_worker_man","construction_worker"]),new Hu("💂‍♀","peoples",["guardswoman"]),new Hu("💂","peoples",["guardsman"]),new Hu("👩‍⚕","peoples",["woman_health_worker"]),new Hu("👨‍⚕","peoples",["man_health_worker"]),new Hu("👩‍🌾","peoples",["woman_farmer"]),new Hu("👨‍🌾","peoples",["man_farmer"]),new Hu("👩‍🍳","peoples",["woman_cook"]),new Hu("👨‍🍳","peoples",["man_cook"]),new Hu("👩‍🎓","peoples",["woman_student"]),new Hu("👨‍🎓","peoples",["man_student"]),new Hu("👩‍🎤","peoples",["woman_singer"]),new Hu("👨‍🎤","peoples",["man_singer"]),new Hu("👩‍🏫","peoples",["woman_teacher"]),new Hu("👨‍🏫","peoples",["man_teacher"]),new Hu("👩‍🏭","peoples",["woman_factory_worker"]),new Hu("👨‍🏭","peoples",["man_factory_worker"]),new Hu("👩‍💻","peoples",["woman_technologist"]),new Hu("👨‍💻","peoples",["man_technologist"]),new Hu("👩‍💼","peoples",["woman_office_worker"]),new Hu("👨‍💼","peoples",["man_office_worker"]),new Hu("👩‍🔧","peoples",["woman_mechanic"]),new Hu("👨‍🔧","peoples",["man_mechanic"]),new Hu("👩‍🔬","peoples",["woman_scientist"]),new Hu("👨‍🔬","peoples",["man_scientist"]),new Hu("👩‍🎨","peoples",["woman_artist"]),new Hu("👨‍🎨","peoples",["man_artist"]),new Hu("👩‍🚒","peoples",["woman_firefighter"]),new Hu("👨‍🚒","peoples",["man_firefighter"]),new Hu("👩‍🚀","peoples",["woman_astronaut"]),new Hu("👨‍🚀","peoples",["man_astronaut"]),new Hu("🤶","peoples",["mrs_claus"]),new Hu("🎅","peoples",["santa"]),new Hu("👸","peoples",["princess"]),new Hu("🤴","peoples",["prince"]),new Hu("👰","peoples",["bride_with_veil"]),new Hu("🤵","peoples",["man_in_tuxedo"]),new Hu("👼","peoples",["angel"]),new Hu("🤰","peoples",["pregnant_woman"]),new Hu("🙇‍♀","peoples",["bowing_woman"]),new Hu("🙇","peoples",["bowing_man","bow"]),new Hu("💁","peoples",["tipping_hand_woman","information_desk_person","sassy_woman"]),new Hu("💁‍♂","peoples",["tipping_hand_man","sassy_man"]),new Hu("🙅","peoples",["no_good_woman","no_good","ng_woman"]),new Hu("🙅‍♂","peoples",["no_good_man","ng_man"]),new Hu("🙆","peoples",["ok_woman"]),new Hu("🙆‍♂","peoples",["ok_man"]),new Hu("🙋","peoples",["raising_hand_woman","raising_hand"]),new Hu("🙋‍♂","peoples",["raising_hand_man"]),new Hu("🤦‍♀","peoples",["woman_facepalming"]),new Hu("🤦‍♂","peoples",["man_facepalming"]),new Hu("🤷‍♀","peoples",["woman_shrugging"]),new Hu("🤷‍♂","peoples",["man_shrugging"]),new Hu("🙎","peoples",["pouting_woman","person_with_pouting_face"]),new Hu("🙎‍♂","peoples",["pouting_man"]),new Hu("🙍","peoples",["frowning_woman","person_frowning"]),new Hu("🙍‍♂","peoples",["frowning_man"]),new Hu("💇","peoples",["haircut_woman","haircut"]),new Hu("💇‍♂","peoples",["haircut_man"]),new Hu("💆","peoples",["massage_woman","massage"]),new Hu("💆‍♂","peoples",["massage_man"]),new Hu("🕴","peoples",["business_suit_levitating"]),new Hu("💃","peoples",["dancer"]),new Hu("🕺","peoples",["man_dancing"]),new Hu("👯","peoples",["dancing_women","dancers"]),new Hu("👯‍♂","peoples",["dancing_men"]),new Hu("🚶‍♀","peoples",["walking_woman"]),new Hu("🚶","peoples",["walking_man","walking"]),new Hu("🏃‍♀","peoples",["running_woman"]),new Hu("🏃","peoples",["running_man","runner","running"]),new Hu("👫","peoples",["couple"]),new Hu("👭","peoples",["two_women_holding_hands"]),new Hu("👬","peoples",["two_men_holding_hands"]),new Hu("💑","peoples",["couple_with_heart_woman_man","couple_with_heart"]),new Hu("👩‍❤️‍👩","peoples",["couple_with_heart_woman_woman"]),new Hu("👨‍❤️‍👨","peoples",["couple_with_heart_man_man"]),new Hu("💏","peoples",["couplekiss_man_woman"]),new Hu("👩‍❤️‍💋‍👩","peoples",["couplekiss_woman_woman"]),new Hu("👨‍❤️‍💋‍👨","peoples",["couplekiss_man_man"]),new Hu("👪","peoples",["family_man_woman_boy","family"]),new Hu("👨‍👩‍👧","peoples",["family_man_woman_girl"]),new Hu("👨‍👩‍👧‍👦","peoples",["family_man_woman_girl_boy"]),new Hu("👨‍👩‍👦‍👦","peoples",["family_man_woman_boy_boy"]),new Hu("👨‍👩‍👧‍👧","peoples",["family_man_woman_girl_girl"]),new Hu("👩‍👩‍👦","peoples",["family_woman_woman_boy"]),new Hu("👩‍👩‍👧","peoples",["family_woman_woman_girl"]),new Hu("👩‍👩‍👧‍👦","peoples",["family_woman_woman_girl_boy"]),new Hu("👩‍👩‍👦‍👦","peoples",["family_woman_woman_boy_boy"]),new Hu("👩‍👩‍👧‍👧","peoples",["family_woman_woman_girl_girl"]),new Hu("👨‍👨‍👦","peoples",["family_man_man_boy"]),new Hu("👨‍👨‍👧","peoples",["family_man_man_girl"]),new Hu("👨‍👨‍👧‍👦","peoples",["family_man_man_girl_boy"]),new Hu("👨‍👨‍👦‍👦","peoples",["family_man_man_boy_boy"]),new Hu("👨‍👨‍👧‍👧","peoples",["family_man_man_girl_girl"]),new Hu("👩‍👦","peoples",["family_woman_boy"]),new Hu("👩‍👧","peoples",["family_woman_girl"]),new Hu("👩‍👧‍👦","peoples",["family_woman_girl_boy"]),new Hu("👩‍👦‍👦","peoples",["family_woman_boy_boy"]),new Hu("👩‍👧‍👧","peoples",["family_woman_girl_girl"]),new Hu("👨‍👦","peoples",["family_man_boy"]),new Hu("👨‍👧","peoples",["family_man_girl"]),new Hu("👨‍👧‍👦","peoples",["family_man_girl_boy"]),new Hu("👨‍👦‍👦","peoples",["family_man_boy_boy"]),new Hu("👨‍👧‍👧","peoples",["family_man_girl_girl"]),new Hu("👚","peoples",["womans_clothes"]),new Hu("👕","peoples",["shirt","tshirt"]),new Hu("👖","peoples",["jeans"]),new Hu("👔","peoples",["necktie"]),new Hu("👗","peoples",["dress"]),new Hu("👙","peoples",["bikini"]),new Hu("👘","peoples",["kimono"]),new Hu("👠","peoples",["high_heel"]),new Hu("👡","peoples",["sandal"]),new Hu("👢","peoples",["boot"]),new Hu("👞","peoples",["mans_shoe","shoe"]),new Hu("👟","peoples",["athletic_shoe"]),new Hu("👒","peoples",["womans_hat"]),new Hu("🎩","peoples",["tophat"]),new Hu("🎓","peoples",["mortar_board"]),new Hu("👑","peoples",["crown"]),new Hu("⛑","peoples",["rescue_worker_helmet"]),new Hu("🎒","peoples",["school_satchel"]),new Hu("👝","peoples",["pouch"]),new Hu("👛","peoples",["purse"]),new Hu("👜","peoples",["handbag"]),new Hu("💼","peoples",["briefcase"]),new Hu("👓","peoples",["eyeglasses"]),new Hu("🕶","peoples",["dark_sunglasses"]),new Hu("🌂","peoples",["closed_umbrella"]),new Hu("☂️","peoples",["open_umbrella"]),new Hu("🐶","nature",["dog"]),new Hu("🐱","nature",["cat"]),new Hu("🐭","nature",["mouse"]),new Hu("🐹","nature",["hamster"]),new Hu("🐰","nature",["rabbit"]),new Hu("🦊","nature",["fox_face"]),new Hu("🐻","nature",["bear"]),new Hu("🐼","nature",["panda_face"]),new Hu("🐨","nature",["koala"]),new Hu("🐯","nature",["tiger"]),new Hu("🦁","nature",["lion"]),new Hu("🐮","nature",["cow"]),new Hu("🐷","nature",["pig"]),new Hu("🐽","nature",["pig_nose"]),new Hu("🐸","nature",["frog"]),new Hu("🐵","nature",["monkey_face"]),new Hu("🙈","nature",["see_no_evil"]),new Hu("🙉","nature",["hear_no_evil"]),new Hu("🙊","nature",["speak_no_evil"]),new Hu("🐒","nature",["monkey"]),new Hu("🐔","nature",["chicken"]),new Hu("🐧","nature",["penguin"]),new Hu("🐦","nature",["bird"]),new Hu("🐤","nature",["baby_chick"]),new Hu("🐣","nature",["hatching_chick"]),new Hu("🐥","nature",["hatched_chick"]),new Hu("🦆","nature",["duck"]),new Hu("🦅","nature",["eagle"]),new Hu("🦉","nature",["owl"]),new Hu("🦇","nature",["bat"]),new Hu("🐺","nature",["wolf"]),new Hu("🐗","nature",["boar"]),new Hu("🐴","nature",["horse"]),new Hu("🦄","nature",["unicorn"]),new Hu("🐝","nature",["bee","honeybee"]),new Hu("🐛","nature",["bug"]),new Hu("🦋","nature",["butterfly"]),new Hu("🐌","nature",["snail"]),new Hu("🐚","nature",["shell"]),new Hu("🐞","nature",["beetle"]),new Hu("🐜","nature",["ant"]),new Hu("🕷","nature",["spider"]),new Hu("🕸","nature",["spider_web"]),new Hu("🐢","nature",["turtle"]),new Hu("🐍","nature",["snake"]),new Hu("🦎","nature",["lizard"]),new Hu("🦂","nature",["scorpion"]),new Hu("🦀","nature",["crab"]),new Hu("🦑","nature",["squid"]),new Hu("🐙","nature",["octopus"]),new Hu("🦐","nature",["shrimp"]),new Hu("🐠","nature",["tropical_fish"]),new Hu("🐟","nature",["fish"]),new Hu("🐡","nature",["blowfish"]),new Hu("🐬","nature",["dolphin","flipper"]),new Hu("🦈","nature",["shark"]),new Hu("🐳","nature",["whale"]),new Hu("🐋","nature",["whale2"]),new Hu("🐊","nature",["crocodile"]),new Hu("🐆","nature",["leopard"]),new Hu("🐅","nature",["tiger2"]),new Hu("🐃","nature",["water_buffalo"]),new Hu("🐂","nature",["ox"]),new Hu("🐄","nature",["cow2"]),new Hu("🦌","nature",["deer"]),new Hu("🐪","nature",["dromedary_camel"]),new Hu("🐫","nature",["camel"]),new Hu("🐘","nature",["elephant"]),new Hu("🦏","nature",["rhinoceros"]),new Hu("🦍","nature",["gorilla"]),new Hu("🐎","nature",["racehorse"]),new Hu("🐖","nature",["pig2"]),new Hu("🐐","nature",["goat"]),new Hu("🐏","nature",["ram"]),new Hu("🐑","nature",["sheep"]),new Hu("🐕","nature",["dog2"]),new Hu("🐩","nature",["poodle"]),new Hu("🐈","nature",["cat2"]),new Hu("🐓","nature",["rooster"]),new Hu("🦃","nature",["turkey"]),new Hu("🕊","nature",["dove"]),new Hu("🐇","nature",["rabbit2"]),new Hu("🐁","nature",["mouse2"]),new Hu("🐀","nature",["rat"]),new Hu("🐿","nature",["chipmunk"]),new Hu("🐾","nature",["feet","paw_prints"]),new Hu("🐉","nature",["dragon"]),new Hu("🐲","nature",["dragon_face"]),new Hu("🌵","nature",["cactus"]),new Hu("🎄","nature",["christmas_tree"]),new Hu("🌲","nature",["evergreen_tree"]),new Hu("🌳","nature",["deciduous_tree"]),new Hu("🌴","nature",["palm_tree"]),new Hu("🌱","nature",["seedling"]),new Hu("🌿","nature",["herb"]),new Hu("☘️","nature",["shamrock"]),new Hu("🍀","nature",["four_leaf_clover"]),new Hu("🎍","nature",["bamboo"]),new Hu("🎋","nature",["tanabata_tree"]),new Hu("🍃","nature",["leaves"]),new Hu("🍂","nature",["fallen_leaf"]),new Hu("🍁","nature",["maple_leaf"]),new Hu("🍄","nature",["mushroom"]),new Hu("🌾","nature",["ear_of_rice"]),new Hu("💐","nature",["bouquet"]),new Hu("🌷","nature",["tulip"]),new Hu("🌹","nature",["rose"]),new Hu("🥀","nature",["wilted_flower"]),new Hu("🌻","nature",["sunflower"]),new Hu("🌼","nature",["blossom"]),new Hu("🌸","nature",["cherry_blossom"]),new Hu("🌺","nature",["hibiscus"]),new Hu("🌎","nature",["earth_americas"]),new Hu("🌍","nature",["earth_africa"]),new Hu("🌏","nature",["earth_asia"]),new Hu("🌕","nature",["full_moon"]),new Hu("🌖","nature",["waning_gibbous_moon"]),new Hu("🌗","nature",["last_quarter_moon"]),new Hu("🌘","nature",["waning_crescent_moon"]),new Hu("🌑","nature",["new_moon"]),new Hu("🌒","nature",["waxing_crescent_moon"]),new Hu("🌓","nature",["first_quarter_moon"]),new Hu("🌔","nature",["moon","waxing_gibbous_moon"]),new Hu("🌚","nature",["new_moon_with_face"]),new Hu("🌝","nature",["full_moon_with_face"]),new Hu("🌞","nature",["sun_with_face"]),new Hu("🌛","nature",["first_quarter_moon_with_face"]),new Hu("🌜","nature",["last_quarter_moon_with_face"]),new Hu("🌙","nature",["crescent_moon"]),new Hu("💫","nature",["dizzy"]),new Hu("⭐️","nature",["star"]),new Hu("🌟","nature",["star2"]),new Hu("✨","nature",["sparkles"]),new Hu("⚡️","nature",["zap"]),new Hu("🔥","nature",["fire"]),new Hu("💥","nature",["boom","collision"]),new Hu("☄","nature",["comet"]),new Hu("☀️","nature",["sunny"]),new Hu("🌤","nature",["sun_behind_small_cloud"]),new Hu("⛅️","nature",["partly_sunny"]),new Hu("🌥","nature",["sun_behind_large_cloud"]),new Hu("🌦","nature",["sun_behind_rain_cloud"]),new Hu("🌈","nature",["rainbow"]),new Hu("☁️","nature",["cloud"]),new Hu("🌧","nature",["cloud_with_rain"]),new Hu("⛈","nature",["cloud_with_lightning_and_rain"]),new Hu("🌩","nature",["cloud_with_lightning"]),new Hu("🌨","nature",["cloud_with_snow"]),new Hu("☃️","nature",["snowman_with_snow"]),new Hu("⛄️","nature",["snowman"]),new Hu("❄️","nature",["snowflake"]),new Hu("🌬","nature",["wind_face"]),new Hu("💨","nature",["dash"]),new Hu("🌪","nature",["tornado"]),new Hu("🌫","nature",["fog"]),new Hu("🌊","nature",["ocean"]),new Hu("💧","nature",["droplet"]),new Hu("💦","nature",["sweat_drops"]),new Hu("☔️","nature",["umbrella"]),new Hu("🍏","foods",["green_apple"]),new Hu("🍎","foods",["apple"]),new Hu("🍐","foods",["pear"]),new Hu("🍊","foods",["tangerine","orange","mandarin"]),new Hu("🍋","foods",["lemon"]),new Hu("🍌","foods",["banana"]),new Hu("🍉","foods",["watermelon"]),new Hu("🍇","foods",["grapes"]),new Hu("🍓","foods",["strawberry"]),new Hu("🍈","foods",["melon"]),new Hu("🍒","foods",["cherries"]),new Hu("🍑","foods",["peach"]),new Hu("🍍","foods",["pineapple"]),new Hu("🥝","foods",["kiwi_fruit"]),new Hu("🥑","foods",["avocado"]),new Hu("🍅","foods",["tomato"]),new Hu("🍆","foods",["eggplant"]),new Hu("🥒","foods",["cucumber"]),new Hu("🥕","foods",["carrot"]),new Hu("🌽","foods",["corn"]),new Hu("🌶","foods",["hot_pepper"]),new Hu("🥔","foods",["potato"]),new Hu("🍠","foods",["sweet_potato"]),new Hu("🌰","foods",["chestnut"]),new Hu("🥜","foods",["peanuts"]),new Hu("🍯","foods",["honey_pot"]),new Hu("🥐","foods",["croissant"]),new Hu("🍞","foods",["bread"]),new Hu("🥖","foods",["baguette_bread"]),new Hu("🧀","foods",["cheese"]),new Hu("🥚","foods",["egg"]),new Hu("🍳","foods",["fried_egg"]),new Hu("🥓","foods",["bacon"]),new Hu("🥞","foods",["pancakes"]),new Hu("🍤","foods",["fried_shrimp"]),new Hu("🍗","foods",["poultry_leg"]),new Hu("🍖","foods",["meat_on_bone"]),new Hu("🍕","foods",["pizza"]),new Hu("🌭","foods",["hotdog"]),new Hu("🍔","foods",["hamburger"]),new Hu("🍟","foods",["fries"]),new Hu("🥙","foods",["stuffed_flatbread"]),new Hu("🌮","foods",["taco"]),new Hu("🌯","foods",["burrito"]),new Hu("🥗","foods",["green_salad"]),new Hu("🥘","foods",["shallow_pan_of_food"]),new Hu("🍝","foods",["spaghetti"]),new Hu("🍜","foods",["ramen"]),new Hu("🍲","foods",["stew"]),new Hu("🍥","foods",["fish_cake"]),new Hu("🍣","foods",["sushi"]),new Hu("🍱","foods",["bento"]),new Hu("🍛","foods",["curry"]),new Hu("🍚","foods",["rice"]),new Hu("🍙","foods",["rice_ball"]),new Hu("🍘","foods",["rice_cracker"]),new Hu("🍢","foods",["oden"]),new Hu("🍡","foods",["dango"]),new Hu("🍧","foods",["shaved_ice"]),new Hu("🍨","foods",["ice_cream"]),new Hu("🍦","foods",["icecream"]),new Hu("🍰","foods",["cake"]),new Hu("🎂","foods",["birthday"]),new Hu("🍮","foods",["custard"]),new Hu("🍭","foods",["lollipop"]),new Hu("🍬","foods",["candy"]),new Hu("🍫","foods",["chocolate_bar"]),new Hu("🍿","foods",["popcorn"]),new Hu("🍩","foods",["doughnut"]),new Hu("🍪","foods",["cookie"]),new Hu("🥛","foods",["milk_glass"]),new Hu("🍼","foods",["baby_bottle"]),new Hu("☕️","foods",["coffee"]),new Hu("🍵","foods",["tea"]),new Hu("🍶","foods",["sake"]),new Hu("🍺","foods",["beer"]),new Hu("🍻","foods",["beers"]),new Hu("🥂","foods",["clinking_glasses"]),new Hu("🍷","foods",["wine_glass"]),new Hu("🥃","foods",["tumbler_glass"]),new Hu("🍸","foods",["cocktail"]),new Hu("🍹","foods",["tropical_drink"]),new Hu("🍾","foods",["champagne"]),new Hu("🥄","foods",["spoon"]),new Hu("🍴","foods",["fork_and_knife"]),new Hu("🍽","foods",["plate_with_cutlery"]),new Hu("⚽️","activity",["soccer"]),new Hu("🏀","activity",["basketball"]),new Hu("🏈","activity",["football"]),new Hu("⚾️","activity",["baseball"]),new Hu("🎾","activity",["tennis"]),new Hu("🏐","activity",["volleyball"]),new Hu("🏉","activity",["rugby_football"]),new Hu("🎱","activity",["8ball"]),new Hu("🏓","activity",["ping_pong"]),new Hu("🏸","activity",["badminton"]),new Hu("🥅","activity",["goal_net"]),new Hu("🏒","activity",["ice_hockey"]),new Hu("🏑","activity",["field_hockey"]),new Hu("🏏","activity",["cricket"]),new Hu("⛳️","activity",["golf"]),new Hu("🏹","activity",["bow_and_arrow"]),new Hu("🎣","activity",["fishing_pole_and_fish"]),new Hu("🥊","activity",["boxing_glove"]),new Hu("🥋","activity",["martial_arts_uniform"]),new Hu("⛸","activity",["ice_skate"]),new Hu("🎿","activity",["ski"]),new Hu("⛷","activity",["skier"]),new Hu("🏂","activity",["snowboarder"]),new Hu("🏋️‍♀️","activity",["weight_lifting_woman"]),new Hu("🏋","activity",["weight_lifting_man"]),new Hu("🤺","activity",["person_fencing"]),new Hu("🤼‍♀","activity",["women_wrestling"]),new Hu("🤼‍♂","activity",["men_wrestling"]),new Hu("🤸‍♀","activity",["woman_cartwheeling"]),new Hu("🤸‍♂","activity",["man_cartwheeling"]),new Hu("⛹️‍♀️","activity",["basketball_woman"]),new Hu("⛹","activity",["basketball_man"]),new Hu("🤾‍♀","activity",["woman_playing_handball"]),new Hu("🤾‍♂","activity",["man_playing_handball"]),new Hu("🏌️‍♀️","activity",["golfing_woman"]),new Hu("🏌","activity",["golfing_man"]),new Hu("🏄‍♀","activity",["surfing_woman"]),new Hu("🏄","activity",["surfing_man","surfer"]),new Hu("🏊‍♀","activity",["swimming_woman"]),new Hu("🏊","activity",["swimming_man","swimmer"]),new Hu("🤽‍♀","activity",["woman_playing_water_polo"]),new Hu("🤽‍♂","activity",["man_playing_water_polo"]),new Hu("🚣‍♀","activity",["rowing_woman"]),new Hu("🚣","activity",["rowing_man","rowboat"]),new Hu("🏇","activity",["horse_racing"]),new Hu("🚴‍♀","activity",["biking_woman"]),new Hu("🚴","activity",["biking_man","bicyclist"]),new Hu("🚵‍♀","activity",["mountain_biking_woman"]),new Hu("🚵","activity",["mountain_biking_man","mountain_bicyclist"]),new Hu("🎽","activity",["running_shirt_with_sash"]),new Hu("🏅","activity",["medal_sports"]),new Hu("🎖","activity",["medal_military"]),new Hu("🥇","activity",["1st_place_medal"]),new Hu("🥈","activity",["2nd_place_medal"]),new Hu("🥉","activity",["3rd_place_medal"]),new Hu("🏆","activity",["trophy"]),new Hu("🏵","activity",["rosette"]),new Hu("🎗","activity",["reminder_ribbon"]),new Hu("🎫","activity",["ticket"]),new Hu("🎟","activity",["tickets"]),new Hu("🎪","activity",["circus_tent"]),new Hu("🤹‍♀","activity",["woman_juggling"]),new Hu("🤹‍♂","activity",["man_juggling"]),new Hu("🎭","activity",["performing_arts"]),new Hu("🎨","activity",["art"]),new Hu("🎬","activity",["clapper"]),new Hu("🎤","activity",["microphone"]),new Hu("🎧","activity",["headphones"]),new Hu("🎼","activity",["musical_score"]),new Hu("🎹","activity",["musical_keyboard"]),new Hu("🥁","activity",["drum"]),new Hu("🎷","activity",["saxophone"]),new Hu("🎺","activity",["trumpet"]),new Hu("🎸","activity",["guitar"]),new Hu("🎻","activity",["violin"]),new Hu("🎲","activity",["game_die"]),new Hu("🎯","activity",["dart"]),new Hu("🎳","activity",["bowling"]),new Hu("🎮","activity",["video_game"]),new Hu("🎰","activity",["slot_machine"]),new Hu("🚗","places",["car","red_car"]),new Hu("🚕","places",["taxi"]),new Hu("🚙","places",["blue_car"]),new Hu("🚌","places",["bus"]),new Hu("🚎","places",["trolleybus"]),new Hu("🏎","places",["racing_car"]),new Hu("🚓","places",["police_car"]),new Hu("🚑","places",["ambulance"]),new Hu("🚒","places",["fire_engine"]),new Hu("🚐","places",["minibus"]),new Hu("🚚","places",["truck"]),new Hu("🚛","places",["articulated_lorry"]),new Hu("🚜","places",["tractor"]),new Hu("🛴","places",["kick_scooter"]),new Hu("🚲","places",["bike"]),new Hu("🛵","places",["motor_scooter"]),new Hu("🏍","places",["motorcycle"]),new Hu("🚨","places",["rotating_light"]),new Hu("🚔","places",["oncoming_police_car"]),new Hu("🚍","places",["oncoming_bus"]),new Hu("🚘","places",["oncoming_automobile"]),new Hu("🚖","places",["oncoming_taxi"]),new Hu("🚡","places",["aerial_tramway"]),new Hu("🚠","places",["mountain_cableway"]),new Hu("🚟","places",["suspension_railway"]),new Hu("🚃","places",["railway_car"]),new Hu("🚋","places",["train"]),new Hu("🚞","places",["mountain_railway"]),new Hu("🚝","places",["monorail"]),new Hu("🚄","places",["bullettrain_side"]),new Hu("🚅","places",["bullettrain_front"]),new Hu("🚈","places",["light_rail"]),new Hu("🚂","places",["steam_locomotive"]),new Hu("🚆","places",["train2"]),new Hu("🚇","places",["metro"]),new Hu("🚊","places",["tram"]),new Hu("🚉","places",["station"]),new Hu("🚁","places",["helicopter"]),new Hu("🛩","places",["small_airplane"]),new Hu("✈️","places",["airplane"]),new Hu("🛫","places",["flight_departure"]),new Hu("🛬","places",["flight_arrival"]),new Hu("🚀","places",["rocket"]),new Hu("🛰","places",["artificial_satellite"]),new Hu("💺","places",["seat"]),new Hu("🛶","places",["canoe"]),new Hu("⛵️","places",["boat","sailboat"]),new Hu("🛥","places",["motor_boat"]),new Hu("🚤","places",["speedboat"]),new Hu("🛳","places",["passenger_ship"]),new Hu("⛴","places",["ferry"]),new Hu("🚢","places",["ship"]),new Hu("⚓️","places",["anchor"]),new Hu("🚧","places",["construction"]),new Hu("⛽️","places",["fuelpump"]),new Hu("🚏","places",["busstop"]),new Hu("🚦","places",["vertical_traffic_light"]),new Hu("🚥","places",["traffic_light"]),new Hu("🗺","places",["world_map"]),new Hu("🗿","places",["moyai"]),new Hu("🗽","places",["statue_of_liberty"]),new Hu("⛲️","places",["fountain"]),new Hu("🗼","places",["tokyo_tower"]),new Hu("🏰","places",["european_castle"]),new Hu("🏯","places",["japanese_castle"]),new Hu("🏟","places",["stadium"]),new Hu("🎡","places",["ferris_wheel"]),new Hu("🎢","places",["roller_coaster"]),new Hu("🎠","places",["carousel_horse"]),new Hu("⛱","places",["parasol_on_ground"]),new Hu("🏖","places",["beach_umbrella"]),new Hu("🏝","places",["desert_island"]),new Hu("⛰","places",["mountain"]),new Hu("🏔","places",["mountain_snow"]),new Hu("🗻","places",["mount_fuji"]),new Hu("🌋","places",["volcano"]),new Hu("🏜","places",["desert"]),new Hu("🏕","places",["camping"]),new Hu("⛺️","places",["tent"]),new Hu("🛤","places",["railway_track"]),new Hu("🛣","places",["motorway"]),new Hu("🏗","places",["building_construction"]),new Hu("🏭","places",["factory"]),new Hu("🏠","places",["house"]),new Hu("🏡","places",["house_with_garden"]),new Hu("🏘","places",["houses"]),new Hu("🏚","places",["derelict_house"]),new Hu("🏢","places",["office"]),new Hu("🏬","places",["department_store"]),new Hu("🏣","places",["post_office"]),new Hu("🏤","places",["european_post_office"]),new Hu("🏥","places",["hospital"]),new Hu("🏦","places",["bank"]),new Hu("🏨","places",["hotel"]),new Hu("🏪","places",["convenience_store"]),new Hu("🏫","places",["school"]),new Hu("🏩","places",["love_hotel"]),new Hu("💒","places",["wedding"]),new Hu("🏛","places",["classical_building"]),new Hu("⛪️","places",["church"]),new Hu("🕌","places",["mosque"]),new Hu("🕍","places",["synagogue"]),new Hu("🕋","places",["kaaba"]),new Hu("⛩","places",["shinto_shrine"]),new Hu("🗾","places",["japan"]),new Hu("🎑","places",["rice_scene"]),new Hu("🏞","places",["national_park"]),new Hu("🌅","places",["sunrise"]),new Hu("🌄","places",["sunrise_over_mountains"]),new Hu("🌠","places",["stars"]),new Hu("🎇","places",["sparkler"]),new Hu("🎆","places",["fireworks"]),new Hu("🌇","places",["city_sunrise"]),new Hu("🌆","places",["city_sunset"]),new Hu("🏙","places",["cityscape"]),new Hu("🌃","places",["night_with_stars"]),new Hu("🌌","places",["milky_way"]),new Hu("🌉","places",["bridge_at_night"]),new Hu("🌁","places",["foggy"]),new Hu("⌚️","objects",["watch"]),new Hu("📱","objects",["iphone"]),new Hu("📲","objects",["calling"]),new Hu("💻","objects",["computer"]),new Hu("⌨️","objects",["keyboard"]),new Hu("🖥","objects",["desktop_computer"]),new Hu("🖨","objects",["printer"]),new Hu("🖱","objects",["computer_mouse"]),new Hu("🖲","objects",["trackball"]),new Hu("🕹","objects",["joystick"]),new Hu("🗜","objects",["clamp"]),new Hu("💽","objects",["minidisc"]),new Hu("💾","objects",["floppy_disk"]),new Hu("💿","objects",["cd"]),new Hu("📀","objects",["dvd"]),new Hu("📼","objects",["vhs"]),new Hu("📷","objects",["camera"]),new Hu("📸","objects",["camera_flash"]),new Hu("📹","objects",["video_camera"]),new Hu("🎥","objects",["movie_camera"]),new Hu("📽","objects",["film_projector"]),new Hu("🎞","objects",["film_strip"]),new Hu("📞","objects",["telephone_receiver"]),new Hu("☎️","objects",["phone","telephone"]),new Hu("📟","objects",["pager"]),new Hu("📠","objects",["fax"]),new Hu("📺","objects",["tv"]),new Hu("📻","objects",["radio"]),new Hu("🎙","objects",["studio_microphone"]),new Hu("🎚","objects",["level_slider"]),new Hu("🎛","objects",["control_knobs"]),new Hu("⏱","objects",["stopwatch"]),new Hu("⏲","objects",["timer_clock"]),new Hu("⏰","objects",["alarm_clock"]),new Hu("🕰","objects",["mantelpiece_clock"]),new Hu("⌛️","objects",["hourglass"]),new Hu("⏳","objects",["hourglass_flowing_sand"]),new Hu("📡","objects",["satellite"]),new Hu("🔋","objects",["battery"]),new Hu("🔌","objects",["electric_plug"]),new Hu("💡","objects",["bulb"]),new Hu("🔦","objects",["flashlight"]),new Hu("🕯","objects",["candle"]),new Hu("🗑","objects",["wastebasket"]),new Hu("🛢","objects",["oil_drum"]),new Hu("💸","objects",["money_with_wings"]),new Hu("💵","objects",["dollar"]),new Hu("💴","objects",["yen"]),new Hu("💶","objects",["euro"]),new Hu("💷","objects",["pound"]),new Hu("💰","objects",["moneybag"]),new Hu("💳","objects",["credit_card"]),new Hu("💎","objects",["gem"]),new Hu("⚖️","objects",["balance_scale"]),new Hu("🔧","objects",["wrench"]),new Hu("🔨","objects",["hammer"]),new Hu("⚒","objects",["hammer_and_pick"]),new Hu("🛠","objects",["hammer_and_wrench"]),new Hu("⛏","objects",["pick"]),new Hu("🔩","objects",["nut_and_bolt"]),new Hu("⚙️","objects",["gear"]),new Hu("⛓","objects",["chains"]),new Hu("🔫","objects",["gun"]),new Hu("💣","objects",["bomb"]),new Hu("🔪","objects",["hocho","knife"]),new Hu("🗡","objects",["dagger"]),new Hu("⚔️","objects",["crossed_swords"]),new Hu("🛡","objects",["shield"]),new Hu("🚬","objects",["smoking"]),new Hu("⚰️","objects",["coffin"]),new Hu("⚱️","objects",["funeral_urn"]),new Hu("🏺","objects",["amphora"]),new Hu("🔮","objects",["crystal_ball"]),new Hu("📿","objects",["prayer_beads"]),new Hu("💈","objects",["barber"]),new Hu("⚗️","objects",["alembic"]),new Hu("🔭","objects",["telescope"]),new Hu("🔬","objects",["microscope"]),new Hu("🕳","objects",["hole"]),new Hu("💊","objects",["pill"]),new Hu("💉","objects",["syringe"]),new Hu("🌡","objects",["thermometer"]),new Hu("🚽","objects",["toilet"]),new Hu("🚰","objects",["potable_water"]),new Hu("🚿","objects",["shower"]),new Hu("🛁","objects",["bathtub"]),new Hu("🛀","objects",["bath"]),new Hu("🛎","objects",["bellhop_bell"]),new Hu("🔑","objects",["key"]),new Hu("🗝","objects",["old_key"]),new Hu("🚪","objects",["door"]),new Hu("🛋","objects",["couch_and_lamp"]),new Hu("🛏","objects",["bed"]),new Hu("🛌","objects",["sleeping_bed"]),new Hu("🖼","objects",["framed_picture"]),new Hu("🛍","objects",["shopping"]),new Hu("🛒","objects",["shopping_cart"]),new Hu("🎁","objects",["gift"]),new Hu("🎈","objects",["balloon"]),new Hu("🎏","objects",["flags"]),new Hu("🎀","objects",["ribbon"]),new Hu("🎊","objects",["confetti_ball"]),new Hu("🎉","objects",["tada"]),new Hu("🎎","objects",["dolls"]),new Hu("🏮","objects",["izakaya_lantern","lantern"]),new Hu("🎐","objects",["wind_chime"]),new Hu("✉️","objects",["email","envelope"]),new Hu("📩","objects",["envelope_with_arrow"]),new Hu("📨","objects",["incoming_envelope"]),new Hu("📧","objects",["e-mail"]),new Hu("💌","objects",["love_letter"]),new Hu("📥","objects",["inbox_tray"]),new Hu("📤","objects",["outbox_tray"]),new Hu("📦","objects",["package"]),new Hu("🏷","objects",["label"]),new Hu("📪","objects",["mailbox_closed"]),new Hu("📫","objects",["mailbox"]),new Hu("📬","objects",["mailbox_with_mail"]),new Hu("📭","objects",["mailbox_with_no_mail"]),new Hu("📮","objects",["postbox"]),new Hu("📯","objects",["postal_horn"]),new Hu("📜","objects",["scroll"]),new Hu("📃","objects",["page_with_curl"]),new Hu("📄","objects",["page_facing_up"]),new Hu("📑","objects",["bookmark_tabs"]),new Hu("📊","objects",["bar_chart"]),new Hu("📈","objects",["chart_with_upwards_trend"]),new Hu("📉","objects",["chart_with_downwards_trend"]),new Hu("🗒","objects",["spiral_notepad"]),new Hu("🗓","objects",["spiral_calendar"]),new Hu("📆","objects",["calendar"]),new Hu("📅","objects",["date"]),new Hu("📇","objects",["card_index"]),new Hu("🗃","objects",["card_file_box"]),new Hu("🗳","objects",["ballot_box"]),new Hu("🗄","objects",["file_cabinet"]),new Hu("📋","objects",["clipboard"]),new Hu("📁","objects",["file_folder"]),new Hu("📂","objects",["open_file_folder"]),new Hu("🗂","objects",["card_index_dividers"]),new Hu("🗞","objects",["newspaper_roll"]),new Hu("📰","objects",["newspaper"]),new Hu("📓","objects",["notebook"]),new Hu("📔","objects",["notebook_with_decorative_cover"]),new Hu("📒","objects",["ledger"]),new Hu("📕","objects",["closed_book"]),new Hu("📗","objects",["green_book"]),new Hu("📘","objects",["blue_book"]),new Hu("📙","objects",["orange_book"]),new Hu("📚","objects",["books"]),new Hu("📖","objects",["book","open_book"]),new Hu("🔖","objects",["bookmark"]),new Hu("🔗","objects",["link"]),new Hu("📎","objects",["paperclip"]),new Hu("🖇","objects",["paperclips"]),new Hu("📐","objects",["triangular_ruler"]),new Hu("📏","objects",["straight_ruler"]),new Hu("📌","objects",["pushpin"]),new Hu("📍","objects",["round_pushpin"]),new Hu("✂️","objects",["scissors"]),new Hu("🖊","objects",["pen"]),new Hu("🖋","objects",["fountain_pen"]),new Hu("✒️","objects",["black_nib"]),new Hu("🖌","objects",["paintbrush"]),new Hu("🖍","objects",["crayon"]),new Hu("📝","objects",["memo","pencil"]),new Hu("✏️","objects",["pencil2"]),new Hu("🔍","objects",["mag"]),new Hu("🔎","objects",["mag_right"]),new Hu("🔏","objects",["lock_with_ink_pen"]),new Hu("🔐","objects",["closed_lock_with_key"]),new Hu("🔒","objects",["lock"]),new Hu("🔓","objects",["unlock"]),new Hu("❤️","symbols",["heart"]),new Hu("💛","symbols",["yellow_heart"]),new Hu("💚","symbols",["green_heart"]),new Hu("💙","symbols",["blue_heart"]),new Hu("💜","symbols",["purple_heart"]),new Hu("🖤","symbols",["black_heart"]),new Hu("💔","symbols",["broken_heart"]),new Hu("❣️","symbols",["heavy_heart_exclamation"]),new Hu("💕","symbols",["two_hearts"]),new Hu("💞","symbols",["revolving_hearts"]),new Hu("💓","symbols",["heartbeat"]),new Hu("💗","symbols",["heartpulse"]),new Hu("💖","symbols",["sparkling_heart"]),new Hu("💘","symbols",["cupid"]),new Hu("💝","symbols",["gift_heart"]),new Hu("💟","symbols",["heart_decoration"]),new Hu("☮️","symbols",["peace_symbol"]),new Hu("✝️","symbols",["latin_cross"]),new Hu("☪️","symbols",["star_and_crescent"]),new Hu("🕉","symbols",["om"]),new Hu("☸️","symbols",["wheel_of_dharma"]),new Hu("✡️","symbols",["star_of_david"]),new Hu("🔯","symbols",["six_pointed_star"]),new Hu("🕎","symbols",["menorah"]),new Hu("☯️","symbols",["yin_yang"]),new Hu("☦️","symbols",["orthodox_cross"]),new Hu("🛐","symbols",["place_of_worship"]),new Hu("⛎","symbols",["ophiuchus"]),new Hu("♈️","symbols",["aries"]),new Hu("♉️","symbols",["taurus"]),new Hu("♊️","symbols",["gemini"]),new Hu("♋️","symbols",["cancer"]),new Hu("♌️","symbols",["leo"]),new Hu("♍️","symbols",["virgo"]),new Hu("♎️","symbols",["libra"]),new Hu("♏️","symbols",["scorpius"]),new Hu("♐️","symbols",["sagittarius"]),new Hu("♑️","symbols",["capricorn"]),new Hu("♒️","symbols",["aquarius"]),new Hu("♓️","symbols",["pisces"]),new Hu("🆔","symbols",["id"]),new Hu("⚛️","symbols",["atom_symbol"]),new Hu("🉑","symbols",["accept"]),new Hu("☢️","symbols",["radioactive"]),new Hu("☣️","symbols",["biohazard"]),new Hu("📴","symbols",["mobile_phone_off"]),new Hu("📳","symbols",["vibration_mode"]),new Hu("🈶","symbols",["u6709"]),new Hu("🈚️","symbols",["u7121"]),new Hu("🈸","symbols",["u7533"]),new Hu("🈺","symbols",["u55b6"]),new Hu("🈷️","symbols",["u6708"]),new Hu("✴️","symbols",["eight_pointed_black_star"]),new Hu("🆚","symbols",["vs"]),new Hu("💮","symbols",["white_flower"]),new Hu("🉐","symbols",["ideograph_advantage"]),new Hu("㊙️","symbols",["secret"]),new Hu("㊗️","symbols",["congratulations"]),new Hu("🈴","symbols",["u5408"]),new Hu("🈵","symbols",["u6e80"]),new Hu("🈹","symbols",["u5272"]),new Hu("🈲","symbols",["u7981"]),new Hu("🅰️","symbols",["a"]),new Hu("🅱️","symbols",["b"]),new Hu("🆎","symbols",["ab"]),new Hu("🆑","symbols",["cl"]),new Hu("🅾️","symbols",["o2"]),new Hu("🆘","symbols",["sos"]),new Hu("❌","symbols",["x"]),new Hu("⭕️","symbols",["o"]),new Hu("🛑","symbols",["stop_sign"]),new Hu("⛔️","symbols",["no_entry"]),new Hu("📛","symbols",["name_badge"]),new Hu("🚫","symbols",["no_entry_sign"]),new Hu("💯","symbols",["100"]),new Hu("💢","symbols",["anger"]),new Hu("♨️","symbols",["hotsprings"]),new Hu("🚷","symbols",["no_pedestrians"]),new Hu("🚯","symbols",["do_not_litter"]),new Hu("🚳","symbols",["no_bicycles"]),new Hu("🚱","symbols",["non-potable_water"]),new Hu("🔞","symbols",["underage"]),new Hu("📵","symbols",["no_mobile_phones"]),new Hu("🚭","symbols",["no_smoking"]),new Hu("❗️","symbols",["exclamation","heavy_exclamation_mark"]),new Hu("❕","symbols",["grey_exclamation"]),new Hu("❓","symbols",["question"]),new Hu("❔","symbols",["grey_question"]),new Hu("‼️","symbols",["bangbang"]),new Hu("⁉️","symbols",["interrobang"]),new Hu("🔅","symbols",["low_brightness"]),new Hu("🔆","symbols",["high_brightness"]),new Hu("〽️","symbols",["part_alternation_mark"]),new Hu("⚠️","symbols",["warning"]),new Hu("🚸","symbols",["children_crossing"]),new Hu("🔱","symbols",["trident"]),new Hu("⚜️","symbols",["fleur_de_lis"]),new Hu("🔰","symbols",["beginner"]),new Hu("♻️","symbols",["recycle"]),new Hu("✅","symbols",["white_check_mark"]),new Hu("🈯️","symbols",["u6307"]),new Hu("💹","symbols",["chart"]),new Hu("❇️","symbols",["sparkle"]),new Hu("✳️","symbols",["eight_spoked_asterisk"]),new Hu("❎","symbols",["negative_squared_cross_mark"]),new Hu("🌐","symbols",["globe_with_meridians"]),new Hu("💠","symbols",["diamond_shape_with_a_dot_inside"]),new Hu("Ⓜ️","symbols",["m"]),new Hu("🌀","symbols",["cyclone"]),new Hu("💤","symbols",["zzz"]),new Hu("🏧","symbols",["atm"]),new Hu("🚾","symbols",["wc"]),new Hu("♿️","symbols",["wheelchair"]),new Hu("🅿️","symbols",["parking"]),new Hu("🈳","symbols",["u7a7a"]),new Hu("🈂️","symbols",["sa"]),new Hu("🛂","symbols",["passport_control"]),new Hu("🛃","symbols",["customs"]),new Hu("🛄","symbols",["baggage_claim"]),new Hu("🛅","symbols",["left_luggage"]),new Hu("🚹","symbols",["mens"]),new Hu("🚺","symbols",["womens"]),new Hu("🚼","symbols",["baby_symbol"]),new Hu("🚻","symbols",["restroom"]),new Hu("🚮","symbols",["put_litter_in_its_place"]),new Hu("🎦","symbols",["cinema"]),new Hu("📶","symbols",["signal_strength"]),new Hu("🈁","symbols",["koko"]),new Hu("🔣","symbols",["symbols"]),new Hu("ℹ️","symbols",["information_source"]),new Hu("🔤","symbols",["abc"]),new Hu("🔡","symbols",["abcd"]),new Hu("🔠","symbols",["capital_abcd"]),new Hu("🆖","symbols",["ng"]),new Hu("🆗","symbols",["ok"]),new Hu("🆙","symbols",["up"]),new Hu("🆒","symbols",["cool"]),new Hu("🆕","symbols",["new"]),new Hu("🆓","symbols",["free"]),new Hu("0️⃣","symbols",["zero"]),new Hu("1️⃣","symbols",["one"]),new Hu("2️⃣","symbols",["two"]),new Hu("3️⃣","symbols",["three"]),new Hu("4️⃣","symbols",["four"]),new Hu("5️⃣","symbols",["five"]),new Hu("6️⃣","symbols",["six"]),new Hu("7️⃣","symbols",["seven"]),new Hu("8️⃣","symbols",["eight"]),new Hu("9️⃣","symbols",["nine"]),new Hu("🔟","symbols",["keycap_ten"]),new Hu("🔢","symbols",["1234"]),new Hu("#️⃣","symbols",["hash"]),new Hu("*️⃣","symbols",["asterisk"]),new Hu("▶️","symbols",["arrow_forward"]),new Hu("⏸","symbols",["pause_button"]),new Hu("⏯","symbols",["play_or_pause_button"]),new Hu("⏹","symbols",["stop_button"]),new Hu("⏺","symbols",["record_button"]),new Hu("⏭","symbols",["next_track_button"]),new Hu("⏮","symbols",["previous_track_button"]),new Hu("⏩","symbols",["fast_forward"]),new Hu("⏪","symbols",["rewind"]),new Hu("⏫","symbols",["arrow_double_up"]),new Hu("⏬","symbols",["arrow_double_down"]),new Hu("◀️","symbols",["arrow_backward"]),new Hu("🔼","symbols",["arrow_up_small"]),new Hu("🔽","symbols",["arrow_down_small"]),new Hu("➡️","symbols",["arrow_right"]),new Hu("⬅️","symbols",["arrow_left"]),new Hu("⬆️","symbols",["arrow_up"]),new Hu("⬇️","symbols",["arrow_down"]),new Hu("↗️","symbols",["arrow_upper_right"]),new Hu("↘️","symbols",["arrow_lower_right"]),new Hu("↙️","symbols",["arrow_lower_left"]),new Hu("↖️","symbols",["arrow_upper_left"]),new Hu("↕️","symbols",["arrow_up_down"]),new Hu("↔️","symbols",["left_right_arrow"]),new Hu("↪️","symbols",["arrow_right_hook"]),new Hu("↩️","symbols",["leftwards_arrow_with_hook"]),new Hu("⤴️","symbols",["arrow_heading_up"]),new Hu("⤵️","symbols",["arrow_heading_down"]),new Hu("🔀","symbols",["twisted_rightwards_arrows"]),new Hu("🔁","symbols",["repeat"]),new Hu("🔂","symbols",["repeat_one"]),new Hu("🔄","symbols",["arrows_counterclockwise"]),new Hu("🔃","symbols",["arrows_clockwise"]),new Hu("🎵","symbols",["musical_note"]),new Hu("🎶","symbols",["notes"]),new Hu("➕","symbols",["heavy_plus_sign"]),new Hu("➖","symbols",["heavy_minus_sign"]),new Hu("➗","symbols",["heavy_division_sign"]),new Hu("✖️","symbols",["heavy_multiplication_x"]),new Hu("💲","symbols",["heavy_dollar_sign"]),new Hu("💱","symbols",["currency_exchange"]),new Hu("™️","symbols",["tm"]),new Hu("©️","symbols",["copyright"]),new Hu("®️","symbols",["registered"]),new Hu("〰️","symbols",["wavy_dash"]),new Hu("➰","symbols",["curly_loop"]),new Hu("➿","symbols",["loop"]),new Hu("🔚","symbols",["end"]),new Hu("🔙","symbols",["back"]),new Hu("🔛","symbols",["on"]),new Hu("🔝","symbols",["top"]),new Hu("🔜","symbols",["soon"]),new Hu("✔️","symbols",["heavy_check_mark"]),new Hu("☑️","symbols",["ballot_box_with_check"]),new Hu("🔘","symbols",["radio_button"]),new Hu("⚪️","symbols",["white_circle"]),new Hu("⚫️","symbols",["black_circle"]),new Hu("🔴","symbols",["red_circle"]),new Hu("🔵","symbols",["large_blue_circle"]),new Hu("🔺","symbols",["small_red_triangle"]),new Hu("🔻","symbols",["small_red_triangle_down"]),new Hu("🔸","symbols",["small_orange_diamond"]),new Hu("🔹","symbols",["small_blue_diamond"]),new Hu("🔶","symbols",["large_orange_diamond"]),new Hu("🔷","symbols",["large_blue_diamond"]),new Hu("🔳","symbols",["white_square_button"]),new Hu("🔲","symbols",["black_square_button"]),new Hu("▪️","symbols",["black_small_square"]),new Hu("▫️","symbols",["white_small_square"]),new Hu("◾️","symbols",["black_medium_small_square"]),new Hu("◽️","symbols",["white_medium_small_square"]),new Hu("◼️","symbols",["black_medium_square"]),new Hu("◻️","symbols",["white_medium_square"]),new Hu("⬛️","symbols",["black_large_square"]),new Hu("⬜️","symbols",["white_large_square"]),new Hu("🔈","symbols",["speaker"]),new Hu("🔇","symbols",["mute"]),new Hu("🔉","symbols",["sound"]),new Hu("🔊","symbols",["loud_sound"]),new Hu("🔔","symbols",["bell"]),new Hu("🔕","symbols",["no_bell"]),new Hu("📣","symbols",["mega"]),new Hu("📢","symbols",["loudspeaker"]),new Hu("👁‍🗨","symbols",["eye_speech_bubble"]),new Hu("💬","symbols",["speech_balloon"]),new Hu("💭","symbols",["thought_balloon"]),new Hu("🗯","symbols",["right_anger_bubble"]),new Hu("♠️","symbols",["spades"]),new Hu("♣️","symbols",["clubs"]),new Hu("♥️","symbols",["hearts"]),new Hu("♦️","symbols",["diamonds"]),new Hu("🃏","symbols",["black_joker"]),new Hu("🎴","symbols",["flower_playing_cards"]),new Hu("🀄️","symbols",["mahjong"]),new Hu("🕐","symbols",["clock1"]),new Hu("🕑","symbols",["clock2"]),new Hu("🕒","symbols",["clock3"]),new Hu("🕓","symbols",["clock4"]),new Hu("🕔","symbols",["clock5"]),new Hu("🕕","symbols",["clock6"]),new Hu("🕖","symbols",["clock7"]),new Hu("🕗","symbols",["clock8"]),new Hu("🕘","symbols",["clock9"]),new Hu("🕙","symbols",["clock10"]),new Hu("🕚","symbols",["clock11"]),new Hu("🕛","symbols",["clock12"]),new Hu("🕜","symbols",["clock130"]),new Hu("🕝","symbols",["clock230"]),new Hu("🕞","symbols",["clock330"]),new Hu("🕟","symbols",["clock430"]),new Hu("🕠","symbols",["clock530"]),new Hu("🕡","symbols",["clock630"]),new Hu("🕢","symbols",["clock730"]),new Hu("🕣","symbols",["clock830"]),new Hu("🕤","symbols",["clock930"]),new Hu("🕥","symbols",["clock1030"]),new Hu("🕦","symbols",["clock1130"]),new Hu("🕧","symbols",["clock1230"]),new Hu("🏳️","flags",["white_flag"]),new Hu("🏴","flags",["black_flag"]),new Hu("🏁","flags",["checkered_flag"]),new Hu("🚩","flags",["triangular_flag_on_post"]),new Hu("🏳️‍🌈","flags",["rainbow_flag"]),new Hu("🇦🇫","flags",["afghanistan"]),new Hu("🇦🇽","flags",["aland_islands"]),new Hu("🇦🇱","flags",["albania"]),new Hu("🇩🇿","flags",["algeria"]),new Hu("🇦🇸","flags",["american_samoa"]),new Hu("🇦🇩","flags",["andorra"]),new Hu("🇦🇴","flags",["angola"]),new Hu("🇦🇮","flags",["anguilla"]),new Hu("🇦🇶","flags",["antarctica"]),new Hu("🇦🇬","flags",["antigua_barbuda"]),new Hu("🇦🇷","flags",["argentina"]),new Hu("🇦🇲","flags",["armenia"]),new Hu("🇦🇼","flags",["aruba"]),new Hu("🇦🇺","flags",["australia"]),new Hu("🇦🇹","flags",["austria"]),new Hu("🇦🇿","flags",["azerbaijan"]),new Hu("🇧🇸","flags",["bahamas"]),new Hu("🇧🇭","flags",["bahrain"]),new Hu("🇧🇩","flags",["bangladesh"]),new Hu("🇧🇧","flags",["barbados"]),new Hu("🇧🇾","flags",["belarus"]),new Hu("🇧🇪","flags",["belgium"]),new Hu("🇧🇿","flags",["belize"]),new Hu("🇧🇯","flags",["benin"]),new Hu("🇧🇲","flags",["bermuda"]),new Hu("🇧🇹","flags",["bhutan"]),new Hu("🇧🇴","flags",["bolivia"]),new Hu("🇧🇶","flags",["caribbean_netherlands"]),new Hu("🇧🇦","flags",["bosnia_herzegovina"]),new Hu("🇧🇼","flags",["botswana"]),new Hu("🇧🇷","flags",["brazil"]),new Hu("🇮🇴","flags",["british_indian_ocean_territory"]),new Hu("🇻🇬","flags",["british_virgin_islands"]),new Hu("🇧🇳","flags",["brunei"]),new Hu("🇧🇬","flags",["bulgaria"]),new Hu("🇧🇫","flags",["burkina_faso"]),new Hu("🇧🇮","flags",["burundi"]),new Hu("🇨🇻","flags",["cape_verde"]),new Hu("🇰🇭","flags",["cambodia"]),new Hu("🇨🇲","flags",["cameroon"]),new Hu("🇨🇦","flags",["canada"]),new Hu("🇮🇨","flags",["canary_islands"]),new Hu("🇰🇾","flags",["cayman_islands"]),new Hu("🇨🇫","flags",["central_african_republic"]),new Hu("🇹🇩","flags",["chad"]),new Hu("🇨🇱","flags",["chile"]),new Hu("🇨🇳","flags",["cn"]),new Hu("🇨🇽","flags",["christmas_island"]),new Hu("🇨🇨","flags",["cocos_islands"]),new Hu("🇨🇴","flags",["colombia"]),new Hu("🇰🇲","flags",["comoros"]),new Hu("🇨🇬","flags",["congo_brazzaville"]),new Hu("🇨🇩","flags",["congo_kinshasa"]),new Hu("🇨🇰","flags",["cook_islands"]),new Hu("🇨🇷","flags",["costa_rica"]),new Hu("🇨🇮","flags",["cote_divoire"]),new Hu("🇭🇷","flags",["croatia"]),new Hu("🇨🇺","flags",["cuba"]),new Hu("🇨🇼","flags",["curacao"]),new Hu("🇨🇾","flags",["cyprus"]),new Hu("🇨🇿","flags",["czech_republic"]),new Hu("🇩🇰","flags",["denmark"]),new Hu("🇩🇯","flags",["djibouti"]),new Hu("🇩🇲","flags",["dominica"]),new Hu("🇩🇴","flags",["dominican_republic"]),new Hu("🇪🇨","flags",["ecuador"]),new Hu("🇪🇬","flags",["egypt"]),new Hu("🇸🇻","flags",["el_salvador"]),new Hu("🇬🇶","flags",["equatorial_guinea"]),new Hu("🇪🇷","flags",["eritrea"]),new Hu("🇪🇪","flags",["estonia"]),new Hu("🇪🇹","flags",["ethiopia"]),new Hu("🇪🇺","flags",["eu","european_union"]),new Hu("🇫🇰","flags",["falkland_islands"]),new Hu("🇫🇴","flags",["faroe_islands"]),new Hu("🇫🇯","flags",["fiji"]),new Hu("🇫🇮","flags",["finland"]),new Hu("🇫🇷","flags",["fr"]),new Hu("🇬🇫","flags",["french_guiana"]),new Hu("🇵🇫","flags",["french_polynesia"]),new Hu("🇹🇫","flags",["french_southern_territories"]),new Hu("🇬🇦","flags",["gabon"]),new Hu("🇬🇲","flags",["gambia"]),new Hu("🇬🇪","flags",["georgia"]),new Hu("🇩🇪","flags",["de"]),new Hu("🇬🇭","flags",["ghana"]),new Hu("🇬🇮","flags",["gibraltar"]),new Hu("🇬🇷","flags",["greece"]),new Hu("🇬🇱","flags",["greenland"]),new Hu("🇬🇩","flags",["grenada"]),new Hu("🇬🇵","flags",["guadeloupe"]),new Hu("🇬🇺","flags",["guam"]),new Hu("🇬🇹","flags",["guatemala"]),new Hu("🇬🇬","flags",["guernsey"]),new Hu("🇬🇳","flags",["guinea"]),new Hu("🇬🇼","flags",["guinea_bissau"]),new Hu("🇬🇾","flags",["guyana"]),new Hu("🇭🇹","flags",["haiti"]),new Hu("🇭🇳","flags",["honduras"]),new Hu("🇭🇰","flags",["hong_kong"]),new Hu("🇭🇺","flags",["hungary"]),new Hu("🇮🇸","flags",["iceland"]),new Hu("🇮🇳","flags",["india"]),new Hu("🇮🇩","flags",["indonesia"]),new Hu("🇮🇷","flags",["iran"]),new Hu("🇮🇶","flags",["iraq"]),new Hu("🇮🇪","flags",["ireland"]),new Hu("🇮🇲","flags",["isle_of_man"]),new Hu("🇮🇱","flags",["israel"]),new Hu("🇮🇹","flags",["it"]),new Hu("🇯🇲","flags",["jamaica"]),new Hu("🇯🇵","flags",["jp"]),new Hu("🎌","flags",["crossed_flags"]),new Hu("🇯🇪","flags",["jersey"]),new Hu("🇯🇴","flags",["jordan"]),new Hu("🇰🇿","flags",["kazakhstan"]),new Hu("🇰🇪","flags",["kenya"]),new Hu("🇰🇮","flags",["kiribati"]),new Hu("🇽🇰","flags",["kosovo"]),new Hu("🇰🇼","flags",["kuwait"]),new Hu("🇰🇬","flags",["kyrgyzstan"]),new Hu("🇱🇦","flags",["laos"]),new Hu("🇱🇻","flags",["latvia"]),new Hu("🇱🇧","flags",["lebanon"]),new Hu("🇱🇸","flags",["lesotho"]),new Hu("🇱🇷","flags",["liberia"]),new Hu("🇱🇾","flags",["libya"]),new Hu("🇱🇮","flags",["liechtenstein"]),new Hu("🇱🇹","flags",["lithuania"]),new Hu("🇱🇺","flags",["luxembourg"]),new Hu("🇲🇴","flags",["macau"]),new Hu("🇲🇰","flags",["macedonia"]),new Hu("🇲🇬","flags",["madagascar"]),new Hu("🇲🇼","flags",["malawi"]),new Hu("🇲🇾","flags",["malaysia"]),new Hu("🇲🇻","flags",["maldives"]),new Hu("🇲🇱","flags",["mali"]),new Hu("🇲🇹","flags",["malta"]),new Hu("🇲🇭","flags",["marshall_islands"]),new Hu("🇲🇶","flags",["martinique"]),new Hu("🇲🇷","flags",["mauritania"]),new Hu("🇲🇺","flags",["mauritius"]),new Hu("🇾🇹","flags",["mayotte"]),new Hu("🇲🇽","flags",["mexico"]),new Hu("🇫🇲","flags",["micronesia"]),new Hu("🇲🇩","flags",["moldova"]),new Hu("🇲🇨","flags",["monaco"]),new Hu("🇲🇳","flags",["mongolia"]),new Hu("🇲🇪","flags",["montenegro"]),new Hu("🇲🇸","flags",["montserrat"]),new Hu("🇲🇦","flags",["morocco"]),new Hu("🇲🇿","flags",["mozambique"]),new Hu("🇲🇲","flags",["myanmar"]),new Hu("🇳🇦","flags",["namibia"]),new Hu("🇳🇷","flags",["nauru"]),new Hu("🇳🇵","flags",["nepal"]),new Hu("🇳🇱","flags",["netherlands"]),new Hu("🇳🇨","flags",["new_caledonia"]),new Hu("🇳🇿","flags",["new_zealand"]),new Hu("🇳🇮","flags",["nicaragua"]),new Hu("🇳🇪","flags",["niger"]),new Hu("🇳🇬","flags",["nigeria"]),new Hu("🇳🇺","flags",["niue"]),new Hu("🇳🇫","flags",["norfolk_island"]),new Hu("🇲🇵","flags",["northern_mariana_islands"]),new Hu("🇰🇵","flags",["north_korea"]),new Hu("🇳🇴","flags",["norway"]),new Hu("🇴🇲","flags",["oman"]),new Hu("🇵🇰","flags",["pakistan"]),new Hu("🇵🇼","flags",["palau"]),new Hu("🇵🇸","flags",["palestinian_territories"]),new Hu("🇵🇦","flags",["panama"]),new Hu("🇵🇬","flags",["papua_new_guinea"]),new Hu("🇵🇾","flags",["paraguay"]),new Hu("🇵🇪","flags",["peru"]),new Hu("🇵🇭","flags",["philippines"]),new Hu("🇵🇳","flags",["pitcairn_islands"]),new Hu("🇵🇱","flags",["poland"]),new Hu("🇵🇹","flags",["portugal"]),new Hu("🇵🇷","flags",["puerto_rico"]),new Hu("🇶🇦","flags",["qatar"]),new Hu("🇷🇪","flags",["reunion"]),new Hu("🇷🇴","flags",["romania"]),new Hu("🇷🇺","flags",["ru"]),new Hu("🇷🇼","flags",["rwanda"]),new Hu("🇧🇱","flags",["st_barthelemy"]),new Hu("🇸🇭","flags",["st_helena"]),new Hu("🇰🇳","flags",["st_kitts_nevis"]),new Hu("🇱🇨","flags",["st_lucia"]),new Hu("🇵🇲","flags",["st_pierre_miquelon"]),new Hu("🇻🇨","flags",["st_vincent_grenadines"]),new Hu("🇼🇸","flags",["samoa"]),new Hu("🇸🇲","flags",["san_marino"]),new Hu("🇸🇹","flags",["sao_tome_principe"]),new Hu("🇸🇦","flags",["saudi_arabia"]),new Hu("🇸🇳","flags",["senegal"]),new Hu("🇷🇸","flags",["serbia"]),new Hu("🇸🇨","flags",["seychelles"]),new Hu("🇸🇱","flags",["sierra_leone"]),new Hu("🇸🇬","flags",["singapore"]),new Hu("🇸🇽","flags",["sint_maarten"]),new Hu("🇸🇰","flags",["slovakia"]),new Hu("🇸🇮","flags",["slovenia"]),new Hu("🇸🇧","flags",["solomon_islands"]),new Hu("🇸🇴","flags",["somalia"]),new Hu("🇿🇦","flags",["south_africa"]),new Hu("🇬🇸","flags",["south_georgia_south_sandwich_islands"]),new Hu("🇰🇷","flags",["kr"]),new Hu("🇸🇸","flags",["south_sudan"]),new Hu("🇪🇸","flags",["es"]),new Hu("🇱🇰","flags",["sri_lanka"]),new Hu("🇸🇩","flags",["sudan"]),new Hu("🇸🇷","flags",["suriname"]),new Hu("🇸🇿","flags",["swaziland"]),new Hu("🇸🇪","flags",["sweden"]),new Hu("🇨🇭","flags",["switzerland"]),new Hu("🇸🇾","flags",["syria"]),new Hu("🇹🇼","flags",["taiwan"]),new Hu("🇹🇯","flags",["tajikistan"]),new Hu("🇹🇿","flags",["tanzania"]),new Hu("🇹🇭","flags",["thailand"]),new Hu("🇹🇱","flags",["timor_leste"]),new Hu("🇹🇬","flags",["togo"]),new Hu("🇹🇰","flags",["tokelau"]),new Hu("🇹🇴","flags",["tonga"]),new Hu("🇹🇹","flags",["trinidad_tobago"]),new Hu("🇹🇳","flags",["tunisia"]),new Hu("🇹🇷","flags",["tr"]),new Hu("🇹🇲","flags",["turkmenistan"]),new Hu("🇹🇨","flags",["turks_caicos_islands"]),new Hu("🇹🇻","flags",["tuvalu"]),new Hu("🇺🇬","flags",["uganda"]),new Hu("🇺🇦","flags",["ukraine"]),new Hu("🇦🇪","flags",["united_arab_emirates"]),new Hu("🇬🇧","flags",["gb","uk"]),new Hu("🇺🇸","flags",["us"]),new Hu("🇻🇮","flags",["us_virgin_islands"]),new Hu("🇺🇾","flags",["uruguay"]),new Hu("🇺🇿","flags",["uzbekistan"]),new Hu("🇻🇺","flags",["vanuatu"]),new Hu("🇻🇦","flags",["vatican_city"]),new Hu("🇻🇪","flags",["venezuela"]),new Hu("🇻🇳","flags",["vietnam"]),new Hu("🇼🇫","flags",["wallis_futuna"]),new Hu("🇪🇭","flags",["western_sahara"]),new Hu("🇾🇪","flags",["yemen"]),new Hu("🇿🇲","flags",["zambia"]),new Hu("🇿🇼","flags",["zimbabwe"])],qu='\n    <svg width="1em" height="1em"\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 303.6 303.6">\n      <path d="M291.503 11.6c-10.4-10.4-37.2-11.6-48.4-11.6-50.4 0-122.4 18.4-173.6 69.6-77.2 76.8-78.4 201.6-58.4 222 10.8 10.4 35.6 12 49.2 12 49.6 0 121.2-18.4 173.2-70 76.4-76.4 80.4-199.6 58-222zm-231.2 277.2c-24.4 0-36-4.8-38.8-7.6-5.2-5.2-8.4-24.4-6.8-49.6l57.2 56.8c-4 .4-8 .4-11.6.4zm162.8-66c-38.8 38.8-90.4 57.2-132.4 63.6l-74-73.6c6-42 24-94 63.2-133.2 38-38 88-56.4 130.8-62.8l75.6 75.6c-6 40.8-24.4 91.6-63.2 130.4zm65.2-148.8l-58.8-59.2c4.8-.4 9.2-.4 13.6-.4 24.4 0 35.6 4.8 38 7.2 5.6 5.6 9.2 25.6 7.2 52.4z"/>\n      <path d="M215.103 139.6l-20.8-20.8 13.2-13.2c2.8-2.8 2.8-7.6 0-10.4s-7.6-2.8-10.4 0l-13.2 13.6-20.8-20.8c-2.8-2.8-7.6-2.8-10.4 0-2.8 2.8-2.8 7.6 0 10.4l20.8 20.8-22 22-20.8-20.8c-2.8-2.8-7.6-2.8-10.4 0s-2.8 7.6 0 10.4l20.8 20.8-22 22-20.8-20.8c-2.8-2.8-7.6-2.8-10.4 0s-2.8 7.6 0 10.4l20.8 20.8-13.2 13.2c-2.8 2.8-2.8 7.6 0 10.4 1.6 1.6 3.2 2 5.2 2s3.6-.8 5.2-2l13.2-13.2 20.8 20.8c1.6 1.6 3.2 2 5.2 2s3.6-.8 5.2-2c2.8-2.8 2.8-7.6 0-10.4l-20.8-21.2 22-22 20.8 20.8c1.6 1.6 3.2 2 5.2 2s3.6-.8 5.2-2c2.8-2.8 2.8-7.6 0-10.4l-20.8-20.8 22-22 20.8 20.8c1.6 1.6 3.2 2 5.2 2s3.6-.8 5.2-2c2.8-2.8 2.8-7.6 0-10.4zM169.103 47.6c-1.2-4-5.2-6-9.2-4.8-3.2 1.2-80.8 25.6-110.4 98-1.6 4 0 8.4 4 9.6.8.4 2 .4 2.8.4 2.8 0 5.6-1.6 6.8-4.4 27.2-66 100.4-89.6 101.2-89.6 4-1.2 6-5.2 4.8-9.2z"/>\n    </svg>\n    ',Gu='\n    <svg width="1em" height="1em"\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n      <path d="M472.928 34.72c-4.384-2.944-9.984-3.52-14.912-1.568-1.088.448-106.528 42.176-195.168.384C186.752-2.4 102.944 14.4 64 25.76V16c0-8.832-7.168-16-16-16S32 7.168 32 16v480c0 8.832 7.168 16 16 16s16-7.168 16-16V315.296c28.352-9.248 112.384-31.232 185.184 3.168 34.592 16.352 70.784 21.792 103.648 21.792 63.2 0 114.016-20.128 117.184-21.408 6.016-2.464 9.984-8.32 9.984-14.848V48c0-5.312-2.656-10.272-7.072-13.28zM448 292.672c-28.512 9.248-112.512 31.136-185.184-3.168C186.752 253.6 102.944 270.4 64 281.76V59.328c28.352-9.248 112.384-31.232 185.184 3.168 76 35.872 159.872 19.104 198.816 7.712v222.464z"/>\n    </svg>\n    ',Ju='\n    <svg width="1em" height="1em"\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.999 511.999">\n      <path d="M413.949 155.583a10.153 10.153 0 0 0-3.24-2.16c-.61-.25-1.24-.44-1.87-.57-3.25-.66-6.701.41-9.03 2.73a10.093 10.093 0 0 0-2.93 7.07 10.098 10.098 0 0 0 1.69 5.56c.36.54.779 1.05 1.24 1.52 1.86 1.86 4.44 2.93 7.07 2.93.65 0 1.31-.07 1.96-.2.63-.13 1.26-.32 1.87-.57a10.146 10.146 0 0 0 3.24-2.16c.47-.47.88-.98 1.25-1.52a10.098 10.098 0 0 0 1.49-3.6 10.038 10.038 0 0 0-2.74-9.03zM115.289 385.873c-.12-.64-.32-1.27-.57-1.87-.25-.6-.55-1.18-.91-1.73-.37-.54-.79-1.06-1.25-1.52a9.57 9.57 0 0 0-1.52-1.24c-.54-.36-1.12-.67-1.72-.92-.61-.25-1.24-.44-1.88-.57a9.847 9.847 0 0 0-3.9 0c-.64.13-1.27.32-1.87.57-.61.25-1.19.56-1.73.92-.55.36-1.06.78-1.52 1.24-.46.46-.88.98-1.24 1.52-.36.55-.67 1.13-.92 1.73-.25.6-.45 1.23-.57 1.87-.13.651-.2 1.3-.2 1.96 0 .65.07 1.3.2 1.95.12.64.32 1.27.57 1.87.25.6.56 1.18.92 1.73.36.54.78 1.06 1.24 1.52.46.46.97.88 1.52 1.24.54.36 1.12.67 1.73.92.6.25 1.23.44 1.87.57s1.3.2 1.95.2c.65 0 1.31-.07 1.95-.2.64-.13 1.27-.32 1.88-.57.6-.25 1.18-.56 1.72-.92.55-.36 1.059-.78 1.52-1.24.46-.46.88-.98 1.25-1.52.36-.55.66-1.13.91-1.73.25-.6.45-1.23.57-1.87.13-.65.2-1.3.2-1.95 0-.66-.07-1.31-.2-1.96z"/>\n      <path d="M511.999 222.726c0-14.215-9.228-26.315-22.007-30.624-1.628-74.155-62.456-133.978-136.994-133.978H159.002c-74.538 0-135.366 59.823-136.994 133.978C9.228 196.411 0 208.51 0 222.726a32.076 32.076 0 0 0 3.847 15.203 44.931 44.931 0 0 0-.795 8.427v.708c0 14.06 6.519 26.625 16.693 34.833-10.178 8.275-16.693 20.891-16.693 35.001 0 15.114 7.475 28.515 18.921 36.702v26.668c0 40.588 33.021 73.608 73.608 73.608h320.836c40.588 0 73.608-33.021 73.608-73.608V353.6c11.446-8.186 18.921-21.587 18.921-36.702 0-13.852-6.354-26.385-16.361-34.702 9.983-8.212 16.361-20.656 16.361-34.562v-.708c0-2.985-.294-5.944-.877-8.845a32.082 32.082 0 0 0 3.93-15.355zM44.033 173.229h322.441c5.523 0 10-4.477 10-10s-4.477-10-10-10H49.737c16.896-43.883 59.503-75.106 109.265-75.106h193.996c62.942 0 114.438 49.953 116.934 112.295H42.068c.234-5.848.9-11.588 1.965-17.189zM23.052 316.896c0-13.837 11.257-25.094 25.094-25.094h117.298l55.346 50.188H48.146c-13.837 0-25.094-11.256-25.094-25.094zm.976-62.945c.422.111.847.215 1.275.309 7.421 1.634 14.68 8.002 22.365 14.744a576.29 576.29 0 0 0 3.206 2.799h-3.081c-11.253-.001-20.774-7.551-23.765-17.852zm308.727 89.752l57.233-51.899 49.904.57-81.871 74.24-25.266-22.911zm7.861 34.126H295.12l17.467-15.839h10.563l17.466 15.839zm19.599-86.027l-82.499 74.811-82.499-74.811h164.998zm-59.529-20c.849-.842 1.677-1.675 2.49-2.493 9.531-9.587 17.059-17.16 32.89-17.16 15.832 0 23.359 7.573 32.89 17.162.812.817 1.64 1.65 2.489 2.491h-70.759zm-160.13 0a485.82 485.82 0 0 0 2.489-2.492c9.531-9.588 17.059-17.161 32.89-17.161 15.83 0 23.358 7.573 32.888 17.16.813.818 1.641 1.651 2.49 2.493h-70.757zm275.862 162.073H95.582c-29.56 0-53.608-24.049-53.608-53.608v-18.275h200.872l17.467 15.839H145.897c-5.523 0-10 4.477-10 10s4.477 10 10 10H467.07c-7.288 20.958-27.242 36.044-50.652 36.044zm53.608-56.046h-94.6l17.467-15.839h77.133v15.839zm-6.174-35.837h-48.906l54.624-49.533c11.135 2.604 19.376 12.665 19.376 24.439 0 13.836-11.257 25.094-25.094 25.094zm-2.728-70.19l.262-.227.101-.087.342-.298c.848-.738 1.682-1.469 2.501-2.187 4.105-3.601 8.089-7.095 12.04-9.819 3.446-2.375 6.868-4.164 10.326-4.925l.359-.081.04-.01.317-.076.065-.016a22.897 22.897 0 0 0 .42-.107l.196-.052a.374.374 0 0 0 .048-.012c-2.433 9.276-10.129 16.443-19.691 18.102a9.984 9.984 0 0 0-2.016-.205h-5.31zm21.271-37.073a40.746 40.746 0 0 0-4.536 1.281c-10.109 3.489-18.327 10.602-26.283 17.58l-.434.381c-9.178 8.052-17.923 15.723-29.033 17.834h-13.146c-11.249-1.93-17.833-8.552-25.823-16.591-10.213-10.275-22.923-23.062-47.074-23.062-24.15 0-36.86 12.786-47.074 23.06-7.992 8.04-14.576 14.663-25.829 16.593h-14.327c-11.253-1.93-17.837-8.553-25.829-16.593-10.213-10.274-22.923-23.06-47.072-23.06-24.151 0-36.861 12.787-47.074 23.062-7.991 8.039-14.574 14.661-25.824 16.591h-7.065c-14.134 0-24.325-8.939-35.113-18.404-9.248-8.112-18.81-16.501-31.252-19.241a12.237 12.237 0 0 1-7.025-4.453 10.027 10.027 0 0 0-1.153-1.252 12.234 12.234 0 0 1-1.428-5.727c-.001-6.788 5.52-12.309 12.307-12.309h447.384c6.787 0 12.308 5.521 12.308 12.308 0 5.729-4.039 10.776-9.605 12.002z"/>\n    </svg>\n    ',Wu='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 219.15 219.15" width="1em" height="1em">\n      <path d="M109.575 0C49.156 0 .001 49.155.001 109.574c0 60.42 49.154 109.576 109.573 109.576 60.42 0 109.574-49.156 109.574-109.576C219.149 49.155 169.995 0 109.575 0zm0 204.15c-52.148 0-94.573-42.427-94.573-94.576C15.001 57.426 57.427 15 109.575 15c52.148 0 94.574 42.426 94.574 94.574 0 52.15-42.426 94.576-94.574 94.576z"/>\n      <path d="M166.112 108.111h-52.051V51.249a7.5 7.5 0 0 0-15 0v64.362a7.5 7.5 0 0 0 7.5 7.5h59.551a7.5 7.5 0 0 0 0-15z"/>\n    </svg>\n    ',Yu='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1em" height="1em">\n      <path d="M490.815 3.784C480.082 5.7 227.049 51.632 148.477 130.203c-39.153 39.153-64.259 87.884-70.694 137.218-5.881 45.081 4.347 85.929 28.878 116.708L.001 490.789 21.212 512l106.657-106.657c33.094 26.378 75.092 34.302 116.711 28.874 49.334-6.435 98.065-31.541 137.218-70.695C460.368 284.951 506.3 31.918 508.216 21.185L511.999 0l-21.184 3.784zm-43.303 39.493L309.407 181.383l-7.544-98.076c46.386-15.873 97.819-29.415 145.649-40.03zm-174.919 50.64l8.877 115.402-78.119 78.119-11.816-153.606c19.947-13.468 47.183-26.875 81.058-39.915zm-109.281 64.119l12.103 157.338-47.36 47.36c-39.246-52.892-24.821-139.885 35.257-204.698zm57.113 247.849c-26.548-.001-51.267-7.176-71.161-21.938l47.363-47.363 157.32 12.102c-40.432 37.475-89.488 57.201-133.522 57.199zm157.743-85.421l-153.605-11.816 78.118-78.118 115.403 8.877c-13.04 33.876-26.448 61.111-39.916 81.057zm50.526-110.326l-98.076-7.544L468.725 64.485c-10.589 47.717-24.147 99.232-40.031 145.653z"/>\n    </svg>\n    ',Zu='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 792 792">\n      <path d="M425.512 741.214H365.58c-14.183 0-25.164 11.439-25.164 25.622S351.397 792 365.58 792h59.932c15.101 0 26.54-10.981 26.54-25.164s-11.44-25.622-26.54-25.622zM472.638 671.209H319.821c-14.183 0-26.081 10.98-26.081 25.163s11.898 25.164 26.081 25.164h152.817c14.183 0 25.164-10.981 25.164-25.164s-10.982-25.163-25.164-25.163zM639.188 138.634c-25.164-42.548-59.181-76.135-102.49-101.113C493.526 12.621 446.566 0 395.771 0 320.28 0 247.19 31.684 197.205 81.445c-49.761 49.527-81.904 121.24-81.904 196.282 0 33.861 7.779 68.629 22.879 103.866 15.1 35.228 38.565 78.614 70.005 130.396 7.448 12.269 15.764 31.205 25.623 56.271 12.104 30.757 22.87 51.713 31.566 63.602 5.027 6.872 11.899 10.063 20.596 10.063h228.766c9.605 0 16.359-4.188 21.504-11.898 6.754-10.132 13.987-27.516 22.42-51.693 8.951-25.691 16.838-43.982 23.329-55.364 30.571-53.587 54.446-99.747 70.464-137.717 16.018-37.979 24.246-74.124 24.246-107.526 0-49.878-12.347-96.545-37.511-139.093zm-35.696 232.437c-15.012 34.348-36.398 76.974-65.427 126.736-9.41 16.125-18.458 37.003-26.989 63.592-3.367 10.474-7.32 20.596-11.439 30.2H300.153c-6.862-11.439-12.26-25.837-18.761-42.089-12.718-31.801-23.338-52.621-30.2-64.061-28.824-48.043-49.868-87.39-64.051-118.957s-20.537-60.859-21.044-88.766c-2.235-121.718 106.13-228.991 229.674-226.941 41.631.693 80.527 10.063 115.765 30.659 35.227 20.586 63.134 48.043 83.729 82.812 20.586 34.768 31.108 72.748 31.108 113.47-.001 27.449-7.692 58.596-22.881 93.345z"/>\n    </svg>\n    ',Ku='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 106.059 106.059">\n      <path d="M90.544 90.542c20.687-20.684 20.685-54.341.002-75.024-20.688-20.689-54.347-20.689-75.031-.006-20.688 20.687-20.686 54.346.002 75.034 20.682 20.684 54.341 20.684 75.027-.004zM21.302 21.3c17.494-17.493 45.959-17.495 63.457.002 17.494 17.494 17.492 45.963-.002 63.455-17.494 17.494-45.96 17.496-63.455.003-17.498-17.498-17.496-45.966 0-63.46zM27 69.865s-2.958-11.438 6.705-8.874c0 0 17.144 9.295 38.651 0 9.662-2.563 6.705 8.874 6.705 8.874C73.539 86.824 53.03 85.444 53.03 85.444S32.521 86.824 27 69.865zm6.24-31.194a6.202 6.202 0 1 1 12.399.001 6.202 6.202 0 0 1-12.399-.001zm28.117 0a6.202 6.202 0 1 1 12.403.001 6.202 6.202 0 0 1-12.403-.001z"/>\n    </svg>\n    ',Xu='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 611.999 611.998">\n      <path d="M596.583 15.454C586.226 5.224 573.354.523 558.423.523c-15.597 0-31.901 4.906-49.452 14.599-17.296 9.551-32.851 20.574-46.458 32.524h-.665c-2.655 2.322-10.953 10.287-25.219 24.553-14.272 14.272-26.217 26.223-35.845 36.51L112.401 26.406c-6.896-1.968-12.928.014-17.593 4.645L46.687 78.839c-4.326 4.297-5.805 9.268-4.977 15.597.829 6.287 3.979 10.627 9.629 13.607L280.32 228.839 161.514 347.978l-95.91 3.32c-4.645.164-8.637 1.643-12.276 5.311L5.872 404.397c-4.312 4.34-6.641 9.289-5.643 16.262 1.657 6.967 5.31 11.611 11.618 13.602l117.142 48.787 48.787 117.148c2.421 5.812 6.634 9.621 13.607 11.279h3.313c4.977 0 9.296-1.658 12.942-5.311l47.456-47.457c3.653-3.645 5.494-7.965 5.643-12.275l3.32-95.91 118.807-118.807 121.128 228.99c2.988 5.643 7.32 8.793 13.607 9.621 6.329.836 11.271-1.316 15.597-5.643l47.456-47.457c4.978-4.977 6.945-10.697 4.978-17.586l-82.296-288.389 59.732-59.739c10.287-10.287 21.699-24.149 33.183-45.134 5.777-10.542 10.032-20.886 12.942-31.194 5.722-20.218 3.258-44.07-12.608-59.73zm-59.4 110.176l-67.039 67.372c-5.628 5.657-6.811 11.122-4.977 17.586l81.637 288.388-22.563 22.238L403.438 292.89c-2.98-5.643-7.299-8.963-12.941-9.621-6.301-1.331-11.611.325-16.263 4.977l-141.37 141.37c-2.987 2.986-4.644 6.973-5.643 11.949l-3.32 95.904-22.896 23.236-41.48-98.566c-1.331-4.645-4.553-8.184-9.629-10.287L51.338 411.03l23.229-22.895 95.578-3.654c5.643-.99 9.622-2.654 12.276-5.309l141.37-141.371c4.651-4.645 6.308-9.954 4.984-16.262-.666-5.643-3.986-9.954-9.629-12.942L90.829 87.47l22.231-22.238 288.389 81.637c6.464 1.833 11.951.666 17.587-4.977l28.545-28.539 26.217-25.884 11.278-11.285 1.331-.666c27.873-23.895 55.088-38.16 72.016-38.16 5.969 0 9.954 1.324 11.611 3.979 18.917 18.585-21.099 72.484-32.851 84.293z"/>\n    </svg>\n    ',$u='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 511.626 511.626">\n      <path d="M475.366 71.949c-24.175-23.606-57.575-35.404-100.215-35.404-11.8 0-23.843 2.046-36.117 6.136-12.279 4.093-23.702 9.615-34.256 16.562-10.568 6.945-19.65 13.467-27.269 19.556a263.828 263.828 0 0 0-21.696 19.414 264.184 264.184 0 0 0-21.698-19.414c-7.616-6.089-16.702-12.607-27.268-19.556-10.564-6.95-21.985-12.468-34.261-16.562-12.275-4.089-24.316-6.136-36.116-6.136-42.637 0-76.039 11.801-100.211 35.404C12.087 95.55 0 128.286 0 170.16c0 12.753 2.24 25.891 6.711 39.398 4.471 13.514 9.566 25.031 15.275 34.546 5.708 9.514 12.181 18.792 19.414 27.834 7.233 9.041 12.519 15.272 15.846 18.698 3.33 3.426 5.948 5.903 7.851 7.427L243.25 469.938c3.427 3.426 7.614 5.144 12.562 5.144s9.138-1.718 12.563-5.144l177.87-171.31c43.588-43.58 65.38-86.406 65.38-128.472.001-41.877-12.085-74.61-36.259-98.207zm-53.961 199.846L255.813 431.391 89.938 271.507C54.344 235.922 36.55 202.133 36.55 170.156c0-15.415 2.046-29.026 6.136-40.824 4.093-11.8 9.327-21.177 15.703-28.124 6.377-6.949 14.132-12.607 23.268-16.988 9.141-4.377 18.086-7.328 26.84-8.85 8.754-1.52 18.079-2.281 27.978-2.281 9.896 0 20.557 2.424 31.977 7.279 11.418 4.853 21.934 10.944 31.545 18.271 9.613 7.332 17.845 14.183 24.7 20.557 6.851 6.38 12.559 12.229 17.128 17.559 3.424 4.189 8.091 6.283 13.989 6.283 5.9 0 10.562-2.094 13.99-6.283 4.568-5.33 10.28-11.182 17.131-17.559 6.852-6.374 15.085-13.222 24.694-20.557 9.613-7.327 20.129-13.418 31.553-18.271 11.416-4.854 22.08-7.279 31.977-7.279s19.219.761 27.977 2.281c8.757 1.521 17.702 4.473 26.84 8.85 9.137 4.38 16.892 10.042 23.267 16.988 6.376 6.947 11.612 16.324 15.705 28.124 4.086 11.798 6.132 25.409 6.132 40.824-.002 31.977-17.89 65.86-53.675 101.639z"/>\n    </svg>\n    ',Qu=c({name:"IBizCategories",props:{categories:{type:Array,required:!0,default:function(){return[]}},current:{type:String,required:!0}},emits:["select"],setup:function(e,t){var n=t.emit;return{ns:ne("emoji-categories"),onSelect:function(e){n("select",e)}}},render:function(){var e=this;return L("div",{class:this.ns.b()},[this.categories.map((function(t){return L("div",{class:[e.ns.e("category"),e.ns.is("active",t.name===e.current)],onClick:function(){return e.onSelect(t)}},[L("span",{class:e.ns.em("category","svg"),title:t.label,innerHTML:t.icon},null)])}))])}}),ec=c({name:"IBizCategoryLabel",props:{name:{type:String,default:""}},emits:["select"],setup:function(){return{ns:ne("emoji-category-label")}},render:function(){return L("div",{class:this.ns.b()},[this.name])}}),tc=c({name:"IBizEmojiItem",props:{emoji:{type:Object,required:!0,default:function(){}},size:{type:Number,required:!0},withBorder:{type:Boolean,required:!0}},emits:["click"],setup:function(e,t){var n=t.emit;return{ns:ne("emoji-item"),styleSize:D((function(){return{fontSize:"".concat(e.size-5,"px"),lineHeight:"".concat(e.size,"px"),height:"".concat(e.size,"px"),width:"".concat(e.size,"px")}})),onClick:function(){n("click",e.emoji)}}},render:function(){return L("span",{class:[this.ns.b(),this.ns.is("border",this.withBorder)],style:this.styleSize,onClick:this.onClick,innerHTML:this.emoji.data},null)}}),nc=function(e,t){return t.aliases.some((function(t){return function(t){return t.toLowerCase().includes(e)}(t)}))},ic=c({name:"IBizEmojiList",props:{data:{type:Object,required:!0},emojisByRow:{type:Number,required:!0},emojiWithBorder:{type:Boolean},emojiSize:{type:Number},filter:{type:String,default:""},continuousList:{type:Boolean},category:{type:String,default:""},categories:{type:Object,required:!0,default:function(){}},hasSearch:{type:Boolean}},emits:["select","data"],setup:function(e,t){var n=t.emit,i=ne("emoji-list"),r=f({}),o=f({}),a=D((function(){var t=e.data[e.category],n=e.filter.trim().toLowerCase();return n&&(t=t.filter((function(e){return nc(n,e)}))),t})),s=D((function(){return Object.keys(e.data)})),l=D((function(){var t=100/e.emojisByRow;return{gridTemplateColumns:"repeat(".concat(e.emojisByRow,", ").concat(t,"%)")}})),u=D((function(){var t={};Object.assign(t,e.data);var n=e.filter.trim().toLowerCase();return n&&s.value.forEach((function(i){t[i]=e.data[i].filter((function(e){return nc(n,e)}))})),t})),c=function(e){n("select",e)};C((function(){return e.data}),(function(){r.value.$el.scrollTop=0})),C((function(){return e.category}),(function(t){if(e.continuousList){var n=o.value[t].$el;r.value.scrollTop=n.offsetTop-(e.hasSearch?88:44)}}));return{ns:i,emojisRef:r,gridDynamic:l,dataFiltered:a,dataFilteredByCategory:u,onSelect:c,setCategoryRef:function(e,t){t&&(o.value[e]=t)},renderGridEmojis:function(e){var t=e.emojis,n=e.style,r=e.size,o=e.withBorder;return t&&t.length>0?L("div",{class:[i.m("grid-emojis")],style:n},[t.map((function(e){return L(tc,{emoji:e,size:r,withBorder:o,onClick:function(){return c(e)}},null)}))]):""}}},render:function(){var e=this;return L("div",{class:[this.ns.b()]},[L("div",{ref:"emojisRef",class:[this.ns.e("container")]},[this.continuousList?Object.keys(this.dataFilteredByCategory).map((function(t){var n=e.dataFilteredByCategory[t],i=e.categories[t],r=i?i.text:t;return L("div",null,[n.length?L(ec,{name:r,ref:function(n){return e.setCategoryRef(t,n)}},null):"",e.renderGridEmojis({emojis:n,style:e.gridDynamic,size:e.emojiSize,withBorder:e.emojiWithBorder})])})):this.renderGridEmojis({emojis:this.dataFiltered||[],style:this.gridDynamic,size:this.emojiSize,withBorder:this.emojiWithBorder})])])}}),rc=c({name:"IBizInputSearch",emits:["update"],setup:function(e,t){var n=t.emit,i=ne("emoji-input-search"),r=f(""),o=function(){n("update",r.value)};return{ns:i,inputSearch:r,onSearch:o,handleKeyUp:function(e){e&&"Enter"===e.code&&o()}}},render:function(){var e=this;return L("div",{class:[this.ns.b()]},[L("div",{class:this.ns.e("container"),onKeyup:this.handleKeyUp},[L("div",{class:this.ns.em("container","search"),onClick:this.onSearch},[L("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",height:"1em",width:"1em",focusable:"false"},[L("g",{"stroke-width":"1"},[L("path",{d:"M6.751 12.303A5.557 5.557 0 0 1 1.2 6.751C1.2 3.691 3.69 1.2 6.751 1.2a5.558 5.558 0 0 1 5.551 5.551 5.557 5.557 0 0 1-5.551 5.552M6.751 0a6.751 6.751 0 1 0 4.309 11.949l3.855 3.855a.6.6 0 1 0 .849-.849l-3.854-3.853A6.751 6.751 0 0 0 6.751 0"},null)])])]),F(L("input",{class:this.ns.em("container","input"),type:"text","onUpdate:modelValue":function(t){return e.inputSearch=t},placeholder:ibiz.i18n.t("app.search")},null),[[H,this.inputSearch]])])])}}),oc=c({name:"IBizEmojiSelectHtmlComment",props:{customEmojis:{type:Array,required:!0,default:function(){return Uu}},customCategories:{type:Array,required:!0,default:function(){return[]}},limitFrequently:{type:Number,default:15},emojisByRow:{type:Number,default:8},continuousList:{type:Boolean,default:!1},emojiSize:{type:Number,default:27},emojiWithBorder:{type:Boolean,default:!0},showSearch:{type:Boolean,default:!0},showCategories:{type:Boolean,default:!0},dark:{type:Boolean,default:!1},initialCategory:{type:String,default:"peoples"},exceptCategories:{type:Array,default:function(){return[]}},exceptEmojis:{type:Array,default:function(){return[]}}},emits:["select","changeCategory","customEmojis"],setup:function(e,t){var n=t.emit,i=ne("emoji-select"),r=f([]),o=f([]),a=f("peoples"),s=f([]),l=f([]),u=f([]),c=f({}),h=f({}),d=f("");d.value=a.value;var g=f(""),p=o.value.map((function(e){return e.name}));p.includes(a.value)||(a.value=p[0]);var y=function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g.value=t;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=D((function(){return o.value.filter((function(e){return!s.value.includes(e)}))})),w=function(e){Object.assign(h.value,{frequently:[]}),e.filter((function(e){return!l.value.includes(e)})).forEach((function(e){var t=e.category;h.value[t]||Object.assign(h.value,O({},t,[])),h.value[t].push(e)}))},b=function(){var e=E(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=u.value||[],Object.assign(h.value,{frequently:t.map((function(e){return r.value[e]}))});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(e){var t=e.map((function(e){return r.value.indexOf(e)}));u.value=t},S=function(){var t=E(x().mark((function t(n){var i,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=h.value.frequently,r=v(new Set([n].concat(v(i)))),h.value.frequently=r.slice(0,e.limitFrequently),k(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),M=function(){var e=E(x().mark((function e(t){var i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=h.value[t.name].length,d.value=t.name,i&&n("changeCategory",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t);case 2:n("select",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return C((function(){return e.customEmojis}),(function(t){r.value=e.customEmojis,t&&t.length&&(h.value={},w(t))}),{immediate:!0,deep:!0}),C((function(){return e.customCategories}),(function(e){e&&e.length>0?o.value=e:o.value=[new Vu("frequently",Wu,"常用"),new Vu("peoples",Ku,"情绪"),new Vu("nature",Yu,"自然"),new Vu("foods",Ju,"食物与饮料"),new Vu("activity",qu,"活动"),new Vu("objects",Zu,"对象"),new Vu("places",Xu,"旅行与地方"),new Vu("symbols",$u,"符号"),new Vu("flags",Gu,"旗帜")],function(e){e.forEach((function(e){Object.assign(c.value,O({},e.name,e))}))}(o.value)}),{immediate:!0,deep:!0}),C((function(){return e.initialCategory}),(function(){a.value=e.initialCategory})),C((function(){return e.exceptCategories}),(function(){s.value=e.exceptCategories})),C((function(){return e.exceptEmojis}),(function(){l.value=e.exceptEmojis})),_((function(){w(r.value),b()})),R((function(){h.value={},u.value=[]})),{ns:i,mapEmojis:h,filterEmoji:g,mapCategories:c,currentCategory:d,categoriesFiltered:m,onSearch:y,onSelectEmoji:A,changeCategory:M}},render:function(){return L("div",{class:[this.ns.b(),this.ns.is("dark",this.dark)]},[this.showCategories&&L(Qu,{categories:this.categoriesFiltered,current:this.currentCategory,onSelect:this.changeCategory},null),this.showSearch&&L(rc,{onUpdate:this.onSearch},null),L(ic,{data:this.mapEmojis,category:this.currentCategory,filter:this.filterEmoji,categories:this.mapCategories,emojiWithBorder:this.emojiWithBorder,emojiSize:this.emojiSize,emojisByRow:this.emojisByRow,continuousList:this.continuousList,hasSearch:this.showSearch,onSelect:this.onSelectEmoji},null)])}}),ac=function(){return P((function e(t,n,i){A(this,e),O(this,"type",void 0),O(this,"icon",void 0),O(this,"text",void 0),this.type=t,this.icon=n,this.text=i}),[{key:"label",get:function(){return this.type}}])}(),sc=P((function e(t,n,i,r,o,a){A(this,e),O(this,"type",void 0),O(this,"icon",void 0),O(this,"category",void 0),O(this,"text",void 0),O(this,"value",void 0),O(this,"isInline",void 0),this.type=t,this.icon=n,this.category=i,this.text=r,this.value=o,this.isInline=!0===a})),lc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit="" preserveAspectRatio="xMidYMid meet" focusable="false"> <title>布局</title> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" id="矩形" fill="#EEEEEE" fill-rule="nonzero"></path> <g transform="translate(4.666667, 4.666667)"> <path d="M1.6,0 L6.95555556,0 C7.83921116,5.97197047e-17 8.55555556,0.7163444 8.55555556,1.6 L8.55555556,9.28888889 C8.55555556,10.1725445 7.83921116,10.8888889 6.95555556,10.8888889 L1.6,10.8888889 C0.7163444,10.8888889 1.082166e-16,10.1725445 0,9.28888889 L0,1.6 C-1.082166e-16,0.7163444 0.7163444,1.623249e-16 1.6,0 Z M11.6512821,0 L17.0068376,0 C17.8904932,5.97197047e-17 18.6068376,0.7163444 18.6068376,1.6 L18.6068376,9.28888889 C18.6068376,10.1725445 17.8904932,10.8888889 17.0068376,10.8888889 L11.6512821,10.8888889 C10.7676265,10.8888889 10.0512821,10.1725445 10.0512821,9.28888889 L10.0512821,1.6 C10.0512821,0.7163444 10.7676265,1.623249e-16 11.6512821,0 Z" id="形状结合" fill="#6698FF" opacity="0.300000012"></path> <path d="M0.466666667,17.8888889 L18.2,17.8888889 C18.4577329,17.8888889 18.6666667,18.0978227 18.6666667,18.3555556 C18.6666667,18.6132884 18.4577329,18.8222222 18.2,18.8222222 L0.466666667,18.8222222 C0.208933783,18.8222222 3.15631751e-17,18.6132884 0,18.3555556 C-3.15631751e-17,18.0978227 0.208933783,17.8888889 0.466666667,17.8888889 Z M0.466666667,14 L10.3025641,14 C10.560297,14 10.7692308,14.2089338 10.7692308,14.4666667 C10.7692308,14.7243995 10.560297,14.9333333 10.3025641,14.9333333 L0.466666667,14.9333333 C0.208933783,14.9333333 3.15631751e-17,14.7243995 0,14.4666667 C-3.15631751e-17,14.2089338 0.208933783,14 0.466666667,14 Z" id="形状结合" fill="#CACACA"></path> <path d="M4.2,4.82222222 L2.8,4.82222222 C2.54226712,4.82222222 2.33333333,4.61328844 2.33333333,4.35555556 C2.33333333,4.09782267 2.54226712,3.88888889 2.8,3.88888889 L4.2,3.88888889 C4.45773288,3.88888889 4.66666667,4.09782267 4.66666667,4.35555556 C4.66666667,4.61328844 4.45773288,4.82222222 4.2,4.82222222 Z M15.0888889,4.82222222 L12.9111111,4.82222222 C12.6533782,4.82222222 12.4444444,4.61328844 12.4444444,4.35555556 C12.4444444,4.09782267 12.6533782,3.88888889 12.9111111,3.88888889 L15.0888889,3.88888889 C15.3466218,3.88888889 15.5555556,4.09782267 15.5555556,4.35555556 C15.5555556,4.61328844 15.3466218,4.82222222 15.0888889,4.82222222 Z M5.75555556,7.93333333 L2.8,7.93333333 C2.54226712,7.93333333 2.33333333,7.72439955 2.33333333,7.46666667 C2.33333333,7.20893378 2.54226712,7 2.8,7 L5.75555556,7 C6.01328844,7 6.22222222,7.20893378 6.22222222,7.46666667 C6.22222222,7.72439955 6.01328844,7.93333333 5.75555556,7.93333333 Z M15.8666667,7.93333333 L12.9111111,7.93333333 C12.6533782,7.93333333 12.4444444,7.72439955 12.4444444,7.46666667 C12.4444444,7.20893378 12.6533782,7 12.9111111,7 L15.8666667,7 C16.1243995,7 16.3333333,7.20893378 16.3333333,7.46666667 C16.3333333,7.72439955 16.1243995,7.93333333 15.8666667,7.93333333 Z" id="形状结合" fill="#6698FF"></path> </g> </g> </g> </svg>',uc="<svg width='1em' height='1em' viewBox='0 0 28 28' version='1.1' xmlns='http://www.w3.org/2000/svg'> <title>日期</title> <g stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'> <g> <rect fill='#FFFFFF' x='0' y='0' width='28' height='28' rx='4'></rect> <path d='M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z' fill='#EEEEEE' fill-rule='nonzero' ></path> <g transform='translate(4.666667, 4.666667)'> <path d='M18.2666667,6.62222222 L18.2666667,17.1111111 C18.2666667,17.430209 18.1373267,17.7190979 17.9282123,17.9282123 C17.7190979,18.1373267 17.430209,18.2666667 17.1111111,18.2666667 L1.55555556,18.2666667 C1.2364577,18.2666667 0.947568811,18.1373267 0.738454386,17.9282123 C0.529339961,17.7190979 0.4,17.430209 0.4,17.1111111 L0.4,6.62222222 L18.2666667,6.62222222 Z M18.1333333,6.75555556 L0.509112478,6.75555556 L1.17926226,18.1481019 L18.1333333,17.4960222 L18.1333333,6.75555556 Z M17.0666667,1.95555556 C17.3980375,1.95555556 17.6980375,2.08987013 17.9151948,2.30702742 C18.1323521,2.52418471 18.2666667,2.82418471 18.2666667,3.15555556 L18.2666667,5.80985059 L0.4,5.80985059 L0.4,3.15555556 C0.4,2.82418471 0.534314575,2.52418471 0.751471863,2.30702742 C0.96862915,2.08987013 1.26862915,1.95555556 1.6,1.95555556 Z' stroke='#EEEEEE' stroke-width='0.8' fill='#EEEEEE' ></path> <rect fill='#DDDDDD' x='3.88888889' y='0' width='1.55555556' height='3.88888889' rx='0.777777778' ></rect> <rect fill='#DDDDDD' x='13.2222222' y='0' width='1.55555556' height='3.88888889' rx='0.777777778' ></rect> <path d='M2.8,10.1111111 L4.2,10.1111111 C4.45773288,10.1111111 4.66666667,10.3200449 4.66666667,10.5777778 C4.66666667,10.8355107 4.45773288,11.0444444 4.2,11.0444444 L2.8,11.0444444 C2.54226712,11.0444444 2.33333333,10.8355107 2.33333333,10.5777778 C2.33333333,10.3200449 2.54226712,10.1111111 2.8,10.1111111 Z M2.8,14 L4.2,14 C4.45773288,14 4.66666667,14.2089338 4.66666667,14.4666667 C4.66666667,14.7243995 4.45773288,14.9333333 4.2,14.9333333 L2.8,14.9333333 C2.54226712,14.9333333 2.33333333,14.7243995 2.33333333,14.4666667 C2.33333333,14.2089338 2.54226712,14 2.8,14 Z M6.68888889,10.1111111 L8.08888889,10.1111111 C8.34662177,10.1111111 8.55555556,10.3200449 8.55555556,10.5777778 C8.55555556,10.8355107 8.34662177,11.0444444 8.08888889,11.0444444 L6.68888889,11.0444444 C6.43115601,11.0444444 6.22222222,10.8355107 6.22222222,10.5777778 C6.22222222,10.3200449 6.43115601,10.1111111 6.68888889,10.1111111 Z M14.4666667,14 L15.8666667,14 C16.1243995,14 16.3333333,14.2089338 16.3333333,14.4666667 C16.3333333,14.7243995 16.1243995,14.9333333 15.8666667,14.9333333 L14.4666667,14.9333333 C14.2089338,14.9333333 14,14.7243995 14,14.4666667 C14,14.2089338 14.2089338,14 14.4666667,14 Z' fill='#CACACA' ></path> <path d='M6.68888889,14 L11.9777778,14 C12.2355107,14 12.4444444,14.2089338 12.4444444,14.4666667 C12.4444444,14.7243995 12.2355107,14.9333333 11.9777778,14.9333333 L6.68888889,14.9333333 C6.43115601,14.9333333 6.22222222,14.7243995 6.22222222,14.4666667 C6.22222222,14.2089338 6.43115601,14 6.68888889,14 Z' fill='#FF7575' ></path> <path d='M10.5777778,10.1111111 L15.8666667,10.1111111 C16.1243995,10.1111111 16.3333333,10.3200449 16.3333333,10.5777778 C16.3333333,10.8355107 16.1243995,11.0444444 15.8666667,11.0444444 L10.5777778,11.0444444 C10.3200449,11.0444444 10.1111111,10.8355107 10.1111111,10.5777778 C10.1111111,10.3200449 10.3200449,10.1111111 10.5777778,10.1111111 Z' fill='#6698FF' ></path> </g> </g> </g></svg>",cc="<svg width='1em' height='1em' viewBox='0 0 28 28' version='1.1' xmlns='http://www.w3.org/2000/svg'> <title>标签</title> <g stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'> <g> <rect fill='#FFFFFF' x='0' y='0' width='28' height='28' rx='4'></rect> <path d='M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z' fill='#EEEEEE' fill-rule='nonzero' ></path> <g transform='translate(3.888889, 6.222222)'> <rect fill='#EEEEEE' x='0' y='0' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#F6C659' opacity='0.300000012' x='0' y='6.22222222' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#D287F8' opacity='0.300000012' x='0' y='12.4444444' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#FF7575' opacity='0.300000012' x='10.8888889' y='0' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#73D897' opacity='0.300000012' x='10.8888889' y='6.22222222' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#56ABFB' opacity='0.300000012' x='10.8888889' y='12.4444444' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <path d='M7.77777778,2.02222222 C7.77777778,2.27995511 7.56884399,2.48888889 7.31111111,2.48888889 L2.02222222,2.48888889 C1.76448934,2.48888889 1.55555556,2.27995511 1.55555556,2.02222222 C1.55555556,1.76448934 1.76448934,1.55555556 2.02222222,1.55555556 L7.31111111,1.55555556 C7.56884399,1.55555556 7.77777778,1.76448934 7.77777778,2.02222222 Z' fill='#CACACA' fill-rule='nonzero' ></path> <path d='M7.77777778,8.24444444 C7.77777778,8.50217733 7.56884399,8.71111111 7.31111111,8.71111111 L2.02222222,8.71111111 C1.76448934,8.71111111 1.55555556,8.50217733 1.55555556,8.24444444 C1.55555556,7.98671156 1.76448934,7.77777778 2.02222222,7.77777778 L7.31111111,7.77777778 C7.56884399,7.77777778 7.77777778,7.98671156 7.77777778,8.24444444 Z' fill='#FFCD5D' fill-rule='nonzero' ></path> <path d='M7.77777778,14.4666667 C7.77777778,14.7243995 7.56884399,14.9333333 7.31111111,14.9333333 L2.02222222,14.9333333 C1.76448934,14.9333333 1.55555556,14.7243995 1.55555556,14.4666667 C1.55555556,14.2089338 1.76448934,14 2.02222222,14 L7.31111111,14 C7.56884399,14 7.77777778,14.2089338 7.77777778,14.4666667 Z' fill='#D287F8' fill-rule='nonzero' ></path> <path d='M18.6666667,2.02222222 C18.6666667,2.27995511 18.4577329,2.48888889 18.2,2.48888889 L12.9111111,2.48888889 C12.6533782,2.48888889 12.4444444,2.27995511 12.4444444,2.02222222 C12.4444444,1.76448934 12.6533782,1.55555556 12.9111111,1.55555556 L18.2,1.55555556 C18.4577329,1.55555556 18.6666667,1.76448934 18.6666667,2.02222222 Z' fill='#FF7575' fill-rule='nonzero' ></path> <path d='M18.6666667,8.24444444 C18.6666667,8.50217733 18.4577329,8.71111111 18.2,8.71111111 L12.9111111,8.71111111 C12.6533782,8.71111111 12.4444444,8.50217733 12.4444444,8.24444444 C12.4444444,7.98671156 12.6533782,7.77777778 12.9111111,7.77777778 L18.2,7.77777778 C18.4577329,7.77777778 18.6666667,7.98671156 18.6666667,8.24444444 Z' fill='#73D897' fill-rule='nonzero' ></path> <path d='M18.6666667,14.4666667 C18.6666667,14.7243995 18.4577329,14.9333333 18.2,14.9333333 L12.9111111,14.9333333 C12.6533782,14.9333333 12.4444444,14.7243995 12.4444444,14.4666667 C12.4444444,14.2089338 12.6533782,14 12.9111111,14 L18.2,14 C18.4577329,14 18.6666667,14.2089338 18.6666667,14.4666667 Z' fill='#56ABFB' fill-rule='nonzero' ></path> </g> </g> </g></svg>",hc="<svg width='1em' height='1em' viewBox='0 0 28 28' version='1.1' xmlns='http://www.w3.org/2000/svg'> <title>提示框</title> <defs> <rec x='1' y='1' width='26' height='26' rx='4'></rect> </defs> <g stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'> <g > <rect fill='#FFFFFF' x='0' y='0' width='28' height='28' rx='3.2' ></rect> <path d='M24.8,0 C26.5673112,0 28,1.4326888 28,3.2 L28,24.8 C28,26.5673112 26.5673112,28 24.8,28 L3.2,28 C1.4326888,28 0,26.5673112 0,24.8 L0,3.2 C0,1.4326888 1.4326888,0 3.2,0 L24.8,0 Z M24.8,1 L3.2,1 C1.98497355,1 1,1.98497355 1,3.2 L1,24.8 C1,26.0150264 1.98497355,27 3.2,27 L24.8,27 C26.0150264,27 27,26.0150264 27,24.8 L27,3.2 C27,1.98497355 26.0150264,1 24.8,1 Z' fill='#EEEEEE' fill-rule='nonzero' ></path> <mask fill='white'> <use xlink:href='#path-1'></use> </mask> <use fill='#FFFFFF' xlink:href='#path-1'></use> <g mask='url(#mask-2)'> <g transform='translate(4.666667, 7.000000)'> <rect fill='#5DCFFF' opacity='0.200000003' x='0' y='0' width='33.4444444' height='14' rx='1.6' ></rect> <path d='M12.9111111,8.55555556 L15.8666667,8.55555556 C16.1243995,8.55555556 16.3333333,8.76448934 16.3333333,9.02222222 C16.3333333,9.27995511 16.1243995,9.48888889 15.8666667,9.48888889 L12.9111111,9.48888889 C12.6533782,9.48888889 12.4444444,9.27995511 12.4444444,9.02222222 C12.4444444,8.76448934 12.6533782,8.55555556 12.9111111,8.55555556 Z M12.9111111,4.66666667 L23.6444444,4.66666667 C23.9021773,4.66666667 24.1111111,4.87560045 24.1111111,5.13333333 C24.1111111,5.39106622 23.9021773,5.6 23.6444444,5.6 L12.9111111,5.6 C12.6533782,5.6 12.4444444,5.39106622 12.4444444,5.13333333 C12.4444444,4.87560045 12.6533782,4.66666667 12.9111111,4.66666667 Z' fill='#5DCFFF' ></path> <g stroke-width='1' fill='none' transform='translate(3.111111, 3.888889)' > <pat  d='M3.11111111,-8.8817842e-16 C4.82222222,-8.8817842e-16 6.22222222,1.4 6.22222222,3.11111111 C6.22222222,4.82222222 4.82222222,6.22222222 3.11111111,6.22222222 C1.4,6.22222222 0,4.82222222 0,3.11111111 C0,1.4 1.4,-8.8817842e-16 3.11111111,-8.8817842e-16 Z M2.85139179,2.72012729 L2.83967627,4.6768138 L3.3841145,4.6794151 L3.39583002,2.72272859 L2.85139179,2.72012729 Z M2.87813929,1.54282507 L2.87038639,2.32474454 L3.50268048,2.33249744 L3.51043338,1.55057797 L2.87813929,1.54282507 Z'  fill='#5DCFFF' ></path> </g> </g> </g> </g> </g></svg>",fc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit="" preserveAspectRatio="xMidYMid meet" focusable="false"> <title>思维导图</title> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" fill="#EEEEEE" fill-rule="nonzero"></path> <g id="编组-26" transform="translate(3.888889, 5.833333)"> <rect id="矩形" fill="#CACACA" x="7" y="7.77777778" width="5.44444444" height="1"></rect> <path d="M12.4444444,14.7777778 L11.3222222,14.7777778 C10.4385666,14.7777778 9.72222222,14.0614334 9.72222222,13.1777778 L9.72222222,3.15555556 C9.72222222,2.27189996 10.4385666,1.55555556 11.3222222,1.55555556 L12.4444444,1.55555556 L12.4444444,1.55555556" stroke="#CACACA" stroke-width="0.96"></path> <path d="M13.2444444,0 L18.6444444,0 C19.0862722,2.00237164e-16 19.4444444,0.3581722 19.4444444,0.8 L19.4444444,2.31111111 C19.4444444,2.75293891 19.0862722,3.11111111 18.6444444,3.11111111 L13.2444444,3.11111111 C12.8026166,3.11111111 12.4444444,2.75293891 12.4444444,2.31111111 L12.4444444,0.8 C12.4444444,0.3581722 12.8026166,-2.98598523e-17 13.2444444,0 Z" id="矩形备份-68" fill="#6698FF" opacity="0.300000012"></path> <rect fill="#73D897" opacity="0.300000012" x="12.4444444" y="6.61111111" width="7" height="3.11111111" rx="0.8"></rect> <path d="M13.2444444,13.2222222 L18.6444444,13.2222222 C19.0862722,13.2222222 19.4444444,13.5803944 19.4444444,14.0222222 L19.4444444,15.5333333 C19.4444444,15.9751611 19.0862722,16.3333333 18.6444444,16.3333333 L13.2444444,16.3333333 C12.8026166,16.3333333 12.4444444,15.9751611 12.4444444,15.5333333 L12.4444444,14.0222222 C12.4444444,13.5803944 12.8026166,13.2222222 13.2444444,13.2222222 Z" fill="#FF7575" opacity="0.300000012"></path> <path d="M17.8888889,1.64666667 C17.8888889,1.91176335 17.6739856,2.12666667 17.4088889,2.12666667 L14.48,2.12666667 C14.2149033,2.12666667 14,1.91176335 14,1.64666667 C14,1.38156999 14.2149033,1.16666667 14.48,1.16666667 L17.4088889,1.16666667 C17.6739856,1.16666667 17.8888889,1.38156999 17.8888889,1.64666667 Z" id="直线-7备份-6" fill="#6698FF" fill-rule="nonzero"></path> <path d="M17.8888889,8.25777778 C17.8888889,8.52287446 17.6739856,8.73777778 17.4088889,8.73777778 L14.48,8.73777778 C14.2149033,8.73777778 14,8.52287446 14,8.25777778 C14,7.9926811 14.2149033,7.77777778 14.48,7.77777778 L17.4088889,7.77777778 C17.6739856,7.77777778 17.8888889,7.9926811 17.8888889,8.25777778 Z" id="直线-7备份-7" fill="#73D897" fill-rule="nonzero"></path> <path d="M17.8888889,14.8688889 C17.8888889,15.1339856 17.6739856,15.3488889 17.4088889,15.3488889 L14.48,15.3488889 C14.2149033,15.3488889 14,15.1339856 14,14.8688889 C14,14.6037922 14.2149033,14.3888889 14.48,14.3888889 L17.4088889,14.3888889 C17.6739856,14.3888889 17.8888889,14.6037922 17.8888889,14.8688889 Z" id="直线-7备份-8" fill="#FF7575" fill-rule="nonzero"></path> <path d="M1.6,5.44444444 L5.4,5.44444444 C6.2836556,5.44444444 7,6.16078884 7,7.04444444 L7,9.28888889 C7,10.1725445 6.2836556,10.8888889 5.4,10.8888889 L1.6,10.8888889 C0.7163444,10.8888889 3.30261205e-16,10.1725445 0,9.28888889 L0,7.04444444 C1.13828005e-16,6.16078884 0.7163444,5.44444444 1.6,5.44444444 Z" fill="#EEEEEE"></path> </g> </g> </g> </svg>',dc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit="" preserveAspectRatio="xMidYMid meet" focusable="false"> <title>音频</title> <g id="音频" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" id="矩形" fill="#EEEEEE" fill-rule="nonzero"></path> <g transform="translate(4.666667, 7.000000)"> <ellipse fill="#CACACA" cx="9.33333333" cy="7" rx="2.33333333" ry="3.11111111"></ellipse> <path d="M2.69356086,9.2803178 L0.690789474,9.2803178 C0.309276809,9.2803178 0,8.97105135 0,8.58952833 L0,5.35862792 C0,4.9771049 0.309276809,4.66783845 0.690789474,4.66783845 L2.69356086,4.66783845 C2.69356086,4.66783845 2.69356086,9.2803178 2.69356086,9.2803178 Z" id="路径" fill="#DDDDDD"></path> <path d="M9.24122807,0 L9.24122807,14 C6.82346491,14 2.69356086,9.2803178 2.69356086,9.2803178 L2.69356086,4.66783845 C2.69356086,4.66783845 6.82346491,0 9.24122807,0 Z" id="路径" fill="#F5F5F5"></path> <path d="M14.4666667,6.67859506 L16.7559366,6.67859506 C17.0136695,6.67859506 17.2226033,6.88752885 17.2226033,7.14526173 C17.2226033,7.40299461 17.0136695,7.6119284 16.7559366,7.6119284 L14.4666667,7.6119284 C14.2089338,7.6119284 14,7.40299461 14,7.14526173 C14,6.88752885 14.2089338,6.67859506 14.4666667,6.67859506 Z" id="矩形备份-74" fill="#73D897"></path> <path d="M14.4666667,2.33333333 L18.927827,2.33333333 C19.1855599,2.33333333 19.3944936,2.54226712 19.3944936,2.8 C19.3944936,3.05773288 19.1855599,3.26666667 18.927827,3.26666667 L14.4666667,3.26666667 C14.2089338,3.26666667 14,3.05773288 14,2.8 C14,2.54226712 14.2089338,2.33333333 14.4666667,2.33333333 Z" id="矩形备份-75" fill="#6698FF"></path> <path d="M14.4666667,11.0238568 L18.927827,11.0238568 C19.1855599,11.0238568 19.3944936,11.2327906 19.3944936,11.4905235 C19.3944936,11.7482563 19.1855599,11.9571901 18.927827,11.9571901 L14.4666667,11.9571901 C14.2089338,11.9571901 14,11.7482563 14,11.4905235 C14,11.2327906 14.2089338,11.0238568 14.4666667,11.0238568 Z" id="矩形备份-77" fill="#FF7575"></path> </g> </g> </g> </svg>',vc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit="" preserveAspectRatio="xMidYMid meet" focusable="false"> <title>公式</title> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" id="矩形" fill="#EEEEEE" fill-rule="nonzero"></path> <g transform="translate(6.222222, 6.222222)"> <path d="M0.466666667,16.3333333 L8.08888889,16.3333333 C8.34662177,16.3333333 8.55555556,16.5422671 8.55555556,16.8 C8.55555556,17.0577329 8.34662177,17.2666667 8.08888889,17.2666667 L0.466666667,17.2666667 C0.208933783,17.2666667 3.15631751e-17,17.0577329 0,16.8 C-3.15631751e-17,16.5422671 0.208933783,16.3333333 0.466666667,16.3333333 Z M0.466666667,13.2222222 L15.0888889,13.2222222 C15.3466218,13.2222222 15.5555556,13.431156 15.5555556,13.6888889 C15.5555556,13.9466218 15.3466218,14.1555556 15.0888889,14.1555556 L0.466666667,14.1555556 C0.208933783,14.1555556 3.15631751e-17,13.9466218 0,13.6888889 C-3.15631751e-17,13.431156 0.208933783,13.2222222 0.466666667,13.2222222 Z" id="形状结合" fill="#CACACA"></path> <path d="M7.29125451,0 C7.38377228,0 7.47325862,0.03098981 7.54722121,0.0875155065 L7.59958726,0.13461254 L8.32633451,0.900605806 C8.49662199,1.08008919 8.49662199,1.37108926 8.32633451,1.55057265 C8.17496787,1.71011343 7.94000374,1.72784019 7.77005987,1.60375291 L7.70966902,1.55057265 L7.11011022,0.919191919 L2.20294226,0.919191919 L5.86172644,4.73057214 C6.01309309,4.89011292 6.0299116,5.13776566 5.91218199,5.31688688 L5.86172644,5.38053898 L1.48925255,9.19191919 L7.21088891,9.19191919 L7.81117445,8.56053847 C7.9625411,8.40099768 8.19750523,8.38327092 8.3674491,8.5073582 L8.42783995,8.56053847 C8.57920659,8.72007925 8.59602511,8.96773199 8.4782955,9.14685321 L8.42783995,9.21050531 L7.70109269,9.97649857 C7.63567275,10.0454513 7.55160597,10.0902317 7.46138469,10.1053857 L7.39275995,10.1111111 L0.436922523,10.1111111 C0.0727247798,10.1111111 -0.121029049,9.67600851 0.0825161905,9.38305589 L0.128589776,9.32653173 L4.93638527,5.05555556 L0.841552739,0.784579379 C0.584026044,0.513145656 0.738922096,0.0610784438 1.07938574,0.00563033025 L1.14988549,0 L7.29125451,0 Z M13.4123521,6.36326594 C13.4835613,6.26668286 13.5653385,6.17894359 13.6560525,6.10179832 C13.7739326,6.14537625 13.9131899,6.18895419 14.0738245,6.23253213 C14.2338105,6.27601914 14.3985524,6.29798932 14.5639737,6.29789904 C14.8254058,6.30337896 15.0782142,6.20113169 15.2666735,6.0136951 C15.4633399,5.81548898 15.5681255,5.53943359 15.5543498,5.25581792 C15.5625234,5.03769835 15.4836884,4.82568311 15.3363022,4.66941046 C15.1932921,4.51889384 14.9960721,4.43684042 14.7920992,4.44299465 C14.5276073,4.44184652 14.2723055,4.54325127 14.076573,4.72719859 C13.79695,5.00734436 13.5561581,5.32614942 13.3610468,5.67454506 C13.305466,5.76927971 13.2388913,5.87854033 13.1613225,6.00232694 L12.7001548,6.55130253 C12.6378555,6.27846675 12.57464,5.99994689 12.5059275,5.71290091 C12.085407,3.96315198 10.6900851,4.30787901 10.2805586,4.48219077 C9.8389663,4.67166006 9.9571518,5.09512393 10.194439,4.98333705 C10.4166026,4.85295335 10.6857788,4.84072112 10.9181474,4.95044941 C11.1505161,5.0601777 11.3178523,5.27853825 11.3680485,5.53753473 C11.5668567,6.24899193 11.7134433,6.89792426 11.8508683,7.46822683 C11.7478048,7.62153899 11.403818,8.05305748 11.2859293,8.19448666 C11.2112337,8.28582736 11.1304112,8.37161645 11.0440613,8.45121756 C10.9090794,8.40069241 10.7652412,8.35427244 10.6125468,8.31195763 C10.4564339,8.269741 10.2956695,8.2487227 10.1343078,8.24943276 C9.87263241,8.24411775 9.61959814,8.34632312 9.43069178,8.5336367 C9.23123516,8.73520831 9.1254105,9.01585021 9.14026694,9.30382938 C9.13218953,9.51704512 9.20928522,9.72430908 9.35345807,9.87697219 C9.49763092,10.0296353 9.69618572,10.1142547 9.90251761,10.1109686 C10.1692308,10.1154591 10.427396,10.0136988 10.6235408,9.82676463 C10.8971525,9.54472709 11.1359499,9.22875305 11.3344861,8.88604959 C11.4206058,8.747737 11.4862644,8.64037107 11.531462,8.56395179 C11.5736056,8.49195346 11.876521,8.09631754 11.9690538,7.95232088 C12.0491926,8.58451479 12.347946,9.16533971 12.8100948,9.58744088 C13.5199368,9.89948674 14.0990436,10.1179285 14.7536202,9.69603082 C15.044045,9.52456111 14.9478475,9.16078006 14.7536202,9.22804166 C14.4839818,9.40974328 13.8958539,9.57918911 13.646555,9.36871093 C13.1802062,8.68324372 12.8921623,7.88528807 12.8100948,7.05150147 C12.9469091,6.85319028 13.3048553,6.49778914 13.4123521,6.36326594 Z" id="形状结合" fill="#666666" fill-rule="nonzero"></path> </g> </g> </g> </svg>',gc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit=""> <title>本地文件</title> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" id="矩形" fill="#EEEEEE" fill-rule="nonzero"></path> <g transform="translate(2.331723, 6.223395)"> <path d="M10.8586379,9.82567869 C10.8586379,11.3135682 9.65287619,12.519741 8.16549379,12.519741 C6.6781114,12.519741 5.47234973,11.3135682 5.47237295,9.83060072 L5.43152142,5.5040927 C5.4288277,5.21612692 5.65998761,4.98048085 5.94785525,4.97776249 C6.23572289,4.97504413 6.47128863,5.20628285 6.47400607,5.49424863 L6.51485711,9.82567869 C6.51485711,10.737611 7.25387232,11.4768781 8.16549379,11.4768781 C9.07711526,11.4768781 9.81613048,10.737611 9.81613048,9.82567869 L9.81613048,5.02838197 C9.81613048,3.65522549 8.5992671,2.52563899 7.0795486,2.52563899 C5.55983011,2.52563899 4.34296673,3.65522549 4.34296673,5.02838197 L4.34296673,10.0065309 C4.34296673,12.103884 6.05369893,13.8053486 8.16549379,13.8053486 C10.2772887,13.8053486 11.9880209,12.103884 11.9880209,10.0065309 L11.9880209,5.5222302 C11.9880209,5.23425158 12.2213941,5.00079879 12.5092745,5.00079879 C12.797155,5.00079879 13.0305282,5.23425158 13.0305282,5.5222302 L13.0305282,10.0065309 C13.0305282,12.6811932 10.8517067,14.8482114 8.16549379,14.8482114 C5.47928093,14.8482114 3.30045935,12.6811932 3.30045935,10.0065309 L3.30045935,5.02838197 C3.30045935,3.06112766 5.0007613,1.48277617 7.0795486,1.48277617 C9.15833591,1.48277617 10.8586379,3.06112766 10.8586379,5.02838197 Z" id="形状结合" fill="#DDDDDD" transform="translate(8.165494, 8.165494) rotate(-315.000000) translate(-8.165494, -8.165494) "></path> <path d="M16.8515613,7.68286899 L19.1408313,7.68286899 C19.3985642,7.68286899 19.6074979,7.89180277 19.6074979,8.14953566 C19.6074979,8.40726854 19.3985642,8.61620232 19.1408313,8.61620232 L16.8515613,8.61620232 C16.5938284,8.61620232 16.3848947,8.40726854 16.3848947,8.14953566 C16.3848947,7.89180277 16.5938284,7.68286899 16.8515613,7.68286899 Z" id="矩形备份-74" fill="#73D897"></path> <path d="M16.8515613,3.33760726 L21.3127216,3.33760726 C21.5704545,3.33760726 21.7793883,3.54654104 21.7793883,3.80427393 C21.7793883,4.06200681 21.5704545,4.27094059 21.3127216,4.27094059 L16.8515613,4.27094059 C16.5938284,4.27094059 16.3848947,4.06200681 16.3848947,3.80427393 C16.3848947,3.54654104 16.5938284,3.33760726 16.8515613,3.33760726 Z" id="矩形备份-75" fill="#6698FF"></path> <path d="M16.8515613,12.0281307 L21.3127216,12.0281307 C21.5704545,12.0281307 21.7793883,12.2370645 21.7793883,12.4947974 C21.7793883,12.7525303 21.5704545,12.9614641 21.3127216,12.9614641 L16.8515613,12.9614641 C16.5938284,12.9614641 16.3848947,12.7525303 16.3848947,12.4947974 C16.3848947,12.2370645 16.5938284,12.0281307 16.8515613,12.0281307 Z" id="矩形备份-77" fill="#FF7575"></path> </g> </g> </g></svg>',pc=function(){return[new sc("layout",lc,"base","布局","",!1),new sc("date",uc,"base","日期",vt().format("YYYY-MM-DD"),!0),new sc("label",cc,"base","标签","",!0),new sc("prompt-box",hc,"base","提示框","",!1),new sc("formula",vc,"base","LaTex 公式","",!0),new sc("mind-map",fc,"graph","思维导图","",!1),new sc("files",gc,"file","本地文件","",!0),new sc("audio",dc,"file","本地音频","",!1)]},yc=c({name:"IBizInsertItemList",props:{data:{type:Object,required:!0},filter:{type:String,default:""},categories:{type:Object,required:!0,default:function(){}},hasSearch:{type:Boolean}},emits:["select","data"],setup:function(e,t){var n=t.emit,i=ne("insert-item-list"),r=f({}),o=D((function(){return Object.keys(e.data)})),a=D((function(){var t={};Object.assign(t,e.data);var n=e.filter.trim().toLowerCase();return n&&o.value.forEach((function(i){t[i]=e.data[i].filter((function(e){return t=n,e.text.toLowerCase().includes(t);var t}))})),t})),s=function(e){n("select",e)};return{ns:i,InsertItemsRef:r,dataFilteredByCategory:a,onSelect:s,renderListInsertItems:function(e){var t=e.insertSelect,n=e.style;return t&&t.length>0?L("div",{class:[i.e("list-insert-items")],style:n},[t.map((function(e){return function(e){var t=e.icon,n=e.text;return L("div",{class:[i.e("insert-item")],onClick:function(){return s(e)}},[t?L("div",{class:i.em("insert-item","icon"),innerHTML:t},null):"",L("div",{class:i.em("insert-item","text")},[n])])}(e)}))]):""}}},render:function(){var e=this;return L("div",{class:[this.ns.b()]},[L("div",{ref:"InsertItemsRef",class:[this.ns.e("container")]},[Object.keys(this.dataFilteredByCategory).map((function(t){var n=e.dataFilteredByCategory[t],i=e.categories[t],r=i?i.text:t;return L("div",null,[n.length?L("div",{class:e.ns.e("label")},[r]):"",e.renderListInsertItems({insertSelect:n})])}))])])}});var mc=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9641",width:"1em",height:"1em"},[L("path",{d:"M852.537678 966.322357c7.542461 0 14.818718-3.016984 20.142807-8.341075s8.341075-12.600347 8.341075-20.142807V262.033969c0-6.743847-2.395841-13.22149-6.743848-18.368111L725.469393 67.793414c-5.412825-6.388908-13.39896-10.115771-21.740034-10.115771h-532.231543c-7.542461 0-14.818718 3.016984-20.142807 8.341075s-8.341075 12.600347-8.341075 20.142807v851.67695c0 7.542461 3.016984 14.818718 8.341075 20.142807s12.600347 8.341075 20.142807 8.341075h681.039862z",fill:"#CA223D","p-id":"9642"},null),L("path",{d:"M881.02156 265.228423v-3.194454c0-6.743847-2.395841-13.22149-6.743848-18.368111L725.469393 67.793414c-5.412825-6.388908-13.39896-10.115771-21.740034-10.115771h-1.331023v207.55078h178.623224z",opacity:".15","p-id":"9643"},null),L("path",{d:"M359.083258 657.52513c-10.293241 0-16.14974-4.614211-19.432929-9.494627-10.027036-15.262392 2.040901-40.640555 14.197574-52.442288 6.300173-6.033969 25.023224-21.562565 65.131369-37.889775 8.07487-19.07799 15.97227-40.55182 23.071057-62.469324 11.801733-36.647487 18.989255-74.271057 22.982323-100.447834-8.696014-16.061005-34.162912-65.042634-34.162912-83.676949 0-10.470711 2.307106-18.989255 7.010052-25.200693 4.880416-6.566378 11.979203-10.204506 20.054073-10.204507 9.228423 0 18.456846 4.702946 25.466898 12.955286 7.098787 8.25234 11.00312 19.255459 11.003119 30.702253 0 17.569497-2.307106 44.012478-6.300173 71.254073 17.392028 31.323397 36.292548 59.984749 52.087348 78.885269 15.617331 18.634315 34.340381 35.493934 55.902946 50.223917 37.97851-3.283189 82.878336-4.348007 99.205546 2.218371 20.852686 8.429809 24.40208 22.272444 20.763952 32.476949-6.388908 17.924437-34.87279 27.951473-58.742461 20.586482-9.760832-3.016984-35.493934-12.067938-66.994801-32.47695-26.176776 2.484575-53.240901 6.388908-78.619064 11.358059-27.507799 5.32409-53.063432 12.422877-76.045754 21.030156-19.521664 44.278683-37.357366 70.10052-53.152166 76.755633-9.583362 4.259272-17.303293 5.856499-23.425997 5.856499z m-0.976083-22.272444c1.419757 0.17747 6.033969 0.266205 15.883536-3.904332 5.945234-2.484575 16.948354-15.351127 30.968457-42.947661-21.917504 11.00312-32.388215 20.054073-35.582669 23.159792-7.808666 7.453726-12.067938 19.699133-11.269324 23.692201z m271.794801-95.478683c15.97227 8.07487 28.128943 12.245407 33.985442 14.108839 14.996187 4.614211 29.105026-2.57331 31.145927-6.388908-0.621144-0.798614-2.57331-2.662045-7.986135-4.880416-5.235355-2.129636-24.490815-4.170537-57.145234-2.839515z m-181.728943 6.477643l-0.443674 1.064818c18.72305-6.033969 38.777123-11.091854 59.807279-15.173656 17.480763-3.371924 35.848873-6.300173 54.128249-8.607279l-0.709878-0.532409 2.129636-0.17747c-14.818718-11.979203-28.128943-25.023224-39.841941-39.043328-14.996187-17.835702-29.193761-39.487002-40.37435-57.943847l-0.17747 1.153553-0.532409-0.887349c-4.348007 22.893588-10.559445 49.691508-18.989255 76.045754-4.880416 15.173657-10.204506 30.258579-15.706066 44.456153l0.709879-0.35494z m9.849567-248.368804c-0.887348 0-1.508492 0.17747-2.307106 1.242288-0.798614 1.064818-2.57331 4.259272-2.57331 11.890468 0 4.525477 5.50156 20.586482 17.037088 44.722357 1.419757-14.108839 2.129636-26.709185 2.129636-36.381283 0-13.842634-9.494627-21.47383-14.286308-21.47383z",fill:"#FFFFFF","p-id":"9644"},null),L("path",{d:"M404.808319 775.25851h17.125823l1.419757 8.252339h0.532409c6.655113-5.679029 14.996187-10.293241 23.514732-10.293241 19.699133 0 31.323397 16.14974 31.323397 40.640555 0 27.330329-16.415945 43.213865-33.896707 43.213865-7.010052 0-13.665165-3.105719-19.787869-8.696014l0.532409 13.132755v24.224611h-20.763951v-110.47487z m52.442288 38.954592c0-15.262392-4.880416-23.692201-15.794801-23.692201-5.412825 0-10.293241 2.75078-15.794801 8.25234v35.05026c5.14662 4.436742 10.293241 5.945234 14.552513 5.945234 9.583362 0.088735 17.037088-8.163605 17.037089-25.555633zM492.034662 815.366655c0-26.088042 16.238475-42.060312 33.453033-42.060312 8.962218 0 14.552513 3.460659 20.231542 8.696014l-0.887348-12.511612v-28.128943h20.941421v113.758059h-16.948353l-1.685962-8.252339h-0.443674c-5.856499 5.679029-13.842634 10.293241-22.094974 10.293241-19.787868-0.088735-32.565685-15.706066-32.565685-41.794108z m52.885962 16.238475v-35.05026c-4.880416-4.436742-9.849567-5.945234-14.818718-5.945234-8.962218 0-16.504679 8.518544-16.504679 24.490815 0 16.504679 5.945234 24.757019 16.504679 24.757019 5.50156 0 10.204506-2.307106 14.818718-8.25234zM630.993414 757.600277c-2.75078-0.976083-5.856499-1.685962-8.429809-1.685962-6.300173 0-9.672097 3.726863-9.672097 12.511612v6.832583h14.996187v16.504679h-14.996187v63.356672h-20.941421v-63.267937h-10.648181v-15.528596l10.648181-0.887349v-6.566378c0-16.682149 7.719931-29.459965 27.774003-29.459965 6.122704 0 11.535529 1.419757 15.084922 2.839515l-3.815598 15.351126z",fill:"#FFFFFF","p-id":"9645"},null)]),wc=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"11602",width:"1em",height:"1em"},[L("path",{d:"M146.879977 0A52.335992 52.335992 0 0 0 95.999985 51.167992v921.647856a49.039992 49.039992 0 0 0 15.279998 35.791994A49.839992 49.839992 0 0 0 146.863977 1023.99984h746.287883a48.559992 48.559992 0 0 0 35.567995-15.359998A50.719992 50.719992 0 0 0 943.999853 972.815848V290.015955L655.679898 0H146.847977h0.016z",fill:"#3662EC","p-id":"11603"},null),L("path",{d:"M943.999853 287.999955H706.84789A52.127992 52.127992 0 0 1 655.999898 237.199963V0l287.951955 287.999955H943.999853z",fill:"#FFFFFF","fill-opacity":".7","p-id":"11604"},null),L("path",{d:"M336.831947 751.999883h45.823993v-152.575977h51.711992V561.279912h-148.991977v38.143994h51.455992V751.999883z m102.399984 0h48.639993l16.383997-37.119995c4.351999-9.983998 8.703999-19.967997 13.055998-31.743995h1.024c5.119999 11.775998 9.471999 21.759997 14.079998 31.743995L550.079914 751.999883h50.943992l-52.479992-95.999985 49.151993-94.719986h-48.383993l-13.823998 34.303995c-3.839999 8.959999-7.935999 18.943997-12.287998 31.231995h-1.024c-5.375999-12.287998-9.471999-22.271997-13.823997-31.231995l-15.359998-34.303995h-50.943992l49.407992 92.671986L439.231931 751.999883z m217.855966 0h45.823993v-152.575977h51.711992V561.279912h-148.991977v38.143994h51.455992V751.999883z",fill:"#FFFFFF","p-id":"11605"},null)]),bc=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"17449",width:"1em",height:"1em"},[L("path",{d:"M947.2 216.064l-192.256-204.8A38.144 38.144 0 0 0 728.064 0h-614.4a40.192 40.192 0 0 0-38.912 41.472v941.056A40.192 40.192 0 0 0 113.664 1024H921.6a40.192 40.192 0 0 0 38.912-41.472V245.504A42.752 42.752 0 0 0 947.2 216.064zM652.8 768l-137.216-203.008L378.624 768h-95.488l184.576-264.704L295.424 256h95.488l124.672 185.088L640 256h95.488L563.2 503.04 748.032 768z",fill:"#25C273","p-id":"17450"},null)]),kc=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"19451",width:"1em",height:"1em"},[L("path",{d:"M854.6 288.7c6 6 9.4 14.1 9.4 22.6V928c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V96c0-17.7 14.3-32 32-32h424.7c8.5 0 16.7 3.4 22.7 9.4l215.2 215.3zM790.2 326L602 137.8V326h188.2zM296 136v64h64v-64h-64z m64 64v64h64v-64h-64z m-64 64v64h64v-64h-64z m64 64v64h64v-64h-64z m-64 64v64h64v-64h-64z m64 64v64h64v-64h-64z m-64 64v64h64v-64h-64z m0 64v160h128V584H296z m48 48h32v64h-32v-64z",fill:"#515151","p-id":"19452"},null)]),xc=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"26339",width:"1em",height:"1em"},[L("path",{d:"M794.574 930.64h-562.47c-24.262 0-44-19.738-44-44V142.99c0-24.262 19.738-44 44-44h344.009v64H252.104v703.65h522.471V345h64v541.64c-0.001 24.261-19.739 44-44.001 44z",fill:"","p-id":"26340"},null),L("path",{d:"M619 301.79h220v64H619z",fill:"","p-id":"26341"},null),L("path",{d:"M618 98.228h64v266.078h-64z",fill:"","p-id":"26342"},null),L("path",{d:"M632.307 136.573l51.007-38.649 155.153 204.764-51.008 38.649zM916.137 779.999H110.146c-6.6 0-12-5.4-12-12V493.127c0-6.6 5.4-12 12-12h805.991c6.6 0 12 5.4 12 12v274.872c0 6.6-5.4 12-12 12z",fill:"","p-id":"26343"},null),L("path",{d:"M266.631 551.092h47.454c52.831 0 85.559 24.867 85.559 77.998 0 52.918-32.728 79.271-83.688 79.271h-49.324V551.092z m45.35 131.978c32.26 0 52.363-15.727 52.363-53.98 0-38.467-20.104-52.92-52.363-52.92h-10.753v106.9h10.753zM436.581 629.09c0-51.219 31.559-80.973 77.376-80.973s77.376 29.967 77.376 80.973-31.559 82.246-77.376 82.246-77.376-31.24-77.376-82.246z m119.453 0c0-33.793-16.363-53.982-42.077-53.982s-42.077 20.189-42.077 53.982c0 33.578 16.363 55.043 42.077 55.043s42.077-21.465 42.077-55.043zM628.271 630.365c0-51.857 36.701-82.248 80.415-82.248 21.975 0 39.507 9.564 50.728 20.189l-18.234 19.979c-8.649-7.652-18.701-13.178-31.792-13.178-26.182 0-45.817 20.402-45.817 54.193 0 34.217 17.766 54.832 45.116 54.832 14.728 0 26.416-6.375 35.767-15.514l18.233 19.553c-14.26 15.088-32.728 23.164-55.169 23.164-43.714 0.001-79.247-28.478-79.247-80.97z",fill:"#FFFFFF","p-id":"26344"},null)]),Cc=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"27355",width:"1em",height:"1em"},[L("path",{d:"M170.65984 42.65984l682.65984 0q53.00224 0 90.50112 37.49888t37.49888 90.50112l0 682.65984q0 53.00224-37.49888 90.50112t-90.50112 37.49888l-682.65984 0q-53.00224 0-90.50112-37.49888t-37.49888-90.50112l0-682.65984q0-53.00224 37.49888-90.50112t90.50112-37.49888zM896 742.99392l-213.34016-213.34016-366.32576 366.32576 537.00608 0q17.67424 0 30.16704-12.4928t12.4928-30.16704l0-110.32576zM853.34016 128l-682.65984 0q-17.67424 0-30.16704 12.4928t-12.4928 30.16704l0 682.65984q0 17.67424 12.4928 30.16704t30.16704 12.4928l25.00608 0 486.99392-486.99392 213.34016 213.34016 0-451.66592q0-17.67424-12.4928-30.16704t-30.16704-12.4928zM341.34016 213.34016q53.00224 0 90.50112 37.49888t37.49888 90.50112-37.49888 90.50112-90.50112 37.49888-90.50112-37.49888-37.49888-90.50112 37.49888-90.50112 90.50112-37.49888zM341.34016 298.65984q-17.67424 0-30.16704 12.4928t-12.4928 30.16704 12.4928 30.16704 30.16704 12.4928 30.16704-12.4928 12.4928-30.16704-12.4928-30.16704-30.16704-12.4928z",fill:"#444444","p-id":"27356"},null)]),Ec=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"28365",width:"1em",height:"1em"},[L("path",{d:"M622.95253333 327.29173333l0.02133334-224.4384H176.6688V921.14133333h670.72853333V327.29173333H622.95253333z m5.1552 195.20533334c-9.32266667-19.97866667-28.90666667-28.61866667-46.624-30.93866667-17.4432-2.34346667-33.1712 1.17973333-44.7872 3.58826667v153.4144c1.2448 22.29866667-12.25066667 46.25066667-36.144 60.04693333-31.80586667 18.3552-70.0032 11.75253333-85.3056-14.752-15.3024-26.5088-1.92213333-62.88 29.8848-81.2416 24.368-14.0736 52.48853333-13.49013333 71.18826667-0.53013333V489.48266667l-0.12053333-0.0544 0.12053333-0.2784V442.35733333c0-5.64266667 4.57066667-10.30613333 10.208-10.31146666a10.18026667 10.18026667 0 0 1 9.16266667 5.86026666c16.0512 13.97013333 31.22346667 19.11466667 48.1472 25.62453334 13.45173333 5.19466667 25.44 13.16693333 32.98666666 24.08533333 7.73333333 10.6656 11.0208 24.26346667 11.328 34.9568l-0.0448-0.07573333z",fill:"#2C2C2C","p-id":"28366"},null),L("path",{d:"M833.74933333 293.94026667L656.82346667 119.28533333l0.28373333 174.65386667z",fill:"#2C2C2C","p-id":"28367"},null)]),Sc=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"30241",width:"1em",height:"1em"},[L("path",{d:"M838.85646561 290.47900106L659.12225186 113.05176719l0.28823703 177.42615027z",fill:"#2C2C2C","p-id":"30242"},null),L("path",{d:"M624.71368465 324.35985608l0.02167197-228.00091428H171.34608254V927.63564021h681.37501799V324.35985608H624.71368465z m13.17655027 250.27210159c-0.75418413 2.25821799-3.01240211 3.76658624-5.27062011 5.27603809L437.46255238 699.71166138c-7.53425608 5.2771217-18.08633227 3.01240211-23.35695238-5.27062011a20.12783068 20.12783068 0 0 1-2.25821799-9.04370794V446.53985186c0-9.79897566 7.53425608-17.33323175 17.33214815-17.33323175 3.01240211 0 6.02480424 0.75526773 9.04262433 2.26471957l194.4082963 119.8090836c7.51800211 4.51535238 10.53040424 15.06201059 5.25978413 23.35153439z",fill:"#2C2C2C","p-id":"30243"},null)]),Mc=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"31313",width:"1em",height:"1em"},[L("path",{d:"M112 16h736v992H112z",fill:"#EDF2F9","p-id":"31314"},null),L("path",{d:"M480 576a128 128 0 1 0 0 256 128 128 0 0 0 0-256z m0 192a64 64 0 1 1 0-128 64 64 0 0 1 0 128z",fill:"#C2CDDC","p-id":"31315"},null),L("path",{d:"M480 784c44.192 0 80-35.808 80-80s-35.808-80-80-80-80 35.808-80 80 35.808 80 80 80z m0-128a48 48 0 1 1 0 96 48 48 0 0 1 0-96z m-176 80h36.016a144.208 144.208 0 0 0 18.576 44.16l-25.664 25.664a15.984 15.984 0 0 0 0 22.624l22.624 22.624a15.984 15.984 0 0 0 22.624 0l25.536-25.536a141.92 141.92 0 0 0 44.304 18.768V880a16 16 0 0 0 16 16h32a16 16 0 0 0 16-16v-35.68a141.92 141.92 0 0 0 44.304-18.768l25.536 25.536a15.984 15.984 0 0 0 22.624 0l22.624-22.624a15.984 15.984 0 0 0 0-22.624l-25.664-25.664a143.824 143.824 0 0 0 18.576-44.16H656a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-36.016a144.208 144.208 0 0 0-18.576-44.16l25.664-25.664a15.984 15.984 0 0 0 0-22.624l-22.624-22.624a15.984 15.984 0 0 0-22.624 0l-25.536 25.536a142.288 142.288 0 0 0-44.304-18.768V528a16 16 0 0 0-16-16h-32a16 16 0 0 0-16 16v35.68a142.288 142.288 0 0 0-44.304 18.768l-25.536-25.536a15.984 15.984 0 0 0-22.624 0l-22.624 22.624a15.984 15.984 0 0 0 0 22.624l25.664 25.664a143.824 143.824 0 0 0-18.576 44.16H304a16 16 0 0 0-16 16v32A16 16 0 0 0 304 736z m176-144a112 112 0 1 1 0 224 112 112 0 0 1 0-224zM896 128h-32V32a32 32 0 0 0-32-32H128a32 32 0 0 0-32 32v960a32 32 0 0 0 32 32h704a32 32 0 0 0 32-32V416h32a32 32 0 0 0 32-32V160a32 32 0 0 0-32-32z m-64 0H448a32 32 0 0 0-32 32v224a32 32 0 0 0 32 32h384v576H128V32h704v96z",fill:"#8592A5","p-id":"31316"},null),L("path",{d:"M603.952 214.112v20.8h-47.824v27.2h36.624v20h-36.624v27.76h47.824v20.8h-75.04v-116.56h75.04zM648.032 270.752l-36.08-56.64h27.04a8.48 8.48 0 0 1 3.872 0.688 5.824 5.824 0 0 1 2.192 2.288l23.216 39.28a13.376 13.376 0 0 1 0.912-2c0.336-0.64 0.736-1.312 1.152-2l20.336-34.896c1.328-2.24 3.136-3.36 5.44-3.36h25.92l-36.56 55.44 37.376 61.12h-27.056a6.688 6.688 0 0 1-4.272-1.28 10.016 10.016 0 0 1-2.608-3.024l-23.344-40.816a15.84 15.84 0 0 1-1.456 3.04l-21.76 37.76a11.008 11.008 0 0 1-2.56 3.008 6.016 6.016 0 0 1-4 1.312h-25.264l37.504-59.92zM808.288 214.112v20.8h-47.84v27.2h36.624v20h-36.624v27.76h47.84v20.8h-75.04v-116.56h75.04z",fill:"#FFFFFF","p-id":"31317"},null)]),Ac=L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"21634",width:"1em",height:"1em"},[L("path",{d:"M640 42.688H170.688A42.688 42.688 0 0 0 128 85.376v853.312c0 23.616 19.072 42.688 42.688 42.688h682.688a42.688 42.688 0 0 0 42.752-42.688v-640c-100.16-99.968-156.16-156.096-256.128-256zM499.2 853.312a42.688 42.688 0 1 1 0-85.376 42.688 42.688 0 0 1 0 85.376z m88-239.36c-26.496 13.568-42.688 23.936-48.384 31.168-9.6 11.072-18.304 27.2-18.24 37.568q0.128 10.88 0 42.688h-51.2v-42.688c0-36.16 8.704-48.512 17.408-62.912 7.68-11.072 19.008-21.504 33.984-31.104 33.856-19.264 54.208-31.744 61.504-37.568 22.208-18.816 33.28-41.92 33.28-69.376 0-38.656-17.344-65.6-52.032-81.024a125.632 125.632 0 0 0-51.328-10.112c-49.216 0-83.392 22.72-102.72 68.032l-9.344 28.16c-1.024 3.904-1.728 8.192-2.24 12.992l-56.384-12.288c11.072-69.376 45.12-115.008 102.016-136.704a194.56 194.56 0 0 1 72.96-12.992c54.016 0 96.896 16.384 128.704 49.216l15.232 18.112c13.952 21.696 21.504 46.976 22.4 75.904-0.128 54.848-32 99.2-95.616 132.992zM640 298.752V128l170.688 170.688H640z",fill:"#515151","p-id":"21635"},null)]);function _c(e){switch(e){case"text/csv":case"text/plain":return wc;case"application/pdf":return mc;case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return xc;case"image/jpeg":case"image/png":case"image/gif":return Cc;case"audio/mpeg":case"audio/wav":case"audio/ogg":return Ec;case"video/mp4":case"video/x-msvideo":case"video/x-matroska":return Sc;case"application/zip":case"application/x-rar-compressed":return kc;case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-excel":return bc;case"application/x-msdownload":case"application/x-apple-diskimage":return Mc;default:return Ac}}var Pc=c({name:"UploadCustom",props:{modal:{type:Object,required:!0},context:{type:Object,default:function(){}},viewParams:{type:Object,default:function(){}},actionParams:{type:Object,default:function(){}},accept:{type:String,default:""}},setup:function(e){var t=ne("upload-custom"),n=function(e){var t=f([]),n={"audio/*":"音频"},i=f({Authorization:"Bearer ".concat(we(Ee.TOKEN))}),r=f(""),o=f(""),a={count:0,cacheFiles:[]},s=D((function(){return a.count}));if(e.context&&e.actionParams){var l=ibiz.util.file.calcFileUpDownUrl(e.context,e.viewParams,{},e.actionParams);r.value=l.uploadUrl,o.value=l.downloadUrl}var u=function(){var t=a.cacheFiles,n=t.length>0?t:null;a.cacheFiles=[],e.modal.dismiss({ok:!0,data:n})},c=f(),h=D((function(){return e.multiple?9999:1}));return{uploadUrl:r,headers:i,files:t,limit:h,filesCount:s,uploadRef:c,onError:function(){var e=arguments.length<=0?void 0:arguments[0];throw a.count-=1,new Le({response:{data:JSON.parse(e.message),status:e.status}})},onRemove:function(n){if(!e.disabled){if(0===a.count){var i=a.cacheFiles.findIndex((function(e){return n.response&&e.id===n.response.id}));-1!==i&&a.cacheFiles.splice(i,1)}var r=t.value.findIndex((function(e){return e.id===n.id}));-1!==r&&t.value.splice(r,1)}},onItemRemove:function(e){c.value&&c.value.handleRemove(e)},onSuccess:function(e,t){var n;e&&(a.cacheFiles.push({id:e.fileid,name:e.filename,ext:e.ext,folder:e.folder,size:e.size,type:(null===(n=t.raw)||void 0===n?void 0:n.type)||"",url:e.rul||o.value.replace("%fileId%",e.fileid)}),a.count-=1)},beforeUpload:function(t){var n=t.size/1024/1024;return e.size&&n>e.size?(ibiz.message.error("".concat(ibiz.i18n.t("editor.upload.fileSizeErr")," ").concat(e.size,"MB!")),!1):(a.count+=1,!0)},onConfirm:function(){u()},onCancel:function(){a.cacheFiles=[],u()},getUploadMessage:function(e){return"点击上传".concat(n[e]||"","文件")}}}(M(M({},e),{},{multiple:!0})),i=n.uploadUrl,r=n.headers;return{ns:t,files:n.files,limit:n.limit,uploadUrl:i,headers:r,uploadRef:n.uploadRef,getUploadMessage:n.getUploadMessage,onError:n.onError,onRemove:n.onRemove,onItemRemove:n.onItemRemove,onSuccess:n.onSuccess,beforeUpload:n.beforeUpload,onConfirm:n.onConfirm,onCancel:n.onCancel}},render:function(){var e=this;return L("div",{class:[this.ns.b()]},[L("div",{class:[this.ns.e("center")]},[L(j("el-upload"),{class:[this.ns.em("center","upload")],ref:"uploadRef",modelValue:this.files,"onUpdate:modelValue":function(t){return e.files=t},action:this.uploadUrl,headers:this.headers,limit:this.limit,multiple:!0,accept:this.accept,drag:!0,"auto-upload":!0,"before-upload":this.beforeUpload,onSuccess:this.onSuccess,onError:this.onError,onRemove:this.onRemove},{default:function(){return L("div",{class:e.ns.e("message")},[L("span",{class:e.ns.em("message","icon")},[L("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",width:"1em",height:"1em"},[L("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"},null)])]),L("span",{class:e.ns.em("message","caption")},[e.getUploadMessage(e.accept)])])},file:function(t){var n,i,r,o=t.file;return[L("div",{class:"el-upload-list__item-info"},[L("a",{class:"el-upload-list__item-name"},[L("i",{class:"el-icon el-icon--document"},[_c((null===(n=o.raw)||void 0===n?void 0:n.type)||"")]),L("span",{class:"el-upload-list__item-file-name",title:null===(i=o.raw)||void 0===i?void 0:i.name},[null===(r=o.raw)||void 0===r?void 0:r.name])]),"uploading"===o.status&&L(j("el-progress"),{type:"line","stroke-width":"2",percentage:Number(o.percentage),style:"margin-top: 0.5rem"},null),L("label",{class:"el-upload-list__item-status-label"},[L("i",{class:"el-icon el-icon--upload-success el-icon--circle-check"},[L("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[L("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"},null),L("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null)])])]),L("i",{class:"el-icon el-icon--close",onClick:function(){return e.onItemRemove(o)}},[L("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[L("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null)])])])]}})]),L("div",{class:[this.ns.e("bottom")]},[L(j("el-button"),{onClick:this.onCancel},{default:function(){return[N("取消")]}}),L(j("el-button"),{onClick:this.onConfirm},{default:function(){return[N("确认")]}})])])}}),Oc=c({name:"IBizHtmlInsertSelect",props:{modal:{type:Object,required:!0},context:{type:Object,default:function(){}},viewParams:{type:Object,default:function(){}},actionParams:{type:Object,default:function(){}}},emits:["select"],setup:function(e){var t=ne("html-insert-select"),n=f(""),i=f([]),r=f({}),o=f([]),a=f({}),s=function(){var t=E(x().mark((function t(n){var i,r,o;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="audio"===n.type?"audio/*":"",r={ok:!0,data:[]},t.next=4,ibiz.overlay.modal((function(t){return U(Pc,{modal:t,context:e.context,viewParams:e.viewParams,actionParams:e.actionParams,accept:i})}),void 0,{width:"auto",height:"auto"});case 4:(o=t.sent).ok&&o.data&&o.data.length>0&&o.data.forEach((function(e){var t;null===(t=r.data)||void 0===t||t.push({type:n.type,value:e,params:{isAdd:!0}})})),e.modal.dismiss(r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=function(t){var n={ok:!0,data:[{type:t.type,value:t.value,params:{isAdd:!0}}]};e.modal.dismiss(n)},u=function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="audio"===e.t0||"files"===e.t0?3:6;break;case 3:return e.next=5,s(t);case 5:return e.abrupt("break",8);case 6:return l(t),e.abrupt("break",8);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return _((function(){var e;r.value={},e=pc(),Object.assign(r.value,{frequently:[]}),e.filter((function(e){return!o.value.includes(e)})).forEach((function(e){var t=e.category;r.value[t]||Object.assign(r.value,O({},t,[])),r.value[t].push(e)})),i.value=[new ac("base","","基础"),new ac("graph","","图形"),new ac("file","","文件")],function(e){e.forEach((function(e){Object.assign(a.value,O({},e.type,e))}))}(i.value)})),{ns:t,mapInsertItems:r,mapCategories:a,searchVal:n,onSelectItem:u}},render:function(){var e=this,t=L("div",{class:[this.ns.b("search")]},[L("div",{class:this.ns.be("search","container")},[L("div",{class:this.ns.bem("search","container","search")},[L("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",height:"1em",width:"1em",focusable:"false"},[L("g",{"stroke-width":"1"},[L("path",{d:"M6.751 12.303A5.557 5.557 0 0 1 1.2 6.751C1.2 3.691 3.69 1.2 6.751 1.2a5.558 5.558 0 0 1 5.551 5.551 5.557 5.557 0 0 1-5.551 5.552M6.751 0a6.751 6.751 0 1 0 4.309 11.949l3.855 3.855a.6.6 0 1 0 .849-.849l-3.854-3.853A6.751 6.751 0 0 0 6.751 0"},null)])])]),F(L("input",{class:this.ns.bem("search","container","input"),type:"text","onUpdate:modelValue":function(t){return e.searchVal=t},placeholder:ibiz.i18n.t("app.search")},null),[[H,this.searchVal]])])]);return L("div",{class:this.ns.b()},[t,L(yc,{data:this.mapInsertItems,filter:this.searchVal,categories:this.mapCategories,onSelect:this.onSelectItem},null)])}}),Tc={name:"zh-cn",el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"}}},Lc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ibiz.overlay.createPopover((function(t){return U(e,M({modal:t},n))}),void 0,M({width:"auto",height:"auto",noArrow:!0,autoClose:!0,placement:"bottom-start"},t))};function jc(){return{data:{type:Object,required:!0},change:{type:Function,required:!0},nodeKey:{type:String,default:""},isFocus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}}}var Nc=function(e){(document.getElementsByClassName(e)||[]).forEach((function(e){e.remove()}))},Dc=c({name:"IBizDateSelect",props:jc(),emits:["change"],setup:function(e){var t=ne("date-select"),n=f(),i=f("");e.data&&(i.value=vt(e.data).format("YYYY-MM-DD")),e.isFocus&&C(n,(function(e){e&&e.focus&&e.focus()}));return{ns:t,dateVal:i,dateRef:n,handleChange:function(t){var n=vt(t).format("YYYY-MM-DD");i.value=n;var r=setTimeout((function(){e.change(n),clearTimeout(r),r=null}),200)}}},render:function(){var e=this;return L("div",{class:[this.ns.b(),this.readonly?this.ns.m("readonly"):""]},[L(j("el-date-picker"),{ref:"dateRef","popper-class":[this.ns.e("popover"),"".concat(this.nodeKey)],modelValue:this.dateVal,"onUpdate:modelValue":function(t){return e.dateVal=t},onChange:this.handleChange},null)])}}),Ic=c({name:"IBizLabelSelect",props:jc(),setup:function(e){var t=ne("label-select"),n=function(e){return e.replace(")",",0.196)")},i=["rgba(207, 207, 207)","rgb(255, 117, 117)","rgb(246, 198, 89)","rgb(115, 216, 151)","rgb(210, 135, 248)","rgb(86, 171, 251)"],r=f(),o=f(),a=f(),s=z({color:i[0],bgColor:n(i[0]),labelName:""}),l=f("");null!=e&&e.data&&(Object.assign(s,null==e?void 0:e.data),l.value=null==e?void 0:e.data.labelName),e.isFocus&&C(a,(function(e){e&&e.click&&e.click()}));var u=function(){var t=E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=void 0,l.value&&(n={color:s.color,bgColor:s.bgColor,labelName:l.value}),e.change(n,{isDelete:!l.value});case 1:case"end":return t.stop()}var n}),t)})));return function(){return t.apply(this,arguments)}}();return{ns:t,curData:s,inputVal:l,inputRef:r,popoverRef:o,labelConfig:i,referenceRef:a,onInput:function(){s.labelName=l.value},handleColorItemClick:function(e){s.color=e,s.bgColor=n(e)},handleAfterEnter:function(){e.isFocus&&r.value&&r.value.focus()},handleAfterLeave:u,calcAlpha:n}},render:function(){var e=this,t=L("div",{ref:"referenceRef",class:this.ns.e("reference"),style:{backgroundColor:"".concat(this.curData.bgColor),color:this.curData.color===this.labelConfig[0]?"":this.curData.color}},[this.curData.labelName||"设置标签"]),n=L(j("el-popover"),{trigger:"click",ref:"popoverRef",width:"200px","hide-after":0,"popper-class":[this.ns.e("popover"),"".concat(this.nodeKey)],onAfterEnter:this.handleAfterEnter,onAfterLeave:this.handleAfterLeave},{default:function(){return L("div",{class:e.ns.em("popover","content")},[F(L("input",{ref:"inputRef",class:e.ns.em("popover","input"),type:"text","onUpdate:modelValue":function(t){return e.inputVal=t},onInput:function(){return e.onInput()},placeholder:"输入标签名称"},null),[[H,e.inputVal]]),L("div",{class:e.ns.em("popover","color-box")},[e.labelConfig.map((function(t,n){return L("div",{class:e.ns.em("popover","color-item"),style:"background-color: ".concat(0===n?e.calcAlpha(t):t),onClick:function(){return e.handleColorItemClick(t)}},[t===e.curData.color?L("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",height:"1em",width:"1em"},[L("g",{"stroke-width":"1","fill-rule":"evenodd"},[L("path",{d:"M13.993 3l1.364 1.364-9.311 9.31-.01-.01-.008.01L0 7.645l1.362-1.363 4.674 4.673L13.993 3z"},null)])]):""])}))])])},reference:function(){return t}});return L("div",{class:[this.ns.b(),this.readonly?this.ns.m("readonly"):""]},[this.readonly?t:n])}}),Rc=["rgb(0, 0, 0)","rgb(38, 38, 38)","rgb(89, 89, 89)","rgb(140, 140, 140)","rgb(191, 191, 191)","rgb(217, 217, 217)","rgb(233, 233, 233)","rgb(245, 245, 245)","rgb(250, 250, 250)","rgb(255, 255, 255)","rgb(225, 60, 57)","rgb(231, 95, 51)","rgb(235, 144, 58)","rgb(245, 219, 77)","rgb(114, 192, 64)","rgb(89, 191, 192)","rgb(66, 144, 247)","rgb(54, 88, 226)","rgb(106, 57, 201)","rgb(216, 68, 147)","rgb(251, 233, 230)","rgb(252, 237, 225)","rgb(252, 239, 212)","rgb(252, 251, 207)","rgb(231, 246, 213)","rgb(218, 244, 240)","rgb(217, 237, 250)","rgb(224, 232, 250)","rgb(237, 225, 248)","rgb(246, 226, 234)","rgb(255, 163, 158)","rgb(255, 187, 150)","rgb(255, 213, 145)","rgb(255, 251, 143)","rgb(183, 235, 143)","rgb(135, 232, 222)","rgb(145, 213, 255)","rgb(173, 198, 255)","rgb(211, 173, 247)","rgb(255, 173, 210)","rgb(255, 77, 79)","rgb(255, 122, 69)","rgb(255, 169, 64)","rgb(255, 236, 61)","rgb(115, 209, 61)","rgb(54, 207, 201)","rgb(64, 169, 255)","rgb(89, 126, 247)","rgb(146, 84, 222)","rgb(247, 89, 171)","rgb(207, 19, 34)","rgb(212, 56, 13)","rgb(212, 107, 8)","rgb(212, 177, 6)","rgb(56, 158, 13)","rgb(8, 151, 156)","rgb(9, 109, 217)","rgb(29, 57, 196)","rgb(83, 29, 171)","rgb(196, 29, 127)","rgb(130, 0, 20)","rgb(135, 20, 0)","rgb(135, 56, 0)","rgb(97, 71, 0)","rgb(19, 82, 0)","rgb(0, 71, 79)","rgb(0, 58, 140)","rgb(6, 17, 120)","rgb(34, 7, 94)","rgb(120, 6, 80)"],Bc=[{type:"success",text:"成功",color:"rgb(103,194,58,0.2)",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' style='fill:rgb(103,194,58)'> <g stroke-width='1' fill-rule='evenodd'> <path d='M0 8c0-4.4 3.6-8 8-8s8 3.6 8 8-3.6 8-8 8-8-3.6-8-8zm7.097.758L5.199 6.905l-.978 1.001 2.9 2.833 4.563-4.685-1.003-.977-3.584 3.68z'></path> </g></svg>"},{type:"danger",text:"危险",color:"rgb(245,108,108,0.2)",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' style='fill:rgb(245,108,108)'> <g stroke-width='1' fill-rule='evenodd'> <path d='M0 8c0-4.4 3.6-8 8-8s8 3.6 8 8-3.6 8-8 8-8-3.6-8-8zm9.005.021l1.777-1.793-.994-.986-1.769 1.784L6.28 5.27l-.995.985 1.75 1.767-1.766 1.782.995.985 1.756-1.772 1.702 1.718.995-.985L9.005 8.02z'></path> </g></svg>"},{type:"warning",text:"警告",color:"rgb(230,162,60,0.2)",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' style='fill:rgb(230,162,60)'> <g stroke-width='1' fill-rule='evenodd'> <path d='M9.718 2.496l5.588 9.387a2 2 0 0 1-1.718 3.023H2.412a2 2 0 0 1-1.718-3.023L6.28 2.496a2 2 0 0 1 3.437 0zm-2.447 9.496v1.457h1.457v-1.457H7.271zm-.363-5.84l.363 4.384h1.457l.376-4.385H6.908z'></path> </g></svg>"},{type:"prompt",text:"提示",color:"rgb(64,158,255,0.2)",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' style='fill:rgb(64,158,255)'> <g stroke-width='1' fill-rule='evenodd'> <path d='M0 8c0-4.4 3.6-8 8-8s8 3.6 8 8-3.6 8-8 8-8-3.6-8-8zm7.332-1.005l-.03 5.031 1.4.007L8.732 7l-1.4-.006zm0-3.052l-.03 1.732 1.4.006.03-1.731-1.4-.007z'></path> </g></svg>"},{type:"add-emoji",text:"添加表情",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M14.727 7h1.211A8 8 0 1 1 11.206.668L10.795 1.8A6.8 6.8 0 1 0 14.727 7zm-.226-1h1.247-1.247zM5 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm6.97 1.5a4 4 0 0 1-7.94 0h1.215a2.8 2.8 0 0 0 5.51 0h1.214zM11 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm2.264-5.177V1.459h1.2v1.364h1.364v1.2h-1.364v1.363h-1.2V4.023H11.9v-1.2h1.364z'></path> </g></svg>"},{type:"delete-emoji",text:"删除表情",icon:"<svg viewBox='0 0 16 16' version='1.1' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M1.90326777,1.07326956 L14.9701984,14.1861127 C15.2041017,14.4208379 15.2034355,14.8007363 14.9687103,15.0346396 C14.7339852,15.2685429 14.3540868,15.2678766 14.1201835,15.0331515 L1.05325285,1.9203083 C0.819349557,1.68558316 0.8200158,1.30568475 1.05474094,1.07178147 C1.28946608,0.837878178 1.66936449,0.838544422 1.90326777,1.07326956 Z M1.78392959,4.77808157 L2.68262793,5.6799605 C2.37220548,6.39042724 2.2,7.17510325 2.2,8 C2.2,11.2032515 4.79674845,13.8 8,13.8 C8.81790048,13.8 9.59625958,13.6307032 10.3019463,13.3252407 L11.199833,14.2274912 C10.2408005,14.7212594 9.15295194,15 8,15 C4.13400675,15 1,11.8659932 1,8 C1,6.83818849 1.28304083,5.7424847 1.78392959,4.77808157 Z M8,1 C11.8659932,1 15,4.13400675 15,8 C15,9.18355772 14.7062644,10.2985098 14.1877157,11.2759337 L13.2919736,10.3773191 C13.6183874,9.65183814 13.8,8.84712801 13.8,8 C13.8,4.79674845 11.2032515,2.2 8,2.2 C7.15989239,2.2 6.36150251,2.37861488 5.640734,2.69994102 L4.7450393,1.80120321 C5.71742699,1.28955298 6.82489914,1 8,1 Z'></path> </g></svg>"},{type:"separator",text:"|"},{type:"background-color",text:"背景色",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M3.58 8.165l2.092 1.209L3.86 12.51l4.9.01.592-1.021 1.39.803 4.138-7.165L7.717 1 3.58 8.165zm1.639-.44L8.156 2.64l5.085 2.936-2.935 5.087-5.087-2.937z'></path> <path d='M1 15.064h11.997v-1.201H1z'></path> </g></svg>"},{type:"separator",text:"|"},{type:"delete",text:"删除",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z'></path> </g></svg>"}];function zc(){return Bc}var Fc=c({name:"IBizPromptBoxSelect",props:jc(),emits:["change"],setup:function(e){var t=ne("prompt-box-select"),n=f(""),i=f(""),r=f(""),o=f(null),a=f(null),s=f(null),l=f(),u=f(),c=f([]),h=f([]);if(c.value=Rc,h.value=zc(),n.value=h.value[0].color,i.value=h.value[0].icon,e.data){var d=e.data,v=d.color,g=d.icon,p=d.text;n.value=v,i.value=je(g),r.value=p}var y=new ResizeObserver((function(){var e;u.value&&0!==u.value.offsetWidth&&(null===(e=u.value)||void 0===e||e.click(),y=null)}));e.isFocus&&(C(u,(function(e){e&&e.click&&y.observe(e)})),C(l,(function(e){e&&e.focus&&e.focus()})));var m=function(e){var t,n={ok:!0,data:[{emoji:Te(e.data)}]};null===(t=a.value)||void 0===t||t.dismiss(n)},w=function(e){var t;null===(t=s.value)||void 0===t||t.dismiss({ok:!0,data:[e]})},b=function(){var e=E(x().mark((function e(t){var n,r,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.value||(a.value=Lc(oc,{},{dark:!0,continuousList:!0,onSelect:m})),e.next=3,a.value.present(t.target);case 3:return e.next=5,a.value.onWillDismiss();case 5:o=e.sent,s=null===(n=o.data)||void 0===n?void 0:n[0],o.ok&&s&&(i.value="".concat(je(s.emoji))),a.value=null,null===(r=l.value)||void 0===r||r.focus();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=E(x().mark((function e(i){var r,o,a,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.value||(s.value=Lc((h=c.value,L("div",{class:t.be("background-popover","content")},[L("ul",{class:t.be("background-popover","list")},[L("li",{class:t.be("background-popover","list-item-clear"),onClick:function(){return w("")}},[L("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em"},[L("path",{d:"M236.8 128L896 787.2V128H236.8z m614.4 704L192 172.8V832h659.2zM192 64h704c38.4 0 64 25.6 64 64v704c0 38.4-25.6 64-64 64H192c-38.4 0-64-25.6-64-64V128c0-38.4 25.6-64 64-64z"},null)]),N("清除背景色")]),h.map((function(e){return L("li",{class:t.be("background-popover","list-item"),onClick:function(){return w(e)}},[L("div",{class:t.bem("background-popover","list-item","color-block"),style:{backgroundColor:e}},null)])}))])])))),e.next=3,s.value.present(i.target);case 3:return e.next=5,s.value.onWillDismiss();case 5:a=e.sent,u=null===(r=a.data)||void 0===r?void 0:r[0],a.ok&&(n.value="".concat(u)),s.value=null,null===(o=l.value)||void 0===o||o.focus();case 10:case"end":return e.stop()}var h}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var t=E(x().mark((function t(){var n,i,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(n=o.value)||void 0===n?void 0:n.dismiss();case 2:return t.next=4,null===(i=a.value)||void 0===i?void 0:i.dismiss();case 4:return t.next=6,null===(r=s.value)||void 0===r?void 0:r.dismiss();case 6:e.change("",{isDelete:!0});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),M=function(e,t){var r;if("separator"!==e.type)switch(null===(r=l.value)||void 0===r||r.focus(),e.type){case"add-emoji":b(t);break;case"background-color":k(t);break;case"delete":S();break;case"delete-emoji":i.value="";break;default:!function(e){var t;e.color&&(n.value=e.color,i.value=e.icon),null===(t=l.value)||void 0===t||t.focus()}(e)}},A=function(){var a=E(x().mark((function a(){var s;return x().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return null===(s=l.value)||void 0===s||s.focus(),o.value=Lc(L("div",{class:t.be("popover","content")},[h.value.map((function(e){return L("div",{class:[t.be("popover","tool-item"),t.be("popover","tool-item-".concat(e.type)),t.is("activated",i.value===e.icon)],title:e.text,onClick:function(t){return M(e,t)}},[L("div",{class:t.bem("popover","tool-item","content"),innerHTML:e.icon||e.text},null)])}))]),{placement:"top-start"}),a.next=4,o.value.present(u.value);case 4:return a.next=6,o.value.onWillDismiss();case 6:c=void 0,c={color:n.value,icon:Te(i.value),text:r.value},e.change(c),o.value=null;case 8:case"end":return a.stop()}var c}),a)})));return function(){return a.apply(this,arguments)}}();return{ns:t,curColor:n,curIcon:i,curText:r,inputRef:l,referenceRef:u,toolBars:h,handleToolItemClick:M,onOpenTopPopover:A}},render:function(){var e=this;return L("div",{class:[this.ns.b(),this.readonly?this.ns.m("readonly"):""]},[L("div",{ref:"referenceRef",class:this.ns.e("reference"),style:{backgroundColor:this.curColor},onClick:this.onOpenTopPopover},[this.curIcon?L("div",{class:[this.ns.em("reference","icon")],innerHTML:this.curIcon},null):"",L(j("el-input"),{ref:"inputRef",modelValue:this.curText,"onUpdate:modelValue":function(t){return e.curText=t},type:"text",autofocus:!0},null)])])}}),Vc=new J(u.meta.url),Hc=function(){return P((function e(){A(this,e)}),null,[{key:"getMathJax",value:function(){return window.MathJax}},{key:"loadScript",value:function(e){return new Promise((function(t,n){var i=document.createElement("script");i.src=e,i.onload=t,i.onerror=n,document.head.appendChild(i)}))}},{key:"initMathJax",value:function(e){window.MathJax={tex:{inlineMath:[["$","$"]],processEnvironments:!0,processRefs:!0},options:{skipHtmlTags:["noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore"},startup:{pageReady:function(){return e&&e()}},svg:{fontCache:"global"}}}},{key:"renderFormula",value:function(e){return window.MathJax&&window.MathJax.typesetPromise?(e&&!Array.isArray(e)&&(e=[e]),window.MathJax.typesetPromise(e)):Promise.reject()}},{key:"loadMathJax",value:function(){var e=this;return new Promise((function(t,n){if(e.getMathJax())t();else{e.initMathJax();var i=[e.loadScript(Vc.dir("assets/mathjax/plugins/js/tex-svg.js"))];Promise.all(i).then((function(){t()})).catch((function(){ibiz.message.error("加载mathJax静态资源失败,请确认静态资源是否存在！"),n()}))}}))}}])}();function Uc(){}var qc='<p data-we-empty-p=""><br></p>',Gc="#ee7959",Jc=["Control","Escape","Tab","CapsLock","Shift","Meta","Alt","ArrowLeft","ArrowUp","ArrowDown","ArrowRight","Enter","Backspace","Delete","Insert","c","v","z"],Wc=[" ","{","}"];function Yc(e){return Array.prototype.slice.call(e)}function Zc(e){return e=e.replace(/[A-Za-z0-9]+/g,(function(e){return'<span style="color: '.concat(Gc,'">').concat(e,"</span>")})),"<span>".concat(e,"</span>&nbsp;")}function Kc(e){return'<div class="me-menu-item"><span class="icon">$'.concat(e,"$</span></div>")}var Xc=new(function(){return P((function e(){A(this,e),O(this,"_ua",void 0),O(this,"isOldEdge",void 0),O(this,"isFirefox",void 0),this._ua=navigator.userAgent;var t=this._ua.match(/(Edge?)\/(\d+)/);this.isOldEdge=!!(t&&"Edge"===t[1]&&parseInt(t[2])<19),this.isFirefox=!(!/Firefox\/\d+/.test(this._ua)||/Seamonkey\/\d+/.test(this._ua))}),[{key:"isIE",value:function(){return"ActiveXObject"in window}},{key:"isWebkit",value:function(){return/webkit/i.test(this._ua)}}])}()),$c=[];function Qc(e){var t=[];return(Array.isArray(e)?e:e.split(";")).forEach((function(e){var n=e.split(":").map((function(e){return e.trim()}));2===n.length&&t.push("".concat(n[0],":").concat(n[1]))})),t}var eh=function(){function e(t){if(A(this,e),O(this,"selector",void 0),O(this,"length",void 0),O(this,"elems",void 0),O(this,"dataSource",void 0),O(this,"prior",void 0),this.elems=[],this.length=this.elems.length,this.dataSource=new Map,t){if(t instanceof e)return t;var n=[],i=t instanceof Node?t.nodeType:-1;if(this.selector=t,1===i||9===i)n=[t];else if(function(e){return!!e&&(e instanceof HTMLCollection||e instanceof NodeList)}(t))n=Yc(t);else if(t instanceof Array)n=t;else if("string"==typeof t){var r=t.replace("/\n/mg","").trim();n=0===r.indexOf("<")?function(e){var t=document.createElement("div");return t.innerHTML=e,Yc(t.children)}(r):function(e){return Yc(document.querySelectorAll(e))}(r)}var o=n.length;if(!o)return this;for(var a=0;a<o;a++)this.elems.push(n[a]);this.length=o}}return P(e,[{key:"id",get:function(){return this.elems[0].id}},{key:"forEach",value:function(e){for(var t=0;t<this.length;t++){var n=this.elems[t];if(!1===e.call(n,n,t))break}return this}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[];return this.elems.forEach((function(n){t.push(n.cloneNode(!!e))})),th(t)}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.length;return e>=t&&(e%=t),th(this.elems[e])}},{key:"first",value:function(){return this.get(0)}},{key:"last",value:function(){var e=this.length;return this.get(e-1)}},{key:"on",value:function(e,t,n){return e?("function"==typeof t&&(n=t,t=""),this.forEach((function(i){if(t){var r=function(e){var i=e.target;i.matches(t)&&n.call(i,e)};i.addEventListener(e,r),$c.push({elem:i,selector:t,fn:n,agentFn:r})}else i.addEventListener(e,n)}))):this}},{key:"off",value:function(e,t,n){return e?("function"==typeof t&&(n=t,t=""),this.forEach((function(i){if(t){for(var r=-1,o=0;o<$c.length;o++){var a=$c[o];if(a.selector===t&&a.fn===n&&a.elem===i){r=o;break}}if(-1!==r){var s=$c.splice(r,1)[0].agentFn;i.removeEventListener(e,s)}}else i.removeEventListener(e,n)}))):this}},{key:"attr",value:function(e,t){return void 0===t?this.elems[0].getAttribute(e)||"":this.forEach((function(n){n.setAttribute(e,t)}))}},{key:"removeAttr",value:function(e){this.forEach((function(t){t.removeAttribute(e)}))}},{key:"addClass",value:function(e){return e?this.forEach((function(t){if(t.className){var n=t.className.split(/\s/);(n=n.filter((function(e){return!!e.trim()}))).indexOf(e)<0&&n.push(e),t.className=n.join(" ")}else t.className=e})):this}},{key:"removeClass",value:function(e){return e?this.forEach((function(t){if(t.className){var n=t.className.split(/\s/);n=n.filter((function(t){return!(!(t=t.trim())||t===e)})),t.className=n.join(" ")}})):this}},{key:"hasClass",value:function(e){if(!e)return!1;var t=this.elems[0];return!!t.className&&t.className.split(/\s/).includes(e)}},{key:"css",value:function(e,t){var n;return n=""===t?"":"".concat(e,":").concat(t,";"),this.forEach((function(t){var i=(t.getAttribute("style")||"").trim();if(i){var r=Qc(i);r=r.map((function(t){return 0===t.indexOf(e)?n:t})),""!==n&&r.indexOf(n)<0&&r.push(n),""===n&&(r=Qc(r)),t.setAttribute("style",r.join("; "))}else t.setAttribute("style",n)}))}},{key:"getBoundingClientRect",value:function(){return this.elems[0].getBoundingClientRect()}},{key:"show",value:function(){return this.css("display","block")}},{key:"hide",value:function(){return this.css("display","none")}},{key:"children",value:function(){var e=this.elems[0];return e?th(e.children):null}},{key:"childNodes",value:function(){var e=this.elems[0];return e?th(e.childNodes):null}},{key:"replaceChildAll",value:function(e){for(var t=this.getNode(),n=this.elems[0];n.hasChildNodes();)t.firstChild&&n.removeChild(t.firstChild);this.append(e)}},{key:"append",value:function(e){return this.forEach((function(t){e.forEach((function(e){t.appendChild(e)}))}))}},{key:"remove",value:function(){return this.forEach((function(e){if(e.remove)e.remove();else{var t=e.parentElement;t&&t.removeChild(e)}}))}},{key:"isContain",value:function(e){var t=this.elems[0],n=e.elems[0];return t.contains(n)}},{key:"getNodeName",value:function(){return this.elems[0].nodeName}},{key:"getNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.elems[e]}},{key:"find",value:function(e){return th(this.elems[0].querySelectorAll(e))}},{key:"text",value:function(e){return void 0===e?this.elems[0].innerHTML.replace(/<[^>]+>/g,(function(){return""})):this.forEach((function(t){t.innerHTML=e}))}},{key:"html",value:function(e){var t=this.elems[0];return void 0===e?t.innerHTML:(t.innerHTML=e,this)}},{key:"val",value:function(){return this.elems[0].value.trim()}},{key:"focus",value:function(){return this.forEach((function(e){e.focus()}))}},{key:"prev",value:function(){return th(this.elems[0].previousElementSibling)}},{key:"next",value:function(){return th(this.elems[0].nextElementSibling)}},{key:"getNextSibling",value:function(){return th(this.elems[0].nextSibling)}},{key:"parent",value:function(){return th(this.elems[0].parentElement)}},{key:"parentUntil",value:function(e,t){var n=t||this.elems[0];if("BODY"===n.nodeName)return null;var i=n.parentElement;return i?i.matches(e)?th(i):this.parentUntil(e,i):null}},{key:"equal",value:function(t){return t instanceof e?this.elems[0]===t.elems[0]:t instanceof HTMLElement&&this.elems[0]===t}},{key:"insertBefore",value:function(e){var t=th(e).elems[0];return t?this.forEach((function(e){var n=t.parentNode;null==n||n.insertBefore(e,t)})):this}},{key:"insertAfter",value:function(e){var t=th(e).elems[0],n=t&&t.nextSibling;return t?this.forEach((function(e){var i=t.parentNode;n?i.insertBefore(e,n):i.appendChild(e)})):this}},{key:"data",value:function(e,t){if(void 0===t)return this.dataSource.get(e);this.dataSource.set(e,t)}},{key:"getNodeTop",value:function(e){if(this.length<1)return this;var t=this.parent();return e.$textLatexElem.equal(this)||e.$textLatexElem.equal(t)?this:(t.prior=this,t.getNodeTop(e))}},{key:"getOffsetData",value:function(){var e=this.elems[0];return{top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight,parent:e.offsetParent}}},{key:"scrollTop",value:function(e){this.elems[0].scrollTo({top:e})}},{key:"renderFormula",value:function(){return Hc.renderFormula(this.elems)}}])}();function th(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i(eh,t)}var nh={width:620,height:272,menuHeight:38,mathJaxUrl:"https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-svg.min.js"},ih={menus:["presets","operators","greekLetters","inequation","AdvancedMath","LinearAlgebra","arrows","Trigonometric"],presets:function(e){return[{label:e("fe.pt"),value:"a^2+b^2=c^2"},{label:e("fe.h"),value:"\\frac{x^2}{a^2}-\\frac{y^2}{b^2}=1"},{label:e("fe.tfr"),value:"\\sin^2\\theta +\\cos^2\\theta = 1"},{label:e("fe.d"),value:"\\left( e^x \\right) ' = e^x"},{label:e("fe.nl"),value:"\\int_a^b f(x) dx = F(b) - F(a)"}]},operators:["+","-","\\pm","\\mp","\\times","\\div","\\ast","\\cdot","\\cap","\\cup","\\aleph","\\Re","\\top","\\bot","\\infty","\\partial","\\forall","\\exists","\\neg","\\because","\\therefore","\\varnothing","\\frac{b}{a}","\\circ","\\bullet","\\prime","\\triangle","\\angle","\\surd","\\barwedge","\\veebar","\\odot","\\oplus","\\otimes","\\oslash","\\circledcirc","\\boxdot","\\bigtriangledown","\\dagger","\\diamond","\\star","\\triangleleft","\\triangleright"],greekLetters:["\\alpha","\\beta","\\gamma","\\delta","\\epsilon","\\zeta","\\eta","\\theta","\\iota","\\kappa","\\lambda","\\mu","\\nu","\\xi","\\omicron","\\pi","\\rho","\\sigma","\\tau","\\upsilon","\\phi","\\chi","\\psi","\\omega","\\varepsilon","\\vartheta","\\varpi","\\varrho","\\varsigma","\\varphi","\\Gamma","\\Delta","\\Theta","\\Lambda","\\Xi","\\Pi","\\Sigma","\\Upsilon","\\Phi","\\Psi","\\Omega"],inequation:["=","\\leq","\\geq","\\prec","\\succ","\\preceq","\\succeq","\\ll","\\gg","\\equiv","\\sim","\\simeq","\\asymp","\\approx","\\ne","\\subset","\\supset","\\subseteq","\\supseteq","\\nsubseteq","\\nsupseteq","\\in","\\ni","\\notin"],AdvancedMath:["x_{a}","x^{b}","x_{a}^{b}","\\sqrt{x}","\\sqrt[n]{x}","\\bigcap_{a}^{b}","\\bigcup_{a}^{b}","\\prod_{a}^{b}","\\coprod_{a}^{b}","\\int_{a}^{b}","\\oint_{a}^{b}","\\sum_{a}^{b}{x}","\\lim_{a  \\rightarrow b}{x}","\\frac{dy}{dx}|_{t=0}","\\vec{a}","\\bar{a}","\\tilde{a}","\\dot{a}","\\ddot{a}","\\hat{a}","\\overleftarrow{ab}","\\overline{ab}","\\overrightarrow{ab}","\\underline{ab}","\\overbrace{ab}","\\underbrace{ab}"],LinearAlgebra:["A^{*}","A^{T}","A^{-1}","\\left( x  \\right)","\\left[ x  \\right]","\\left \\{ x  \\right \\}","\\left| x  \\right|","\\begin{pmatrix}a&b\\\\c&d\\\\ \\end{pmatrix}","\\begin{bmatrix}a&b\\\\c&d\\\\ \\end{bmatrix}","\\begin{Bmatrix}a&b\\\\c&d\\\\ \\end{Bmatrix}","\\begin{vmatrix}a&b\\\\c&d\\\\ \\end{vmatrix}"],arrows:["\\leftarrow","\\rightarrow","\\leftrightarrow","\\Leftarrow","\\Rightarrow","\\Leftrightarrow","\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow"],trigonometric:["\\sin \\theta","\\cos \\theta","\\tan \\theta","\\csc \\theta","\\sec \\theta","\\cot \\theta","\\arcsin \\theta","\\arccos \\theta"]};function rh(e){var t=e.$editorRootElem,n=e.$toolbarElem,i=e.$textLatexElem,r=e.config;t.append(n);var o=th("<div></div>");o.addClass("clearfix").css("width","100%").css("height","".concat(r.height-r.menuHeight,"px")).css("overflow","hidden"),i.attr("contenteditable","true").css("outline","none"),o.append(i),t.css("width","".concat(r.width,"px")).css("height","".concat(r.height,"px")),t.append(o)}var oh=function(){return P((function e(t){A(this,e),O(this,"editor",void 0),this.editor=t}),[{key:"do",value:function(e){var t=this.editor.selection;t.getRange()&&(t.restoreSelection(),this.insertHtml(e),this.renderFormula(),t.saveRange(),t.restoreSelection())}},{key:"insert",value:function(e,t){if(t){var n=this.editor.selection.getRange();if(n){var i=n.startContainer;n.setStart(i,n.endOffset),n.setEnd(i,n.endOffset),n.deleteContents()}this.insertHtml(" "===e?"&nbsp;":e)}else{var r,o=(r=e,'<span style="color: '.concat(Gc,'">').concat(" "!==r?r:"&nbsp;","</span>"));this.do(o)}}},{key:"renderFormula",value:function(){var e=this.editor,t=e.latex.text();e.change(t)}},{key:"insertHtml",value:function(e){var t=this.editor,n=t.selection.getRange();if(n)if(this.queryCommandSupported("insertHTML"))this.execCommand("insertHTML",e);else if(n.insertNode){if(n.deleteContents(),th(e).elems.length>0)n.insertNode(th(e).elems[0]);else{var i=document.createElement("p");i.appendChild(document.createTextNode(e)),n.insertNode(i)}t.selection.collapseRange()}}},{key:"execCommand",value:function(e,t){document.execCommand(e,!1,t)}},{key:"queryCommandSupported",value:function(e){return document.queryCommandSupported(e)}}])}(),ah=function(){return P((function e(t){A(this,e),O(this,"editor",void 0),O(this,"_currentRange",null),this.editor=t}),[{key:"getRange",value:function(){return this._currentRange}},{key:"saveRange",value:function(e){if(e)this._currentRange=e;else{var t=window.getSelection();if(0!==t.rangeCount){var n=t.getRangeAt(0),i=this.getSelectionContainerElem(n);if(null!=i&&i.length){var r=this.editor,o=r.$textLatexElem;if(o.isContain(i)){if(o.elems[0]===i.elems[0]&&o.html().trim()===qc){var a=o.children(),s=null==a?void 0:a.last();r.selection.createRangeByElem(s,!0,!0),r.selection.restoreSelection()}this._currentRange=n}}}}}},{key:"collapseRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._currentRange;t&&t.collapse(e)}},{key:"getSelectionText",value:function(){var e=this._currentRange;return e?e.toString():""}},{key:"getSelectionContainerElem",value:function(e){var t=e||this._currentRange;if(t){var n=t.commonAncestorContainer;return th(1===n.nodeType?n:n.parentNode)}}},{key:"getSelectionStartElem",value:function(e){var t=e||this._currentRange;if(t){var n=t.startContainer;return th(1===n.nodeType?n:n.parentNode)}}},{key:"getSelectionEndElem",value:function(e){var t=e||this._currentRange;if(t){var n=t.endContainer;return th(1===n.nodeType?n:n.parentNode)}}},{key:"isSelectionEmpty",value:function(){var e=this._currentRange;return!(!e||!e.startContainer||e.startContainer!==e.endContainer||e.startOffset!==e.endOffset)}},{key:"restoreSelection",value:function(){var e=window.getSelection(),t=this._currentRange;e&&t&&(e.removeAllRanges(),e.addRange(t))}},{key:"createRangeByElems",value:function(e,t){var n=window.getSelection?window.getSelection():document.getSelection();null==n||n.removeAllRanges();var i=document.createRange();i.setStart(e,0),i.setEnd(t,t.childNodes.length||1),this.saveRange(i),this.restoreSelection()}},{key:"createRangeByElem",value:function(e,t,n){if(e.length){var i=e.elems[0],r=document.createRange();n?r.selectNodeContents(i):r.selectNode(i),null!=t&&(r.collapse(t),t||(this.saveRange(r),this.editor.selection.moveCursor(i))),this.saveRange(r)}}},{key:"getSelectionRangeTopNodes",value:function(){var e,t,n=null===(e=this.getSelectionStartElem())||void 0===e?void 0:e.getNodeTop(this.editor),i=null===(t=this.getSelectionEndElem())||void 0===t?void 0:t.getNodeTop(this.editor);return this.recordSelectionNodes(th(n),th(i))}},{key:"moveCursor",value:function(e,t){var n,i=this.getRange(),r=3===e.nodeType?null===(n=e.nodeValue)||void 0===n?void 0:n.length:e.childNodes.length;(Xc.isFirefox||Xc.isIE())&&0!==r&&(3!==e.nodeType&&"BR"!==e.childNodes[r-1].nodeName||(r-=1));var o=null!=t?t:r;i&&e&&(i.setStart(e,o),i.setEnd(e,o),this.restoreSelection())}},{key:"getCursorPos",value:function(){var e=window.getSelection();return null==e?void 0:e.anchorOffset}},{key:"clearWindowSelectionRange",value:function(){var e=window.getSelection();e&&e.removeAllRanges()}},{key:"recordSelectionNodes",value:function(e,t){var n=[],i=!0;try{for(var r=e,o=this.editor.$textLatexElem;i;){var a,s=null===(a=r)||void 0===a?void 0:a.getNodeTop(this.editor);"BODY"===s.getNodeName()&&(i=!1),s.length>0&&(n.push(th(r)),null!=t&&t.equal(s)||o.equal(s)?i=!1:r=s.getNextSibling())}}catch(dx){i=!1}return n}},{key:"setRangeToElem",value:function(e){var t=this.getRange();null==t||t.setStart(e,0),null==t||t.setEnd(e,0)}}])}();function sh(e,t){var n=e.$textLatexElem,i=n.children();if(!i||!i.length)return n.append(th(qc)),void sh(e);var r=i.last();if(t){var o=r.html().toLowerCase(),a=r.getNodeName();if("<br>"!==o&&"<br/>"!==o||"P"!==a)return n.append(th(qc)),void sh(e)}e.selection.createRangeByElem(r,!1,!0),e.selection.restoreSelection()}var lh=function(){return P((function e(t,n){var i=this;A(this,e),O(this,"key",void 0),O(this,"$elem",void 0),O(this,"editor",void 0),O(this,"_active",void 0),this.$elem=t,this.editor=n,this._active=!1,t.on("click",(function(e){e.stopPropagation(),n.selection.getRange()&&(t.addClass("active"),i.clickHandler())}))}),[{key:"clickHandler",value:function(){}},{key:"active",value:function(){this._active=!0,this.$elem.addClass("me-active")}},{key:"unActive",value:function(){this._active=!1,this.$elem.removeClass("me-active")}},{key:"isActive",get:function(){return this._active}}])}(),uh=function(){return P((function e(t,n){var i=this;A(this,e),O(this,"menu",void 0),O(this,"conf",void 0),O(this,"$container",void 0),O(this,"rendered",void 0),O(this,"_show",void 0),O(this,"hideTimeoutId",void 0),this.hideTimeoutId=0,this.menu=t,this.conf=n;var r=this.menu.editor.config,o=r.height,a=r.menuHeight,s=r.zIndex,l=void 0===s?0:s,u=th("<p>".concat(n.title,"</p>")).addClass("me-dp-title"),c=th('<div class="me-droplist"></div>').append(u).css("z-index",l+1),h=n.list||[],f=n.type||"block",d=n.clickHandler||Uc,v=th('<ul class="'.concat("list"===f?"me-list":"me-block",'"></ul>')).css("max-height","".concat(o-a-38,"px")).css("overflow-y","auto");h.forEach((function(e){var t=e.$elem,n=e.value,r=th('<li class="me-item"></li>');t&&(r.append(t),v.append(r),r.on("click",(function(e){d(n),e.stopPropagation(),i.hideTimeoutId=window.setTimeout((function(){i.hide()}))})))})),c.append(v),c.on("mouseleave",(function(){i.hideTimeoutId=window.setTimeout((function(){i.hide()}))})),this.$container=c,this.rendered=!1,this._show=!1}),[{key:"show",value:function(){this.hideTimeoutId&&clearTimeout(this.hideTimeoutId);var e=this.menu.$elem,t=this.$container;if(!this._show){if(this.rendered)t.show();else{var n=this.conf.width||232;t.css("width","".concat(n,"px")),e.append(t),this.rendered=!0,e.renderFormula()}this._show=!0}}},{key:"hide",value:function(){var e=this.$container;this._show&&(e.hide(),this._show=!1)}},{key:"isShow",get:function(){return this._show}}])}(),ch=function(e){function t(e,n,i){var r;A(this,t),O(r=s(this,t,[e,n]),"dropList",void 0);var o=new uh(r,i);return r.dropList=o,e.on("mouseover",(function(){n.selection.getRange()&&(e.addClass("active"),o.show())})).on("mouseleave",(function(){e.removeClass("active"),o.hideTimeoutId=window.setTimeout((function(){o.hide()}))})),r}return h(t,e),P(t,[{key:"command",value:function(e){var t,n=this.editor,i=n.selection.isSelectionEmpty();if(null===(t=n.selection.getSelectionContainerElem())||void 0===t?void 0:t.elems[0]){var r=Zc(e);n.cmd.do(r),i&&(n.selection.collapseRange(),n.selection.restoreSelection())}}}])}(lh),hh=function(){return P((function e(t){A(this,e),O(this,"itemList",void 0),this.itemList=t.map((function(e){var t=e.label,n=e.value;return{$elem:th('<p class="title">'.concat(t,"：</p><p>$ ").concat(n," $</p>")),value:n}}))}),[{key:"getItemList",value:function(){return this.itemList}}])}(),fh=function(e){function t(e){var n;A(this,t);var i=th(Kc("f_{(x)}")),r=new hh(e.menusConfig.presets(e.t)),o={width:252,title:e.t("fe.p"),type:"list",list:r.getItemList(),clickHandler:function(e){n.command(e)}};return n=s(this,t,[i,e,o])}return h(t,e),P(t)}(ch),dh=function(){return P((function e(t){A(this,e),O(this,"itemList",void 0),this.itemList=t.map((function(e){return{$elem:th("<span>$".concat(e,"$</span>")),value:e}}))}),[{key:"getItemList",value:function(){return this.itemList}}])}(),vh={presets:fh,operators:function(e){function t(e){var n;A(this,t);var i=th(Kc("+")),r=new dh(e.menusConfig.operators),o={title:e.t("fe.o"),list:r.getItemList(),clickHandler:function(e){n.command(e)}};return n=s(this,t,[i,e,o])}return h(t,e),P(t)}(ch),greekLetters:function(e){function t(e){var n;A(this,t);var i=th(Kc("\\alpha")),r=new dh(e.menusConfig.greekLetters),o={title:e.t("fe.gl"),list:r.getItemList(),clickHandler:function(e){n.command(e)}};return n=s(this,t,[i,e,o])}return h(t,e),P(t)}(ch),inequation:function(e){function t(e){var n;A(this,t);var i=th(Kc("\\approx")),r=new dh(e.menusConfig.inequation),o={title:e.t("fe.i"),list:r.getItemList(),clickHandler:function(e){n.command(e)}};return n=s(this,t,[i,e,o])}return h(t,e),P(t)}(ch),AdvancedMath:function(e){function t(e){var n;A(this,t);var i=th(Kc("\\Sigma")),r=new dh(e.menusConfig.AdvancedMath),o={width:244,title:e.t("fe.am"),list:r.getItemList(),clickHandler:function(e){n.command(e)}};return n=s(this,t,[i,e,o])}return h(t,e),P(t)}(ch),LinearAlgebra:function(e){function t(e){var n;A(this,t);var i=th(Kc("\\left|x\\right|")),r=new dh(e.menusConfig.LinearAlgebra),o={width:244,title:e.t("fe.lg"),list:r.getItemList(),clickHandler:function(e){n.command(e)}};return n=s(this,t,[i,e,o])}return h(t,e),P(t)}(ch),arrows:function(e){function t(e){var n;A(this,t);var i=th(Kc("\\rightarrow")),r=new dh(e.menusConfig.arrows),o={title:e.t("fe.a"),list:r.getItemList(),clickHandler:function(e){n.command(e)}};return n=s(this,t,[i,e,o])}return h(t,e),P(t)}(ch),Trigonometric:function(e){function t(e){var n;A(this,t);var i=th(Kc("\\theta")),r=new dh(e.menusConfig.trigonometric),o={title:e.t("fe.t"),list:r.getItemList(),clickHandler:function(e){n.command(e)}};return n=s(this,t,[i,e,o])}return h(t,e),P(t)}(ch)},gh=function(){return P((function e(t){A(this,e),O(this,"editor",void 0),O(this,"menuList",void 0),O(this,"constructorList",void 0),this.editor=t,this.menuList=[],this.constructorList=vh}),[{key:"extend",value:function(e,t){t&&"function"==typeof t&&(this.constructorList[e]=t)}},{key:"init",value:function(){var e=this;this.editor.menusConfig.menus.forEach((function(t){var n=e.constructorList[t];e._initMenuList(t,n)})),this._addToToolbar()}},{key:"_initMenuList",value:function(e,t){if("function"==typeof t)if(this.menuList.some((function(t){return t.key===e})))console.warn("Duplicate menu name:".concat(e));else{var n=new t(this.editor);n.key=e,this.menuList.push(n)}}},{key:"_addToToolbar",value:function(){var e=this.editor.$toolbarElem;e.addClass("clearfix"),this.menuList.forEach((function(t){var n=t.$elem;n&&e.append(n)}))}},{key:"menuFind",value:function(e){for(var t=this.menuList,n=0,i=t.length;n<i;n++)if(t[n].key===e)return t[n];return t[0]}}])}(),ph=function(){return P((function e(t){A(this,e),O(this,"editor",void 0),this.editor=t}),[{key:"init",value:function(){this._saveRange()}},{key:"clear",value:function(){this.editor.$textLatexElem.replaceChildAll(th(qc))}},{key:"text",value:function(){return this.editor.$textLatexElem.text().replace(/&nbsp;/g," ")}},{key:"_saveRange",value:function(){var e=this.editor,t=e.$textLatexElem,n=th(document);function i(){e.selection.saveRange()}function r(){i(),n.off("mouseup",r)}function o(){n.on("mouseup",r),t.off("mouseleave",o)}t.on("keyup",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0;return function(){for(var i=this,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];n&&window.clearTimeout(n),n=window.setTimeout((function(){n=0,e.call.apply(e,[i].concat(o))}),t)}}((function(){i(),e.cmd.renderFormula()}))),t.on("keydown",(function(t){var n=t.key,r=t.ctrlKey&&!Jc.includes(n),o=Wc.includes(n);(r||o)&&(t.preventDefault(),i(),e.cmd.insert(n,o))})),t.on("click",(function e(){i(),t.off("click",e)})),t.on("mousedown",(function(){t.on("mouseleave",o)})),t.on("mouseup",(function(){t.off("mouseleave",o),setTimeout((function(){e.selection.getRange()&&i()}),0)}))}}])}(),yh={"fe.a":"箭头符号","fe.am":"高数","fe.lg":"线代","fe.gl":"希腊字母","fe.i":"不等式","fe.o":"运算符","fe.p":"预设公式","fe.t":"三角函数","fe.l":"资源加载中...","fe.pt":"勾股定理","fe.h":"双曲线","fe.tfr":"三角函数关系","fe.d":"导数","fe.nl":"牛莱公式"};function mh(e){return yh[e]||e}var wh=function(){return P((function e(){A(this,e),O(this,"config",void 0),O(this,"menusConfig",void 0),O(this,"$editorRootElem",void 0),O(this,"$toolbarElem",void 0),O(this,"$textLatexElem",void 0),O(this,"$textSvgElem",void 0),O(this,"cmd",void 0),O(this,"selection",void 0),O(this,"menus",void 0),O(this,"latex",void 0),O(this,"t",void 0),this.config=nh,this.menusConfig=ih,this.$editorRootElem=th('<div class="math-editor"></div>'),this.$toolbarElem=th('<div class="me-menu"></div>'),this.$textLatexElem=th('<div class="me-latex is-no-data"></div>'),this.$textSvgElem=th('<div class="me-svg"></div>'),this.cmd=new oh(this),this.selection=new ah(this),this.menus=new gh(this),this.latex=new ph(this),this.t=mh}),[{key:"create",value:(e=E(x().mark((function e(t,n){var i,r,o=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.menus.init(),this.latex.init(),rh(this),(i=th(t)).text(this.t("fe.l")),r=function(){i.text("").append(o.$editorRootElem),o.initSelection(),o.$toolbarElem.renderFormula(),n&&n()},Hc.loadMathJax().then((function(){return r()}));case 7:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"append",value:function(e){var t=Zc(e);this.cmd.do(t)}},{key:"change",value:function(e){e?this.$textLatexElem.removeClass("is-no-data"):this.$textLatexElem.addClass("is-no-data")}},{key:"initSelection",value:function(){sh(this)}},{key:"destroyDom",value:function(){this.$editorRootElem.remove()}}]);var e}();O(wh,"$",th);try{document}catch(vx){throw new Error("Please run in the browser environment!")}Hc.loadMathJax();var bh=c({name:"IBizFormula",props:jc(),setup:function(e){var t=ne("formula-elem"),n=f(),i=f(null),r=f(null),o=f(""),a=f(),s=f("");e.data&&(s.value=e.data);var l=function(){var e=E(x().mark((function e(){var t,o,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=i.value)||void 0===t?void 0:t.dismiss();case 2:return e.next=4,null===(o=r.value)||void 0===o?void 0:o.dismiss();case 4:return e.next=6,null===(a=n.value)||void 0===a?void 0:a.destroyDom();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){if(s.value){var e=s.value.replace(/&nbsp;/g," ").trim(),t="$ ".concat(e," $");a.value.innerHTML=t,Hc.renderFormula(a.value)}else a.value.innerHTML="输入 LaTeX 公式"},c=function(){var e;s.value&&(null===(e=n.value)||void 0===e||e.append(s.value))},h=function(){u(),n.value=new wh,n.value.config={width:570,height:184,menuHeight:40},n.value.change=function(e){e?n.value.$textLatexElem.removeClass("is-no-data"):n.value.$textLatexElem.addClass("is-no-data"),s.value=e,u()}},d=f([{type:"edit",text:"编辑",icon:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g id="ajbaction/edit" stroke-width="1" fill-rule="evenodd"><path d="M2 8.34L10.71 0 15 4.17 6.538 13H2V8.34zm1.2.512V11.8h2.826l7.283-7.6-2.606-2.533L3.2 8.852zM0 16v-1.2h16V16H0z"></path></g></svg>'},{type:"delete",text:"删除",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z'></path> </g></svg>"}]),v=function(){var t=E(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:e.change("",{isDelete:!0});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g=function(){var e;null===(e=r.value)||void 0===e||e.dismiss()},p=function(){var l=E(x().mark((function l(){return x().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return o.value=be(),r.value||(r.value=Lc(L("div",{class:t.b("edit-popover")},[L("div",{id:o.value,class:t.be("edit-popover","editor")},null),L("div",{class:t.be("edit-popover","confirm"),onClick:g},[L("button",{class:["el-button el-button--default"]},[N("确定")])])]),{placement:"top-start"})),l.next=4,r.value.present(a.value);case 4:return n.value.create(document.getElementById(o.value),c),l.next=7,r.value.onWillDismiss();case 7:e.change(s.value),n.value.destroyDom(),n.value=null,i.value=null;case 11:case"end":return l.stop()}}),l)})));return function(){return l.apply(this,arguments)}}(),y=function(){var e=E(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("separator"!==t.type){e.next=2;break}return e.abrupt("return");case 2:e.t0=t.type,e.next="edit"===e.t0?5:"delete"===e.t0?9:11;break;case 5:return e.next=7,i.value.dismiss();case 7:return p(),e.abrupt("break",11);case 9:return v(),e.abrupt("break",11);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.value=Lc(L("div",{class:t.b("tool-popover")},[d.value.map((function(e){return L("div",{class:[t.be("tool-popover","item"),t.is(e.type,!0)],title:e.text,onClick:function(){return y(e)}},[L("div",{class:t.bem("popover","item","content"),innerHTML:e.icon||e.text},null)])}))]),{placement:"top-start"}),e.next=3,i.value.present(a.value);case 3:return e.next=5,i.value.onWillDismiss();case 5:i.value=null;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=this,b=new ResizeObserver((function(){a.value&&0!==a.value.offsetWidth&&(h.bind(w)(),e.isFocus&&p(),b.disconnect(),b=null)}));return C(a,(function(e){e&&e.click&&b.observe(a.value)})),R((function(){l()})),{ns:t,nodeRef:a,openNodeOverlay:m}},render:function(){return L("div",{ref:"nodeRef",class:[this.ns.b(),this.readonly?this.ns.m("readonly"):""],onClick:this.openNodeOverlay},null)}});"object"===("undefined"==typeof window?"undefined":d(window))&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"undefined"!=typeof window&&[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){for(var e=document.createDocumentFragment(),t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach((function(t){var n=t instanceof Node;e.appendChild(n?t:document.createTextNode(String(t)))})),this.appendChild(e)}})}));var kh=function(){return P((function e(){A(this,e)}),[{key:"disposed",get:function(){return!0===this._disposed}},{key:"dispose",value:function(){this._disposed=!0}}])}();!function(e){e.dispose=function(){return function(e,t,n){var i=n.value,r=e.__proto__;n.value=function(){if(!this.disposed){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.call.apply(i,[this].concat(t)),r.dispose.call(this)}}}}}(kh||(kh={}));var xh=function(){return P((function e(){A(this,e),this.isDisposed=!1,this.items=new Set}),[{key:"disposed",get:function(){return this.isDisposed}},{key:"dispose",value:function(){this.isDisposed||(this.isDisposed=!0,this.items.forEach((function(e){e.dispose()})),this.items.clear())}},{key:"contains",value:function(e){return this.items.has(e)}},{key:"add",value:function(e){this.items.add(e)}},{key:"remove",value:function(e){this.items.delete(e)}},{key:"clear",value:function(){this.items.clear()}}])}();function Ch(e,t,n){if(n)switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2]);case 4:return e.call(t,n[0],n[1],n[2],n[3]);case 5:return e.call(t,n[0],n[1],n[2],n[3],n[4]);case 6:return e.call(t,n[0],n[1],n[2],n[3],n[4],n[5]);default:return e.apply(t,n)}return e.call(t)}function Eh(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return Ch(e,t,i)}function Sh(e){return null!=e&&(e instanceof Promise||function(e){return"object"===d(e)&&e.then&&"function"==typeof e.then}(e))}function Mh(){for(var e=[],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(n.forEach((function(t){Array.isArray(t)?e.push.apply(e,v(t)):e.push(t)})),e.some((function(e){return Sh(e)}))){var r=e.map((function(e){return Sh(e)?e:Promise.resolve(!1!==e)}));return Promise.all(r).then((function(e){return e.reduce((function(e,t){return!1!==t&&e}),!0)}))}return e.every((function(e){return!1!==e}))}function Ah(e,t){for(var n=[],i=0;i<e.length;i+=2){var r=Ch(e[i],e[i+1],Array.isArray(t)?t:[t]);n.push(r)}return Mh(n)}!function(e){e.from=function(t){var n=new e;return t.forEach((function(e){n.add(e)})),n}}(xh||(xh={}));var _h=function(){return P((function e(){A(this,e),this.listeners={}}),[{key:"on",value:function(e,t,n){return null==t||(this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t,n)),this}},{key:"once",value:function(e,t,n){var i=this,r=function(){i.off(e,r);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return Ah([t,n],a)};return this.on(e,r,this)}},{key:"off",value:function(e,t,n){if(!(e||t||n))return this.listeners={},this;var i=this.listeners;return(e?[e]:Object.keys(i)).forEach((function(e){var r=i[e];if(r)if(t||n)for(var o=r.length-2;o>=0;o-=2)t&&r[o]!==t||n&&r[o+1]!==n||r.splice(o,2);else delete i[e]})),this}},{key:"trigger",value:function(e){for(var t=!0,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if("*"!==e){var o=this.listeners[e];null!=o&&(t=Ah(v(o),i))}var a=this.listeners["*"];return null!=a?Mh([t,Ah(v(a),[e].concat(i))]):t}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.trigger.apply(this,[e].concat(n))}}])}();var Ph=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};var Oh=/^\s*class\s+/.test("".concat(P((function e(){A(this,e)}))))||/^\s*class\s*\{/.test("".concat(P((function e(){A(this,e)}))));function Th(e,t){var n;return Oh?n=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t)}(t):(n=function(){return t.apply(this,arguments)},function(e,t){function n(){this.constructor=e}Ph(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,t)),Object.defineProperty(n,"name",{value:e}),n}function Lh(e){return"__proto__"===e}function jh(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r=Array.isArray(t)?t:t.split(i);if(r.length)for(n=e;r.length;){var o=r.shift();if(Object(n)!==n||!o||!(o in n))return;n=n[o]}return n}function Nh(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",r=Array.isArray(t)?t:t.split(i),o=r.pop();if(o&&!Lh(o)){var a=e;r.forEach((function(e){Lh(e)||(null==a[e]&&(a[e]={}),a=a[e])})),a[o]=n}return e}function Dh(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",i=Array.isArray(t)?t.slice():t.split(n),r=i.pop();if(r)if(i.length>0){var o=jh(e,i);o&&delete o[r]}else delete e[r];return e}var Ih=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Rh=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"dispose",value:function(){this.off()}}])}(_h);Ih([kh.dispose()],Rh.prototype,"dispose",null),function(e){e.dispose=kh.dispose}(Rh||(Rh={})),function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){Object.getOwnPropertyNames(t.prototype).forEach((function(n){"constructor"!==n&&Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))}))}))}(Rh,kh);var Bh=function(e){var t=Object.create(null);return function(n){return t[n]||(t[n]=e(n))}},zh=Bh((function(e){return e.replace(/\B([A-Z])/g,"-$1").toLowerCase()})),Fh=Bh((function(e){return He(Ue(e)).replace(/ /g,"")}));function Vh(e){for(var t=2166136261,n=!1,i=e,r=0,o=i.length;r<o;r+=1){var a=i.charCodeAt(r);a>127&&!n&&(a=(i=unescape(encodeURIComponent(i))).charCodeAt(r),n=!0),t^=a,t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)}return t>>>0}function Hh(){for(var e="",t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n=0;n<36;n+=1){var i=t[n],r=16*Math.random()|0;e+=("x"===i?r:"y"===i?3&r|8:i).toString(16)}return e}function Uh(e,t,n){for(var i=new Array(t.length+1),r=new Array(t.length+1),o=n+1,a=0;a<=t.length;a+=1)i[a]=a;for(var s=1;s<=e.length;s+=1){var l=e.charCodeAt(s-1),u=s>n?s-n:1,c=t.length>n+s?n+s:t.length;r[0]=s;for(var h=s,f=1;f<u;f+=1)r[f]=o;for(var d=u;d<=c;d+=1){var v=l===t.charCodeAt(d-1)?i[d-1]:Math.min(i[d]+1,r[d-1]+1,i[d-1]+2);r[d]=v,h=Math.min(h,v)}for(var g=c+1;g<=t.length;g+=1)r[g]=o;if(h>n)return;var p=i;i=r,r=p}var y=i[t.length];return y>n?void 0:y}function qh(e){return"string"==typeof e&&"%"===e.slice(-1)}function Gh(e,t){if(null==e)return 0;var n;if("string"==typeof e){if(n=parseFloat(e),qh(e)&&(n/=100,Number.isFinite(n)))return n*t}else n=e;return Number.isFinite(n)?n>0&&n<1?n*t:n:0}function Jh(e){if("object"===d(e)){var t=0,n=0,i=0,r=0;return null!=e.vertical&&Number.isFinite(e.vertical)&&(n=r=e.vertical),null!=e.horizontal&&Number.isFinite(e.horizontal)&&(i=t=e.horizontal),null!=e.left&&Number.isFinite(e.left)&&(t=e.left),null!=e.top&&Number.isFinite(e.top)&&(n=e.top),null!=e.right&&Number.isFinite(e.right)&&(i=e.right),null!=e.bottom&&Number.isFinite(e.bottom)&&(r=e.bottom),{top:n,right:i,bottom:r,left:t}}var o=0;return null!=e&&Number.isFinite(e)&&(o=e),{top:o,right:o,bottom:o,left:o}}var Wh,Yh=!1,Zh=!1,Kh=!1,Xh=!1,$h=!1,Qh=!1,ef=!1,tf=!1,nf=!1,rf=!1,of=!1,af=!1,sf=!1,lf=!1,uf=!1,cf=!1;if("object"===("undefined"==typeof navigator?"undefined":d(navigator))){var hf=navigator.userAgent;Yh=hf.indexOf("Macintosh")>=0,Zh=!!hf.match(/(iPad|iPhone|iPod)/g),Kh=hf.indexOf("Windows")>=0,Xh=hf.indexOf("MSIE")>=0,$h=!!hf.match(/Trident\/7\./),Qh=!!hf.match(/Edge\//),ef=hf.indexOf("Mozilla/")>=0&&hf.indexOf("MSIE")<0&&hf.indexOf("Edge/")<0,nf=hf.indexOf("Chrome/")>=0&&hf.indexOf("Edge/")<0,rf=hf.indexOf("Opera/")>=0||hf.indexOf("OPR/")>=0,of=hf.indexOf("Firefox/")>=0,af=hf.indexOf("AppleWebKit/")>=0&&hf.indexOf("Chrome/")<0&&hf.indexOf("Edge/")<0,"object"===("undefined"==typeof document?"undefined":d(document))&&(cf=!document.createElementNS||"[object SVGForeignObjectElement]"!=="".concat(document.createElementNS("http://www.w3.org/2000/svg","foreignObject"))||hf.indexOf("Opera/")>=0)}if("object"===("undefined"==typeof window?"undefined":d(window))&&(tf=null!=window.chrome&&null!=window.chrome.app&&null!=window.chrome.app.runtime,lf=null!=window.PointerEvent&&!Yh),"object"===("undefined"==typeof document?"undefined":d(document))){sf="ontouchstart"in document.documentElement;try{var ff=Object.defineProperty({},"passive",{get:function(){uf=!0}}),df=document.createElement("div");df.addEventListener&&df.addEventListener("click",(function(){}),ff)}catch(gx){}}!function(e){e.IS_MAC=Yh,e.IS_IOS=Zh,e.IS_WINDOWS=Kh,e.IS_IE=Xh,e.IS_IE11=$h,e.IS_EDGE=Qh,e.IS_NETSCAPE=ef,e.IS_CHROME_APP=tf,e.IS_CHROME=nf,e.IS_OPERA=rf,e.IS_FIREFOX=of,e.IS_SAFARI=af,e.SUPPORT_TOUCH=sf,e.SUPPORT_POINTER=lf,e.SUPPORT_PASSIVE=uf,e.NO_FOREIGNOBJECT=cf,e.SUPPORT_FOREIGNOBJECT=!e.NO_FOREIGNOBJECT}(Wh||(Wh={})),function(e){function t(){var e=window.module;return null!=e&&null!=e.hot&&null!=e.hot.status?e.hot.status():"unkonwn"}e.getHMRStatus=t,e.isApplyingHMR=function(){return"apply"===t()};var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};e.isEventSupported=function(e){var t=document.createElement(n[e]||"div"),i="on".concat(e),r=i in t;return r||(t.setAttribute(i,"return;"),r="function"==typeof t[i]),r}}(Wh||(Wh={}));var vf=/[\t\r\n\f]/g,gf=/\S+/g,pf=function(e){return" ".concat(e," ")};function yf(e){return e&&e.getAttribute&&e.getAttribute("class")||""}function mf(e,t){if(null==e||null==t)return!1;var n=pf(yf(e)),i=pf(t);return 1===e.nodeType&&n.replace(vf," ").includes(i)}function wf(e,t){if(null!=e&&null!=t){if("function"==typeof t)return wf(e,t(yf(e)));if("string"==typeof t&&1===e.nodeType){var n=t.match(gf)||[],i=pf(yf(e)).replace(vf," "),r=n.reduce((function(e,t){return e.indexOf(pf(t))<0?"".concat(e).concat(t," "):e}),i);i!==(r=r.trim())&&e.setAttribute("class",r)}}}function bf(e,t){if(null!=e){if("function"==typeof t)return bf(e,t(yf(e)));if((!t||"string"==typeof t)&&1===e.nodeType){var n=(t||"").match(gf)||[],i=pf(yf(e)).replace(vf," "),r=n.reduce((function(e,t){var n=pf(t);return e.indexOf(n)>-1?e.replace(n," "):e}),i);i!==(r=t?r.trim():"")&&e.setAttribute("class",r)}}}function kf(e,t,n){if(null!=e&&null!=t)if(null==n||"string"!=typeof t){if("function"==typeof t)return kf(e,t(yf(e),n),n);if("string"==typeof t)(t.match(gf)||[]).forEach((function(t){mf(e,t)?bf(e,t):wf(e,t)}))}else n?wf(e,t):bf(e,t)}var xf=0;function Cf(e){return null!=e.id&&""!==e.id||(e.id="v".concat(xf+=1)),e.id}function Ef(e){return null!=e&&("function"==typeof e.getScreenCTM&&e instanceof SVGElement)}var Sf={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"};function Mf(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).createElement(e)}function Af(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sf.xhtml;return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).createElementNS(t,e)}function _f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return Af(e,Sf.svg,t)}function Pf(e){if(e){var t=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var i=new DOMParser;if(null!=n.async)i.async=n.async;t=i.parseFromString(e,n.mimeType||"text/xml")}catch(r){t=void 0}if(!t||t.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: ".concat(e));return t}('<svg xmlns="'.concat(Sf.svg,'" xmlns:xlink="').concat(Sf.xlink,'" version="').concat("1.1",'">').concat(e,"</svg>"),{async:!1});return t.documentElement}var n=document.createElementNS(Sf.svg,"svg");return n.setAttributeNS(Sf.xmlns,"xmlns:xlink",Sf.xlink),n.setAttribute("version","1.1"),n}function Of(e){for(var t=0,n=e.previousSibling;n;)1===n.nodeType&&(t+=1),n=n.previousSibling;return t}function Tf(e,t,n){for(var i=e.ownerSVGElement,r=e.parentNode;r&&r!==n&&r!==i;){if(mf(r,t))return r;r=r.parentNode}return null}function Lf(e,t){var n=t&&t.parentNode;return e===n||!!(n&&1===n.nodeType&&16&e.compareDocumentPosition(n))}function jf(e){e&&(Array.isArray(e)?e:[e]).forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}function Nf(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Df(e,t){(Array.isArray(t)?t:[t]).forEach((function(t){null!=t&&e.appendChild(t)}))}function If(e,t){var n=e.parentNode;n&&(Array.isArray(t)?t:[t]).forEach((function(t){null!=t&&n.insertBefore(t,e)}))}function Rf(e){try{return e instanceof HTMLElement}catch(dx){return"object"===d(e)&&1===e.nodeType&&"object"===d(e.style)&&"object"===d(e.ownerDocument)}}var Bf,zf,Ff=["viewBox","attributeName","attributeType","repeatCount","textLength","lengthAdjust","gradientUnits"];function Vf(e,t){var n=Gf(t);n.ns?e.hasAttributeNS(n.ns,n.local)&&e.removeAttributeNS(n.ns,n.local):e.hasAttribute(t)&&e.removeAttribute(t)}function Hf(e,t,n){if(null==n)return Vf(e,t);var i=Gf(t);i.ns&&"string"==typeof n?e.setAttributeNS(i.ns,t,n):"id"===t?e.id="".concat(n):e.setAttribute(t,"".concat(n))}function Uf(e,t){Object.keys(t).forEach((function(n){Hf(e,n,t[n])}))}function qf(e,t,n){if(null==t){for(var i=e.attributes,r={},o=0;o<i.length;o+=1)r[i[o].name]=i[o].value;return r}if("string"==typeof t&&void 0===n)return e.getAttribute(t);"object"===d(t)?Uf(e,t):Hf(e,t,n)}function Gf(e){if(-1!==e.indexOf(":")){var t=e.split(":");return{ns:Sf[t[0]],local:t[1]}}return{ns:null,local:e}}function Jf(e){var t={};return Object.keys(e).forEach((function(n){var i=Ff.includes(n)?n:zh(n);t[i]=e[n]})),t}function Wf(e){var t={};return e.split(";").forEach((function(e){var n=e.trim();if(n){var i=n.split("=");i.length&&(t[i[0].trim()]=i[1]?i[1].trim():"")}})),t}function Yf(e,t){return Object.keys(t).forEach((function(n){if("class"===n)e[n]=e[n]?"".concat(e[n]," ").concat(t[n]):t[n];else if("style"===n){var i,r,o="object"===d(e[n]),a="object"===d(t[n]);o&&a?(i=e[n],r=t[n]):o?(i=e[n],r=Wf(t[n])):a?(i=Wf(e[n]),r=t[n]):(i=Wf(e[n]),r=Wf(t[n])),e[n]=Yf(i,r)}else e[n]=t[n]})),e}function Zf(e,t){for(var n,i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.offset||0,a=[],s=[],l=null,u=0;u<e.length;u+=1){n=s[u]=e[u];for(var c=0,h=t.length;c<h;c+=1){var f=t[c],d=f.start+o,v=f.end+o;u>=d&&u<v&&("string"==typeof n?n=s[u]={t:e[u],attrs:f.attrs}:n.attrs=Yf(Yf({},n.attrs),f.attrs),r.includeAnnotationIndices&&(null==n.annotations&&(n.annotations=[]),n.annotations.push(c)))}(i=s[u-1])?qe(n)&&qe(i)?JSON.stringify(n.attrs)===JSON.stringify(i.attrs)?l.t+=n.t:(a.push(l),l=n):qe(n)||qe(i)?(a.push(l),l=n):l=(l||"")+n:l=n}return null!=l&&a.push(l),a}!function(e){function t(e){var t="data:";return e.substr(0,5)===t}function n(e){var t,n=e.replace(/\s/g,""),i=(n=decodeURIComponent(n)).indexOf(","),r=n.slice(0,i),o=r.split(":")[1].split(";")[0],a=n.slice(i+1);t=r.indexOf("base64")>=0?atob(a):unescape(encodeURIComponent(a));for(var s=new Uint8Array(t.length),l=0;l<t.length;l+=1)s[l]=t.charCodeAt(l);return new Blob([s],{type:o})}function i(e,t){var n=window.navigator.msSaveBlob;if(n)n(e,t);else{var i=window.URL.createObjectURL(e),r=document.createElement("a");r.href=i,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i)}}function r(e){var t=parseFloat(e);return Number.isNaN(t)?null:t}e.isDataUrl=t,e.imageToDataUri=function(e,n){if(e&&!t(e)){var i=function(){n(new Error("Failed to load image: ".concat(e)))},r=window.FileReader?function(e){if(200===e.status){var t=new FileReader;t.onload=function(e){var t=e.target.result;n(null,t)},t.onerror=i,t.readAsDataURL(e.response)}else i()}:function(t){if(200===t.status){var r=e.split(".").pop()||"png";"svg"===r&&(r="svg+xml");var o="data:image/".concat(r,";base64,"),a=new Uint8Array(t.response),s=o+btoa(function(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")}(a));n(null,s)}else i()},o=new XMLHttpRequest;o.responseType=window.FileReader?"blob":"arraybuffer",o.open("GET",e,!0),o.addEventListener("error",i),o.addEventListener("load",(function(){return r(o)})),o.send()}else setTimeout((function(){return n(null,e)}))},e.dataUriToBlob=n,e.downloadBlob=i,e.downloadDataUri=function(e,t){i(n(e),t)},e.svgToDataUrl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=function(t){return null==n&&(n=function(e){var t=e.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return t&&t[2]?t[2].replace(/\s+/," ").split(" "):null}(e)),null!=n?r(n[t]):null},o=function(t){var n=e.match(t);return n&&n[2]?r(n[2]):null},a=t.width;if(null==a&&(a=o(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==a&&(a=i(2)),null==a)throw new Error("Can not parse width from svg string");var s=t.height;if(null==s&&(s=o(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==s&&(s=i(3)),null==s)throw new Error("Can not parse height from svg string");var l=encodeURIComponent(e).replace(/'/g,"%27").replace(/"/g,"%22");return"".concat("data:image/svg+xml",",").concat(l)}}(Bf||(Bf={}));var Kf,Xf={px:function(e){return e},mm:function(e){return zf*e},cm:function(e){return zf*e*10},in:function(e){return zf*e*25.4},pt:function(e){return zf*(25.4*e/72)},pc:function(e){return zf*(25.4*e/6)}};!function(e){function t(e,t,n){var i=document.createElement("div"),r=i.style;r.display="inline-block",r.position="absolute",r.left="-15000px",r.top="-15000px",r.width=e+(n||"px"),r.height=t+(n||"px"),document.body.appendChild(i);var o=i.getBoundingClientRect(),a={width:o.width||0,height:o.height||0};return document.body.removeChild(i),a}e.measure=t,e.toPx=function(e,n){null==zf&&(zf=t("1","1","mm").width);var i=n?Xf[n]:null;return i?i(e):e}}(Kf||(Kf={}));var $f=/-(.)/g;var Qf={},ed=["webkit","ms","moz","o"],td="undefined"!=typeof document?document.createElement("div").style:{};function nd(e){var t=e.replace($f,(function(e,t){return t.toUpperCase()}));if(null==Qf[t]){var n=t.charAt(0).toUpperCase()+t.slice(1);Qf[t]=t in td?t:function(e){for(var t=0;t<ed.length;t+=1){var n=ed[t]+e;if(n in td)return n}return null}(n)}return Qf[t]}function id(e,t){var n=e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null);return n&&t?n.getPropertyValue(t)||n[t]:n}var rd={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function od(e,t,n){if("string"!=typeof t)for(var i in t)od(e,i,t[i]);else{var r=function(e){return/^--/.test(e)}(t);if(r||(t=nd(t)),void 0===n)return function(e,t,n){var i=window.getComputedStyle(e,null);return n?i.getPropertyValue(t)||void 0:i[t]||e.style[t]}(e,t,r);r||(n=function(e,t){return rd[e]||"number"!=typeof t?t:"".concat(t,"px")}(t,n));var o=e.style;r?o.setProperty(t,n):o[t]=n}}var ad=new WeakMap;function sd(e,t){var n=Ue(t),i=ad.get(e);if(i)return i[n]}function ld(e,t,n){if(!t){var i={};return Object.keys(ad).forEach((function(t){i[t]=sd(e,t)})),i}if("string"==typeof t)return void 0===n?sd(e,t):void function(e,t,n){var i=Ue(t),r=ad.get(e);r?r[i]=n:ad.set(e,O({},i,n))}(e,t,n);for(var r in t)ld(e,r,t[r])}var ud=function(){function e(t,n,i){if(A(this,e),!t)throw new TypeError("Invalid element to create vector");var r;if(e.isVector(t))r=t.node;else if("string"==typeof t)if("svg"===t.toLowerCase())r=Pf();else if("<"===t[0]){var o=Pf(t);r=document.importNode(o.firstChild,!0)}else r=document.createElementNS(Sf.svg,t);else r=t;this.node=r,n&&this.setAttributes(n),i&&this.append(i)}return P(e,[{key:Symbol.toStringTag,get:function(){return e.toStringTag}},{key:"type",get:function(){return this.node.nodeName}},{key:"id",get:function(){return this.node.id},set:function(e){this.node.id=e}},{key:"transform",value:function(e,t){return null==e?Dd(this.node):(Dd(this.node,e,t),this)}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return null==e?Id(this.node):(Id(this.node,e,t,n),this)}},{key:"rotate",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return null==e?Rd(this.node):(Rd(this.node,e,t,n,i),this)}},{key:"scale",value:function(e,t){return null==e?Bd(this.node):(Bd(this.node,e,t),this)}},{key:"getTransformToElement",value:function(t){var n=e.toNode(t);return zd(this.node,n)}},{key:"removeAttribute",value:function(e){return Vf(this.node,e),this}},{key:"getAttribute",value:function(e){return function(e,t){return e.getAttribute(t)}(this.node,e)}},{key:"setAttribute",value:function(e,t){return Hf(this.node,e,t),this}},{key:"setAttributes",value:function(e){return Uf(this.node,e),this}},{key:"attr",value:function(e,t){return null==e?qf(this.node):"string"==typeof e&&void 0===t?qf(this.node,e):("object"===d(e)?qf(this.node,e):qf(this.node,e,t),this)}},{key:"svg",value:function(){return this.node instanceof SVGSVGElement?this:e.create(this.node.ownerSVGElement)}},{key:"defs",value:function(){var t=this.svg()||this,n=t.node.getElementsByTagName("defs")[0];return n?e.create(n):e.create("defs").appendTo(t)}},{key:"text",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dd(this.node,e,t),this}},{key:"tagName",value:function(){return function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.nodeName;return t?n.toLowerCase():n.toUpperCase()}(this.node)}},{key:"clone",value:function(){return e.create(this.node.cloneNode(!0))}},{key:"remove",value:function(){return jf(this.node),this}},{key:"empty",value:function(){return Nf(this.node),this}},{key:"append",value:function(t){return Df(this.node,e.toNodes(t)),this}},{key:"appendTo",value:function(t){return function(e,t){null!=t&&t.appendChild(e)}(this.node,e.isVector(t)?t.node:t),this}},{key:"prepend",value:function(t){return function(e,t){var n=e.firstChild;n?If(n,t):Df(e,t)}(this.node,e.toNodes(t)),this}},{key:"before",value:function(t){return If(this.node,e.toNodes(t)),this}},{key:"replace",value:function(t){return this.node.parentNode&&this.node.parentNode.replaceChild(e.toNode(t),this.node),e.create(t)}},{key:"first",value:function(){return this.node.firstChild?e.create(this.node.firstChild):null}},{key:"last",value:function(){return this.node.lastChild?e.create(this.node.lastChild):null}},{key:"get",value:function(t){var n=this.node.childNodes[t];return n?e.create(n):null}},{key:"indexOf",value:function(t){return Array.prototype.slice.call(this.node.childNodes).indexOf(e.toNode(t))}},{key:"find",value:function(t){var n=[],i=function(e,t){return e.querySelectorAll(t)}(this.node,t);if(i)for(var r=0,o=i.length;r<o;r+=1)n.push(e.create(i[r]));return n}},{key:"findOne",value:function(t){var n=function(e,t){return e.querySelector(t)}(this.node,t);return n?e.create(n):null}},{key:"findParentByClass",value:function(t,n){var i=Tf(this.node,t,n);return i?e.create(i):null}},{key:"matches",value:function(e){var t=this.node;this.node.matches;var n=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return n&&n.call(t,e)}},{key:"contains",value:function(t){return Lf(this.node,e.isVector(t)?t.node:t)}},{key:"wrap",value:function(t){var n=e.create(t),i=this.node.parentNode;return null!=i&&i.insertBefore(n.node,this.node),n.append(this)}},{key:"parent",value:function(t){var n=this;if(null==n.node.parentNode)return null;if(n=e.create(n.node.parentNode),null==t)return n;do{if("string"==typeof t?n.matches(t):n instanceof t)return n}while(n=e.create(n.node.parentNode));return n}},{key:"children",value:function(){for(var t=this.node.childNodes,n=[],i=0;i<t.length;i+=1){1===t[i].nodeType&&n.push(e.create(t[i]))}return n}},{key:"eachChild",value:function(e,t){for(var n=this.children(),i=0,r=n.length;i<r;i+=1)e.call(n[i],n[i],i,n),t&&n[i].eachChild(e,t);return this}},{key:"index",value:function(){return Of(this.node)}},{key:"hasClass",value:function(e){return mf(this.node,e)}},{key:"addClass",value:function(e){return wf(this.node,e),this}},{key:"removeClass",value:function(e){return bf(this.node,e),this}},{key:"toggleClass",value:function(e,t){return kf(this.node,e,t),this}},{key:"toLocalPoint",value:function(e,t){return function(e,t,n){var i=e instanceof SVGSVGElement?e:e.ownerSVGElement,r=i.createSVGPoint();r.x=t,r.y=n;try{var o=i.getScreenCTM(),a=r.matrixTransform(o.inverse()),s=zd(e,i).inverse();return a.matrixTransform(s)}catch(dx){return r}}(this.node,e,t)}},{key:"sample",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.node instanceof SVGPathElement?function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=e.getTotalLength(),r=[],o=0;for(;o<i;)t=e.getPointAtLength(o),r.push({distance:o,x:t.x,y:t.y}),o+=n;return r}(this.node,e):[]}},{key:"toPath",value:function(){return e.create(function(e){var t=_f("path");qf(t,qf(e));var n=xd(e);n&&t.setAttribute("d",n);return t}(this.node))}},{key:"toPathData",value:function(){return xd(this.node)}}])}();function cd(e,t,n){for(var i,r=n.eol,o=n.baseSize,a=n.lineHeight,s=0,l={},u=t.length-1,c=0;c<=u;c+=1){var h=t[c],f=null;if("object"===d(h)){var v=h.attrs,g=ud.create("tspan",v);i=g.node;var p=h.t;r&&c===u&&(p+=r),i.textContent=p;var y=v.class;y&&g.addClass(y),n.includeAnnotationIndices&&g.attr("annotations",h.annotations.join(",")),void 0===(f=parseFloat(v["font-size"]))&&(f=o),f&&f>s&&(s=f)}else r&&c===u&&(h+=r),i=document.createTextNode(h||" "),o&&o>s&&(s=o);e.appendChild(i)}return s&&(l.maxFontSize=s),a?l.lineHeight=a:s&&(l.lineHeight=1.2*s),l}!function(e){function t(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&i.node instanceof SVGElement&&"function"==typeof i.sample&&"function"==typeof i.toPath}function n(t,n,i){return new e(t,n,i)}function i(e){return t(e)?e.node:e}e.toStringTag="X6.".concat(e.name),e.isVector=t,e.create=n,e.createVectors=function(e){if("<"===e[0]){for(var t=Pf(e),i=[],r=0,o=t.childNodes.length;r<o;r+=1){var a=t.childNodes[r];i.push(n(document.importNode(a,!0)))}return i}return[n(e)]},e.toNode=i,e.toNodes=function(e){return Array.isArray(e)?e.map((function(e){return i(e)})):[i(e)]}}(ud||(ud={}));var hd=/em$/;function fd(e,t){var n=parseFloat(e);return hd.test(e)?n*t:n}function dd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=function(e){return e.replace(/ /g," ")}(t);var i=n.eol,r=n.textPath,o=n.textVerticalAnchor,a="middle"===o||"bottom"===o||"top"===o,s=n.x;void 0===s&&(s=e.getAttribute("x")||0);var l=n.includeAnnotationIndices,u=n.annotations;u&&!Array.isArray(u)&&(u=[u]);var c=n.lineHeight,h="auto"===c,f=h?"1.5em":c||"1em",v=!0,g=e.childNodes;if(1===g.length){var p=g[0];p&&"TITLE"===p.tagName.toUpperCase()&&(v=!1)}v&&Nf(e),qf(e,{"xml:space":"preserve",display:t||n.displayEmpty?null:"none"});var y,m,w=qf(e,"font-size"),b=parseFloat(w);b||(b=16,!a&&!u||w||qf(e,"font-size","".concat(b))),r?("string"==typeof r&&(r={d:r}),y=function(e,t){var n=ud.create(t),i=ud.create("textPath"),r=e.d;if(r&&void 0===e["xlink:href"]){var o=ud.create("path").attr("d",r).appendTo(n.defs());i.attr("xlink:href","#".concat(o.id))}return"object"===d(e)&&i.attr(e),i.node}(r,e)):y=document.createDocumentFragment();for(var k,x=0,C=t.split("\n"),E=[],S=C.length-1,M=0;M<=S;M+=1){m=f;var A="v-line",_=_f("tspan"),P=void 0,O=C[M];if(O)if(u){var T=(P=cd(_,Zf(O,u,{offset:-x,includeAnnotationIndices:l}),{eol:M!==S&&i,baseSize:b,lineHeight:h?null:f,includeAnnotationIndices:l})).lineHeight;T&&h&&0!==M&&(m=T),0===M&&(k=.8*P.maxFontSize)}else i&&M!==S&&(O+=i),_.textContent=O;else{_.textContent="-",A+=" v-empty-line";var L=_.style;L.fillOpacity=0,L.strokeOpacity=0,u&&(P={})}P&&E.push(P),M>0&&_.setAttribute("dy",m),(M>0||r)&&_.setAttribute("x",s),_.className.baseVal=A,y.appendChild(_),x+=O.length+1}if(a)if(u)m=function(e,t,n,i){if(!Array.isArray(t))return 0;var r=t.length;if(!r)return 0;for(var o=t[0],a=fd(o.maxFontSize,n)||n,s=0,l=fd(i,n),u=1;u<r;u+=1)s+=fd((o=t[u]).lineHeight,n)||l;var c,h=fd(o.maxFontSize,n)||n;switch(e){case"middle":c=a/2-.15*h-s/2;break;case"bottom":c=-.25*h-s;break;default:c=.8*a}return c}(o,E,b,f);else if("top"===o)m="0.8em";else{var j;switch(S>0?(j=parseFloat(f)||1,j*=S,hd.test(f)||(j/=b)):j=0,o){case"middle":m="".concat(.3-j/2,"em");break;case"bottom":m="".concat(-j-.3,"em")}}else 0===o?m="0em":o?m=o:(m=0,null==e.getAttribute("y")&&e.setAttribute("y","".concat(k||"0.8em")));y.firstChild.setAttribute("dy",m),e.appendChild(y)}function vd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement("canvas").getContext("2d");if(!e)return{width:0};var i=[],r=t["font-size"]?"".concat(parseFloat(t["font-size"]),"px"):"14px";return i.push(t["font-style"]||"normal"),i.push(t["font-variant"]||"normal"),i.push(t["font-weight"]||400),i.push(r),i.push(t["font-family"]||"sans-serif"),n.font=i.join(" "),n.measureText(e)}function gd(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t>=n)return[e,""];var r=e.length,o={},a=Math.round(t/n*r-1);for(a<0&&(a=0);a>=0&&a<r;){var s=e.slice(0,a),l=o[s]||vd(s,i).width,u=e.slice(0,a+1),c=o[u]||vd(u,i).width;if(o[s]=l,o[u]=c,l>t)a-=1;else{if(!(c<=t))break;a+=1}}return[e.slice(0,a),e.slice(a)]}function pd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=t.width,o=t.height,a=i.eol||"\n",s=n.fontSize||14,l=n.lineHeight?parseFloat(n.lineHeight):Math.ceil(1.4*s),u=Math.floor(o/l);if(e.indexOf(a)>-1){var c=Hh(),h=[];return e.split(a).map((function(e){var r=pd(e,Object.assign(Object.assign({},t),{height:Number.MAX_SAFE_INTEGER}),n,Object.assign(Object.assign({},i),{eol:c}));r&&h.push.apply(h,v(r.split(c)))})),h.slice(0,u).join(a)}var f=vd(e,n).width;if(f<r)return e;var d=[],g=e,y=f,m=i.ellipsis,w=0;m&&("string"!=typeof m&&(m="…"),w=vd(m,n).width);for(var b=0;b<u;b+=1){if(!(y>r)){d.push(g);break}if(b===u-1){var k=p(gd(g,r-w,y,n),1)[0];d.push(m?"".concat(k).concat(m):k)}else{var x=p(gd(g,r,y,n),2),C=x[0],E=x[1];d.push(C),y=vd(g=E,n).width}}return d.join(a)}var yd=.551784;function md(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN,i=e.getAttribute(t);if(null==i)return n;var r=parseFloat(i);return Number.isNaN(r)?n:r}function wd(e){var t=e.map((function(e){return"".concat(e.x," ").concat(e.y)}));return"M ".concat(t.join(" L"))}function bd(e){var t=[],n=e.points;if(n)for(var i=0,r=n.numberOfItems;i<r;i+=1)t.push(n.getItem(i));return t}function kd(e){var t=e.x,n=e.y,i=e.width,r=e.height,o=Math.min(e.rx||e["top-rx"]||0,i/2),a=Math.min(e.rx||e["bottom-rx"]||0,i/2),s=Math.min(e.ry||e["top-ry"]||0,r/2),l=Math.min(e.ry||e["bottom-ry"]||0,r/2);return(o||a||s||l?["M",t,n+s,"v",r-s-l,"a",a,l,0,0,0,a,l,"h",i-2*a,"a",a,l,0,0,0,a,-l,"v",-(r-l-s),"a",o,s,0,0,0,-o,-s,"h",-(i-2*o),"a",o,s,0,0,0,-o,s,"Z"]:["M",t,n,"H",t+i,"V",n+r,"H",t,"V",n,"Z"]).join(" ")}function xd(e){var t,n=e.tagName.toLowerCase();switch(n){case"path":return e.getAttribute("d");case"line":return function(e){return["M",md(e,"x1"),md(e,"y1"),"L",md(e,"x2"),md(e,"y2")].join(" ")}(e);case"polygon":return 0===(t=bd(e)).length?null:"".concat(wd(t)," Z");case"polyline":return function(e){var t=bd(e);return 0===t.length?null:wd(t)}(e);case"ellipse":return function(e){var t=md(e,"cx",0),n=md(e,"cy",0),i=md(e,"rx"),r=md(e,"ry")||i,o=i*yd,a=r*yd;return["M",t,n-r,"C",t+o,n-r,t+i,n-a,t+i,n,"C",t+i,n+a,t+o,n+r,t,n+r,"C",t-o,n+r,t-i,n+a,t-i,n,"C",t-i,n-a,t-o,n-r,t,n-r,"Z"].join(" ")}(e);case"circle":return function(e){var t=md(e,"cx",0),n=md(e,"cy",0),i=md(e,"r"),r=i*yd;return["M",t,n-i,"C",t+r,n-i,t+i,n-r,t+i,n,"C",t+i,n+r,t+r,n+i,t,n+i,"C",t-r,n+i,t-i,n+r,t-i,n,"C",t-i,n-r,t-r,n-i,t,n-i,"Z"].join(" ")}(e);case"rect":return function(e){return kd({x:md(e,"x",0),y:md(e,"y",0),width:md(e,"width",0),height:md(e,"height",0),rx:md(e,"rx",0),ry:md(e,"ry",0)})}(e)}throw new Error('"'.concat(n,'" cannot be converted to svg path element.'))}var Cd,Ed,Sd,Md=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,Ad=/[ ,]+/,_d=/^(\w+)\((.*)\)/;function Pd(e){var t=_f("svg").createSVGMatrix();if(null!=e){var n=e,i=t;for(var r in n)i[r]=n[r]}return t}function Od(e){var t=_f("svg");return null!=e?(e instanceof DOMMatrix||(e=Pd(e)),t.createSVGTransformFromMatrix(e)):t.createSVGTransform()}function Td(e){var t=Pd(),n=null!=e&&e.match(Md);if(!n)return t;for(var i=0,r=n.length;i<r;i+=1){var o=n[i].match(_d);if(o){var a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=Pd(),f=o[2].split(Ad);switch(o[1].toLowerCase()){case"scale":a=parseFloat(f[0]),s=void 0===f[1]?a:parseFloat(f[1]),h=h.scaleNonUniform(a,s);break;case"translate":l=parseFloat(f[0]),u=parseFloat(f[1]),h=h.translate(l,u);break;case"rotate":c=parseFloat(f[0]),l=parseFloat(f[1])||0,u=parseFloat(f[2])||0,h=0!==l||0!==u?h.translate(l,u).rotate(c).translate(-l,-u):h.rotate(c);break;case"skewx":c=parseFloat(f[0]),h=h.skewX(c);break;case"skewy":c=parseFloat(f[0]),h=h.skewY(c);break;case"matrix":h.a=parseFloat(f[0]),h.b=parseFloat(f[1]),h.c=parseFloat(f[2]),h.d=parseFloat(f[3]),h.e=parseFloat(f[4]),h.f=parseFloat(f[5]);break;default:continue}t=t.multiply(h)}}return t}function Ld(e){var t=e||{},n=null!=t.a?t.a:1,i=null!=t.b?t.b:0,r=null!=t.c?t.c:0,o=null!=t.d?t.d:1,a=null!=t.e?t.e:0,s=null!=t.f?t.f:0;return"matrix(".concat(n,",").concat(i,",").concat(r,",").concat(o,",").concat(a,",").concat(s,")")}function jd(e){var t,n,i;if(e){var r=Ad;if(e.trim().indexOf("matrix")>=0){var o=function(e){var t=Nd(e,{x:0,y:1}),n=Nd(e,{x:1,y:0}),i=180/Math.PI*Math.atan2(t.y,t.x)-90,r=180/Math.PI*Math.atan2(n.y,n.x);return{skewX:i,skewY:r,translateX:e.e,translateY:e.f,scaleX:Math.sqrt(e.a*e.a+e.b*e.b),scaleY:Math.sqrt(e.c*e.c+e.d*e.d),rotation:i}}(Td(e));t=[o.translateX,o.translateY],n=[o.rotation],i=[o.scaleX,o.scaleY];var a=[];0===t[0]&&0===t[1]||a.push("translate(".concat(t.join(","),")")),1===i[0]&&1===i[1]||a.push("scale(".concat(i.join(","),")")),0!==n[0]&&a.push("rotate(".concat(n[0],")")),e=a.join(" ")}else{var s=e.match(/translate\((.*?)\)/);s&&(t=s[1].split(r));var l=e.match(/rotate\((.*?)\)/);l&&(n=l[1].split(r));var u=e.match(/scale\((.*?)\)/);u&&(i=u[1].split(r))}}var c=i&&i[0]?parseFloat(i[0]):1;return{raw:e||"",translation:{tx:t&&t[0]?parseInt(t[0],10):0,ty:t&&t[1]?parseInt(t[1],10):0},rotation:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:c,sy:i&&i[1]?parseFloat(i[1]):c}}}function Nd(e,t){return{x:t.x*e.a+t.y*e.c+0,y:t.x*e.b+t.y*e.d+0}}function Dd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==t)return Td(qf(e,"transform"));if(n.absolute)e.setAttribute("transform",Ld(t));else{var i=e.transform,r=Od(t);i.baseVal.appendItem(r)}}function Id(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=qf(e,"transform"),o=jd(r);if(null==t)return o.translation;r=(r=o.raw).replace(/translate\([^)]*\)/g,"").trim();var a=i.absolute?t:o.translation.tx+t,s=i.absolute?n:o.translation.ty+n,l="translate(".concat(a,",").concat(s,")");e.setAttribute("transform","".concat(l," ").concat(r).trim())}function Rd(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=qf(e,"transform"),a=jd(o);if(null==t)return a.rotation;o=(o=a.raw).replace(/rotate\([^)]*\)/g,"").trim(),t%=360;var s=r.absolute?t:a.rotation.angle+t,l=null!=n&&null!=i?",".concat(n,",").concat(i):"",u="rotate(".concat(s).concat(l,")");e.setAttribute("transform","".concat(o," ").concat(u).trim())}function Bd(e,t,n){var i=qf(e,"transform"),r=jd(i);if(null==t)return r.scale;n=null==n?t:n,i=(i=r.raw).replace(/scale\([^)]*\)/g,"").trim();var o="scale(".concat(t,",").concat(n,")");e.setAttribute("transform","".concat(i," ").concat(o).trim())}function zd(e,t){if(Ef(t)&&Ef(e)){var n=t.getScreenCTM(),i=e.getScreenCTM();if(n&&i)return n.inverse().multiply(i)}return Pd()}!function(e){var t={};e.get=function(e){return t[e]||{}},e.register=function(e,n){t[e]=n},e.unregister=function(e){delete t[e]}}(Cd||(Cd={})),function(e){var t=new WeakMap;e.ensure=function(e){return t.has(e)||t.set(e,{events:Object.create(null)}),t.get(e)},e.get=function(e){return t.get(e)},e.remove=function(e){return t.delete(e)}}(Ed||(Ed={})),function(e){e.returnTrue=function(){return!0},e.returnFalse=function(){return!1},e.stopPropagationCallback=function(e){e.stopPropagation()},e.addEventListener=function(e,t,n){null!=e.addEventListener&&e.addEventListener(t,n)},e.removeEventListener=function(e,t,n){null!=e.removeEventListener&&e.removeEventListener(t,n)}}(Sd||(Sd={})),function(e){var t=/[^\x20\t\r\n\f]+/g,n=/^([^.]*)(?:\.(.+)|)/;e.splitType=function(e){return(e||"").match(t)||[""]},e.normalizeType=function(e){var t=n.exec(e)||[];return{originType:t[1]?t[1].trim():t[1],namespaces:t[2]?t[2].split(".").map((function(e){return e.trim()})).sort():[]}},e.isValidTarget=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},e.isValidSelector=function(e,t){if(t){var n=e;return null!=n.querySelector&&null!=n.querySelector(t)}return!0}}(Sd||(Sd={})),function(e){var t=0,n=new WeakMap;e.ensureHandlerId=function(e){return n.has(e)||(n.set(e,t),t+=1),n.get(e)},e.getHandlerId=function(e){return n.get(e)},e.removeHandlerId=function(e){return n.delete(e)},e.setHandlerId=function(e,t){return n.set(e,t)}}(Sd||(Sd={})),function(e){e.getHandlerQueue=function(e,t){var n=[],i=Ed.get(e),r=i&&i.events&&i.events[t.type],o=r&&r.handlers||[],a=r?r.delegateCount:0;if(a>0&&!("click"===t.type&&"number"==typeof t.button&&t.button>=1))for(var s=t.target;s!==e;s=s.parentNode||e)if(1===s.nodeType&&("click"!==t.type||!0!==s.disabled)){for(var l=[],u={},c=function(){var t=o[h],n=t.selector;if(null!=n&&null==u[n]){var i=[];e.querySelectorAll(n).forEach((function(e){i.push(e)})),u[n]=i.includes(s)}u[n]&&l.push(t)},h=0;h<a;h+=1)c();l.length&&n.push({elem:s,handlers:l})}return a<o.length&&n.push({elem:e,handlers:o.slice(a)}),n}}(Sd||(Sd={})),function(e){e.isWindow=function(e){return null!=e&&e===e.window}}(Sd||(Sd={})),function(e){e.contains=function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}}(Sd||(Sd={}));var Fd=P((function e(t,n){var i=this;A(this,e),this.isDefaultPrevented=Sd.returnFalse,this.isPropagationStopped=Sd.returnFalse,this.isImmediatePropagationStopped=Sd.returnFalse,this.isSimulated=!1,this.preventDefault=function(){var e=i.originalEvent;i.isDefaultPrevented=Sd.returnTrue,e&&!i.isSimulated&&e.preventDefault()},this.stopPropagation=function(){var e=i.originalEvent;i.isPropagationStopped=Sd.returnTrue,e&&!i.isSimulated&&e.stopPropagation()},this.stopImmediatePropagation=function(){var e=i.originalEvent;i.isImmediatePropagationStopped=Sd.returnTrue,e&&!i.isSimulated&&e.stopImmediatePropagation(),i.stopPropagation()},"string"==typeof t?this.type=t:t.type&&(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?Sd.returnTrue:Sd.returnFalse,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.timeStamp=t.timeStamp),n&&Object.assign(this,n),this.timeStamp||(this.timeStamp=Date.now())}));!function(e){e.create=function(t){return t instanceof e?t:new e(t)}}(Fd||(Fd={})),function(e){e.addProperty=function(t,n){Object.defineProperty(e.prototype,t,{enumerable:!0,configurable:!0,get:"function"==typeof n?function(){if(this.originalEvent)return n(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})}}(Fd||(Fd={})),function(e){var t={bubbles:!0,cancelable:!0,eventPhase:!0,detail:!0,view:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pageX:!0,pageY:!0,screenX:!0,screenY:!0,toElement:!0,pointerId:!0,pointerType:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,touches:!0,changedTouches:!0,targetTouches:!0,which:!0,altKey:!0,ctrlKey:!0,metaKey:!0,shiftKey:!0};Object.keys(t).forEach((function(n){return e.addProperty(n,t[n])}))}(Fd||(Fd={})),Cd.register("load",{noBubble:!0}),Cd.register("beforeunload",{postDispatch:function(e,t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}),Cd.register("mouseenter",{delegateType:"mouseover",bindType:"mouseover",handle:function(e,t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===e||Sd.contains(e,i))||(t.type=r.originType,n=r.handler.call(e,t),t.type="mouseover"),n}}),Cd.register("mouseleave",{delegateType:"mouseout",bindType:"mouseout",handle:function(e,t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===e||Sd.contains(e,i))||(t.type=r.originType,n=r.handler.call(e,t),t.type="mouseout"),n}});var Vd,Hd,Ud,qd=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};!function(e){var t;function n(e,t){var n=Fd.create(t);n.delegateTarget=e;var i=Cd.get(n.type);if(!i.preDispatch||!1!==i.preDispatch(e,n)){for(var r=Sd.getHandlerQueue(e,n),o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];for(var l=0,u=r.length;l<u&&!n.isPropagationStopped();l+=1){var c=r[l];n.currentTarget=c.elem;for(var h=0,f=c.handlers.length;h<f&&!n.isImmediatePropagationStopped();h+=1){var d=c.handlers[h];if(null==n.rnamespace||d.namespace&&n.rnamespace.test(d.namespace)){var v;n.handleObj=d,n.data=d.data;var g=Cd.get(d.originType).handle,p=g?g.apply(void 0,[c.elem,n].concat(a)):(v=d.handler).call.apply(v,[c.elem,n].concat(a));void 0!==p&&(n.result=p,!1===p&&(n.preventDefault(),n.stopPropagation()))}}}return i.postDispatch&&i.postDispatch(e,n),n.result}}e.on=function(e,i,r,o,a){if(Sd.isValidTarget(e)){var s;if("function"!=typeof r){var l=r,u=l.handler,c=l.selector,h=qd(r,["handler","selector"]);r=u,a=c,s=h}var f=Ed.ensure(e),d=f.handler;null==d&&(d=f.handler=function(i){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return t!==i.type?n.apply(void 0,[e,i].concat(o)):void 0});var v=Sd.ensureHandlerId(r);Sd.splitType(i).forEach((function(t){var n=Sd.normalizeType(t),i=n.originType,l=n.namespaces;if(i){var u=i,c=Cd.get(u);u=(a?c.delegateType:c.bindType)||u,c=Cd.get(u);var h=Object.assign({type:u,originType:i,data:o,selector:a,guid:v,handler:r,namespace:l.join(".")},s),g=f.events,p=g[u];p||(p=g[u]={handlers:[],delegateCount:0},c.setup&&!1!==c.setup(e,o,l,d)||Sd.addEventListener(e,u,d)),c.add&&(Sd.removeHandlerId(h.handler),c.add(e,h),Sd.setHandlerId(h.handler,v)),a?(p.handlers.splice(p.delegateCount,0,h),p.delegateCount+=1):p.handlers.push(h)}}))}},e.off=function e(t,n,i,r,o){var a=Ed.get(t);if(a){var s=a.events;s&&(Sd.splitType(n).forEach((function(n){var l=Sd.normalizeType(n),u=l.originType,c=l.namespaces;if(u){var h=u,f=Cd.get(h);h=(r?f.delegateType:f.bindType)||h;var d=s[h];if(d){for(var v=c.length>0?new RegExp("(^|\\.)".concat(c.join("\\.(?:.*\\.|)"),"(\\.|$)")):null,g=d.handlers.length,p=d.handlers.length-1;p>=0;p-=1){var y=d.handlers[p];!o&&u!==y.originType||i&&Sd.getHandlerId(i)!==y.guid||!(null==v||y.namespace&&v.test(y.namespace))||!(null==r||r===y.selector||"**"===r&&y.selector)||(d.handlers.splice(p,1),y.selector&&(d.delegateCount-=1),f.remove&&f.remove(t,y))}g&&0===d.handlers.length&&(f.teardown&&!1!==f.teardown(t,c,a.handler)||Sd.removeEventListener(t,h,a.handler),delete s[h])}}else Object.keys(s).forEach((function(o){e(t,o+n,i,r,!0)}))})),0===Object.keys(s).length&&Ed.remove(t))}},e.dispatch=n,e.trigger=function(e,n,i,r){var o=e,a="string"==typeof e?e:e.type,s="string"==typeof e||null==o.namespace?[]:o.namespace.split("."),l=i;if(3!==l.nodeType&&8!==l.nodeType){a.indexOf(".")>-1&&(s=a.split("."),a=s.shift(),s.sort());var u=a.indexOf(":")<0&&"on".concat(a);(o=e instanceof Fd?e:new Fd(a,"object"===d(e)?e:null)).namespace=s.join("."),o.rnamespace=o.namespace?new RegExp("(^|\\.)".concat(s.join("\\.(?:.*\\.|)"),"(\\.|$)")):null,o.result=void 0,o.target||(o.target=l);var c=[o];Array.isArray(n)?c.push.apply(c,v(n)):c.push(n);var h=Cd.get(a);if(r||!h.trigger||!1!==h.trigger(l,o,n)){var f,g=[l];if(!r&&!h.noBubble&&!Sd.isWindow(l)){f=h.delegateType||a;for(var p=l,y=l.parentNode;null!=y;)g.push(y),p=y,y=y.parentNode;if(p===(l.ownerDocument||document)){var m=p.defaultView||p.parentWindow||window;g.push(m)}}for(var w=l,b=0,k=g.length;b<k&&!o.isPropagationStopped();b+=1){var x=g[b];w=x,o.type=b>1?f:h.bindType||a;var C,E=Ed.get(x);if(E)if(E.events[o.type]&&E.handler)(C=E.handler).call.apply(C,[x].concat(c));var S=u&&x[u]||null;S&&Sd.isValidTarget(x)&&(o.result=S.call.apply(S,[x].concat(c)),!1===o.result&&o.preventDefault())}if(o.type=a,!r&&!o.isDefaultPrevented()){var M=h.preventDefault;if((null==M||!1===M(g.pop(),o,n))&&Sd.isValidTarget(l)&&u&&"function"==typeof l[a]&&!Sd.isWindow(l)){var A=l[u];A&&(l[u]=null),t=a,o.isPropagationStopped()&&w.addEventListener(a,Sd.stopPropagationCallback),l[a](),o.isPropagationStopped()&&w.removeEventListener(a,Sd.stopPropagationCallback),t=void 0,A&&(l[u]=A)}}return o.result}}}}(Vd||(Vd={})),function(e){e.on=function(e,t,n,i,r){return Ud.on(e,t,n,i,r),e},e.once=function(e,t,n,i,r){return Ud.on(e,t,n,i,r,!0),e},e.off=function(e,t,n,i){return Ud.off(e,t,n,i),e},e.trigger=function(e,t,n,i){return Vd.trigger(t,n,e,i),e}}(Hd||(Hd={})),function(e){e.on=function t(n,i,r,o,a,s){if("object"===d(i))return"string"!=typeof r&&(o=o||r,r=void 0),void Object.keys(i).forEach((function(e){return t(n,e,r,o,i[e],s)}));if(null==o&&null==a?(a=r,o=r=void 0):null==a&&("string"==typeof r?(a=o,o=void 0):(a=o,o=r,r=void 0)),!1===a)a=Sd.returnFalse;else if(!a)return;if(s){var l=a;a=function(t){e.off(n,t);for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return l.call.apply(l,[this,t].concat(r))},Sd.setHandlerId(a,Sd.ensureHandlerId(l))}Vd.on(n,i,a,o,r)},e.off=function e(t,n,i,r){var o=n;if(o&&null!=o.preventDefault&&null!=o.handleObj){var a=o.handleObj;e(o.delegateTarget,a.namespace?"".concat(a.originType,".").concat(a.namespace):a.originType,a.selector,a.handler)}else if("object"!==d(n))!1!==i&&"function"!=typeof i||(r=i,i=void 0),!1===r&&(r=Sd.returnFalse),Vd.off(t,n,r,i);else{var s=n;Object.keys(s).forEach((function(n){return e(t,n,i,s[n])}))}}}(Ud||(Ud={}));var Gd=function(){return P((function e(t,n,i){A(this,e),this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=Wh.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=n,this.onWheelGuard=i,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}),[{key:"enable",value:function(){this.target.addEventListener(this.eventName,this.onWheel,{passive:!1})}},{key:"disable",value:function(){this.target.removeEventListener(this.eventName,this.onWheel)}},{key:"onWheel",value:function(e){var t,n=this;(null==this.onWheelGuard||this.onWheelGuard(e))&&(this.deltaX+=e.deltaX,this.deltaY+=e.deltaY,e.preventDefault(),0===this.deltaX&&0===this.deltaY||(e.stopPropagation(),t=!0),!0===t&&0===this.animationFrameId&&(this.animationFrameId=requestAnimationFrame((function(){n.didWheel(e)}))))}},{key:"didWheel",value:function(e){this.animationFrameId=0,this.onWheelCallback(e,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}])}();function Jd(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,i=null;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];i&&clearTimeout(i),i=window.setTimeout((function(){e.apply(t,o)}),n)}}var Wd,Yd="undefined"!=typeof ResizeObserver?function(e){var t=null,n=[],i=Jd((function(){n.forEach((function(t){t(e)}))})),r=function(){t&&(t.disconnect(),n=[],t=null)};return{element:e,bind:function(r){var o;t||((o=new ResizeObserver(i)).observe(e),i(),t=o),-1===n.indexOf(r)&&n.push(r)},destroy:r,unbind:function(e){var i=n.indexOf(e);-1!==i&&n.splice(i,1),0===n.length&&t&&r()}}}:function(e){var t=null,n=[],i=Jd((function(){n.forEach((function(t){return t(e)}))})),r=function(){t&&t.parentNode&&(t.contentDocument&&t.contentDocument.defaultView.removeEventListener("resize",i),t.parentNode.removeChild(t),t=null,n=[])};return{element:e,bind:function(r){t||(t=function(){"static"===getComputedStyle(e).position&&(e.style.position="relative");var t=document.createElement("object");return t.onload=function(){t.contentDocument.defaultView.addEventListener("resize",i),i()},t.style.display="block",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none",t.style.zIndex="-1",t.style.opacity="0",t.setAttribute("tabindex","-1"),t.type="text/html",e.appendChild(t),t.data="about:blank",t}()),-1===n.indexOf(r)&&n.push(r)},destroy:r,unbind:function(e){var i=n.indexOf(e);-1!==i&&n.splice(i,1),0===n.length&&t&&r()}}};!function(e){var t=new WeakMap;function n(e){var n=t.get(e);return n||(n=Yd(e),t.set(e,n),n)}e.bind=function(e,t){var i=n(e);return i.bind(t),function(){return i.unbind(t)}},e.clear=function(e){!function(e){e.destroy(),t.delete(e.element)}(n(e))}}(Wd||(Wd={}));var Zd,Kd=function(){return P((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A(this,e),this.comparator=t.comparator||e.defaultComparator,this.index={},this.data=t.data||[],this.heapify()}),[{key:"isEmpty",value:function(){return 0===this.data.length}},{key:"insert",value:function(e,t,n){var i={priority:e,value:t},r=this.data.length;return n&&(i.id=n,this.index[n]=r),this.data.push(i),this.bubbleUp(r),this}},{key:"peek",value:function(){return this.data[0]?this.data[0].value:null}},{key:"peekPriority",value:function(){return this.data[0]?this.data[0].priority:null}},{key:"updatePriority",value:function(e,t){var n=this.index[e];if(void 0===n)throw new Error("Node with id '".concat(e,"' was not found in the heap."));var i=this.data,r=i[n].priority,o=this.comparator(t,r);o<0?(i[n].priority=t,this.bubbleUp(n)):o>0&&(i[n].priority=t,this.bubbleDown(n))}},{key:"remove",value:function(){var e=this.data,t=e[0],n=e.pop();return t.id&&delete this.index[t.id],e.length>0&&(e[0]=n,n.id&&(this.index[n.id]=0),this.bubbleDown(0)),t?t.value:null}},{key:"heapify",value:function(){for(var e=0;e<this.data.length;e+=1)this.bubbleUp(e)}},{key:"bubbleUp",value:function(e){for(var t,n,i=this.data,r=e;r>0&&(n=r-1>>>1,this.comparator(i[r].priority,i[n].priority)<0);){t=i[n],i[n]=i[r];var o=i[r].id;null!=o&&(this.index[o]=n),i[r]=t,null!=(o=i[r].id)&&(this.index[o]=r),r=n}}},{key:"bubbleDown",value:function(e){for(var t=this.data,n=t.length-1,i=e;;){var r=1+(i<<1),o=r+1,a=i;if(r<=n&&this.comparator(t[r].priority,t[a].priority)<0&&(a=r),o<=n&&this.comparator(t[o].priority,t[a].priority)<0&&(a=o),a===i)break;var s=t[a];t[a]=t[i];var l=t[i].id;null!=l&&(this.index[l]=a),t[i]=s,null!=(l=t[i].id)&&(this.index[l]=i),i=a}}}])}();!function(e){e.defaultComparator=function(e,t){return e-t}}(Kd||(Kd={})),function(e){e.run=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return 1},i={},r={},o={},a=new Kd;for(i[t]=0,Object.keys(e).forEach((function(e){e!==t&&(i[e]=1/0),a.insert(i[e],e,e)}));!a.isEmpty();){var s=a.remove();o[s]=!0;for(var l=e[s]||[],u=0;u<l.length;u+=1){var c=l[u];if(!o[c]){var h=i[s]+n(s,c);h<i[c]&&(i[c]=h,r[c]=s,a.updatePriority(c,h))}}}return r}}(Zd||(Zd={}));var Xd=function(){function e(t,n,i,r){return A(this,e),null==t?this.set(255,255,255,1):"number"==typeof t?this.set(t,n,i,r):"string"==typeof t?e.fromString(t)||this:Array.isArray(t)?this.set(t):void this.set(t.r,t.g,t.b,null==t.a?1:t.a)}return P(e,[{key:"blend",value:function(e,t,n){this.set(e.r+(t.r-e.r)*n,e.g+(t.g-e.g)*n,e.b+(t.b-e.b)*n,e.a+(t.a-e.a)*n)}},{key:"lighten",value:function(t){var n=e.lighten(this.toArray(),t);this.r=n[0],this.g=n[1],this.b=n[2],this.a=n[3]}},{key:"darken",value:function(e){this.lighten(-e)}},{key:"set",value:function(e,t,n,i){var r=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:t,a=Array.isArray(e)?e[2]:n,s=Array.isArray(e)?e[3]:i;return this.r=Math.round(Ge(r,0,255)),this.g=Math.round(Ge(o,0,255)),this.b=Math.round(Ge(a,0,255)),this.a=null==s?1:Ge(s,0,1),this}},{key:"toHex",value:function(){var e=this,t=["r","g","b"].map((function(t){var n=e[t].toString(16);return n.length<2?"0".concat(n):n}));return"#".concat(t.join(""))}},{key:"toRGBA",value:function(){return this.toArray()}},{key:"toHSLA",value:function(){return e.rgba2hsla(this.r,this.g,this.b,this.a)}},{key:"toCSS",value:function(e){var t="".concat(this.r,",").concat(this.g,",").concat(this.b,",");return e?"rgb(".concat(t,")"):"rgba(".concat(t,",").concat(this.a,")")}},{key:"toGrey",value:function(){return e.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}},{key:"toArray",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toString",value:function(){return this.toCSS()}}])}();!function(e){function t(t){return new e([].concat(v(s(t)),[1]))}function n(t){var n=t.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(n){var i=n[1].split(/\s*,\s*/).map((function(e){return parseInt(e,10)}));return new e(i)}return null}function i(e,t,n){n<0&&++n,n>1&&--n;var i=6*n;return i<1?e+(t-e)*i:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function r(t){var n=t.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(n){var i=n[2].split(/\s*,\s*/),r=(parseFloat(i[0])%360+360)%360/360,a=parseFloat(i[1])/100,s=parseFloat(i[2])/100,l=null==i[3]?1:parseInt(i[3],10);return new e(o(r,a,s,l))}return null}function o(e,t,n,r){var o=Array.isArray(e)?e[0]:e,a=Array.isArray(e)?e[1]:t,s=Array.isArray(e)?e[2]:n,l=Array.isArray(e)?e[3]:r,u=s<=.5?s*(a+1):s+a-s*a,c=2*s-u;return[256*i(c,u,o+1/3),256*i(c,u,o),256*i(c,u,o-1/3),null==l?1:l]}function a(t){return new e(Math.round(256*Math.random()),Math.round(256*Math.random()),Math.round(256*Math.random()),t?void 0:parseFloat(Math.random().toFixed(2)))}function s(e){var t=0===e.indexOf("#")?e:"#".concat(e),n=Number("0x".concat(t.substr(1)));if(4!==t.length&&7!==t.length||Number.isNaN(n))throw new Error("Invalid hex color.");var i=4===t.length?4:8,r=(1<<i)-1,o=["b","g","r"].map((function(){var e=n&r;return n>>=i,4===i?17*e:e}));return[o[2],o[1],o[0]]}function l(e,t,n){var i=function(e){return e.length<2?"0".concat(e):e};return"".concat(i(e.toString(16))).concat(i(t.toString(16))).concat(i(n.toString(16)))}function u(e,t){if("string"==typeof e){var n="#"===e[0],i=parseInt(n?e.substr(1):e,16),r=Ge((i>>16)+t,0,255),o=Ge((i>>8&255)+t,0,255),a=Ge((255&i)+t,0,255);return"".concat(n?"#":"").concat((a|o<<8|r<<16).toString(16))}var c=s(u(l(e[0],e[1],e[2]),t));return[c[0],c[1],c[2],e[3]]}e.fromArray=function(t){return new e(t)},e.fromHex=t,e.fromRGBA=n,e.fromHSLA=r,e.fromString=function(i){if(i.startsWith("#"))return t(i);if(i.startsWith("rgb"))return n(i);var o=e.named[i];return o?t(o):r(i)},e.makeGrey=function(t,n){return e.fromArray([t,t,t,n])},e.rgba2hsla=function(e,t,n,i){var r=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:t,a=Array.isArray(e)?e[2]:n,s=Array.isArray(e)?e[3]:i,l=Math.max(r,o,a),u=Math.min(r,o,a),c=(l+u)/2,h=0,f=0;if(u!==l){var d=l-u;switch(f=c>.5?d/(2-l-u):d/(l+u),l){case r:h=(o-a)/d+(o<a?6:0);break;case o:h=(a-r)/d+2;break;case a:h=(r-o)/d+4}h/=6}return[h,f,c,null==s?1:s]},e.hsla2rgba=o,e.random=a,e.randomHex=function(){for(var e="#",t=0;t<6;t+=1)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},e.randomRGBA=function(e){return a(e).toString()},e.invert=function(e,t){if("string"==typeof e){var n="#"===e[0],i=p(s(e),3),r=i[0],o=i[1],a=i[2];return t?.299*r+.587*o+.114*a>186?"#000000":"#ffffff":"".concat(n?"#":"").concat(l(255-r,255-o,255-a))}var u=e[0],c=e[1],h=e[2],f=e[3];return t?.299*u+.587*c+.114*h>186?[0,0,0,f]:[255,255,255,f]:[255-u,255-c,255-h,f]},e.lighten=function(e,t){return u(e,t)},e.darken=function(e,t){return u(e,-t)}}(Xd||(Xd={})),function(e){e.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(Xd||(Xd={}));var $d,Qd,ev,tv=function(){return P((function e(){A(this,e),this.clear()}),[{key:"clear",value:function(){this.map=new WeakMap,this.arr=[]}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e){return this.map.get(e)}},{key:"set",value:function(e,t){this.map.set(e,t),this.arr.push(e)}},{key:"delete",value:function(e){var t=this.arr.indexOf(e);t>=0&&this.arr.splice(t,1);var n=this.map.get(e);return this.map.delete(e),n}},{key:"each",value:function(e){var t=this;this.arr.forEach((function(n){var i=t.map.get(n);e(i,n)}))}},{key:"dispose",value:function(){this.clear()}}])}();!function(e){function t(e){var t=[],n=[];return Array.isArray(e)?t.push.apply(t,v(e)):e.split("|").forEach((function(e){-1===e.indexOf("&")?t.push(e):n.push.apply(n,v(e.split("&")))})),{or:t,and:n}}e.parse=t,e.equals=function(e,n){if(null!=e&&null!=n){var i=t(e),r=t(n),o=i.or.sort(),a=r.or.sort(),s=i.and.sort(),l=r.and.sort(),u=function(e,t){return e.length===t.length&&(0===e.length||e.every((function(e,n){return e===t[n]})))};return u(o,a)&&u(s,l)}return null==e&&null==n},e.isMatch=function(e,n,i){if(null==n||Array.isArray(n)&&0===n.length)return!i||!0!==e.altKey&&!0!==e.ctrlKey&&!0!==e.metaKey&&!0!==e.shiftKey;var r=t(n),o=r.or,a=r.and,s=function(t){var n="".concat(t.toLowerCase(),"Key");return!0===e[n]};return o.some((function(e){return s(e)}))&&a.every((function(e){return s(e)}))}}($d||($d={})),function(e){e.linear=function(e){return e},e.quad=function(e){return e*e},e.cubic=function(e){return e*e*e},e.inout=function(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)},e.exponential=function(e){return Math.pow(2,10*(e-1))},e.bounce=function(e){for(var t=0,n=1;;t+=n,n/=2)if(e>=(7-4*t)/11){var i=(11-6*t-11*e)/4;return-i*i+n*n}}}(Qd||(Qd={})),function(e){e.decorators={reverse:function(e){return function(t){return 1-e(1-t)}},reflect:function(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}},clamp:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(i){var r=e(i);return r<t?t:r>n?n:r}},back:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.70158;return function(t){return t*t*((e+1)*t-e)}},elastic:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.5;return function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}}}(Qd||(Qd={})),function(e){function t(e){var t=e/1;if(t<1/2.75)return 7.5625*t*t;if(t<2/2.75){var n=t-1.5/2.75;return 7.5625*n*n+.75}if(t<2.5/2.75){var i=t-2.25/2.75;return 7.5625*i*i+.9375}var r=t-2.625/2.75;return 7.5625*r*r+.984375}function n(e){return 1-t(1-e)}e.easeInSine=function(e){return-1*Math.cos(e*(Math.PI/2))+1},e.easeOutSine=function(e){return Math.sin(e*(Math.PI/2))},e.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)},e.easeInQuad=function(e){return e*e},e.easeOutQuad=function(e){return e*(2-e)},e.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1},e.easeInCubic=function(e){return e*e*e},e.easeOutCubic=function(e){var t=e-1;return t*t*t+1},e.easeInOutCubic=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},e.easeInQuart=function(e){return e*e*e*e},e.easeOutQuart=function(e){var t=e-1;return 1-t*t*t*t},e.easeInOutQuart=function(e){var t=e-1;return e<.5?8*e*e*e*e:1-8*t*t*t*t},e.easeInQuint=function(e){return e*e*e*e*e},e.easeOutQuint=function(e){var t=e-1;return 1+t*t*t*t*t},e.easeInOutQuint=function(e){var t=e-1;return e<.5?16*e*e*e*e*e:1+16*t*t*t*t*t},e.easeInExpo=function(e){return 0===e?0:Math.pow(2,10*(e-1))},e.easeOutExpo=function(e){return 1===e?1:1-Math.pow(2,-10*e)},e.easeInOutExpo=function(e){if(0===e||1===e)return e;var t=2*e,n=t-1;return t<1?.5*Math.pow(2,10*n):.5*(2-Math.pow(2,-10*n))},e.easeInCirc=function(e){var t=e/1;return-1*(Math.sqrt(1-t*e)-1)},e.easeOutCirc=function(e){var t=e-1;return Math.sqrt(1-t*t)},e.easeInOutCirc=function(e){var t=2*e,n=t-2;return t<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-n*n)+1)},e.easeInBack=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158;return e*e*((t+1)*e-t)},e.easeOutBack=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158,n=e/1-1;return n*n*((t+1)*n+t)+1},e.easeInOutBack=function(e){var t=2*e,n=t-2,i=1.525*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158);return t<1?.5*t*t*((i+1)*t-i):.5*(n*n*((i+1)*n+i)+2)},e.easeInElastic=function(e){if(0===e||1===e)return e;var t=e/1-1,n=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7),i=n/(2*Math.PI)*Math.asin(1);return-Math.pow(2,10*t)*Math.sin((t-i)*(2*Math.PI)/n)},e.easeOutElastic=function(e){var t=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7),n=2*e;if(0===e||1===e)return e;var i=t/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*n)*Math.sin((n-i)*(2*Math.PI)/t)+1},e.easeInOutElastic=function(e){var t=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.65);if(0===e||1===e)return e;var n=2*e,i=n-1,r=t/(2*Math.PI)*Math.asin(1);return n<1?Math.pow(2,10*i)*Math.sin((i-r)*(2*Math.PI)/t)*-.5:Math.pow(2,-10*i)*Math.sin((i-r)*(2*Math.PI)/t)*.5+1},e.easeOutBounce=t,e.easeInBounce=n,e.easeInOutBounce=function(e){return e<.5?.5*n(2*e):.5*t(2*e-1)+.5}}(Qd||(Qd={})),function(e){e.number=function(e,t){var n=t-e;return function(t){return e+n*t}},e.object=function(e,t){var n=Object.keys(e);return function(i){for(var r={},o=n.length-1;-1!==o;o-=1){var a=n[o];r[a]=e[a]+(t[a]-e[a])*i}return r}},e.unit=function(e,t){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,i=n.exec(e),r=n.exec(t),o=r?r[1]:"",a=i?+i[1]:0,s=r?+r[1]:0,l=o.indexOf("."),u=l>0?o[1].length-l-1:0,c=s-a,h=i?i[2]:"";return function(e){return(a+c*e).toFixed(u)+h}},e.color=function(e,t){var n=parseInt(e.slice(1),16),i=parseInt(t.slice(1),16),r=255&n,o=(255&i)-r,a=65280&n,s=(65280&i)-a,l=16711680&n,u=(16711680&i)-l;return function(e){return"#".concat((1<<24|r+o*e&255|a+s*e&65280|l+u*e&16711680).toString(16).slice(1))}}}(ev||(ev={}));var nv,iv,rv=[];!function(e){e.toDeg=function(e){return 180*e/Math.PI%360},e.toRad=function(e){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:e%360)*Math.PI/180},e.normalize=function(e){return e%360+(e<0?360:0)}}(nv||(nv={})),function(e){e.round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number.isInteger(e)?e:+e.toFixed(t)},e.random=function(e,t){var n,i;if(null==t?(i=null==e?1:e,n=0):(i=t,n=null==e?0:e),i<n){var r=n;n=i,i=r}return Math.floor(Math.random()*(i-n+1)+n)},e.clamp=function(e,t,n){return Number.isNaN(e)?NaN:Number.isNaN(t)||Number.isNaN(n)?0:t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e},e.snapToGrid=function(e,t){return t*Math.round(e/t)},e.containsPoint=function(e,t){return null!=t&&null!=e&&t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},e.squaredLength=function(e,t){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}}(iv||(iv={}));var ov=function(){return P((function e(){A(this,e)}),[{key:"valueOf",value:function(){return this.toJSON()}},{key:"toString",value:function(){return JSON.stringify(this.toJSON())}}])}(),av=function(e){function t(e,n){var i;return A(this,t),(i=s(this,t)).x=null==e?0:e,i.y=null==n?0:n,i}return h(t,e),P(t,[{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x=iv.round(this.x,e),this.y=iv.round(this.y,e),this}},{key:"add",value:function(e,n){var i=t.create(e,n);return this.x+=i.x,this.y+=i.y,this}},{key:"update",value:function(e,n){var i=t.create(e,n);return this.x=i.x,this.y=i.y,this}},{key:"translate",value:function(e,n){var i=t.create(e,n);return this.x+=i.x,this.y+=i.y,this}},{key:"rotate",value:function(e,n){var i=t.rotate(this,e,n);return this.x=i.x,this.y=i.y,this}},{key:"scale",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t,r=t.create(i);return this.x=r.x+e*(this.x-r.x),this.y=r.y+n*(this.y-r.y),this}},{key:"closest",value:function(e){var n=this;if(1===e.length)return t.create(e[0]);var i=null,r=1/0;return e.forEach((function(e){var t=n.squaredDistance(e);t<r&&(i=e,r=t)})),i?t.create(i):null}},{key:"distance",value:function(e){return Math.sqrt(this.squaredDistance(e))}},{key:"squaredDistance",value:function(e){var n=t.create(e),i=this.x-n.x,r=this.y-n.y;return i*i+r*r}},{key:"manhattanDistance",value:function(e){var n=t.create(e);return Math.abs(n.x-this.x)+Math.abs(n.y-this.y)}},{key:"magnitude",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}},{key:"theta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t,n=t.create(e),i=-(n.y-this.y),r=n.x-this.x,o=Math.atan2(i,r);return o<0&&(o=2*Math.PI+o),180*o/Math.PI}},{key:"angleBetween",value:function(e,t){if(this.equals(e)||this.equals(t))return NaN;var n=this.theta(t)-this.theta(e);return n<0&&(n+=360),n}},{key:"vectorAngle",value:function(e){return new t(0,0).angleBetween(this,e)}},{key:"toPolar",value:function(e){return this.update(t.toPolar(this,e)),this}},{key:"changeInAngle",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return this.clone().translate(-e,-n).theta(i)-this.theta(i)}},{key:"adhereToRect",value:function(e){return iv.containsPoint(e,this)||(this.x=Math.min(Math.max(this.x,e.x),e.x+e.width),this.y=Math.min(Math.max(this.y,e.y),e.y+e.height)),this}},{key:"bearing",value:function(e){var n=t.create(e),i=nv.toRad(this.y),r=nv.toRad(n.y),o=this.x,a=n.x,s=nv.toRad(a-o),l=Math.sin(s)*Math.cos(r),u=Math.cos(i)*Math.sin(r)-Math.sin(i)*Math.cos(r)*Math.cos(s),c=nv.toDeg(Math.atan2(l,u))-22.5;return c<0&&(c+=360),["NE","E","SE","S","SW","W","NW","N"][c=parseInt(c/45,10)]}},{key:"cross",value:function(e,n){if(null!=e&&null!=n){var i=t.create(e),r=t.create(n);return(r.x-this.x)*(i.y-this.y)-(r.y-this.y)*(i.x-this.x)}return NaN}},{key:"dot",value:function(e){var n=t.create(e);return this.x*n.x+this.y*n.y}},{key:"diff",value:function(e,n){if("number"==typeof e)return new t(this.x-e,this.y-n);var i=t.create(e);return new t(this.x-i.x,this.y-i.y)}},{key:"lerp",value:function(e,n){var i=t.create(e);return new t((1-n)*this.x+n*i.x,(1-n)*this.y+n*i.y)}},{key:"normalize",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)/this.magnitude();return this.scale(e,e)}},{key:"move",value:function(e,n){var i=t.create(e),r=nv.toRad(i.theta(this));return this.translate(Math.cos(r)*n,-Math.sin(r)*n)}},{key:"reflection",value:function(e){return t.create(e).move(this,this.distance(e))}},{key:"snapToGrid",value:function(e,t){return this.x=iv.snapToGrid(this.x,e),this.y=iv.snapToGrid(this.y,null==t?e:t),this}},{key:"equals",value:function(e){var n=t.create(e);return null!=n&&n.x===this.x&&n.y===this.y}},{key:"clone",value:function(){return t.clone(this)}},{key:"toJSON",value:function(){return t.toJSON(this)}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y)}}])}(ov);!function(e){e.isPoint=function(t){return null!=t&&t instanceof e}}(av||(av={})),function(e){e.isPointLike=function(e){return null!=e&&"object"===d(e)&&"number"==typeof e.x&&"number"==typeof e.y},e.isPointData=function(e){return null!=e&&Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}}(av||(av={})),function(e){function t(t){return e.isPoint(t)?new e(t.x,t.y):Array.isArray(t)?new e(t[0],t[1]):new e(t.x,t.y)}function n(e,t){return e===t||null!=e&&null!=t&&(e.x===t.x&&e.y===t.y)}function i(n,i,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e,a=t(n),s=t(o),l=a.x-s.x,u=a.y-s.y,c=u*i+l*r;return new e(l*i-u*r+s.x,c+s.y)}e.create=function(n,i){return null==n||"number"==typeof n?new e(n,i):t(n)},e.clone=t,e.toJSON=function(t){return e.isPoint(t)?{x:t.x,y:t.y}:Array.isArray(t)?{x:t[0],y:t[1]}:{x:t.x,y:t.y}},e.fromPolar=function(n,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e,o=Math.abs(n*Math.cos(i)),a=Math.abs(n*Math.sin(i)),s=t(r),l=nv.normalize(nv.toDeg(i));return l<90?a=-a:l<180?(o=-o,a=-a):l<270&&(o=-o),new e(s.x+o,s.y+a)},e.toPolar=function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=t(n),o=t(i),a=r.x-o.x,s=r.y-o.y;return new e(Math.sqrt(a*a+s*s),nv.toRad(o.theta(r)))},e.equals=n,e.equalPoints=function(e,t){if(null==e&&null!=t||null!=e&&null==t||null!=e&&null!=t&&e.length!==t.length)return!1;if(null!=e&&null!=t)for(var i=0,r=e.length;i<r;i+=1)if(!n(e[i],t[i]))return!1;return!0},e.random=function(t,n,i,r){return new e(iv.random(t,n),iv.random(i,r))},e.rotate=function(e,t,n){var r=nv.toRad(nv.normalize(-t)),o=Math.sin(r);return i(e,Math.cos(r),o,n)},e.rotateEx=i}(av||(av={}));var sv=function(e){function t(e,n,i,r){var o;return A(this,t),(o=s(this,t)).x=null==e?0:e,o.y=null==n?0:n,o.width=null==i?0:i,o.height=null==r?0:r,o}return h(t,e),P(t,[{key:"left",get:function(){return this.x}},{key:"top",get:function(){return this.y}},{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"origin",get:function(){return new av(this.x,this.y)}},{key:"topLeft",get:function(){return new av(this.x,this.y)}},{key:"topCenter",get:function(){return new av(this.x+this.width/2,this.y)}},{key:"topRight",get:function(){return new av(this.x+this.width,this.y)}},{key:"center",get:function(){return new av(this.x+this.width/2,this.y+this.height/2)}},{key:"bottomLeft",get:function(){return new av(this.x,this.y+this.height)}},{key:"bottomCenter",get:function(){return new av(this.x+this.width/2,this.y+this.height)}},{key:"bottomRight",get:function(){return new av(this.x+this.width,this.y+this.height)}},{key:"corner",get:function(){return new av(this.x+this.width,this.y+this.height)}},{key:"rightMiddle",get:function(){return new av(this.x+this.width,this.y+this.height/2)}},{key:"leftMiddle",get:function(){return new av(this.x,this.y+this.height/2)}},{key:"topLine",get:function(){return new lv(this.topLeft,this.topRight)}},{key:"rightLine",get:function(){return new lv(this.topRight,this.bottomRight)}},{key:"bottomLine",get:function(){return new lv(this.bottomLeft,this.bottomRight)}},{key:"leftLine",get:function(){return new lv(this.topLeft,this.bottomLeft)}},{key:"getOrigin",value:function(){return this.origin}},{key:"getTopLeft",value:function(){return this.topLeft}},{key:"getTopCenter",value:function(){return this.topCenter}},{key:"getTopRight",value:function(){return this.topRight}},{key:"getCenter",value:function(){return this.center}},{key:"getCenterX",value:function(){return this.x+this.width/2}},{key:"getCenterY",value:function(){return this.y+this.height/2}},{key:"getBottomLeft",value:function(){return this.bottomLeft}},{key:"getBottomCenter",value:function(){return this.bottomCenter}},{key:"getBottomRight",value:function(){return this.bottomRight}},{key:"getCorner",value:function(){return this.corner}},{key:"getRightMiddle",value:function(){return this.rightMiddle}},{key:"getLeftMiddle",value:function(){return this.leftMiddle}},{key:"getTopLine",value:function(){return this.topLine}},{key:"getRightLine",value:function(){return this.rightLine}},{key:"getBottomLine",value:function(){return this.bottomLine}},{key:"getLeftLine",value:function(){return this.leftLine}},{key:"bbox",value:function(e){if(!e)return this.clone();var n=nv.toRad(e),i=Math.abs(Math.sin(n)),r=Math.abs(Math.cos(n)),o=this.width*r+this.height*i,a=this.width*i+this.height*r;return new t(this.x+(this.width-o)/2,this.y+(this.height-a)/2,o,a)}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x=iv.round(this.x,e),this.y=iv.round(this.y,e),this.width=iv.round(this.width,e),this.height=iv.round(this.height,e),this}},{key:"add",value:function(e,n,i,r){var o=t.create(e,n,i,r),a=Math.min(this.x,o.x),s=Math.min(this.y,o.y),l=Math.max(this.x+this.width,o.x+o.width),u=Math.max(this.y+this.height,o.y+o.height);return this.x=a,this.y=s,this.width=l-a,this.height=u-s,this}},{key:"update",value:function(e,n,i,r){var o=t.create(e,n,i,r);return this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height,this}},{key:"inflate",value:function(e,t){var n=e,i=null!=t?t:e;return this.x-=n,this.y-=i,this.width+=2*n,this.height+=2*i,this}},{key:"snapToGrid",value:function(e,t){var n=this.origin.snapToGrid(e,t),i=this.corner.snapToGrid(e,t);return this.x=n.x,this.y=n.y,this.width=i.x-n.x,this.height=i.y-n.y,this}},{key:"translate",value:function(e,t){var n=av.create(e,t);return this.x+=n.x,this.y+=n.y,this}},{key:"scale",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new av,i=this.origin.scale(e,t,n);return this.x=i.x,this.y=i.y,this.width*=e,this.height*=t,this}},{key:"rotate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCenter();if(0!==e){var i=nv.toRad(e),r=Math.cos(i),o=Math.sin(i),a=this.getOrigin(),s=this.getTopRight(),l=this.getBottomRight(),u=this.getBottomLeft();a=av.rotateEx(a,r,o,n),s=av.rotateEx(s,r,o,n),l=av.rotateEx(l,r,o,n),u=av.rotateEx(u,r,o,n);var c=new t(a.x,a.y,0,0);c.add(s.x,s.y,0,0),c.add(l.x,l.y,0,0),c.add(u.x,u.y,0,0),this.update(c)}return this}},{key:"rotate90",value:function(){var e=(this.width-this.height)/2;this.x+=e,this.y-=e;var t=this.width;return this.width=this.height,this.height=t,this}},{key:"moveAndExpand",value:function(e){var n=t.clone(e);return this.x+=n.x||0,this.y+=n.y||0,this.width+=n.width||0,this.height+=n.height||0,this}},{key:"getMaxScaleToFit",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.center,i=t.clone(e),r=n.x,o=n.y,a=1/0,s=1/0,l=1/0,u=1/0,c=1/0,h=1/0,f=1/0,d=1/0,v=i.topLeft;v.x<r&&(a=(this.x-r)/(v.x-r)),v.y<o&&(c=(this.y-o)/(v.y-o));var g=i.bottomRight;g.x>r&&(s=(this.x+this.width-r)/(g.x-r)),g.y>o&&(h=(this.y+this.height-o)/(g.y-o));var p=i.topRight;p.x>r&&(l=(this.x+this.width-r)/(p.x-r)),p.y<o&&(f=(this.y-o)/(p.y-o));var y=i.bottomLeft;return y.x<r&&(u=(this.x-r)/(y.x-r)),y.y>o&&(d=(this.y+this.height-o)/(y.y-o)),{sx:Math.min(a,s,l,u),sy:Math.min(c,h,f,d)}}},{key:"getMaxUniformScaleToFit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.center,n=this.getMaxScaleToFit(e,t);return Math.min(n.sx,n.sy)}},{key:"containsPoint",value:function(e,t){return iv.containsPoint(this,av.create(e,t))}},{key:"containsRect",value:function(e,n,i,r){var o=t.create(e,n,i,r),a=this.x,s=this.y,l=this.width,u=this.height,c=o.x,h=o.y,f=o.width,d=o.height;return 0!==l&&0!==u&&0!==f&&0!==d&&(c>=a&&h>=s&&c+f<=a+l&&h+d<=s+u)}},{key:"intersectsWithLine",value:function(e){var t=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],n=[],i=[];return t.forEach((function(t){var r=e.intersectsWithLine(t);null!==r&&i.indexOf(r.toString())<0&&(n.push(r),i.push(r.toString()))})),n.length>0?n:null}},{key:"intersectsWithLineFromCenterToPoint",value:function(e,t){var n=av.clone(e),i=this.center,r=null;null!=t&&0!==t&&n.rotate(t,i);for(var o=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],a=new lv(i,n),s=o.length-1;s>=0;s-=1){var l=o[s].intersectsWithLine(a);if(null!==l){r=l;break}}return r&&null!=t&&0!==t&&r.rotate(-t,i),r}},{key:"intersectsWithRect",value:function(e,n,i,r){var o=t.create(e,n,i,r);if(!this.isIntersectWithRect(o))return null;var a=this.origin,s=this.corner,l=o.origin,u=o.corner,c=Math.max(a.x,l.x),h=Math.max(a.y,l.y);return new t(c,h,Math.min(s.x,u.x)-c,Math.min(s.y,u.y)-h)}},{key:"isIntersectWithRect",value:function(e,n,i,r){var o=t.create(e,n,i,r),a=this.origin,s=this.corner,l=o.origin,u=o.corner;return!(u.x<=a.x||u.y<=a.y||l.x>=s.x||l.y>=s.y)}},{key:"normalize",value:function(){var e=this.x,t=this.y,n=this.width,i=this.height;return this.width<0&&(e=this.x+this.width,n=-this.width),this.height<0&&(t=this.y+this.height,i=-this.height),this.x=e,this.y=t,this.width=n,this.height=i,this}},{key:"union",value:function(e){var n=t.clone(e),i=this.origin,r=this.corner,o=n.origin,a=n.corner,s=Math.min(i.x,o.x),l=Math.min(i.y,o.y);return new t(s,l,Math.max(r.x,a.x)-s,Math.max(r.y,a.y)-l)}},{key:"getNearestSideToPoint",value:function(e){var t=av.clone(e),n=t.x-this.x,i=this.x+this.width-t.x,r=t.y-this.y,o=n,a="left";return i<o&&(o=i,a="right"),r<o&&(o=r,a="top"),this.y+this.height-t.y<o&&(a="bottom"),a}},{key:"getNearestPointToPoint",value:function(e){var t=av.clone(e);if(this.containsPoint(t)){var n=this.getNearestSideToPoint(t);if("left"===n)return new av(this.x,t.y);if("top"===n)return new av(t.x,this.y);if("right"===n)return new av(this.x+this.width,t.y);if("bottom"===n)return new av(t.x,this.y+this.height)}return t.adhereToRect(this)}},{key:"equals",value:function(e){return null!=e&&e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}},{key:"clone",value:function(){return new t(this.x,this.y,this.width,this.height)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y," ").concat(this.width," ").concat(this.height)}}])}(ov);!function(e){e.isRectangle=function(t){return null!=t&&t instanceof e}}(sv||(sv={})),function(e){e.isRectangleLike=function(e){return null!=e&&"object"===d(e)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.width&&"number"==typeof e.height}}(sv||(sv={})),function(e){function t(t){return e.isRectangle(t)?t.clone():Array.isArray(t)?new e(t[0],t[1],t[2],t[3]):new e(t.x,t.y,t.width,t.height)}e.create=function(n,i,r,o){return null==n||"number"==typeof n?new e(n,i,r,o):t(n)},e.clone=t,e.fromEllipse=function(t){return new e(t.x-t.a,t.y-t.b,2*t.a,2*t.b)},e.fromSize=function(t){return new e(0,0,t.width,t.height)},e.fromPositionAndSize=function(t,n){return new e(t.x,t.y,n.width,n.height)}}(sv||(sv={}));var lv=function(e){function t(e,n,i,r){var o;return A(this,t),o=s(this,t),"number"==typeof e&&"number"==typeof n?(o.start=new av(e,n),o.end=new av(i,r)):(o.start=av.create(e),o.end=av.create(n)),o}return h(t,e),P(t,[{key:"center",get:function(){return new av((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}},{key:"getCenter",value:function(){return this.center}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.start.round(e),this.end.round(e),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.start.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.end.translate(e)),this}},{key:"rotate",value:function(e,t){return this.start.rotate(e,t),this.end.rotate(e,t),this}},{key:"scale",value:function(e,t,n){return this.start.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"length",value:function(){return Math.sqrt(this.squaredLength())}},{key:"squaredLength",value:function(){var e=this.start.x-this.end.x,t=this.start.y-this.end.y;return e*e+t*t}},{key:"setLength",value:function(e){var t=this.length();if(!t)return this;var n=e/t;return this.scale(n,n,this.start)}},{key:"parallel",value:function(e){var t=this.clone();if(!t.isDifferentiable())return t;var n=t.start,i=t.end,r=n.clone().rotate(270,i),o=i.clone().rotate(90,n);return n.move(o,e),i.move(r,e),t}},{key:"vector",value:function(){return new av(this.end.x-this.start.x,this.end.y-this.start.y)}},{key:"angle",value:function(){var e=new av(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,e)}},{key:"bbox",value:function(){var e=Math.min(this.start.x,this.end.x),t=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),i=Math.max(this.start.y,this.end.y);return new sv(e,t,n-e,i-t)}},{key:"bearing",value:function(){return this.start.bearing(this.end)}},{key:"closestPoint",value:function(e){return this.pointAt(this.closestPointNormalizedLength(e))}},{key:"closestPointLength",value:function(e){return this.closestPointNormalizedLength(e)*this.length()}},{key:"closestPointTangent",value:function(e){return this.tangentAt(this.closestPointNormalizedLength(e))}},{key:"closestPointNormalizedLength",value:function(e){var n=this.vector().dot(new t(this.start,e).vector()),i=Math.min(1,Math.max(0,n/this.squaredLength()));return Number.isNaN(i)?0:i}},{key:"pointAt",value:function(e){var t=this.start,n=this.end;return e<=0?t.clone():e>=1?n.clone():t.lerp(n,e)}},{key:"pointAtLength",value:function(e){var t=this.start,n=this.end,i=!0;e<0&&(i=!1,e=-e);var r=this.length();if(e>=r)return i?n.clone():t.clone();var o=(i?e:r-e)/r;return this.pointAt(o)}},{key:"divideAt",value:function(e){var n=this.pointAt(e);return[new t(this.start,n),new t(n,this.end)]}},{key:"divideAtLength",value:function(e){var n=this.pointAtLength(e);return[new t(this.start,n),new t(n,this.end)]}},{key:"containsPoint",value:function(e){var n=this.start,i=this.end;if(0!==n.cross(e,i))return!1;var r=this.length();return!(new t(n,e).length()>r)&&!(new t(e,i).length()>r)}},{key:"intersect",value:function(e,t){var n=e.intersectsWithLine(this,t);return n?Array.isArray(n)?n:[n]:null}},{key:"intersectsWithLine",value:function(e){var t=new av(this.end.x-this.start.x,this.end.y-this.start.y),n=new av(e.end.x-e.start.x,e.end.y-e.start.y),i=t.x*n.y-t.y*n.x,r=new av(e.start.x-this.start.x,e.start.y-this.start.y),o=r.x*n.y-r.y*n.x,a=r.x*t.y-r.y*t.x;if(0===i||o*i<0||a*i<0)return null;if(i>0){if(o>i||a>i)return null}else if(o<i||a<i)return null;return new av(this.start.x+o*t.x/i,this.start.y+o*t.y/i)}},{key:"isDifferentiable",value:function(){return!this.start.equals(this.end)}},{key:"pointOffset",value:function(e){var t=av.clone(e),n=this.start,i=this.end;return((i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x))/this.length()}},{key:"pointSquaredDistance",value:function(e,t){var n=av.create(e,t);return this.closestPoint(n).squaredDistance(n)}},{key:"pointDistance",value:function(e,t){var n=av.create(e,t);return this.closestPoint(n).distance(n)}},{key:"tangentAt",value:function(e){if(!this.isDifferentiable())return null;var n=this.start,i=this.end,r=this.pointAt(e),o=new t(n,i);return o.translate(r.x-n.x,r.y-n.y),o}},{key:"tangentAtLength",value:function(e){if(!this.isDifferentiable())return null;var n=this.start,i=this.end,r=this.pointAtLength(e),o=new t(n,i);return o.translate(r.x-n.x,r.y-n.y),o}},{key:"relativeCcw",value:function(e,t){var n=av.create(e,t),i=n.x-this.start.x,r=n.y-this.start.y,o=this.end.x-this.start.x,a=this.end.y-this.start.y,s=i*a-r*o;return 0===s&&(s=i*o+r*a)>0&&(s=(i-=o)*o+(r-=a)*a)<0&&(s=0),s<0?-1:s>0?1:0}},{key:"equals",value:function(e){return null!=e&&this.start.x===e.start.x&&this.start.y===e.start.y&&this.end.x===e.end.x&&this.end.y===e.end.y}},{key:"clone",value:function(){return new t(this.start,this.end)}},{key:"toJSON",value:function(){return{start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return[this.start.serialize(),this.end.serialize()].join(" ")}}])}(ov);!function(e){e.isLine=function(t){return null!=t&&t instanceof e}}(lv||(lv={}));var uv=function(e){function t(e,n,i,r){var o;return A(this,t),(o=s(this,t)).x=null==e?0:e,o.y=null==n?0:n,o.a=null==i?0:i,o.b=null==r?0:r,o}return h(t,e),P(t,[{key:"center",get:function(){return new av(this.x,this.y)}},{key:"bbox",value:function(){return sv.fromEllipse(this)}},{key:"getCenter",value:function(){return this.center}},{key:"inflate",value:function(e,t){var n=e,i=null!=t?t:e;return this.a+=2*n,this.b+=2*i,this}},{key:"normalizedDistance",value:function(e,t){var n=av.create(e,t),i=n.x-this.x,r=n.y-this.y,o=this.a,a=this.b;return i*i/(o*o)+r*r/(a*a)}},{key:"containsPoint",value:function(e,t){return this.normalizedDistance(e,t)<=1}},{key:"intersectsWithLine",value:function(e){var t=[],n=this.a,i=this.b,r=e.start,o=e.end,a=e.vector(),s=r.diff(new av(this.x,this.y)),l=new av(a.x/(n*n),a.y/(i*i)),u=new av(s.x/(n*n),s.y/(i*i)),c=a.dot(l),h=a.dot(u),f=h*h-c*(s.dot(u)-1);if(f<0)return null;if(f>0){var d=Math.sqrt(f),v=(-h-d)/c,g=(-h+d)/c;if((v<0||v>1)&&(g<0||g>1))return null;v>=0&&v<=1&&t.push(r.lerp(o,v)),g>=0&&g<=1&&t.push(r.lerp(o,g))}else{var p=-h/c;if(!(p>=0&&p<=1))return null;t.push(r.lerp(o,p))}return t}},{key:"intersectsWithLineFromCenterToPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=av.clone(e);t&&n.rotate(t,this.getCenter());var i,r=n.x-this.x,o=n.y-this.y;if(0===r)return i=this.bbox().getNearestPointToPoint(n),t?i.rotate(-t,this.getCenter()):i;var a=o/r,s=a*a,l=this.a*this.a,u=this.b*this.b,c=Math.sqrt(1/(1/l+s/u)),h=a*(c=r<0?-c:c);return i=new av(this.x+c,this.y+h),t?i.rotate(-t,this.getCenter()):i}},{key:"tangentTheta",value:function(e){var t,n,i=av.clone(e),r=i.x,o=i.y,a=this.a,s=this.b,l=this.bbox().center,u=l.x,c=l.y,h=r>l.x+a/2,f=r<l.x-a/2;return h||f?t=a*a/(r-u)-a*a*(o-c)*((n=r>l.x?o-30:o+30)-c)/(s*s*(r-u))+u:n=s*s/(o-c)-s*s*(r-u)*((t=o>l.y?r+30:r-30)-u)/(a*a*(o-c))+c,new av(t,n).theta(i)}},{key:"scale",value:function(e,t){return this.a*=e,this.b*=t,this}},{key:"rotate",value:function(e,n){var i=sv.fromEllipse(this);i.rotate(e,n);var r=t.fromRect(i);return this.a=r.a,this.b=r.b,this.x=r.x,this.y=r.y,this}},{key:"translate",value:function(e,t){var n=av.create(e,t);return this.x+=n.x,this.y+=n.y,this}},{key:"equals",value:function(e){return null!=e&&e.x===this.x&&e.y===this.y&&e.a===this.a&&e.b===this.b}},{key:"clone",value:function(){return new t(this.x,this.y,this.a,this.b)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,a:this.a,b:this.b}}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y," ").concat(this.a," ").concat(this.b)}}])}(ov);!function(e){e.isEllipse=function(t){return null!=t&&t instanceof e}}(uv||(uv={})),function(e){function t(t){return e.isEllipse(t)?t.clone():Array.isArray(t)?new e(t[0],t[1],t[2],t[3]):new e(t.x,t.y,t.a,t.b)}e.create=function(n,i,r,o){return null==n||"number"==typeof n?new e(n,i,r,o):t(n)},e.parse=t,e.fromRect=function(t){var n=t.center;return new e(n.x,n.y,t.width/2,t.height/2)}}(uv||(uv={}));var cv=new RegExp("^[\\s\\dLMCZz,.]*$");function hv(e){return"string"==typeof e&&cv.test(e)}function fv(e,t){return(e%t+t)%t}function dv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e&&e.length&&e.forEach((function(e){Array.isArray(e)?n.push({x:e[0],y:e[1]}):n.push({x:e.x,y:e.y})})),function(e,t,n,i,r){var o=[],a=e[e.length-1],s=null!=t&&t>0,l=t||0;if(i&&s){var u=(e=e.slice())[0],c=new av(a.x+(u.x-a.x)/2,a.y+(u.y-a.y)/2);e.splice(0,0,c)}var h=e[0],f=1;for(n?o.push("M",h.x,h.y):o.push("L",h.x,h.y);f<(i?e.length:e.length-1);){var d=e[fv(f,e.length)],v=h.x-d.x,g=h.y-d.y;if(s&&(0!==v||0!==g)&&(null==r||r.indexOf(f-1)<0)){var p=Math.sqrt(v*v+g*g),y=v*Math.min(l,p/2)/p,m=g*Math.min(l,p/2)/p,w=d.x+y,b=d.y+m;o.push("L",w,b);for(var k=e[fv(f+1,e.length)];f<e.length-2&&0===Math.round(k.x-d.x)&&0===Math.round(k.y-d.y);)k=e[fv(f+2,e.length)],f+=1;v=k.x-d.x,g=k.y-d.y,p=Math.max(1,Math.sqrt(v*v+g*g));var x=v*Math.min(l,p/2)/p,C=g*Math.min(l,p/2)/p,E=d.x+x,S=d.y+C;o.push("Q",d.x,d.y,E,S),d=new av(E,S)}else o.push("L",d.x,d.y);h=d,f+=1}return i?o.push("Z"):o.push("L",a.x,a.y),o.map((function(e){return"string"==typeof e?e:+e.toFixed(3)})).join(" ")}(n,t.round,null==t.initialMove||t.initialMove,t.close,t.exclude)}function vv(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0;if(0===n||0===i)return[];s-=e,l-=t,n=Math.abs(n),i=Math.abs(i);var u,c=-s/2,h=-l/2,f=Math.cos(r*Math.PI/180),d=Math.sin(r*Math.PI/180),v=f*c+d*h,g=-1*d*c+f*h,p=v*v,y=g*g,m=n*n,w=i*i,b=p/m+y/w;if(b>1)n=Math.sqrt(b)*n,i=Math.sqrt(b)*i,u=0;else{var k=1;o===a&&(k=-1),u=k*Math.sqrt((m*w-m*y-w*p)/(m*y+w*p))}var x=u*n*g/i,C=-1*u*i*v/n,E=f*x-d*C+s/2,S=d*x+f*C+l/2,M=Math.atan2((g-C)/i,(v-x)/n)-Math.atan2(0,1),A=M>=0?M:2*Math.PI+M,_=(M=Math.atan2((-g-C)/i,(-v-x)/n)-Math.atan2((g-C)/i,(v-x)/n))>=0?M:2*Math.PI+M;0===a&&_>0?_-=2*Math.PI:0!==a&&_<0&&(_+=2*Math.PI);for(var P=2*_/Math.PI,O=Math.ceil(P<0?-1*P:P),T=_/O,L=8/3*Math.sin(T/4)*Math.sin(T/4)/Math.sin(T/2),j=f*n,N=f*i,D=d*n,I=d*i,R=Math.cos(A),B=Math.sin(A),z=-L*(j*B+I*R),F=-L*(D*B-N*R),V=0,H=0,U=[],q=0;q<O;q+=1){A+=T,V=j*(R=Math.cos(A))-I*(B=Math.sin(A))+E,H=D*R+N*B+S;var G=-L*(j*B+I*R),J=-L*(D*B-N*R),W=6*q;U[W]=Number(z+e),U[W+1]=Number(F+t),U[W+2]=Number(V-G+e),U[W+3]=Number(H-J+t),U[W+4]=Number(V+e),U[W+5]=Number(H+t),z=V+G,F=H+J}return U.map((function(e){return+e.toFixed(2)}))}function gv(e,t,n,i){var r=[],o=vv(e,t,n,i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0);if(null!=o)for(var a=0,s=o.length;a<s;a+=6)r.push("C",o[a],o[a+1],o[a+2],o[a+3],o[a+4],o[a+5]);return r.join(" ")}var pv=function(e){function t(e){var n;if(A(this,t),n=s(this,t),null!=e){if("string"==typeof e)return l(n,t.parse(e));n.points=e.map((function(e){return av.create(e)}))}else n.points=[];return n}return h(t,e),P(t,[{key:"start",get:function(){return this.points[0]||null}},{key:"end",get:function(){return this.points[this.points.length-1]||null}},{key:"scale",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new av;return this.points.forEach((function(i){return i.scale(e,t,n)})),this}},{key:"rotate",value:function(e,t){return this.points.forEach((function(n){return n.rotate(e,t)})),this}},{key:"translate",value:function(e,t){var n=av.create(e,t);return this.points.forEach((function(e){return e.translate(n.x,n.y)})),this}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.points.forEach((function(t){return t.round(e)})),this}},{key:"bbox",value:function(){if(0===this.points.length)return new sv;for(var e=1/0,t=-1/0,n=1/0,i=-1/0,r=this.points,o=0,a=r.length;o<a;o+=1){var s=r[o],l=s.x,u=s.y;l<e&&(e=l),l>t&&(t=l),u<n&&(n=u),u>i&&(i=u)}return new sv(e,n,t-e,i-n)}},{key:"closestPoint",value:function(e){var t=this.closestPointLength(e);return this.pointAtLength(t)}},{key:"closestPointLength",value:function(e){var t=this.points,n=t.length;if(0===n||1===n)return 0;for(var i=0,r=0,o=1/0,a=0,s=n-1;a<s;a+=1){var l=new lv(t[a],t[a+1]),u=l.length(),c=l.closestPointNormalizedLength(e),h=l.pointAt(c).squaredDistance(e);h<o&&(o=h,r=i+c*u),i+=u}return r}},{key:"closestPointNormalizedLength",value:function(e){var t=this.length();return 0===t?0:this.closestPointLength(e)/t}},{key:"closestPointTangent",value:function(e){var t=this.closestPointLength(e);return this.tangentAtLength(t)}},{key:"containsPoint",value:function(e){if(0===this.points.length)return!1;for(var t=av.clone(e),n=t.x,i=t.y,r=this.points,o=r.length,a=o-1,s=0,l=0;l<o;l+=1){var u=r[a],c=r[l];if(t.equals(u))return!0;var h=new lv(u,c);if(h.containsPoint(e))return!0;if(i<=u.y&&i>c.y||i>u.y&&i<=c.y){var f=u.x-n>c.x-n?u.x-n:c.x-n;if(f>=0){var d=new av(n+f,i),v=new lv(e,d);h.intersectsWithLine(v)&&(s+=1)}}a=l}return s%2==1}},{key:"intersectsWithLine",value:function(e){for(var t=[],n=0,i=this.points.length-1;n<i;n+=1){var r=this.points[n],o=this.points[n+1],a=e.intersectsWithLine(new lv(r,o));a&&t.push(a)}return t.length>0?t:null}},{key:"isDifferentiable",value:function(){for(var e=0,t=this.points.length-1;e<t;e+=1){var n=this.points[e],i=this.points[e+1];if(new lv(n,i).isDifferentiable())return!0}return!1}},{key:"length",value:function(){for(var e=0,t=0,n=this.points.length-1;t<n;t+=1){var i=this.points[t],r=this.points[t+1];e+=i.distance(r)}return e}},{key:"pointAt",value:function(e){var t=this.points,n=t.length;if(0===n)return null;if(1===n)return t[0].clone();if(e<=0)return t[0].clone();if(e>=1)return t[n-1].clone();var i=this.length()*e;return this.pointAtLength(i)}},{key:"pointAtLength",value:function(e){var t=this.points,n=t.length;if(0===n)return null;if(1===n)return t[0].clone();var i=!0;e<0&&(i=!1,e=-e);for(var r=0,o=0,a=n-1;o<a;o+=1){var s=i?o:a-1-o,l=t[s],u=t[s+1],c=new lv(l,u),h=l.distance(u);if(e<=r+h)return c.pointAtLength((i?1:-1)*(e-r));r+=h}return(i?t[n-1]:t[0]).clone()}},{key:"tangentAt",value:function(e){var t=this.points.length;if(0===t||1===t)return null;e<0&&(e=0),e>1&&(e=1);var n=this.length()*e;return this.tangentAtLength(n)}},{key:"tangentAtLength",value:function(e){var t=this.points,n=t.length;if(0===n||1===n)return null;var i,r=!0;e<0&&(r=!1,e=-e);for(var o=0,a=0,s=n-1;a<s;a+=1){var l=r?a:s-1-a,u=t[l],c=t[l+1],h=new lv(u,c),f=u.distance(c);if(h.isDifferentiable()){if(e<=o+f)return h.tangentAtLength((r?1:-1)*(e-o));i=h}o+=f}if(i){var d=r?1:0;return i.tangentAt(d)}return null}},{key:"simplify",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.points;if(t.length<3)return this;for(var n=e.threshold||0,i=0;t[i+2];){var r=i+1,o=i+2,a=t[i],s=t[r],l=t[o];new lv(a,l).closestPoint(s).distance(s)<=n?t.splice(r,1):i+=1}return this}},{key:"toHull",value:function(){var e=this.points,n=e.length;if(0===n)return new t;for(var i=e[0],r=1;r<n;r+=1)(e[r].y<i.y||e[r].y===i.y&&e[r].x>i.x)&&(i=e[r]);for(var o=[],a=0;a<n;a+=1){var s=i.theta(e[a]);0===s&&(s=360),o.push([e[a],a,s])}if(o.sort((function(e,t){var n=e[2]-t[2];return 0===n&&(n=t[1]-e[1]),n})),o.length>2){var l=o[o.length-1];o.unshift(l)}for(var u,c={},h=[],f=function(e){return"".concat(e[0].toString(),"@").concat(e[1])};0!==o.length;){var d=o.pop(),v=d[0];if(!c[f(d)])for(var g=!1;!g;)if(h.length<2)h.push(d),g=!0;else{var p=h.pop(),y=p[0],m=h.pop(),w=m[0],b=w.cross(y,v);if(b<0)h.push(m),h.push(p),h.push(d),g=!0;else if(0===b){var k=y.angleBetween(w,v);Math.abs(k-180)<1e-10||y.equals(v)||w.equals(y)?(c[f(p)]=y,h.push(m)):Math.abs((k+1)%360-1)<1e-10&&(h.push(m),o.push(p))}else c[f(p)]=y,h.push(m)}}h.length>2&&h.pop();for(var x=-1,C=0,E=h.length;C<E;C+=1){var S=h[C][1];(void 0===u||S<u)&&(u=S,x=C)}var M=[];if(x>0){var A=h.slice(x),_=h.slice(0,x);M=A.concat(_)}else M=h;for(var P=[],O=0,T=M.length;O<T;O+=1)P.push(M[O][0]);return new t(P)}},{key:"equals",value:function(e){var t=this;return null!=e&&(e.points.length===this.points.length&&e.points.every((function(e,n){return e.equals(t.points[n])})))}},{key:"clone",value:function(){return new t(this.points.map((function(e){return e.clone()})))}},{key:"toJSON",value:function(){return this.points.map((function(e){return e.toJSON()}))}},{key:"serialize",value:function(){return this.points.map((function(e){return"".concat(e.serialize())})).join(" ")}}])}(ov);!function(e){e.isPolyline=function(t){return null!=t&&t instanceof e}}(pv||(pv={})),function(e){e.parse=function(t){var n=t.trim();if(""===n)return new e;for(var i=[],r=n.split(/\s*,\s*|\s+/),o=0,a=r.length;o<a;o+=2)i.push({x:+r[o],y:+r[o+1]});return new e(i)}}(pv||(pv={}));var yv=function(e){function t(e,n,i,r){var o;return A(this,t),(o=s(this,t)).PRECISION=3,o.start=av.create(e),o.controlPoint1=av.create(n),o.controlPoint2=av.create(i),o.end=av.create(r),o}return h(t,e),P(t,[{key:"bbox",value:function(){for(var e,t,n,i,r,o,a,s,l,u,c,h=this.start,f=this.controlPoint1,d=this.controlPoint2,v=this.end,g=h.x,p=h.y,y=f.x,m=f.y,w=d.x,b=d.y,k=v.x,x=v.y,C=[],E=[[],[]],S=0;S<2;S+=1)if(0===S?(t=6*g-12*y+6*w,e=-3*g+9*y-9*w+3*k,n=3*y-3*g):(t=6*p-12*m+6*b,e=-3*p+9*m-9*b+3*x,n=3*m-3*p),Math.abs(e)<1e-12){if(Math.abs(t)<1e-12)continue;(i=-n/t)>0&&i<1&&C.push(i)}else a=t*t-4*n*e,s=Math.sqrt(a),a<0||((r=(-t+s)/(2*e))>0&&r<1&&C.push(r),(o=(-t-s)/(2*e))>0&&o<1&&C.push(o));for(var M=C.length,A=M;M;)l=(c=1-(i=C[M-=1]))*c*c*g+3*c*c*i*y+3*c*i*i*w+i*i*i*k,E[0][M]=l,u=c*c*c*p+3*c*c*i*m+3*c*i*i*b+i*i*i*x,E[1][M]=u;C[A]=0,C[A+1]=1,E[0][A]=g,E[1][A]=p,E[0][A+1]=k,E[1][A+1]=x,C.length=A+2,E[0].length=A+2,E[1].length=A+2;var _=Math.min.apply(null,E[0]),P=Math.min.apply(null,E[1]),O=Math.max.apply(null,E[0]),T=Math.max.apply(null,E[1]);return new sv(_,P,O-_,T-P)}},{key:"closestPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.pointAtT(this.closestPointT(e,t))}},{key:"closestPointLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t);return this.lengthAtT(this.closestPointT(e,n),n)}},{key:"closestPointNormalizedLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),i=this.closestPointLength(e,n);if(!i)return 0;var r=this.length(n);return 0===r?0:i/r}},{key:"closestPointT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPrecision(t),i=this.getDivisions(t),r=Math.pow(10,-n),o=null,a=0,s=0,l=0,u=0,c=0,h=null,f=i.length,d=f>0?1/f:0;for(i.forEach((function(t,n){var i=t.start.distance(e),r=t.end.distance(e),f=i+r;(null==h||f<h)&&(o=t,a=n*d,s=(n+1)*d,l=i,u=r,h=f,c=t.endpointDistance())}));;){var v=l?Math.abs(l-u)/l:0,g=null!=u?Math.abs(l-u)/u:0;if(v<r||g<r||(!l||l<c*r||(!u||u<c*r)))return l<=u?a:s;var p=o.divide(.5);d/=2;var y=p[0].start.distance(e),m=p[0].end.distance(e),w=y+m,b=p[1].start.distance(e),k=p[1].end.distance(e);w<=b+k?(o=p[0],s-=d,l=y,u=m):(o=p[1],a+=d,l=b,u=k)}}},{key:"closestPointTangent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.tangentAtT(this.closestPointT(e,t))}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toPolyline(t).containsPoint(e)}},{key:"divideAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return this.divideAtT(0);if(e>=1)return this.divideAtT(1);var n=this.tAt(e,t);return this.divideAtT(n)}},{key:"divideAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.tAtLength(e,t);return this.divideAtT(n)}},{key:"divide",value:function(e){return this.divideAtT(e)}},{key:"divideAtT",value:function(e){var n=this.start,i=this.controlPoint1,r=this.controlPoint2,o=this.end;if(e<=0)return[new t(n,n,n,n),new t(n,i,r,o)];if(e>=1)return[new t(n,i,r,o),new t(o,o,o,o)];var a=this.getSkeletonPoints(e),s=a.startControlPoint1,l=a.startControlPoint2,u=a.divider,c=a.dividerControlPoint1,h=a.dividerControlPoint2;return[new t(n,s,l,u),new t(u,c,h,o)]}},{key:"endpointDistance",value:function(){return this.start.distance(this.end)}},{key:"getSkeletonPoints",value:function(e){var t=this.start,n=this.controlPoint1,i=this.controlPoint2,r=this.end;if(e<=0)return{startControlPoint1:t.clone(),startControlPoint2:t.clone(),divider:t.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:i.clone()};if(e>=1)return{startControlPoint1:n.clone(),startControlPoint2:i.clone(),divider:r.clone(),dividerControlPoint1:r.clone(),dividerControlPoint2:r.clone()};var o=new lv(t,n).pointAt(e),a=new lv(n,i).pointAt(e),s=new lv(i,r).pointAt(e),l=new lv(o,a).pointAt(e),u=new lv(a,s).pointAt(e);return{startControlPoint1:o,startControlPoint2:l,divider:new lv(l,u).pointAt(e),dividerControlPoint1:u,dividerControlPoint2:s}}},{key:"getSubdivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.getPrecision(e),i=[new t(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===n)return i;for(var r,o=this.endpointDistance(),a=Math.pow(10,-n),s=0,l=function(){s+=1;var e=[];i.forEach((function(t){var n=t.divide(.5);e.push(n[0],n[1])}));var t=e.reduce((function(e,t){return e+t.endpointDistance()}),0);if(s>1&&(0!==t?(t-o)/t:0)<a)return{v:e};i=e,o=t};;)if(r=l())return r.v}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getDivisions(e).reduce((function(e,t){return e+t.endpointDistance()}),0)}},{key:"lengthAtT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return 0;var n=void 0===t.precision?this.PRECISION:t.precision;return this.divide(e)[0].length({precision:n})}},{key:"pointAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();var n=this.tAt(e,t);return this.pointAtT(n)}},{key:"pointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.tAtLength(e,t);return this.pointAtT(n)}},{key:"pointAtT",value:function(e){return e<=0?this.start.clone():e>=1?this.end.clone():this.getSkeletonPoints(e).divider}},{key:"isDifferentiable",value:function(){var e=this.start,t=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(i))}},{key:"tangentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isDifferentiable())return null;e<0?e=0:e>1&&(e=1);var n=this.tAt(e,t);return this.tangentAtT(n)}},{key:"tangentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isDifferentiable())return null;var n=this.tAtLength(e,t);return this.tangentAtT(n)}},{key:"tangentAtT",value:function(e){if(!this.isDifferentiable())return null;e<0&&(e=0),e>1&&(e=1);var t=this.getSkeletonPoints(e),n=t.startControlPoint2,i=t.dividerControlPoint1,r=t.divider,o=new lv(n,i);return o.translate(r.x-n.x,r.y-n.y),o}},{key:"getPrecision",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null==e.precision?this.PRECISION:e.precision}},{key:"getDivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!=e.subdivisions)return e.subdivisions;var t=this.getPrecision(e);return this.getSubdivisions({precision:t})}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{precision:this.getPrecision(e),subdivisions:this.getDivisions(e)}}},{key:"tAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return 0;if(e>=1)return 1;var n=this.getOptions(t),i=this.length(n)*e;return this.tAtLength(i,n)}},{key:"tAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!0;e<0&&(n=!1,e=-e);for(var i,r,o=this.getPrecision(t),a=this.getDivisions(t),s={precision:o,subdivisions:a},l=null,u=0,c=0,h=0,f=a.length,d=f>0?1/f:0,v=0;v<f;v+=1){var g=n?v:f-1-v,p=a[v],y=p.endpointDistance();if(e<=h+y){l=p,i=g*d,r=(g+1)*d,u=n?e-h:y+h-e,c=n?y+h-e:e-h;break}h+=y}if(null==l)return n?1:0;for(var m=this.length(s),w=Math.pow(10,-o);;){if((0!==m?u/m:0)<w)return i;if((0!==m?c/m:0)<w)return r;var b=void 0,k=void 0,x=l.divide(.5);d/=2;var C=x[0].endpointDistance(),E=x[1].endpointDistance();u<=C?(l=x[0],r-=d,k=C-(b=u)):(l=x[1],i+=d,k=E-(b=u-C)),u=b,c=k}}},{key:"toPoints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getDivisions(e),n=[t[0].start.clone()];return t.forEach((function(e){return n.push(e.end.clone())})),n}},{key:"toPolyline",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new pv(this.toPoints(e))}},{key:"scale",value:function(e,t,n){return this.start.scale(e,t,n),this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.start.rotate(e,t),this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.start.translate(e,t),this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}},{key:"equals",value:function(e){return null!=e&&this.start.equals(e.start)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)&&this.end.equals(e.end)}},{key:"clone",value:function(){return new t(this.start,this.controlPoint1,this.controlPoint2,this.end)}},{key:"toJSON",value:function(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}])}(ov);!function(e){e.isCurve=function(t){return null!=t&&t instanceof e}}(yv||(yv={})),function(e){function t(e){var t=e.length,n=[],i=[],r=2;n[0]=e[0]/r;for(var o=1;o<t;o+=1)i[o]=1/r,r=(o<t-1?4:3.5)-i[o],n[o]=(e[o]-n[o-1])/r;for(var a=1;a<t;a+=1)n[t-a-1]-=i[t-a]*n[t-a];return n}e.throughPoints=function(n){if(null==n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");for(var i=function(e){var n=e.map((function(e){return av.clone(e)})),i=[],r=[],o=n.length-1;if(1===o)return i[0]=new av((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),r[0]=new av(2*i[0].x-n[0].x,2*i[0].y-n[0].y),[i,r];for(var a=[],s=1;s<o-1;s+=1)a[s]=4*n[s].x+2*n[s+1].x;a[0]=n[0].x+2*n[1].x,a[o-1]=(8*n[o-1].x+n[o].x)/2;for(var l=t(a),u=1;u<o-1;u+=1)a[u]=4*n[u].y+2*n[u+1].y;a[0]=n[0].y+2*n[1].y,a[o-1]=(8*n[o-1].y+n[o].y)/2;for(var c=t(a),h=0;h<o;h+=1)i.push(new av(l[h],c[h])),h<o-1?r.push(new av(2*n[h+1].x-l[h+1],2*n[h+1].y-c[h+1])):r.push(new av((n[o].x+l[o-1])/2,(n[o].y+c[o-1])/2));return[i,r]}(n),r=[],o=0,a=i[0].length;o<a;o+=1){var s=new av(i[0][o].x,i[0][o].y),l=new av(i[1][o].x,i[1][o].y);r.push(new e(n[o],s,l,n[o+1]))}return r}}(yv||(yv={}));var mv=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).isVisible=!0,e.isSegment=!0,e.isSubpathStart=!1,e}return h(t,e),P(t,[{key:"end",get:function(){return this.endPoint}},{key:"start",get:function(){if(null==this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}},{key:"closestPointT",value:function(e,t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(e);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}},{key:"lengthAtT",value:function(e,t){if(e<=0)return 0;var n=this.length();return e>=1?n:n*e}},{key:"divideAtT",value:function(e){if(this.divideAt)return this.divideAt(e);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}},{key:"pointAtT",value:function(e){if(this.pointAt)return this.pointAt(e);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}},{key:"tangentAtT",value:function(e){if(this.tangentAt)return this.tangentAt(e);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}])}(ov),wv=function(e){function t(e,n){var i;return A(this,t),i=s(this,t),lv.isLine(e)?i.endPoint=e.end.clone().round(2):i.endPoint=av.create(e,n).round(2),i}return h(t,e),P(t,[{key:"type",get:function(){return"L"}},{key:"line",get:function(){return new lv(this.start,this.end)}},{key:"bbox",value:function(){return this.line.bbox()}},{key:"closestPoint",value:function(e){return this.line.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.line.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.line.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.line.closestPointTangent(e)}},{key:"length",value:function(){return this.line.length()}},{key:"divideAt",value:function(e){var n=this.line.divideAt(e);return[new t(n[0]),new t(n[1])]}},{key:"divideAtLength",value:function(e){var n=this.line.divideAtLength(e);return[new t(n[0]),new t(n[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.line.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.line.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.line.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.line.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){return null!=this.previousSegment&&!this.start.equals(this.end)}},{key:"clone",value:function(){return new t(this.end)}},{key:"scale",value:function(e,t,n){return this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.end.translate(e,t):this.end.translate(e),this}},{key:"equals",value:function(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.end;return"".concat(this.type," ").concat(e.x," ").concat(e.y)}}])}(mv);!function(e){e.create=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=n.length,o=n[0];if(lv.isLine(o))return new e(o);if(av.isPointLike(o))return 1===r?new e(o):n.map((function(t){return new e(t)}));if(2===r)return new e(+n[0],+n[1]);for(var a=[],s=0;s<r;s+=2){var l=+n[s],u=+n[s+1];a.push(new e(l,u))}return a}}(wv||(wv={}));var bv=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"end",get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}},{key:"type",get:function(){return"Z"}},{key:"line",get:function(){return new lv(this.start,this.end)}},{key:"bbox",value:function(){return this.line.bbox()}},{key:"closestPoint",value:function(e){return this.line.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.line.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.line.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.line.closestPointTangent(e)}},{key:"length",value:function(){return this.line.length()}},{key:"divideAt",value:function(e){var t=this.line.divideAt(e);return[t[1].isDifferentiable()?new wv(t[0]):this.clone(),new wv(t[1])]}},{key:"divideAtLength",value:function(e){var t=this.line.divideAtLength(e);return[t[1].isDifferentiable()?new wv(t[0]):this.clone(),new wv(t[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.line.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.line.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.line.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.line.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){return!(!this.previousSegment||!this.subpathStartSegment)&&!this.start.equals(this.end)}},{key:"scale",value:function(){return this}},{key:"rotate",value:function(){return this}},{key:"translate",value:function(){return this}},{key:"equals",value:function(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}},{key:"clone",value:function(){return new t}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return this.type}}])}(mv);!function(e){e.create=function(){return new e}}(bv||(bv={}));var kv=function(e){function t(e,n){var i;return A(this,t),(i=s(this,t)).isVisible=!1,i.isSubpathStart=!0,lv.isLine(e)||yv.isCurve(e)?i.endPoint=e.end.clone().round(2):i.endPoint=av.create(e,n).round(2),i}return h(t,e),P(t,[{key:"start",get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}},{key:"type",get:function(){return"M"}},{key:"bbox",value:function(){return null}},{key:"closestPoint",value:function(){return this.end.clone()}},{key:"closestPointLength",value:function(){return 0}},{key:"closestPointNormalizedLength",value:function(){return 0}},{key:"closestPointT",value:function(){return 1}},{key:"closestPointTangent",value:function(){return null}},{key:"length",value:function(){return 0}},{key:"lengthAtT",value:function(){return 0}},{key:"divideAt",value:function(){return[this.clone(),this.clone()]}},{key:"divideAtLength",value:function(){return[this.clone(),this.clone()]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(){return this.end.clone()}},{key:"pointAtLength",value:function(){return this.end.clone()}},{key:"pointAtT",value:function(){return this.end.clone()}},{key:"tangentAt",value:function(){return null}},{key:"tangentAtLength",value:function(){return null}},{key:"tangentAtT",value:function(){return null}},{key:"isDifferentiable",value:function(){return!1}},{key:"scale",value:function(e,t,n){return this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.end.translate(e,t):this.end.translate(e),this}},{key:"clone",value:function(){return new t(this.end)}},{key:"equals",value:function(e){return this.type===e.type&&this.end.equals(e.end)}},{key:"toJSON",value:function(){return{type:this.type,end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.end;return"".concat(this.type," ").concat(e.x," ").concat(e.y)}}])}(mv);!function(e){e.create=function(){var t=arguments.length,n=arguments.length<=0?void 0:arguments[0];if(lv.isLine(n))return new e(n);if(yv.isCurve(n))return new e(n);if(av.isPointLike(n)){if(1===t)return new e(n);for(var i=[],r=0;r<t;r+=1)0===r?i.push(new e(r<0||arguments.length<=r?void 0:arguments[r])):i.push(new wv(r<0||arguments.length<=r?void 0:arguments[r]));return i}if(2===t)return new e(+(arguments.length<=0?void 0:arguments[0]),+(arguments.length<=1?void 0:arguments[1]));for(var o=[],a=0;a<t;a+=2){var s=+(a<0||arguments.length<=a?void 0:arguments[a]),l=+(a+1<0||arguments.length<=a+1?void 0:arguments[a+1]);0===a?o.push(new e(s,l)):o.push(new wv(s,l))}return o}}(kv||(kv={}));var xv=function(e){function t(e,n,i,r,o,a){var l;return A(this,t),l=s(this,t),yv.isCurve(e)?(l.controlPoint1=e.controlPoint1.clone().round(2),l.controlPoint2=e.controlPoint2.clone().round(2),l.endPoint=e.end.clone().round(2)):"number"==typeof e?(l.controlPoint1=new av(e,n).round(2),l.controlPoint2=new av(i,r).round(2),l.endPoint=new av(o,a).round(2)):(l.controlPoint1=av.create(e).round(2),l.controlPoint2=av.create(n).round(2),l.endPoint=av.create(i).round(2)),l}return h(t,e),P(t,[{key:"type",get:function(){return"C"}},{key:"curve",get:function(){return new yv(this.start,this.controlPoint1,this.controlPoint2,this.end)}},{key:"bbox",value:function(){return this.curve.bbox()}},{key:"closestPoint",value:function(e){return this.curve.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.curve.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.curve.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.curve.closestPointTangent(e)}},{key:"length",value:function(){return this.curve.length()}},{key:"divideAt",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.curve.divideAt(e,n);return[new t(i[0]),new t(i[1])]}},{key:"divideAtLength",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.curve.divideAtLength(e,n);return[new t(i[0]),new t(i[1])]}},{key:"divideAtT",value:function(e){var n=this.curve.divideAtT(e);return[new t(n[0]),new t(n[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.curve.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.curve.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.curve.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.curve.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){if(!this.previousSegment)return!1;var e=this.start,t=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(i))}},{key:"scale",value:function(e,t,n){return this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}},{key:"equals",value:function(e){return this.start.equals(e.start)&&this.end.equals(e.end)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)}},{key:"clone",value:function(){return new t(this.controlPoint1,this.controlPoint2,this.end)}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.controlPoint1,t=this.controlPoint2,n=this.end;return[this.type,e.x,e.y,t.x,t.y,n.x,n.y].join(" ")}}])}(mv);function Cv(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}}function Ev(e,t,n,i,r,o){var a=1/3,s=2/3;return[a*e+s*n,a*t+s*i,a*r+s*n,a*o+s*i,r,o]}function Sv(e,t,n,i,r,o,a,s,l,u){var c,h,f,d,v,g=120*Math.PI/180,p=Math.PI/180*(+r||0),y=[];if(u)h=u[0],f=u[1],d=u[2],v=u[3];else{e=(c=Cv(e,t,-p)).x,t=c.y;var m=(e-(s=(c=Cv(s,l,-p)).x))/2,w=(t-(l=c.y))/2,b=m*m/(n*n)+w*w/(i*i);b>1&&(n*=b=Math.sqrt(b),i*=b);var k=n*n,x=i*i,C=(o===a?-1:1)*Math.sqrt(Math.abs((k*x-k*w*w-x*m*m)/(k*w*w+x*m*m)));d=C*n*w/i+(e+s)/2,v=C*-i*m/n+(t+l)/2,h=Math.asin((t-v)/i),f=Math.asin((l-v)/i),h=e<d?Math.PI-h:h,f=s<d?Math.PI-f:f,h<0&&(h=2*Math.PI+h),f<0&&(f=2*Math.PI+f),a&&h>f&&(h-=2*Math.PI),!a&&f>h&&(f-=2*Math.PI)}var E=f-h;if(Math.abs(E)>g){var S=f,M=s,A=l;f=h+g*(a&&f>h?1:-1),y=Sv(s=d+n*Math.cos(f),l=v+i*Math.sin(f),n,i,r,0,a,M,A,[f,S,d,v])}E=f-h;var _=Math.cos(h),P=Math.sin(h),O=Math.cos(f),T=Math.sin(f),L=Math.tan(E/4),j=4/3*(n*L),N=4/3*(i*L),D=[e,t],I=[e+j*P,t-N*_],R=[s+j*T,l-N*O],B=[s,l];if(I[0]=2*D[0]-I[0],I[1]=2*D[1]-I[1],u)return[I,R,B].concat(y);for(var z=[],F=(y=[I,R,B].concat(y).join().split(",")).length,V=0;V<F;V+=1)z[V]=V%2?Cv(+y[V-1],+y[V],p).y:Cv(+y[V],+y[V+1],p).x;return z}function Mv(e){var t=function(e){if(!e)return null;var t="\t\n\v\f\r   ᠎             　\u2028\u2029",n=new RegExp("([a-z])[".concat(t,",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[").concat(t,"]*,?[").concat(t,"]*)+)"),"ig"),i=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[".concat(t,"]*,?[").concat(t,"]*"),"ig"),r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return e.replace(n,(function(e,t,n){var a=[],s=t.toLowerCase();n.replace(i,(function(e,t){return t&&a.push(+t),e})),"m"===s&&a.length>2&&(o.push([t].concat(v(a.splice(0,2)))),s="l",t="m"===t?"l":"L");for(var l=r[s];a.length>=l&&(o.push([t].concat(v(a.splice(0,l)))),l););return e})),o}(e);if(!t||!t.length)return[["M",0,0]];for(var n=0,i=0,r=0,o=0,a=[],s=0,l=t.length;s<l;s+=1){var u=[];a.push(u);var c=t[s],h=c[0];if(h!==h.toUpperCase())switch(u[0]=h.toUpperCase(),u[0]){case"A":u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5],u[6]=+c[6]+n,u[7]=+c[7]+i;break;case"V":u[1]=+c[1]+i;break;case"H":u[1]=+c[1]+n;break;case"M":r=+c[1]+n,o=+c[2]+i;for(var f=1,d=c.length;f<d;f+=1)u[f]=+c[f]+(f%2?n:i);break;default:for(var g=1,p=c.length;g<p;g+=1)u[g]=+c[g]+(g%2?n:i)}else for(var y=0,m=c.length;y<m;y+=1)u[y]=c[y];switch(u[0]){case"Z":n=+r,i=+o;break;case"H":n=u[1];break;case"V":i=u[1];break;case"M":r=u[u.length-2],o=u[u.length-1],n=u[u.length-2],i=u[u.length-1];break;default:n=u[u.length-2],i=u[u.length-1]}}return a}function Av(e){var t=Mv(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function i(e,t,n){var i,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(e[0]in{T:1,Q:1}||(t.qx=null,t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":return 0===parseFloat(e[1])||0===parseFloat(e[2])?["L",e[6],e[7]]:["C"].concat(Sv.apply(0,[t.x,t.y].concat(e.slice(1))));case"S":return"C"===n||"S"===n?(i=2*t.x-t.bx,r=2*t.y-t.by):(i=t.x,r=t.y),["C",i,r].concat(e.slice(1));case"T":return"Q"===n||"T"===n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),["C"].concat(Ev(t.x,t.y,t.qx,t.qy,e[1],e[2]));case"Q":return t.qx=e[1],t.qy=e[2],["C"].concat(Ev(t.x,t.y,e[1],e[2],e[3],e[4]));case"H":return["L"].concat(e[1],t.y);case"V":return["L"].concat(t.x,e[1])}return e}function r(e,n){if(e[n].length>7){e[n].shift();for(var i=e[n];i.length;)o[n]="A",n+=1,e.splice(n,0,["C"].concat(i.splice(0,6)));e.splice(n,1),s=t.length}}for(var o=[],a="",s=t.length,l=0;l<s;l+=1){var u="";t[l]&&(u=t[l][0]),"C"!==u&&(o[l]=u,l>0&&(a=o[l-1])),t[l]=i(t[l],n,a),"A"!==o[l]&&"C"===u&&(o[l]="C"),r(t,l);var c=t[l],h=c.length;n.x=c[h-2],n.y=c[h-1],n.bx=parseFloat(c[h-4])||n.x,n.by=parseFloat(c[h-3])||n.y}return t[0][0]&&"M"===t[0][0]||t.unshift(["M",0,0]),t}function _v(e){return Av(e).map((function(e){return e.map((function(e){return"string"==typeof e?e:iv.round(e,2)}))})).join(",").split(",").join(" ")}!function(e){e.create=function(){var t=arguments.length,n=arguments.length<=0?void 0:arguments[0];if(yv.isCurve(n))return new e(n);if(av.isPointLike(n)){if(3===t)return new e(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);for(var i=[],r=0;r<t;r+=3)i.push(new e(r<0||arguments.length<=r?void 0:arguments[r],r+1<0||arguments.length<=r+1?void 0:arguments[r+1],r+2<0||arguments.length<=r+2?void 0:arguments[r+2]));return i}if(6===t)return new e(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5]);for(var o=[],a=0;a<t;a+=6)o.push(new e(a<0||arguments.length<=a?void 0:arguments[a],a+1<0||arguments.length<=a+1?void 0:arguments[a+1],a+2<0||arguments.length<=a+2?void 0:arguments[a+2],a+3<0||arguments.length<=a+3?void 0:arguments[a+3],a+4<0||arguments.length<=a+4?void 0:arguments[a+4],a+5<0||arguments.length<=a+5?void 0:arguments[a+5]));return o}}(xv||(xv={}));var Pv=function(e){function t(e){var n;if(A(this,t),(n=s(this,t)).PRECISION=3,n.segments=[],Array.isArray(e))if(lv.isLine(e[0])||yv.isCurve(e[0])){var i=null;e.forEach((function(e,r){0===r&&n.appendSegment(t.createSegment("M",e.start)),null==i||i.end.equals(e.start)||n.appendSegment(t.createSegment("M",e.start)),lv.isLine(e)?n.appendSegment(t.createSegment("L",e.end)):yv.isCurve(e)&&n.appendSegment(t.createSegment("C",e.controlPoint1,e.controlPoint2,e.end)),i=e}))}else{e.forEach((function(e){e.isSegment&&n.appendSegment(e)}))}else null!=e&&(lv.isLine(e)?(n.appendSegment(t.createSegment("M",e.start)),n.appendSegment(t.createSegment("L",e.end))):yv.isCurve(e)?(n.appendSegment(t.createSegment("M",e.start)),n.appendSegment(t.createSegment("C",e.controlPoint1,e.controlPoint2,e.end))):pv.isPolyline(e)?e.points&&e.points.length&&e.points.forEach((function(e,i){var r=0===i?t.createSegment("M",e):t.createSegment("L",e);n.appendSegment(r)})):e.isSegment&&n.appendSegment(e));return n}return h(t,e),P(t,[{key:"start",get:function(){var e=this.segments,t=e.length;if(0===t)return null;for(var n=0;n<t;n+=1){var i=e[n];if(i.isVisible)return i.start}return e[t-1].end}},{key:"end",get:function(){var e=this.segments,t=e.length;if(0===t)return null;for(var n=t-1;n>=0;n-=1){var i=e[n];if(i.isVisible)return i.end}return e[t-1].end}},{key:"moveTo",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.appendSegment((e=kv.create).call.apply(e,[null].concat(n)))}},{key:"lineTo",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.appendSegment((e=wv.create).call.apply(e,[null].concat(n)))}},{key:"curveTo",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.appendSegment((e=xv.create).call.apply(e,[null].concat(n)))}},{key:"arcTo",value:function(e,t,n,i,r,o,a){var s=this.end||new av,l="number"==typeof o?vv(s.x,s.y,e,t,n,i,r,o,a):vv(s.x,s.y,e,t,n,i,r,o.x,o.y);if(null!=l)for(var u=0,c=l.length;u<c;u+=6)this.curveTo(l[u],l[u+1],l[u+2],l[u+3],l[u+4],l[u+5]);return this}},{key:"quadTo",value:function(e,n,i,r){var o=this.end||new av,a=["M",o.x,o.y];if("number"==typeof e)a.push("Q",e,n,i,r);else{var s=n;a.push("Q",e.x,e.y,s.x,s.y)}var l=t.parse(a.join(" "));return this.appendSegment(l.segments.slice(1)),this}},{key:"close",value:function(){return this.appendSegment(bv.create())}},{key:"drawPoints",value:function(e){var n=dv(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),i=t.parse(n);i&&i.segments&&this.appendSegment(i.segments)}},{key:"bbox",value:function(){var e,t=this.segments,n=t.length;if(0===n)return null;for(var i=0;i<n;i+=1){var r=t[i];if(r.isVisible){var o=r.bbox();null!=o&&(e=e?e.union(o):o)}}if(null!=e)return e;var a=t[n-1];return new sv(a.end.x,a.end.y,0,0)}},{key:"appendSegment",value:function(e){var t,n=this.segments.length,i=0!==n?this.segments[n-1]:null;if(Array.isArray(e))for(var r=0,o=e.length;r<o;r+=1){var a=e[r];t=this.prepareSegment(a,i,null),this.segments.push(t),i=t}else null!=e&&e.isSegment&&(t=this.prepareSegment(e,i,null),this.segments.push(t));return this}},{key:"insertSegment",value:function(e,t){var n,i=this.segments.length;if(e<0&&(e=i+e+1),e>i||e<0)throw new Error("Index out of range.");var r=null,o=null;if(0!==i&&(e>=1?o=(r=this.segments[e-1]).nextSegment:(r=null,o=this.segments[0])),Array.isArray(t))for(var a=0,s=t.length;a<s;a+=1){var l=t[a];n=this.prepareSegment(l,r,o),this.segments.splice(e+a,0,n),r=n}else n=this.prepareSegment(t,r,o),this.segments.splice(e,0,n);return this}},{key:"removeSegment",value:function(e){var t=this.fixIndex(e),n=this.segments.splice(t,1)[0],i=n.previousSegment,r=n.nextSegment;return i&&(i.nextSegment=r),r&&(r.previousSegment=i),n.isSubpathStart&&r&&this.updateSubpathStartSegment(r),n}},{key:"replaceSegment",value:function(e,t){var n,i=this.fixIndex(e),r=this.segments[i],o=r.previousSegment,a=r.nextSegment,s=r.isSubpathStart;if(Array.isArray(t)){this.segments.splice(e,1);for(var l=0,u=t.length;l<u;l+=1){var c=t[l];n=this.prepareSegment(c,o,a),this.segments.splice(e+l,0,n),o=n,s&&n.isSubpathStart&&(s=!1)}}else n=this.prepareSegment(t,o,a),this.segments.splice(i,1,n),s&&n.isSubpathStart&&(s=!1);s&&a&&this.updateSubpathStartSegment(a)}},{key:"getSegment",value:function(e){var t=this.fixIndex(e);return this.segments[t]}},{key:"fixIndex",value:function(e){var t=this.segments.length;if(0===t)throw new Error("Path has no segments.");for(var n=e;n<0;)n=t+n;if(n>=t||n<0)throw new Error("Index out of range.");return n}},{key:"segmentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segmentIndexAt(e,t);return n?this.getSegment(n):null}},{key:"segmentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segmentIndexAtLength(e,t);return n?this.getSegment(n):null}},{key:"segmentIndexAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=iv.clamp(e,0,1),i=this.getOptions(t),r=this.length(i)*n;return this.segmentIndexAtLength(r,i)}},{key:"segmentIndexAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segments.length;if(0===n)return null;var i=!0;e<0&&(i=!1,e=-e);for(var r=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=null,l=0;l<n;l+=1){var u=i?l:n-1-l,c=this.segments[u],h=o[u],f=c.length({precision:r,subdivisions:h});if(c.isVisible){if(e<=a+f)return u;s=u}a+=f}return s}},{key:"getSegmentSubdivisions",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getPrecision(e),n=[],i=0,r=this.segments.length;i<r;i+=1){var o=this.segments[i].getSubdivisions({precision:t});n.push(o)}return n}},{key:"updateSubpathStartSegment",value:function(e){for(var t=e.previousSegment,n=e;n&&!n.isSubpathStart;)n.subpathStartSegment=null!=t?t.subpathStartSegment:null,t=n,n=n.nextSegment}},{key:"prepareSegment",value:function(e,t,n){e.previousSegment=t,e.nextSegment=n,null!=t&&(t.nextSegment=e),null!=n&&(n.previousSegment=e);var i=e;return e.isSubpathStart&&(e.subpathStartSegment=e,i=n),null!=i&&this.updateSubpathStartSegment(i),e}},{key:"closestPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.closestPointT(e,t);return n?this.pointAtT(n):null}},{key:"closestPointLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),i=this.closestPointT(e,n);return i?this.lengthAtT(i,n):0}},{key:"closestPointNormalizedLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),i=this.closestPointLength(e,n);if(0===i)return 0;var r=this.length(n);return 0===r?0:i/r}},{key:"closestPointT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;for(var n,i=this.getPrecision(t),r=this.getSubdivisions(t),o=1/0,a=0,s=this.segments.length;a<s;a+=1){var l=this.segments[a],u=r[a];if(l.isVisible){var c=l.closestPointT(e,{precision:i,subdivisions:u}),h=l.pointAtT(c),f=iv.squaredLength(h,e);f<o&&(n={segmentIndex:a,value:c},o=f)}}return n||{segmentIndex:this.segments.length-1,value:1}}},{key:"closestPointTangent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;for(var n,i=this.getPrecision(t),r=this.getSubdivisions(t),o=1/0,a=0,s=this.segments.length;a<s;a+=1){var l=this.segments[a],u=r[a];if(l.isDifferentiable()){var c=l.closestPointT(e,{precision:i,subdivisions:u}),h=l.pointAtT(c),f=iv.squaredLength(h,e);f<o&&(n=l.tangentAtT(c),o=f)}}return n||null}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.toPolylines(t);if(!n)return!1;for(var i=0,r=0,o=n.length;r<o;r+=1){n[r].containsPoint(e)&&(i+=1)}return i%2==1}},{key:"pointAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();var n=this.getOptions(t),i=this.length(n)*e;return this.pointAtLength(i,n)}},{key:"pointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;if(0===e)return this.start.clone();var n=!0;e<0&&(n=!1,e=-e);for(var i,r=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=0,l=this.segments.length;s<l;s+=1){var u=n?s:l-1-s,c=this.segments[u],h=o[u],f=c.length({precision:r,subdivisions:h});if(c.isVisible){if(e<=a+f)return c.pointAtLength((n?1:-1)*(e-a),{precision:r,subdivisions:h});i=c}a+=f}return i?n?i.end:i.start:this.segments[this.segments.length-1].end.clone()}},{key:"pointAtT",value:function(e){var t=this.segments,n=t.length;if(0===n)return null;var i=e.segmentIndex;if(i<0)return t[0].pointAtT(0);if(i>=n)return t[n-1].pointAtT(1);var r=iv.clamp(e.value,0,1);return t[i].pointAtT(r)}},{key:"divideAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=iv.clamp(e,0,1),i=this.getOptions(t),r=this.length(i)*n;return this.divideAtLength(r,i)}},{key:"divideAtLength",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var i=!0;e<0&&(i=!1,e=-e);for(var r,o,a,s,l,u=this.getPrecision(n),c=this.getSubdivisions(n),h=0,f=0,d=this.segments.length;f<d;f+=1){var v=i?f:d-1-f,g=this.getSegment(v),p={precision:u,subdivisions:c[v]},y=g.length(p);if(g.isDifferentiable()&&(a=g,s=v,e<=h+y)){o=v,r=g.divideAtLength((i?1:-1)*(e-h),p);break}h+=y}if(!a)return null;r||(o=s,l=i?1:0,r=a.divideAtT(l));var m=this.clone(),w=o;m.replaceSegment(w,r);var b=w,k=w+1,x=w+2;r[0].isDifferentiable()||(m.removeSegment(b),k-=1,x-=1);var C=m.getSegment(k).start;m.insertSegment(k,t.createSegment("M",C)),x+=1,r[1].isDifferentiable()||(m.removeSegment(x-1),x-=1);for(var E=x-b-1,S=x,M=m.segments.length;S<M;S+=1){var A=this.getSegment(S-E),_=m.getSegment(S);if("Z"===_.type&&!A.subpathStartSegment.end.equals(_.subpathStartSegment.end)){var P=t.createSegment("L",A.end);m.replaceSegment(S,P)}}return[new t(m.segments.slice(0,k)),new t(m.segments.slice(k))]}},{key:"intersectsWithLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.toPolylines(t);if(null==n)return null;for(var i=null,r=0,o=n.length;r<o;r+=1){var a,s=n[r],l=e.intersect(s);if(l)if(null==i&&(i=[]),Array.isArray(l))(a=i).push.apply(a,v(l));else i.push(l)}return i}},{key:"isDifferentiable",value:function(){for(var e=0,t=this.segments.length;e<t;e+=1){if(this.segments[e].isDifferentiable())return!0}return!1}},{key:"isValid",value:function(){var e=this.segments,t=0===e.length||"M"===e[0].type;return t}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===this.segments.length)return 0;for(var t=this.getSubdivisions(e),n=0,i=0,r=this.segments.length;i<r;i+=1){var o=this.segments[i],a=t[i];n+=o.length({subdivisions:a})}return n}},{key:"lengthAtT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segments.length;if(0===n)return 0;var i=e.segmentIndex;if(i<0)return 0;var r=iv.clamp(e.value,0,1);i>=n&&(i=n-1,r=1);for(var o=this.getPrecision(t),a=this.getSubdivisions(t),s=0,l=0;l<i;l+=1){var u=this.segments[l],c=a[l];s+=u.length({precision:o,subdivisions:c})}var h=this.segments[i],f=a[i];return s+=h.lengthAtT(r,{precision:o,subdivisions:f})}},{key:"tangentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=iv.clamp(e,0,1),i=this.getOptions(t),r=this.length(i)*n;return this.tangentAtLength(r,i)}},{key:"tangentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=!0;e<0&&(n=!1,e=-e);for(var i,r=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=0,l=this.segments.length;s<l;s+=1){var u=n?s:l-1-s,c=this.segments[u],h=o[u],f=c.length({precision:r,subdivisions:h});if(c.isDifferentiable()){if(e<=a+f)return c.tangentAtLength((n?1:-1)*(e-a),{precision:r,subdivisions:h});i=c}a+=f}if(i){var d=n?1:0;return i.tangentAtT(d)}return null}},{key:"tangentAtT",value:function(e){var t=this.segments.length;if(0===t)return null;var n=e.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=t)return this.segments[t-1].tangentAtT(1);var i=iv.clamp(e.value,0,1);return this.segments[n].tangentAtT(i)}},{key:"getPrecision",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null==e.precision?this.PRECISION:e.precision}},{key:"getSubdivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null==e.segmentSubdivisions){var t=this.getPrecision(e);return this.getSegmentSubdivisions({precision:t})}return e.segmentSubdivisions}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{precision:this.getPrecision(e),segmentSubdivisions:this.getSubdivisions(e)}}},{key:"toPoints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.segments,n=t.length;if(0===n)return null;for(var i=this.getSubdivisions(e),r=[],o=[],a=0;a<n;a+=1){var s=t[a];if(s.isVisible){var l=i[a];l.length>0?l.forEach((function(e){return o.push(e.start)})):o.push(s.start)}else o.length>0&&(o.push(t[a-1].end),r.push(o),o=[])}return o.length>0&&(o.push(this.end),r.push(o)),r}},{key:"toPolylines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.toPoints(e);return t?t.map((function(e){return new pv(e)})):null}},{key:"scale",value:function(e,t,n){return this.segments.forEach((function(i){return i.scale(e,t,n)})),this}},{key:"rotate",value:function(e,t){return this.segments.forEach((function(n){return n.rotate(e,t)})),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.segments.forEach((function(n){return n.translate(e,t)})):this.segments.forEach((function(t){return t.translate(e)})),this}},{key:"clone",value:function(){var e=new t;return this.segments.forEach((function(t){return e.appendSegment(t.clone())})),e}},{key:"equals",value:function(e){if(null==e)return!1;var t=this.segments,n=e.segments,i=t.length;if(n.length!==i)return!1;for(var r=0;r<i;r+=1){var o=t[r],a=n[r];if(o.type!==a.type||!o.equals(a))return!1}return!0}},{key:"toJSON",value:function(){return this.segments.map((function(e){return e.toJSON()}))}},{key:"serialize",value:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map((function(e){return e.serialize()})).join(" ")}},{key:"toString",value:function(){return this.serialize()}}])}(ov);!function(e){e.isPath=function(t){return null!=t&&t instanceof e}}(Pv||(Pv={})),function(e){function t(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o,a;if("M"===e)return(r=kv.create).call.apply(r,[null].concat(n));if("L"===e)return(o=wv.create).call.apply(o,[null].concat(n));if("C"===e)return(a=xv.create).call.apply(a,[null].concat(n));if("z"===e||"Z"===e)return bv.create();throw new Error('Invalid path segment type "'.concat(e,'"'))}e.parse=function(n){if(!n)return new e;var i=new e,r=e.normalize(n).match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g);if(null!=r)for(var o=0,a=r.length;o<a;o+=1){var s=r[o].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g);if(null!=s){var l=s[0],u=s.slice(1).map((function(e){return+e})),c=t.call.apply(t,[null,l].concat(v(u)));i.appendSegment(c)}}return i},e.createSegment=t}(Pv||(Pv={})),function(e){e.normalize=_v,e.isValid=hv,e.drawArc=gv,e.drawPoints=dv,e.arcToCurves=vv}(Pv||(Pv={}));var Ov=function(){return P((function e(t){A(this,e),this.options=Object.assign({},t),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}),[{key:"names",get:function(){return Object.keys(this.data)}},{key:"register",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("object"!==d(e)){!this.exist(e)||i||Wh.isApplyingHMR()||this.onDuplicated(e);var r=this.options.process,o=r?Eh(r,this,e,t):t;return this.data[e]=o,o}Object.entries(e).forEach((function(e){var i=p(e,2),r=i[0],o=i[1];n.register(r,o,t)}))}},{key:"unregister",value:function(e){var t=e?this.data[e]:null;return delete this.data[e],t}},{key:"get",value:function(e){return e?this.data[e]:null}},{key:"exist",value:function(e){return!!e&&null!=this.data[e]}},{key:"onDuplicated",value:function(e){try{throw this.options.onConflict&&Eh(this.options.onConflict,this,e),new Error("".concat(Je(this.options.type)," with name '").concat(e,"' already registered."))}catch(gx){throw gx}}},{key:"onNotFound",value:function(e,t){throw new Error(this.getSpellingSuggestion(e,t))}},{key:"getSpellingSuggestion",value:function(e,t){var n=this.getSpellingSuggestionForName(e),i=t?"".concat(t," ").concat(We(this.options.type)):this.options.type;return"".concat(Je(i)," with name '").concat(e,"' does not exist.").concat(n?" Did you mean '".concat(n,"'?"):"")}},{key:"getSpellingSuggestionForName",value:function(e){return function(e,t,n){var i,r,o=Math.min(2,Math.floor(.34*e.length)),a=Math.floor(.4*e.length)+1,s=!1,l=e.toLowerCase(),u=w(t);try{for(u.s();!(r=u.n()).done;){var c=r.value,h=n(c);if(void 0!==h&&Math.abs(h.length-l.length)<=o){var f=h.toLowerCase();if(f===l){if(h===e)continue;return c}if(s)continue;if(h.length<3)continue;var d=Uh(l,f,a-1);if(void 0===d)continue;d<3?(s=!0,i=c):(a=d,i=c)}}}catch(gx){u.e(gx)}finally{u.f()}return i}(e,Object.keys(this.data),(function(e){return e}))}}])}();!function(e){e.create=function(t){return new e(t)}}(Ov||(Ov={}));var Tv={color:"#aaaaaa",thickness:1,markup:"rect",update:function(e,t){var n=t.thickness*t.sx,i=t.thickness*t.sy;qf(e,{width:n,height:i,rx:n,ry:i,fill:t.color})}},Lv={color:"#aaaaaa",thickness:1,markup:"rect",update:function(e,t){var n=t.sx<=1?t.thickness*t.sx:t.thickness;qf(e,{width:n,height:n,rx:n,ry:n,fill:t.color})}},jv={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update:function(e,t){var n=t.width,i=t.height,r=t.thickness;qf(e,{d:n-r>=0&&i-r>=0?["M",n,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",stroke:t.color,"stroke-width":t.thickness})}},Nv=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update:function(e,t){var n=t.width,i=t.height,r=t.thickness;qf(e,{d:n-r>=0&&i-r>=0?["M",n,0,"H0 M0 0 V0",i].join(" "):"M 0 0 0 0",stroke:t.color,"stroke-width":t.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update:function(e,t){var n,i=t.factor||1,r=t.width*i,o=t.height*i,a=t.thickness;n=r-a>=0&&o-a>=0?["M",r,0,"H0 M0 0 V0",o].join(" "):"M 0 0 0 0",t.width=r,t.height=o,qf(e,{d:n,stroke:t.color,"stroke-width":t.thickness})}}],Dv=Object.freeze(Object.defineProperty({__proto__:null,dot:Tv,doubleMesh:Nv,fixedDot:Lv,mesh:jv},Symbol.toStringTag,{value:"Module"})),Iv=function(){return P((function e(){A(this,e),this.patterns={},this.root=ud.create(Pf(),{width:"100%",height:"100%"},[_f("defs")]).node}),[{key:"add",value:function(e,t){var n=this.root.childNodes[0];n&&n.appendChild(t),this.patterns[e]=t,ud.create("rect",{width:"100%",height:"100%",fill:"url(#".concat(e,")")}).appendTo(this.root)}},{key:"get",value:function(e){return this.patterns[e]}},{key:"has",value:function(e){return null!=this.patterns[e]}}])}();!function(e){e.presets=Dv,e.registry=Ov.create({type:"grid"}),e.registry.register(e.presets,!0)}(Iv||(Iv={}));var Rv,Bv=function(e){var t=document.createElement("canvas"),n=e.width,i=e.height;t.width=2*n,t.height=i;var r=t.getContext("2d");return r.drawImage(e,0,0,n,i),r.translate(2*n,0),r.scale(-1,1),r.drawImage(e,0,0,n,i),t},zv=function(e){var t=document.createElement("canvas"),n=e.width,i=e.height;t.width=n,t.height=2*i;var r=t.getContext("2d");return r.drawImage(e,0,0,n,i),r.translate(0,2*i),r.scale(1,-1),r.drawImage(e,0,0,n,i),t},Fv=function(e){var t=document.createElement("canvas"),n=e.width,i=e.height;t.width=2*n,t.height=2*i;var r=t.getContext("2d");return r.drawImage(e,0,0,n,i),r.setTransform(-1,0,0,-1,t.width,t.height),r.drawImage(e,0,0,n,i),r.setTransform(-1,0,0,1,t.width,0),r.drawImage(e,0,0,n,i),r.setTransform(1,0,0,-1,0,t.height),r.drawImage(e,0,0,n,i),t},Vv=Object.freeze(Object.defineProperty({__proto__:null,flipX:Bv,flipXY:Fv,flipY:zv,watermark:function(e,t){var n=e.width,i=e.height,r=document.createElement("canvas");r.width=3*n,r.height=3*i;for(var o=r.getContext("2d"),a=null!=t.angle?-t.angle:-20,s=nv.toRad(a),l=r.width/4,u=r.height/4,c=0;c<4;c+=1)for(var h=0;h<4;h+=1)(c+h)%2>0&&(o.setTransform(1,0,0,1,(2*c-1)*l,(2*h-1)*u),o.rotate(s),o.drawImage(e,-n/2,-i/2,n,i));return r}},Symbol.toStringTag,{value:"Module"}));function Hv(e,t){return null!=e?e:t}function Uv(e,t){return null!=e&&Number.isFinite(e)?e:t}!function(e){e.presets=Object.assign({},Vv),e.presets["flip-x"]=Bv,e.presets["flip-y"]=zv,e.presets["flip-xy"]=Fv,e.registry=Ov.create({type:"background pattern"}),e.registry.register(e.presets,!0)}(Rv||(Rv={}));var qv,Gv=Object.freeze(Object.defineProperty({__proto__:null,blur:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Uv(e.x,2),n=null!=e.y&&Number.isFinite(e.y)?[t,e.y]:t;return'\n    <filter>\n      <feGaussianBlur stdDeviation="'.concat(n,'"/>\n    </filter>\n  ').trim()},brightness:function(){var e=Uv((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1);return'\n    <filter>\n      <feComponentTransfer>\n        <feFuncR type="linear" slope="'.concat(e,'"/>\n        <feFuncG type="linear" slope="').concat(e,'"/>\n        <feFuncB type="linear" slope="').concat(e,'"/>\n      </feComponentTransfer>\n    </filter>\n  ').trim()},contrast:function(){var e=Uv((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.5-e/2;return'\n    <filter>\n     <feComponentTransfer>\n        <feFuncR type="linear" slope="'.concat(e,'" intercept="').concat(t,'"/>\n        <feFuncG type="linear" slope="').concat(e,'" intercept="').concat(t,'"/>\n        <feFuncB type="linear" slope="').concat(e,'" intercept="').concat(t,'"/>\n      </feComponentTransfer>\n    </filter>\n  ').trim()},dropShadow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Uv(e.dx,0),n=Uv(e.dy,0),i=Hv(e.color,"black"),r=Uv(e.blur,4),o=Uv(e.opacity,1);return"SVGFEDropShadowElement"in window?'<filter>\n         <feDropShadow stdDeviation="'.concat(r,'" dx="').concat(t,'" dy="').concat(n,'" flood-color="').concat(i,'" flood-opacity="').concat(o,'" />\n       </filter>').trim():'<filter>\n         <feGaussianBlur in="SourceAlpha" stdDeviation="'.concat(r,'" />\n         <feOffset dx="').concat(t,'" dy="').concat(n,'" result="offsetblur" />\n         <feFlood flood-color="').concat(i,'" />\n         <feComposite in2="offsetblur" operator="in" />\n         <feComponentTransfer>\n           <feFuncA type="linear" slope="').concat(o,'" />\n         </feComponentTransfer>\n         <feMerge>\n           <feMergeNode/>\n           <feMergeNode in="SourceGraphic"/>\n         </feMerge>\n       </filter>').trim()},grayScale:function(){var e=Uv((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.7152-.7152*(1-e),n=.0722-.0722*(1-e),i=.2126-.2126*(1-e),r=.7152+.2848*(1-e),o=.0722-.0722*(1-e),a=.2126-.2126*(1-e),s=.0722+.9278*(1-e);return'\n    <filter>\n      <feColorMatrix type="matrix" values="'.concat(.2126+.7874*(1-e)," ").concat(t," ").concat(n," 0 0 ").concat(i," ").concat(r," ").concat(o," 0 0 ").concat(a," ").concat(t," ").concat(s,' 0 0 0 0 0 1 0"/>\n    </filter>\n  ').trim()},highlight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Hv(e.color,"red"),n=Uv(e.blur,0),i=Uv(e.width,1),r=Uv(e.opacity,1);return'\n      <filter>\n        <feFlood flood-color="'.concat(t,'" flood-opacity="').concat(r,'" result="colored"/>\n        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="').concat(i,'"/>\n        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>\n        <feGaussianBlur result="blured" in="composed" stdDeviation="').concat(n,'"/>\n        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>\n      </filter>\n    ').trim()},hueRotate:function(){var e=Uv((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).angle,0);return'\n      <filter>\n        <feColorMatrix type="hueRotate" values="'.concat(e,'"/>\n      </filter>\n    ').trim()},invert:function(){var e=Uv((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=1-e;return'\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="table" tableValues="'.concat(e," ").concat(t,'"/>\n          <feFuncG type="table" tableValues="').concat(e," ").concat(t,'"/>\n          <feFuncB type="table" tableValues="').concat(e," ").concat(t,'"/>\n        </feComponentTransfer>\n      </filter>\n    ').trim()},outline:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Hv(e.color,"blue"),n=Uv(e.width,1),i=Uv(e.margin,2),r=Uv(e.opacity,1),o=i,a=i+n;return'\n    <filter>\n      <feFlood flood-color="'.concat(t,'" flood-opacity="').concat(r,'" result="colored"/>\n      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="').concat(a,'" />\n      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="').concat(o,'" />\n      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>\n      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>\n      <feMerge>\n        <feMergeNode in="outline"/>\n        <feMergeNode in="SourceGraphic"/>\n      </feMerge>\n    </filter>\n  ').trim()},saturate:function(){var e=Uv((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1);return'\n      <filter>\n        <feColorMatrix type="saturate" values="'.concat(1-e,'"/>\n      </filter>\n    ').trim()},sepia:function(){var e=Uv((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.769-.769*(1-e),n=.189-.189*(1-e),i=.349-.349*(1-e),r=.686+.314*(1-e),o=.168-.168*(1-e),a=.272-.272*(1-e),s=.534-.534*(1-e),l=.131+.869*(1-e);return'\n      <filter>\n        <feColorMatrix type="matrix" values="'.concat(.393+.607*(1-e)," ").concat(t," ").concat(n," 0 0 ").concat(i," ").concat(r," ").concat(o," 0 0 ").concat(a," ").concat(s," ").concat(l,' 0 0 0 0 0 1 0"/>\n      </filter>\n    ').trim()}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Gv,e.registry=Ov.create({type:"filter"}),e.registry.register(e.presets,!0)}(qv||(qv={}));var Jv,Wv,Yv={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},Zv={position:mg("x","width","origin")},Kv={position:mg("y","height","origin")},Xv={position:mg("x","width","corner")},$v={position:mg("y","height","corner")},Qv={set:wg("width","width")},eg={set:wg("height","height")},tg={set:wg("rx","width")},ng={set:wg("ry","height")},ig={set:(Jv=wg("r","width"),Wv=wg("r","height"),function(e,t){var n=t.refBBox;return Eh(n.height>n.width?Jv:Wv,this,e,t)})},rg={set:function(e,t){var n=t.refBBox,i=parseFloat(e),r=qh(e);r&&(i/=100);var o,a=Math.sqrt(n.height*n.height+n.width*n.width);return Number.isFinite(i)&&(o=r||i>=0&&i<=1?i*a:Math.max(i+a,0)),{r:o}}},og={set:wg("cx","width")},ag={set:wg("cy","height")},sg={set:kg({resetOffset:!0})},lg={set:kg({resetOffset:!1})},ug={set:xg({resetOffset:!0})},cg={set:xg({resetOffset:!1})},hg=ig,fg=sg,dg=ug,vg=Zv,gg=Kv,pg=Qv,yg=eg;function mg(e,t,n){return function(i,r){var o=r.refBBox;if(null==i)return null;var a,s=parseFloat(i),l=qh(i);if(l&&(s/=100),Number.isFinite(s)){var u=o[n];a=l||s>0&&s<1?u[e]+o[t]*s:u[e]+s}var c=new av;return c[e]=a||0,c}}function wg(e,t){return function(n,i){var r=i.refBBox,o=parseFloat(n),a=qh(n);a&&(o/=100);var s={};if(Number.isFinite(o)){var l=a||o>=0&&o<=1?o*r[t]:Math.max(o+r[t],0);s[e]=l}return s}}function bg(e,t){var n="x6-shape",i=t&&t.resetOffset;return function(t,r){var o=r.elem,a=r.refBBox,s=ld(o,n);if(!s||s.value!==t){var l=e(t);s={value:t,shape:l,shapeBBox:l.bbox()},ld(o,n,s)}var u=s.shape.clone(),c=s.shapeBBox.clone(),h=c.getOrigin(),f=a.getOrigin();c.x=f.x,c.y=f.y;var d=a.getMaxScaleToFit(c,f),v=0===c.width||0===a.width?1:d.sx,g=0===c.height||0===a.height?1:d.sy;return u.scale(v,g,h),i&&u.translate(-h.x,-h.y),u}}function kg(e){var t=bg((function(e){return Pv.parse(e)}),e);return function(e,n){return{d:t(e,n).serialize()}}}function xg(e){var t=bg((function(e){return new pv(e)}),e);return function(e,n){return{points:t(e,n).serialize()}}}var Cg={qualify:Ye,set:function(e,t){var n=t.view;return"url(#".concat(n.graph.defineGradient(e),")")}},Eg={qualify:Ye,set:function(e,t){var n=t.view,i=n.cell,r=Object.assign({},e);if(i.isEdge()&&"linearGradient"===r.type){var o=n,a=o.sourcePoint,s=o.targetPoint;r.id="gradient-".concat(r.type,"-").concat(i.id),r.attrs=Object.assign(Object.assign({},r.attrs),{x1:a.x,y1:a.y,x2:s.x,y2:s.y,gradientUnits:"userSpaceOnUse"}),n.graph.defs.remove(r.id)}return"url(#".concat(n.graph.defineGradient(r),")")}},Sg={qualify:function(e,t){var n=t.attrs;return null==n.textWrap||!Ye(n.textWrap)},set:function(e,t){var n=t.view,i=t.elem,r=t.attrs,o="x6-text",a=ld(i,o),s=function(e){try{return JSON.parse(e)}catch(t){return e}},l={x:r.x,eol:r.eol,annotations:s(r.annotations),textPath:s(r["text-path"]||r.textPath),textVerticalAnchor:r["text-vertical-anchor"]||r.textVerticalAnchor,displayEmpty:"true"===(r["display-empty"]||r.displayEmpty),lineHeight:r["line-height"]||r.lineHeight},u=r["font-size"]||r.fontSize,c=JSON.stringify([e,l]);if(u&&i.setAttribute("font-size",u),null==a||a!==c){var h=l.textPath;if(null!=h&&"object"===d(h)){var f=h.selector;if("string"==typeof f){var v=n.find(f)[0];v instanceof SVGPathElement&&(Cf(v),l.textPath=Object.assign({"xlink:href":"#".concat(v.id)},h))}}dd(i,"".concat(e),l),ld(i,o,c)}}},Mg={qualify:Ye,set:function(e,t){var n=t.view,i=t.elem,r=t.attrs,o=t.refBBox,a=e,s=a.width||0;qh(s)?o.width*=parseFloat(s)/100:s<=0?o.width+=s:o.width=s;var l,u=a.height||0;qh(u)?o.height*=parseFloat(u)/100:u<=0?o.height+=u:o.height=u;var c=a.text;null==c&&(c=r.text||(null==i?void 0:i.textContent)),l=null!=c?pd("".concat(c),o,{"font-weight":r["font-weight"]||r.fontWeight,"font-size":r["font-size"]||r.fontSize,"font-family":r["font-family"]||r.fontFamily,lineHeight:r.lineHeight},{ellipsis:a.ellipsis}):"",Eh(Sg.set,this,l,{view:n,elem:i,attrs:r,refBBox:o,cell:n.cell})}},Ag=function(e,t){return void 0!==t.attrs.text},_g={qualify:Ag},Pg={qualify:Ag},Og={qualify:Ag},Tg={qualify:Ag},Lg={qualify:Ag},jg={qualify:Ag},Ng={qualify:function(e,t){return t.elem instanceof SVGElement},set:function(e,t){var n=t.elem,i="x6-title",r="".concat(e),o=ld(n,i);if(null==o||o!==r){ld(n,i,r);var a=n.firstChild;if(a&&"TITLE"===a.tagName.toUpperCase()){a.textContent=r}else{var s=document.createElementNS(n.namespaceURI,"title");s.textContent=r,n.insertBefore(s,a)}}}},Dg={offset:Rg("x","width","right")},Ig={offset:Rg("y","height","bottom")};function Rg(e,t,n){return function(i,r){var o,a=r.refBBox,s=new av;return o="middle"===i?a[t]/2:i===n?a[t]:"number"==typeof i&&Number.isFinite(i)?i>-1&&i<1?-a[t]*i:-i:qh(i)?a[t]*parseFloat(i)/100:0,s[e]=-(a[e]+o),s}}var Bg={qualify:Ye,set:function(e,t){od(t.elem,e)}},zg={qualify:Ye,set:function(e,t){var n=t.view;return"url(#".concat(n.graph.defineFilter(e),")")}},Fg={set:function(e){return null!=e&&"object"===d(e)&&e.id?e.id:e}};function Vg(e,t,n){var i,r;"object"===d(t)?(i=t.x,r=t.y):(i=t,r=n);var o=Pv.parse(e),a=o.bbox();if(a){var s=-a.height/2-a.y,l=-a.width/2-a.x;"number"==typeof i&&(l-=i),"number"==typeof r&&(s-=r),o.translate(l,s)}return o.serialize()}var Hg=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Ug(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3/4,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=e.size||10,a=e.width||o,s=e.height||o,l=new Pv,u={};if(t)l.moveTo(a,0).lineTo(0,s/2).lineTo(a,s),u.fill="none";else{if(l.moveTo(0,s/2),l.lineTo(a,0),!n){var c=Ge(i,0,1);l.lineTo(a*c,s/2)}l.lineTo(a,s),l.close()}return Object.assign(Object.assign(Object.assign({},u),r),{tagName:"path",d:Vg(l.serialize(),{x:null!=e.offset?e.offset:-a/2})})}var qg,Gg=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Jg=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Wg=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Yg=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Zg=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Kg=function(e){var t=e.r,n=Zg(e,["r"]),i=t||5;return Object.assign(Object.assign({cx:i},n),{tagName:"circle",r:i})},Xg=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},$g=Object.freeze(Object.defineProperty({__proto__:null,async:function(e){var t=e.width,n=e.height,i=e.offset,r=e.open,o=e.flip,a=Yg(e,["width","height","offset","open","flip"]),s=n||6,l=t||10,u=!0===r,c=!0===o,h=Object.assign(Object.assign({},a),{tagName:"path"});c&&(s=-s);var f=new Pv;return f.moveTo(0,s).lineTo(l,0),u?h.fill="none":(f.lineTo(l,s),f.close()),h.d=Vg(f.serialize(),{x:i||-l/2,y:s/2}),h},block:function(e){return Ug({size:e.size,width:e.width,height:e.height,offset:e.offset},!0===e.open,!0,void 0,Hg(e,["size","width","height","offset","open"]))},circle:Kg,circlePlus:function(e){var t=e.r,n=Zg(e,["r"]),i=t||5,r=new Pv;return r.moveTo(i,0).lineTo(i,2*i),r.moveTo(0,i).lineTo(2*i,i),{children:[Object.assign(Object.assign({},Kg({r:i})),{fill:"none"}),Object.assign(Object.assign({},n),{tagName:"path",d:Vg(r.serialize(),-i)})]}},classic:function(e){return Ug({size:e.size,width:e.width,height:e.height,offset:e.offset},!1,!1,e.factor,Hg(e,["size","width","height","offset","factor"]))},cross:function(e){var t=e.size,n=e.width,i=e.height,r=e.offset,o=Wg(e,["size","width","height","offset"]),a=t||10,s=n||a,l=i||a,u=new Pv;return u.moveTo(0,0).lineTo(s,l).moveTo(0,l).lineTo(s,0),Object.assign(Object.assign({},o),{tagName:"path",fill:"none",d:Vg(u.serialize(),r||-s/2)})},diamond:function(e){var t=e.size,n=e.width,i=e.height,r=e.offset,o=Gg(e,["size","width","height","offset"]),a=t||10,s=n||a,l=i||a,u=new Pv;return u.moveTo(0,l/2).lineTo(s/2,0).lineTo(s,l/2).lineTo(s/2,l).close(),Object.assign(Object.assign({},o),{tagName:"path",d:Vg(u.serialize(),null==r?-s/2:r)})},ellipse:function(e){var t=e.rx,n=e.ry,i=Xg(e,["rx","ry"]),r=t||5,o=n||5;return Object.assign(Object.assign({cx:r},i),{tagName:"ellipse",rx:r,ry:o})},path:function(e){var t=e.d,n=e.offsetX,i=e.offsetY,r=Jg(e,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},r),{tagName:"path",d:Vg(t,n,i)})}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=$g,e.registry=Ov.create({type:"marker"}),e.registry.register(e.presets,!0)}(qg||(qg={})),function(e){e.normalize=Vg}(qg||(qg={}));var Qg=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function ep(e){return"string"==typeof e||Ye(e)}var tp={qualify:ep,set:function(e,t){return rp("marker-start",e,t.view,t.attrs)}},np={qualify:ep,set:function(e,t){return rp("marker-end",e,t.view,t.attrs,{transform:"rotate(180)"})}},ip={qualify:ep,set:function(e,t){return rp("marker-mid",e,t.view,t.attrs)}};function rp(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="string"==typeof t?{name:t}:t,a=o.name,s=o.args,l=Qg(o,["name","args"]),u=l;if(a&&"string"==typeof a){var c=qg.registry.get(a);if(!c)return qg.registry.onNotFound(a);u=c(Object.assign(Object.assign({},l),s))}var h=Object.assign(Object.assign(Object.assign({},function(e,t){var n={},i=e.stroke;"string"==typeof i&&(n.stroke=i,n.fill=i);var r=e.strokeOpacity;null==r&&(r=e["stroke-opacity"]);null==r&&(r=e.opacity);null!=r&&(n["stroke-opacity"]=r,n["fill-opacity"]=r);if("marker-mid"!==t){var o=parseFloat(e.strokeWidth||e["stroke-width"]);if(Number.isFinite(o)&&o>1){var a=Math.ceil(o/2);n.refX="marker-start"===t?a:-a}}return n}(i,e)),r),u);return O({},e,"url(#".concat(n.graph.defineMarker(h),")"))}var op=function(e,t){return t.view.cell.isEdge()},ap={qualify:op,set:function(e,t){var n,i,r,o,a,s=t.view,l=e.reverse||!1,u=e.stubs||0;if(Number.isFinite(u)&&0!==u)if(l){var c,h,f=s.getConnectionLength()||0;u<0?(c=(f+u)/2,h=-u):(c=u,h=f-2*u);var d=s.getConnection();a=null===(o=null===(r=null===(i=null===(n=null==d?void 0:d.divideAtLength(c))||void 0===n?void 0:n[1])||void 0===i?void 0:i.divideAtLength(h))||void 0===r?void 0:r[0])||void 0===o?void 0:o.serialize()}else{var v;if(u<0)v=((s.getConnectionLength()||0)+u)/2;else v=u;var g=s.getConnection();if(g){var p=g.divideAtLength(v),y=g.divideAtLength(-v);p&&y&&(a="".concat(p[0].serialize()," ").concat(y[1].serialize()))}}return{d:a||s.getConnectionPathData()}}},sp={qualify:op,set:dp("getTangentAtLength",{rotate:!0})},lp={qualify:op,set:dp("getTangentAtLength",{rotate:!1})},up={qualify:op,set:dp("getTangentAtRatio",{rotate:!0})},cp={qualify:op,set:dp("getTangentAtRatio",{rotate:!1})},hp=sp,fp=up;function dp(e,t){var n={x:1,y:0};return function(i,r){var o,a,s=r.view,l=s[e](Number(i));return l?(a=t.rotate?l.vector().vectorAngle(n):0,o=l.start):(o=s.path.start,a=0),0===a?{transform:"translate(".concat(o.x,",").concat(o.y,"')")}:{transform:"translate(".concat(o.x,",").concat(o.y,"') rotate(").concat(a,")")}}}var vp,gp=Object.freeze(Object.defineProperty({__proto__:null,annotations:Tg,atConnectionLength:hp,atConnectionLengthIgnoreGradient:lp,atConnectionLengthKeepGradient:sp,atConnectionRatio:fp,atConnectionRatioIgnoreGradient:cp,atConnectionRatioKeepGradient:up,connection:ap,displayEmpty:jg,eol:Lg,fill:Cg,filter:zg,html:{set:function(e,t){t.elem.innerHTML="".concat(e)}},lineHeight:_g,port:Fg,ref:{},refCx:og,refCy:ag,refD:fg,refDKeepOffset:lg,refDResetOffset:sg,refDx:Xv,refDy:$v,refHeight:eg,refHeight2:yg,refPoints:dg,refPointsKeepOffset:cg,refPointsResetOffset:ug,refR:hg,refRCircumscribed:rg,refRInscribed:ig,refRx:tg,refRy:ng,refWidth:Qv,refWidth2:pg,refX:Zv,refX2:vg,refY:Kv,refY2:gg,resetOffset:{offset:function(e,t){var n=t.refBBox;return e?{x:-n.x,y:-n.y}:{x:0,y:0}}},sourceMarker:tp,stroke:Eg,style:Bg,targetMarker:np,text:Sg,textPath:Og,textVerticalAnchor:Pg,textWrap:Mg,title:Ng,vertexMarker:ip,xAlign:Dg,yAlign:Ig},Symbol.toStringTag,{value:"Module"}));!function(e){e.isValidDefinition=function(e,t,n){if(null!=e){if("string"==typeof e)return!0;if("function"!=typeof e.qualify||Eh(e.qualify,this,t,n))return!0}return!1}}(vp||(vp={})),function(e){e.presets=Object.assign(Object.assign({},Yv),gp),e.registry=Ov.create({type:"attribute definition"}),e.registry.register(e.presets,!0)}(vp||(vp={}));var pp,yp={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix:function(e){return"".concat(yp.prefixCls,"-").concat(e)}},mp=yp.prefix("highlighted"),wp={highlight:function(e,t,n){wf(t,n&&n.className||mp)},unhighlight:function(e,t,n){bf(t,n&&n.className||mp)}},bp=yp.prefix("highlight-opacity"),kp={highlight:function(e,t){wf(t,bp)},unhighlight:function(e,t){bf(t,bp)}};!function(e){function t(e,t){var n,i,r,o=(n=e.x,i=e.y,r=_f("svg").createSVGPoint(),r.x=n,r.y=i,r).matrixTransform(t);return new av(o.x,o.y)}function n(e,t){var n=_f("svg").createSVGPoint();n.x=e.x,n.y=e.y;var i=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y;var r=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y+e.height;var o=n.matrixTransform(t);n.x=e.x,n.y=e.y+e.height;var a=n.matrixTransform(t),s=Math.min(i.x,r.x,o.x,a.x),l=Math.max(i.x,r.x,o.x,a.x),u=Math.min(i.y,r.y,o.y,a.y),c=Math.max(i.y,r.y,o.y,a.y);return new sv(s,u,l-s,c-u)}function i(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.ownerSVGElement||!Ef(e)){if(Rf(e)){var a=r(e),s=a.left,l=a.top,u=a.width,c=a.height;return new sv(s,l,u,c)}return new sv(0,0,0,0)}var h=o.target;if(!o.recursive){try{t=e.getBBox()}catch(dx){t={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight}}return h?n(t,zd(e,h)):sv.create(t)}var f=e.childNodes,d=f.length;if(0===d)return i(e,{target:h});h||(h=e);for(var v=0;v<d;v+=1){var g=f[v],p=void 0;p=0===g.childNodes.length?i(g,{target:h}):i(g,{target:h,recursive:!0}),t=t?t.union(p):p}return t}function r(e){var t=0,n=0,i=0,r=0;if(e){for(var o=e;o;)t+=o.offsetLeft,n+=o.offsetTop,(o=o.offsetParent)&&(t+=parseInt(id(o,"borderLeft"),10),n+=parseInt(id(o,"borderTop"),10));i=e.offsetWidth,r=e.offsetHeight}return{left:t,top:n,width:i,height:r}}function o(e){var t=function(t){var n=e.getAttribute(t),i=n?parseFloat(n):0;return Number.isNaN(i)?0:i};switch(e instanceof SVGElement&&e.nodeName.toLowerCase()){case"rect":return new sv(t("x"),t("y"),t("width"),t("height"));case"circle":return new uv(t("cx"),t("cy"),t("r"),t("r"));case"ellipse":return new uv(t("cx"),t("cy"),t("rx"),t("ry"));case"polyline":var n=bd(e);return new pv(n);case"polygon":var r=bd(e);return r.length>1&&r.push(r[0]),new pv(r);case"path":var o=e.getAttribute("d");return Pv.isValid(o)||(o=Pv.normalize(o)),Pv.parse(o);case"line":return new lv(t("x1"),t("y1"),t("x2"),t("y2"))}return i(e)}function a(e){if(null==e)return null;var t=e;do{var n=t.tagName;if("string"!=typeof n)return null;if(n=n.toUpperCase(),mf(t,"x6-port"))t=t.nextElementSibling;else if("G"===n)t=t.firstElementChild;else{if("TITLE"!==n)break;t=t.nextElementSibling}}while(t);return t}e.normalizeMarker=Vg,e.transformPoint=t,e.transformLine=function(e,n){return new lv(t(e.start,n),t(e.end,n))},e.transformPolyline=function(e,n){var i=e instanceof pv?e.points:e;return Array.isArray(i)||(i=[]),new pv(i.map((function(e){return t(e,n)})))},e.transformRectangle=n,e.bbox=function(e,t,i){var r,o=e.ownerSVGElement;if(!o)return new sv(0,0,0,0);try{r=e.getBBox()}catch(dx){r={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight}}return t?sv.create(r):n(r,zd(e,i||o))},e.getBBox=i,e.getBoundingOffsetRect=r,e.toGeometryShape=o,e.translateAndAutoOrient=function(e,t,n,r){var o=av.create(t),a=av.create(n);r||(r=e instanceof SVGSVGElement?e:e.ownerSVGElement);var s=Bd(e);e.setAttribute("transform","");var l=i(e,{target:r}).scale(s.sx,s.sy),u=Od();u.setTranslate(-l.x-l.width/2,-l.y-l.height/2);var c=Od(),h=o.angleBetween(a,o.clone().translate(1,0));h&&c.setRotate(h,0,0);var f=Od(),d=o.clone().move(a,l.width/2);f.setTranslate(2*o.x-d.x,2*o.y-d.y);var v=zd(e,r),g=Od();g.setMatrix(f.matrix.multiply(c.matrix.multiply(u.matrix.multiply(v.scale(s.sx,s.sy))))),e.setAttribute("transform",Ld(g.matrix))},e.findShapeNode=a,e.getBBoxV2=function(e){var t=a(e);if(!Ef(t)){if(Rf(e)){var n=r(e),i=n.left,s=n.top,l=n.width,u=n.height;return new sv(i,s,l,u)}return new sv(0,0,0,0)}return o(t).bbox()||sv.create()}}(pp||(pp={}));var xp,Cp={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},Ep={highlight:function(e,t,n){var i=xp.getHighlighterId(t,n);if(!xp.hasCache(i)){n=Ze({},n,Cp);var r,o,a=ud.create(t);try{r=a.toPathData()}catch(w){o=pp.bbox(a.node,!0),r=kd(Object.assign(Object.assign({},n),o))}var s=_f("path");if(qf(s,Object.assign({d:r,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},n.attrs?Jf(n.attrs):null)),e.isEdgeElement(t))qf(s,"d",e.getConnectionPathData());else{var l=a.getTransformToElement(e.container),u=n.padding;if(u){null==o&&(o=pp.bbox(a.node,!0));var c=o.x+o.width/2,h=o.y+o.height/2;o=pp.transformRectangle(o,l);var f=Math.max(o.width,1),d=Math.max(o.height,1),v=(f+u)/f,g=(d+u)/d,p=Pd({a:v,b:0,c:0,d:g,e:c-v*c,f:h-g*h});l=l.multiply(p)}Dd(s,l)}wf(s,yp.prefix("highlight-stroke"));var y=e.cell,m=function(){return xp.removeHighlighter(i)};y.on("removed",m),y.model&&y.model.on("reseted",m),e.container.appendChild(s),xp.setCache(i,s)}},unhighlight:function(e,t,n){xp.removeHighlighter(xp.getHighlighterId(t,n))}};!function(e){e.getHighlighterId=function(e,t){return Cf(e),e.id+JSON.stringify(t)};var t={};e.setCache=function(e,n){t[e]=n},e.hasCache=function(e){return null!=t[e]},e.removeHighlighter=function(e){var n=t[e];n&&(jf(n),delete t[e])}}(xp||(xp={}));var Sp,Mp=Object.freeze(Object.defineProperty({__proto__:null,className:wp,opacity:kp,stroke:Ep},Symbol.toStringTag,{value:"Module"}));function Ap(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new av(Gh(t.x,e.width),Gh(t.y,e.height))}function _p(e,t,n){return Object.assign({angle:t,position:e.toJSON()},n)}!function(e){e.check=function(e,t){if("function"!=typeof t.highlight)throw new Error("Highlighter '".concat(e,"' is missing required `highlight()` method"));if("function"!=typeof t.unhighlight)throw new Error("Highlighter '".concat(e,"' is missing required `unhighlight()` method"))}}(Sp||(Sp={})),function(e){e.presets=Mp,e.registry=Ov.create({type:"highlighter"}),e.registry.register(e.presets,!0)}(Sp||(Sp={}));function Pp(e,t,n,i){var r=t.getCenter(),o=t.getTopCenter(),a=t.width/t.height,s=uv.fromRect(t),l=e.length;return e.map((function(e,t){var u=n+i(t,l),c=o.clone().rotate(-u,r).scale(a,1,r),h=e.compensateRotate?-s.tangentTheta(c):0;return(e.dx||e.dy)&&c.translate(e.dx||0,e.dy||0),e.dr&&c.move(r,e.dr),_p(c.round(),h,e)}))}var Op=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Tp(e,t,n,i){var r=new lv(t,n),o=e.length;return e.map((function(e,t){var n=e.strict,a=Op(e,["strict"]),s=n||i.strict?(t+1)/(o+1):(t+.5)/o,l=r.pointAt(s);return(a.dx||a.dy)&&l.translate(a.dx||0,a.dy||0),_p(l.round(),0,a)}))}var Lp,jp=Object.freeze(Object.defineProperty({__proto__:null,absolute:function(e,t){return e.map((function(e){var n=e.x,i=e.y,r=e.angle;return _p(Ap(t,{x:n,y:i}),r||0)}))},bottom:function(e,t,n){return Tp(e,t.getBottomLeft(),t.getBottomRight(),n)},ellipse:function(e,t,n){var i=n.start||0,r=n.step||20;return Pp(e,t,i,(function(e,t){return(e+.5-t/2)*r}))},ellipseSpread:function(e,t,n){var i=n.start||0,r=n.step||360/e.length;return Pp(e,t,i,(function(e){return e*r}))},left:function(e,t,n){return Tp(e,t.getTopLeft(),t.getBottomLeft(),n)},line:function(e,t,n){return Tp(e,Ap(t,n.start||t.getOrigin()),Ap(t,n.end||t.getCorner()),n)},right:function(e,t,n){return Tp(e,t.getTopRight(),t.getBottomRight(),n)},top:function(e,t,n){return Tp(e,t.getTopLeft(),t.getTopRight(),n)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=jp,e.registry=Ov.create({type:"port layout"}),e.registry.register(e.presets,!0)}(Lp||(Lp={}));var Np={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function Dp(e,t){var n=t||{},i=n.x,r=n.y,o=n.angle,a=n.attrs;return Ze({},{angle:o,attrs:a,position:{x:i,y:r}},e,Np)}function Ip(e,t,n,i){var r,o,a,s,l=null!=i.offset?i.offset:15,u=t.getCenter().theta(e),c=Bp(t),h=0;return u<c[1]||u>c[2]?(r=".3em",o=l,a=0,s="start"):u<c[0]?(r="0",o=0,a=-l,n?(h=-90,s="start"):s="middle"):u<c[3]?(r=".3em",o=-l,a=0,s="end"):(r=".6em",o=0,a=l,n?(h=90,s="start"):s="middle"),Dp({position:{x:Math.round(o),y:Math.round(a)},angle:h,attrs:{".":{y:r,"text-anchor":s}}},i)}function Rp(e,t,n,i){var r,o,a,s,l=null!=i.offset?i.offset:15,u=t.getCenter().theta(e),c=Bp(t),h=0;return u<c[1]||u>c[2]?(r=".3em",o=-l,a=0,s="end"):u<c[0]?(r=".6em",o=0,a=l,n?(h=90,s="start"):s="middle"):u<c[3]?(r=".3em",o=l,a=0,s="start"):(r="0em",o=0,a=-l,n?(h=-90,s="start"):s="middle"),Dp({position:{x:Math.round(o),y:Math.round(a)},angle:h,attrs:{".":{y:r,"text-anchor":s}}},i)}function Bp(e){var t=e.getCenter(),n=t.theta(e.getTopLeft()),i=t.theta(e.getBottomLeft()),r=t.theta(e.getBottomRight());return[n,t.theta(e.getTopRight()),r,i]}function zp(e,t,n){var i,r=null!=n.offset?n.offset:20,o=new av(0,0),a=-e.theta(o),s=".3em",l=a;return(a+90)%180==0?(i=t?"end":"middle",t||-270!==a||(s="0em")):a>-270&&a<-90?(i="start",l=a-180):i="end",Dp({position:e.clone().move(o,r).diff(e).round().round().toJSON(),angle:t?l:0,attrs:{".":{y:s,"text-anchor":i}}},n)}var Fp,Vp=Object.freeze(Object.defineProperty({__proto__:null,bottom:function(e,t,n){return Dp({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},n)},inside:function(e,t,n){return Rp(e,t,!1,n)},insideOriented:function(e,t,n){return Rp(e,t,!0,n)},left:function(e,t,n){return Dp({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},n)},manual:function(e,t,n){return Dp({position:t.getTopLeft()},n)},outside:function(e,t,n){return Ip(e,t,!1,n)},outsideOriented:function(e,t,n){return Ip(e,t,!0,n)},radial:function(e,t,n){return zp(e.diff(t.getCenter()),!1,n)},radialOriented:function(e,t,n){return zp(e.diff(t.getCenter()),!0,n)},right:function(e,t,n){return Dp({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},n)},top:function(e,t,n){return Dp({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},n)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Vp,e.registry=Ov.create({type:"port label layout"}),e.registry.register(e.presets,!0)}(Fp||(Fp={}));var Hp,Up=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},qp=function(e){function t(){var e;return A(this,t),(e=s(this,t)).cid=Hp.uniqueId(),t.views[e.cid]=e,e}return h(t,e),P(t,[{key:"priority",get:function(){return 2}},{key:"disposeContainer",get:function(){return!0}},{key:"confirmUpdate",value:function(e,t){return 0}},{key:"empty",value:function(){return Nf(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container),this}},{key:"unmount",value:function(){return jf(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container),this}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container;return e===this.container?(this.removeEventListeners(document),this.onRemove(),delete t.views[this.cid],this.disposeContainer&&this.unmount(e)):this.unmount(e),this}},{key:"onRemove",value:function(){}},{key:"setClass",value:function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container).classList.value=Array.isArray(e)?e.join(" "):e}},{key:"addClass",value:function(e){return wf(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,Array.isArray(e)?e.join(" "):e),this}},{key:"removeClass",value:function(e){return bf(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,Array.isArray(e)?e.join(" "):e),this}},{key:"setStyle",value:function(e){return od(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,e),this}},{key:"setAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;return null!=e&&null!=t&&qf(t,e),this}},{key:"findAttr",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;t&&1===t.nodeType;){var n=t.getAttribute(e);if(null!=n)return n;if(t===this.container)return null;t=t.parentNode}return null}},{key:"find",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors;return t.find(e,n,i).elems}},{key:"findOne",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors,i=this.find(e,t,n);return i.length>0?i[0]:null}},{key:"findByAttr",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;t&&t.getAttribute;){var n=t.getAttribute(e);if((null!=n||t===this.container)&&"false"!==n)return t;t=t.parentNode}return null}},{key:"getSelector",value:function(e,t){var n;if(e===this.container)return"string"==typeof t&&(n="> ".concat(t)),n;if(e){var i=Of(e)+1;n="".concat(e.tagName.toLowerCase(),":nth-child(").concat(i,")"),t&&(n+=" > ".concat(t)),n=this.getSelector(e.parentNode,n)}return n}},{key:"prefixClassName",value:function(e){return yp.prefix(e)}},{key:"delegateEvents",value:function(e,t){var n=this;if(null==e)return this;t||this.undelegateEvents();var i=/^(\S+)\s*(.*)$/;return Object.keys(e).forEach((function(t){var r=t.match(i);if(null!=r){var o=n.getEventHandler(e[t]);"function"==typeof o&&n.delegateEvent(r[1],r[2],o)}})),this}},{key:"undelegateEvents",value:function(){return Hd.off(this.container,this.getEventNamespace()),this}},{key:"delegateDocumentEvents",value:function(e,t){return this.addEventListeners(document,e,t),this}},{key:"undelegateDocumentEvents",value:function(){return this.removeEventListeners(document),this}},{key:"delegateEvent",value:function(e,t,n){return Hd.on(this.container,e+this.getEventNamespace(),t,n),this}},{key:"undelegateEvent",value:function(e,t,n){var i=e+this.getEventNamespace();return null==t?Hd.off(this.container,i):"string"==typeof t?Hd.off(this.container,i,t,n):Hd.off(this.container,i,t),this}},{key:"addEventListeners",value:function(e,t,n){var i=this;if(null==t)return this;var r=this.getEventNamespace();return Object.keys(t).forEach((function(o){var a=i.getEventHandler(t[o]);"function"==typeof a&&Hd.on(e,o+r,n,a)})),this}},{key:"removeEventListeners",value:function(e){return null!=e&&Hd.off(e,this.getEventNamespace()),this}},{key:"getEventNamespace",value:function(){return".".concat(yp.prefixCls,"-event-").concat(this.cid)}},{key:"getEventHandler",value:function(e){var t,n=this;if("string"==typeof e){var i=this[e];"function"==typeof i&&(t=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.call.apply(i,[n].concat(t))})}else t=function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.call.apply(e,[n].concat(i))};return t}},{key:"getEventTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.target,i=e.type,r=e.clientX,o=void 0===r?0:r,a=e.clientY,s=void 0===a?0:a;return t.fromPoint||"touchmove"===i||"touchend"===i?document.elementFromPoint(o,s):n}},{key:"stopPropagation",value:function(e){return this.setEventData(e,{propagationStopped:!0}),this}},{key:"isPropagationStopped",value:function(e){return!0===this.getEventData(e).propagationStopped}},{key:"getEventData",value:function(e){return this.eventData(e)}},{key:"setEventData",value:function(e,t){return this.eventData(e,t)}},{key:"eventData",value:function(e,t){if(null==e)throw new TypeError("Event object required");var n=e.data,i="__".concat(this.cid,"__");return null==t?null==n?{}:n[i]||{}:(null==n&&(n=e.data={}),null==n[i]?n[i]=Object.assign({},t):n[i]=Object.assign(Object.assign({},n[i]),t),n[i])}},{key:"normalizeEvent",value:function(e){return t.normalizeEvent(e)}},{key:"dispose",value:function(){this.remove()}}])}(Rh);Up([qp.dispose()],qp.prototype,"dispose",null),function(e){e.createElement=function(e,t){return t?_f(e||"g"):Af(e||"div")},e.find=function(e,t,n){if(!e||"."===e)return{elems:[t]};if(n){var i=n[e];if(i)return{elems:Array.isArray(i)?i:[i]}}var r=e.includes(">")?":scope ".concat(e):e;return{isCSSSelector:!0,elems:Array.prototype.slice.call(t.querySelectorAll(r))}},e.normalizeEvent=function(e){var t=e,n=e.originalEvent,i=n&&n.changedTouches&&n.changedTouches[0];if(i){for(var r in e)void 0===i[r]&&(i[r]=e[r]);t=i}return t}}(qp||(qp={})),function(e){e.views={},e.getView=function(t){return e.views[t]||null}}(qp||(qp={})),function(e){var t=0;e.uniqueId=function(){var e="v".concat(t);return t+=1,e}}(Hp||(Hp={}));var Gp,Jp=function(){return P((function e(t){A(this,e),this.view=t,this.clean()}),[{key:"clean",value:function(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new tv,this.pathCache={}}},{key:"get",value:function(e){return this.elemCache.has(e)||this.elemCache.set(e,{}),this.elemCache.get(e)}},{key:"getData",value:function(e){var t=this.get(e);return t.data||(t.data={}),t.data}},{key:"getMatrix",value:function(e){var t=this.get(e);if(null==t.matrix){var n=this.view.container;t.matrix=function(e,t){var n=Pd();if(Ef(t)&&Ef(e)){for(var i=e,r=[];i&&i!==t;){var o=Td(i.getAttribute("transform")||null);r.push(o),i=i.parentNode}r.reverse().forEach((function(e){n=n.multiply(e)}))}return n}(e,n)}return Pd(t.matrix)}},{key:"getShape",value:function(e){var t=this.get(e);return null==t.shape&&(t.shape=pp.toGeometryShape(e)),t.shape.clone()}},{key:"getBoundingRect",value:function(e){var t=this.get(e);return null==t.boundingRect&&(t.boundingRect=pp.getBBoxV2(e)),t.boundingRect.clone()}}])}();!function(e){function t(e){return null!=e&&"string"==typeof e}function n(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:Sf.svg},n=document.createDocumentFragment(),i={},r={},o=[{markup:Array.isArray(e)?e:[e],parent:n,ns:t.ns}],a=function(){var e=o.pop(),t=e.ns||Sf.svg,n=e.markup,a=e.parent;n.forEach((function(e){var n=e.tagName;if(!n)throw new TypeError("Invalid tagName");e.ns&&(t=e.ns);var s=t?Af(n,t):Mf(n),l=e.attrs;l&&qf(s,Jf(l));var u=e.style;u&&od(s,u);var c=e.className;null!=c&&s.setAttribute("class",Array.isArray(c)?c.join(" "):c),e.textContent&&(s.textContent=e.textContent);var h=e.selector;if(null!=h){if(r[h])throw new TypeError("Selector must be unique");r[h]=s}if(e.groupSelector){var f=e.groupSelector;Array.isArray(f)||(f=[f]),f.forEach((function(e){i[e]||(i[e]=[]),i[e].push(s)}))}a.appendChild(s);var d=e.children;Array.isArray(d)&&o.push({ns:t,markup:d,parent:s})}))};o.length>0;)a();return Object.keys(i).forEach((function(e){if(r[e])throw new Error("Ambiguous group selector");r[e]=i[e]})),{fragment:n,selectors:r,groups:i}}function i(e){return e instanceof SVGElement?_f("g"):Mf("div")}e.isJSONMarkup=function(e){return null!=e&&!t(e)},e.isStringMarkup=t,e.clone=function(e){return null==e||t(e)?e:Ke(e)},e.sanitize=function(e){return"".concat(e).trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")},e.parseJSONMarkup=n,e.renderMarkup=function(e){if(t(e)){var r=ud.createVectors(e),o=r.length;if(1===o)return{elem:r[0].node};if(o>1){var a=i(r[0].node);return r.forEach((function(e){a.appendChild(e.node)})),{elem:a}}return{}}var s=n(e),l=s.fragment,u=null;return l.childNodes.length>1?(u=i(l.firstChild)).appendChild(l):u=l.firstChild,{elem:u,selectors:s.selectors}},e.parseLabelStringMarkup=function(e){for(var t=ud.createVectors(e),n=document.createDocumentFragment(),i=0,r=t.length;i<r;i+=1){var o=t[i].node;n.appendChild(o)}return{fragment:n,selectors:{}}}}(Gp||(Gp={})),function(e){e.getSelector=function e(t,n,i){if(null!=t){var r,o=t.tagName.toLowerCase();if(t===n)return r="string"==typeof i?"> ".concat(o," > ").concat(i):"> ".concat(o);var a=t.parentNode;if(a&&a.childNodes.length>1){var s=Of(t)+1;r="".concat(o,":nth-child(").concat(s,")")}else r=o;return i&&(r+=" > ".concat(i)),e(t.parentNode,n,r)}return i}}(Gp||(Gp={})),function(e){e.getPortContainerMarkup=function(){return"g"},e.getPortMarkup=function(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}},e.getPortLabelMarkup=function(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}}(Gp||(Gp={})),function(e){e.getEdgeMarkup=function(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]}}(Gp||(Gp={})),function(e){e.getForeignObjectMarkup=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{tagName:"foreignObject",selector:"fo",children:[{ns:Sf.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:Sf.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:e?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}}(Gp||(Gp={}));var Wp=function(){return P((function e(t){A(this,e),this.view=t}),[{key:"cell",get:function(){return this.view.cell}},{key:"getDefinition",value:function(e){return this.cell.getAttrDefinition(e)}},{key:"processAttrs",value:function(e,t){var n,i,r,o,a=this,s=[];return Object.keys(t).forEach((function(i){var r=t[i],o=a.getDefinition(i),l=Eh(vp.isValidDefinition,a.view,o,r,{elem:e,attrs:t,cell:a.cell,view:a.view});if(o&&l)"string"==typeof o?(null==n&&(n={}),n[o]=r):null!==r&&s.push({name:i,definition:o});else{null==n&&(n={});var u=Ff.includes(i)?i:zh(i);n[u]=r}})),s.forEach((function(e){var n=e.name,a=e.definition,s=t[n];"function"==typeof a.set&&(null==i&&(i={}),i[n]=s),"function"==typeof a.offset&&(null==r&&(r={}),r[n]=s),"function"==typeof a.position&&(null==o&&(o={}),o[n]=s)})),{raw:t,normal:n,set:i,offset:r,position:o}}},{key:"mergeProcessedAttrs",value:function(e,t){e.set=Object.assign(Object.assign({},e.set),t.set),e.position=Object.assign(Object.assign({},e.position),t.position),e.offset=Object.assign(Object.assign({},e.offset),t.offset);var n=e.normal&&e.normal.transform;null!=n&&t.normal&&(t.normal.transform=n),e.normal=t.normal}},{key:"findAttrs",value:function(e,t,n,i){var r=[],o=new tv;return Object.keys(e).forEach((function(a){var s=e[a];if(Ye(s)){var l=qp.find(a,t,i),u=l.isCSSSelector,c=l.elems;n[a]=c;for(var h=0,f=c.length;h<f;h+=1){var d=c[h],v=i&&i[a]===d,g=o.get(d);if(g){g.array||(r.push(d),g.array=!0,g.attrs=[g.attrs],g.priority=[g.priority]);var p=g.attrs,y=g.priority;if(v)p.unshift(s),y.unshift(-1);else{var m=Xe(y,u?-1:f);p.splice(m,0,s),y.splice(m,0,f)}}else o.set(d,{elem:d,attrs:s,priority:v?-1:f,array:!1})}}})),r.forEach((function(e){var t=o.get(e),n=t.attrs;t.attrs=n.reduceRight((function(e,t){return $e(e,t)}),{})})),o}},{key:"updateRelativeAttrs",value:function(e,t,n){var i=this,r=t.raw||{},o=t.normal||{},a=t.set,s=t.position,l=t.offset,u=function(){return{elem:e,cell:i.cell,view:i.view,attrs:r,refBBox:n.clone()}};if(null!=a&&Object.keys(a).forEach((function(e){var t=a[e],n=i.getDefinition(e);if(null!=n){var r=Eh(n.set,i.view,t,u());"object"===d(r)?o=Object.assign(Object.assign({},o),r):null!=r&&(o[e]=r)}})),e instanceof HTMLElement)this.view.setAttrs(o,e);else{var c=o.transform,h=Td(c?"".concat(c):null),f=new av(h.e,h.f);c&&(delete o.transform,h.e=0,h.f=0);var v=!1;null!=s&&Object.keys(s).forEach((function(e){var t=s[e],n=i.getDefinition(e);if(null!=n){var r=Eh(n.position,i.view,t,u());null!=r&&(v=!0,f.translate(av.create(r)))}})),this.view.setAttrs(o,e);var g=!1;if(null!=l){var p=this.view.getBoundingRectOfElement(e);if(p.width>0&&p.height>0){var y=pp.transformRectangle(p,h);Object.keys(l).forEach((function(t){var n=l[t],o=i.getDefinition(t);if(null!=o){var a=Eh(o.offset,i.view,n,{elem:e,cell:i.cell,view:i.view,attrs:r,refBBox:y});null!=a&&(g=!0,f.translate(av.create(a)))}}))}}(null!=c||v||g)&&(f.round(1),h.e=f.x,h.f=f.y,e.setAttribute("transform",Ld(h)))}}},{key:"update",value:function(e,t,n){var i=this,r={},o=this.findAttrs(n.attrs||t,e,r,n.selectors),a=n.attrs?this.findAttrs(t,e,r,n.selectors):o,s=[];o.each((function(t){var o=t.elem,l=t.attrs,u=i.processAttrs(o,l);if(null==u.set&&null==u.position&&null==u.offset)i.view.setAttrs(u.normal,o);else{var c,h=a.get(o),f=h?h.attrs:null,d=f&&null==l.ref?f.ref:l.ref;if(d){if(!(c=(r[d]||i.view.find(d,e,n.selectors))[0]))throw new Error('"'.concat(d,'" reference does not exist.'))}else c=null;var v={node:o,refNode:c,attributes:f,processedAttributes:u},g=s.findIndex((function(e){return e.refNode===o}));g>-1?s.splice(g,0,v):s.push(v)}}));var l,u=new tv;s.forEach((function(t){var r,o,a=t.node,s=t.refNode,c=null!=s&&null!=n.rotatableNode&&Lf(n.rotatableNode,s);if(s&&(r=u.get(s)),!r){var h=c?n.rotatableNode:e;r=s?pp.getBBox(s,{target:h}):n.rootBBox,s&&u.set(s,r)}n.attrs&&t.attributes?(o=i.processAttrs(a,t.attributes),i.mergeProcessedAttrs(o,t.processedAttributes)):o=t.processedAttributes;var f=r;c&&null!=n.rotatableNode&&!n.rotatableNode.contains(a)&&(l||(l=Td(qf(n.rotatableNode,"transform"))),f=pp.transformRectangle(r,l)),i.updateRelativeAttrs(a,o,f)}))}}])}(),Yp=function(){return P((function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];A(this,e),this.view=t;var r={},o={},a=0;Object.keys(n).forEach((function(e){var t=n[e];Array.isArray(t)||(t=[t]),t.forEach((function(t){var n=r[t];n||(a+=1,n=r[t]=1<<a),o[e]|=n}))}));var s=i;if(Array.isArray(s)||(s=[s]),s.forEach((function(e){r[e]||(a+=1,r[e]=1<<a)})),a>25)throw new Error("Maximum number of flags exceeded.");this.flags=r,this.attrs=o,this.bootstrap=i}),[{key:"cell",get:function(){return this.view.cell}},{key:"getFlag",value:function(e){var t=this.flags;return null==t?0:Array.isArray(e)?e.reduce((function(e,n){return e|t[n]}),0):0|t[e]}},{key:"hasAction",value:function(e,t){return e&this.getFlag(t)}},{key:"removeAction",value:function(e,t){return e^e&this.getFlag(t)}},{key:"getBootstrapFlag",value:function(){return this.getFlag(this.bootstrap)}},{key:"getChangedFlag",value:function(){var e=this,t=0;return this.attrs?(Object.keys(this.attrs).forEach((function(n){e.cell.hasChanged(n)&&(t|=e.attrs[n])})),t):t}}])}(),Zp=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Kp=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Xp=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return A(this,t),(n=s(this,t)).cell=e,n.options=n.ensureOptions(i),n.graph=n.options.graph,n.attr=new Wp(n),n.flag=new Yp(n,n.options.actions,n.options.bootstrap),n.cache=new Jp(n),n.setContainer(n.ensureContainer()),n.setup(),n.init(),n}return h(t,e),P(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"init",value:function(){}},{key:"onRemove",value:function(){this.removeTools()}},{key:"priority",get:function(){return this.options.priority}},{key:"rootSelector",get:function(){return this.options.rootSelector}},{key:"getConstructor",value:function(){return this.constructor}},{key:"ensureOptions",value:function(e){return this.getConstructor().getOptions(e)}},{key:"getContainerTagName",value:function(){return this.options.isSvgElement?"g":"div"}},{key:"getContainerStyle",value:function(){}},{key:"getContainerAttrs",value:function(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}},{key:"getContainerClassName",value:function(){return this.prefixClassName("cell")}},{key:"ensureContainer",value:function(){return qp.createElement(this.getContainerTagName(),this.options.isSvgElement)}},{key:"setContainer",value:function(e){if(this.container!==e){this.undelegateEvents(),this.container=e,null!=this.options.events&&this.delegateEvents(this.options.events);var t=this.getContainerAttrs();null!=t&&this.setAttrs(t,e);var n=this.getContainerStyle();null!=n&&this.setStyle(n,e);var i=this.getContainerClassName();null!=i&&this.addClass(i,e)}return this}},{key:"isNodeView",value:function(){return!1}},{key:"isEdgeView",value:function(){return!1}},{key:"render",value:function(){return this}},{key:"confirmUpdate",value:function(e){return 0}},{key:"getBootstrapFlag",value:function(){return this.flag.getBootstrapFlag()}},{key:"getFlag",value:function(e){return this.flag.getFlag(e)}},{key:"hasAction",value:function(e,t){return this.flag.hasAction(e,t)}},{key:"removeAction",value:function(e,t){return this.flag.removeAction(e,t)}},{key:"handleAction",value:function(e,t,n,i){if(this.hasAction(e,t)){n();var r=[t];return i&&("string"==typeof i?r.push(i):r.push.apply(r,v(i))),this.removeAction(e,r)}return e}},{key:"setup",value:function(){this.cell.on("changed",this.onCellChanged,this)}},{key:"onCellChanged",value:function(e){var t=e.options;this.onAttrsChange(t)}},{key:"onAttrsChange",value:function(e){var t=this.flag.getChangedFlag();!e.updated&&t&&(e.dirty&&this.hasAction(t,"update")&&(t|=this.getFlag("render")),e.toolId&&(e.async=!1),null!=this.graph&&this.graph.renderer.requestViewUpdate(this,t,e))}},{key:"parseJSONMarkup",value:function(e,t){var n=Gp.parseJSONMarkup(e),i=n.selectors,r=this.rootSelector;if(t&&r){if(i[r])throw new Error("Invalid root selector");i[r]=t}return n}},{key:"can",value:function(e){var t=this.graph.options.interacting;if("function"==typeof t&&(t=Eh(t,this.graph,this)),"object"===d(t)){var n=t[e];return"function"==typeof n&&(n=Eh(n,this.graph,this)),!1!==n}return"boolean"==typeof t&&t}},{key:"cleanCache",value:function(){return this.cache.clean(),this}},{key:"getCache",value:function(e){return this.cache.get(e)}},{key:"getDataOfElement",value:function(e){return this.cache.getData(e)}},{key:"getMatrixOfElement",value:function(e){return this.cache.getMatrix(e)}},{key:"getShapeOfElement",value:function(e){return this.cache.getShape(e)}},{key:"getBoundingRectOfElement",value:function(e){return this.cache.getBoundingRect(e)}},{key:"getBBoxOfElement",value:function(e){var t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),i=this.getRootRotatedMatrix(),r=this.getRootTranslatedMatrix();return pp.transformRectangle(t,r.multiply(i).multiply(n))}},{key:"getUnrotatedBBoxOfElement",value:function(e){var t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),i=this.getRootTranslatedMatrix();return pp.transformRectangle(t,i.multiply(n))}},{key:"getBBox",value:function(){var e;if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).useCellGeometry){var t=this.cell,n=t.isNode()?t.getAngle():0;e=t.getBBox().bbox(n)}else e=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(e)}},{key:"getRootTranslatedMatrix",value:function(){var e=this.cell,t=e.isNode()?e.getPosition():{x:0,y:0};return Pd().translate(t.x,t.y)}},{key:"getRootRotatedMatrix",value:function(){var e=Pd(),t=this.cell,n=t.isNode()?t.getAngle():0;if(n){var i=t.getBBox(),r=i.width/2,o=i.height/2;e=e.translate(r,o).rotate(n).translate(-r,-o)}return e}},{key:"findMagnet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container;return this.findByAttr("magnet",e)}},{key:"updateAttrs",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null==n.rootBBox&&(n.rootBBox=new sv),null==n.selectors&&(n.selectors=this.selectors),this.attr.update(e,t,n)}},{key:"isEdgeElement",value:function(e){return this.cell.isEdge()&&(null==e||e===this.container)}},{key:"prepareHighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e||this.container;return t.partial=n===this.container,n}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.prepareHighlight(e,t);return this.notify("cell:highlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}),this}},{key:"unhighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.prepareHighlight(e,t);return this.notify("cell:unhighlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}),this}},{key:"notifyUnhighlight",value:function(e,t){}},{key:"getEdgeTerminal",value:function(e,t,n,i,r){var o=this.cell,a=this.findAttr("port",e),s=e.getAttribute("data-selector"),l={cell:o.id};return null!=s&&(l.magnet=s),null!=a?(l.port=a,o.isNode()&&(o.hasPort(a)||null!=s||(l.selector=this.getSelector(e)))):null==s&&this.container!==e&&(l.selector=this.getSelector(e)),l}},{key:"getMagnetFromEdgeTerminal",value:function(e){var t,n=this.cell,i=this.container,r=e.port,o=e.magnet;return null!=r&&n.isNode()&&n.hasPort(r)?t=this.findPortElem(r,o)||i:(o||(o=e.selector),o||null==r||(o='[port="'.concat(r,'"]')),t=this.findOne(o,i,this.selectors)),t}},{key:"hasTools",value:function(e){var t=this.tools;return null!=t&&(null==e||t.name===e)}},{key:"addTools",value:function(e){if(this.removeTools(),e){if(!this.can("toolsAddable"))return this;var t=$p.isToolsView(e)?e:new $p(e);this.tools=t,t.config({view:this}),t.mount()}return this}},{key:"updateTools",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.tools&&this.tools.update(e),this}},{key:"removeTools",value:function(){return this.tools&&(this.tools.remove(),this.tools=null),this}},{key:"hideTools",value:function(){return this.tools&&this.tools.hide(),this}},{key:"showTools",value:function(){return this.tools&&this.tools.show(),this}},{key:"renderTools",value:function(){var e=this.cell.getTools();return this.addTools(e),this}},{key:"notify",value:function(e,t){return this.trigger(e,t),this.graph.trigger(e,t),this}},{key:"getEventArgs",value:function(e,t,n){var i=this,r=i.cell;return null==t||null==n?{e:e,view:i,cell:r}:{e:e,x:t,y:n,view:i,cell:r}}},{key:"onClick",value:function(e,t,n){this.notify("cell:click",this.getEventArgs(e,t,n))}},{key:"onDblClick",value:function(e,t,n){this.notify("cell:dblclick",this.getEventArgs(e,t,n))}},{key:"onContextMenu",value:function(e,t,n){this.notify("cell:contextmenu",this.getEventArgs(e,t,n))}},{key:"onMouseDown",value:function(e,t,n){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(e,t,n))}},{key:"onMouseUp",value:function(e,t,n){this.notify("cell:mouseup",this.getEventArgs(e,t,n)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}},{key:"onMouseMove",value:function(e,t,n){this.notify("cell:mousemove",this.getEventArgs(e,t,n))}},{key:"onMouseOver",value:function(e){this.notify("cell:mouseover",this.getEventArgs(e))}},{key:"onMouseOut",value:function(e){this.notify("cell:mouseout",this.getEventArgs(e))}},{key:"onMouseEnter",value:function(e){this.notify("cell:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){this.notify("cell:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,t,n,i){this.notify("cell:mousewheel",Object.assign({delta:i},this.getEventArgs(e,t,n)))}},{key:"onCustomEvent",value:function(e,t,n,i){this.notify("cell:customevent",Object.assign({name:t},this.getEventArgs(e,n,i))),this.notify(t,Object.assign({},this.getEventArgs(e,n,i)))}},{key:"onMagnetMouseDown",value:function(e,t,n,i){}},{key:"onMagnetDblClick",value:function(e,t,n,i){}},{key:"onMagnetContextMenu",value:function(e,t,n,i){}},{key:"onLabelMouseDown",value:function(e,t,n){}},{key:"checkMouseleave",value:function(e){var t=this.getEventTarget(e,{fromPoint:!0}),n=this.graph.findViewByElem(t);n!==this&&(this.onMouseLeave(e),n&&n.onMouseEnter(e))}},{key:"dispose",value:function(){this.cell.off("changed",this.onCellChanged,this)}}],[{key:"getDefaults",value:function(){return this.defaults}},{key:"config",value:function(e){this.defaults=this.getOptions(e)}},{key:"getOptions",value:function(e){var t=function(e,t){return null!=t?Qe([].concat(v(Array.isArray(e)?e:[e]),v(Array.isArray(t)?t:[t]))):Array.isArray(e)?v(e):[e]},n=Ke(this.getDefaults()),i=e.bootstrap,r=e.actions,o=e.events,a=e.documentEvents,s=Kp(e,["bootstrap","actions","events","documentEvents"]);return i&&(n.bootstrap=t(n.bootstrap,i)),r&&Object.entries(r).forEach((function(e){var i=p(e,2),r=i[0],o=i[1],a=n.actions[r];o&&a?n.actions[r]=t(a,o):o&&(n.actions[r]=t(o))})),o&&(n.events=Object.assign(Object.assign({},n.events),o)),e.documentEvents&&(n.documentEvents=Object.assign(Object.assign({},n.documentEvents),a)),$e(n,s)}}])}(qp);Xp.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},Zp([Xp.dispose()],Xp.prototype,"dispose",null),function(e){e.Flag=Yp,e.Attr=Wp}(Xp||(Xp={})),function(e){e.toStringTag="X6.".concat(e.name),e.isCellView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNodeView&&"function"==typeof i.isEdgeView&&"function"==typeof i.confirmUpdate}}(Xp||(Xp={})),function(e){e.priority=function(e){return function(t){t.config({priority:e})}},e.bootstrap=function(e){return function(t){t.config({bootstrap:e})}}}(Xp||(Xp={})),function(e){e.registry=Ov.create({type:"view"})}(Xp||(Xp={}));var $p=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,t),(e=s(this,t)).svgContainer=e.createContainer(!0,n),e.htmlContainer=e.createContainer(!1,n),e.config(n),e}return h(t,e),P(t,[{key:"name",get:function(){return this.options.name}},{key:"graph",get:function(){return this.cellView.graph}},{key:"cell",get:function(){return this.cellView.cell}},{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"createContainer",value:function(e,t){var n=e?qp.createElement("g",!0):qp.createElement("div",!1);return wf(n,this.prefixClassName("cell-tools")),t.className&&wf(n,t.className),n}},{key:"config",value:function(e){if(this.options=Object.assign(Object.assign({},this.options),e),!Xp.isCellView(e.view)||e.view===this.cellView)return this;this.cellView=e.view,this.cell.isEdge()?(wf(this.svgContainer,this.prefixClassName("edge-tools")),wf(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(wf(this.svgContainer,this.prefixClassName("node-tools")),wf(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));var n=this.options.items;if(!Array.isArray(n))return this;this.tools=[];var i=[];n.forEach((function(e){t.ToolItem.isToolItem(e)?"vertices"===e.name?i.unshift(e):i.push(e):"vertices"===("object"===d(e)?e.name:e)?i.unshift(e):i.push(e)}));for(var r=0;r<i.length;r+=1){var o=i[r],a=void 0;if(t.ToolItem.isToolItem(o))a=o;else{var s="object"===d(o)?o.name:o,l="object"===d(o)&&o.args||{};if(s)if(this.cell.isNode()){var u=by.registry.get(s);if(!u)return by.registry.onNotFound(s);a=new u(l)}else if(this.cell.isEdge()){var c=ky.registry.get(s);if(!c)return ky.registry.onNotFound(s);a=new c(l)}}if(a)a.config(this.cellView,this),a.render(),(!1!==a.options.isSVGElement?this.svgContainer:this.htmlContainer).appendChild(a.container),this.tools.push(a)}return this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.tools;return t&&t.forEach((function(t){e.toolId!==t.cid&&t.isVisible()&&t.update()})),this}},{key:"focus",value:function(e){var t=this.tools;return t&&t.forEach((function(t){e===t?t.show():t.hide()})),this}},{key:"blur",value:function(e){var t=this.tools;return t&&t.forEach((function(t){t===e||t.isVisible()||(t.show(),t.update())})),this}},{key:"hide",value:function(){return this.focus(null)}},{key:"show",value:function(){return this.blur(null)}},{key:"remove",value:function(){var e=this.tools;return e&&(e.forEach((function(e){return e.remove()})),this.tools=null),jf(this.svgContainer),jf(this.htmlContainer),o(t,"remove",this,3)([])}},{key:"mount",value:function(){var e=this.tools,t=this.cellView;if(t&&e){var n=e.some((function(e){return!1!==e.options.isSVGElement})),i=e.some((function(e){return!1===e.options.isSVGElement}));if(n)(this.options.local?t.container:t.graph.view.decorator).appendChild(this.svgContainer);i&&this.graph.container.appendChild(this.htmlContainer)}return this}}])}(qp);!function(e){e.toStringTag="X6.".concat(e.name),e.isToolsView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&null!=i.graph&&null!=i.cell&&"function"==typeof i.config&&"function"==typeof i.update&&"function"==typeof i.focus&&"function"==typeof i.blur&&"function"==typeof i.show&&"function"==typeof i.hide}}($p||($p={})),function(e){var t=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,t),(e=s(this,t)).visible=!0,e.options=e.getOptions(n),e.container=qp.createElement(e.options.tagName||"g",!1!==e.options.isSVGElement),wf(e.container,e.prefixClassName("cell-tool")),"string"==typeof e.options.className&&wf(e.container,e.options.className),e.init(),e}return h(t,e),P(t,[{key:"graph",get:function(){return this.cellView.graph}},{key:"cell",get:function(){return this.cellView.cell}},{key:"name",get:function(){return this.options.name}},{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"init",value:function(){}},{key:"getOptions",value:function(e){return this.constructor.getOptions(e)}},{key:"delegateEvents",value:function(){return this.options.events&&o(t,"delegateEvents",this,3)([this.options.events]),this}},{key:"config",value:function(e,t){return this.cellView=e,this.parent=t,this.stamp(this.container),this.cell.isEdge()?wf(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&wf(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}},{key:"render",value:function(){this.empty();var e=this.options.markup;if(e){var t=Gp.parseJSONMarkup(e);this.container.appendChild(t.fragment),this.childNodes=t.selectors}return this.onRender(),this}},{key:"onRender",value:function(){}},{key:"update",value:function(){return this}},{key:"stamp",value:function(e){e&&e.setAttribute("data-cell-id",this.cellView.cell.id)}},{key:"show",value:function(){return this.container.style.display="",this.visible=!0,this}},{key:"hide",value:function(){return this.container.style.display="none",this.visible=!1,this}},{key:"isVisible",value:function(){return this.visible}},{key:"focus",value:function(){var e=this.options.focusOpacity;return null!=e&&Number.isFinite(e)&&(this.container.style.opacity="".concat(e)),this.parent.focus(this),this}},{key:"blur",value:function(){return this.container.style.opacity="",this.parent.blur(this),this}},{key:"guard",value:function(e){return null==this.graph||null==this.cellView||this.graph.view.guard(e,this.cellView)}}],[{key:"getDefaults",value:function(){return this.defaults}},{key:"config",value:function(e){this.defaults=this.getOptions(e)}},{key:"getOptions",value:function(e){return $e(Ke(this.getDefaults()),e)}}])}(qp);t.defaults={isSVGElement:!0,tagName:"g"},e.ToolItem=t,function(e){var t=0;e.define=function(e){var n=Th(function(e){return e?Fh(e):"CustomTool".concat(t+=1)}(e.name),this);return n.config(e),n}}(t=e.ToolItem||(e.ToolItem={})),function(e){e.toStringTag="X6.".concat(e.name),e.isToolItem=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&null!=i.graph&&null!=i.cell&&"function"==typeof i.config&&"function"==typeof i.update&&"function"==typeof i.focus&&"function"==typeof i.blur&&"function"==typeof i.show&&"function"==typeof i.hide&&"function"==typeof i.isVisible}}(t=e.ToolItem||(e.ToolItem={}))}($p||($p={}));function Qp(e,t){return 0===t?"0%":"".concat(Math.round(e/t*100),"%")}function ey(e){return function(t,n,i,r){return n.isEdgeElement(i)?function(e,t,n,i,r){var o=n.getConnection();if(!o)return t;var a=o.closestPointLength(r);if(e){var s=o.length();t.anchor={name:"ratio",args:{ratio:a/s}}}else t.anchor={name:"length",args:{length:a}};return t}(e,t,n,0,r):function(e,t,n,i,r){var o=n.cell,a=o.getAngle(),s=n.getUnrotatedBBoxOfElement(i),l=o.getBBox().getCenter(),u=av.create(r).rotate(a,l),c=u.x-s.x,h=u.y-s.y;e&&(c=Qp(c,s.width),h=Qp(h,s.height));return t.anchor={name:"topLeft",args:{dx:c,dy:h,rotate:!0}},t}(e,t,n,i,r)}}var ty,ny=ey(!0),iy=ey(!1),ry=Object.freeze(Object.defineProperty({__proto__:null,noop:function(e){return e},pinAbsolute:iy,pinRelative:ny},Symbol.toStringTag,{value:"Module"}));function oy(e,t,n,i){return Eh(ty.presets.pinRelative,this.graph,{},t,n,e,this.cell,i,{}).anchor}function ay(e,t){return t?e.cell.getBBox():e.cell.isEdge()?e.getConnection().bbox():e.getUnrotatedBBoxOfElement(e.container)}!function(e){e.presets=ry,e.registry=Ov.create({type:"connection strategy"}),e.registry.register(e.presets,!0)}(ty||(ty={}));var sy=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"onRender",value:function(){wf(this.container,this.prefixClassName("cell-tool-button")),this.update()}},{key:"update",value:function(){return this.updatePosition(),this}},{key:"updatePosition",value:function(){var e=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();Dd(this.container,e,{absolute:!0})}},{key:"getNodeMatrix",value:function(){var e=this.cellView,t=this.options,n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r,a=t.offset,s=t.useCellGeometry,l=t.rotate,u=ay(e,s),c=e.cell.getAngle();l||(u=u.bbox(c));var h=0,f=0;"number"==typeof a?(h=a,f=a):"object"===d(a)&&(h=a.x,f=a.y),i=Gh(i,u.width),o=Gh(o,u.height);var v=Pd().translate(u.x+u.width/2,u.y+u.height/2);return l&&(v=v.rotate(c)),v=v.translate(i+h-u.width/2,o+f-u.height/2)}},{key:"getEdgeMatrix",value:function(){var e,t,n,i=this.cellView,r=this.options,o=r.offset,a=void 0===o?0:o,s=r.distance,l=void 0===s?0:s,u=r.rotate,c=Gh(l,1);(e=c>=0&&c<=1?i.getTangentAtRatio(c):i.getTangentAtLength(c))?(t=e.start,n=e.vector().vectorAngle(new av(1,0))||0):(t=i.getConnection().start,n=0);var h=Pd().translate(t.x,t.y).rotate(n);return h="object"===d(a)?h.translate(a.x||0,a.y||0):h.translate(0,a),u||(h=h.rotate(-n)),h}},{key:"onMouseDown",value:function(e){if(!this.guard(e)){e.stopPropagation(),e.preventDefault();var t=this.options.onClick;"function"==typeof t&&Eh(t,this.cellView,{e:e,view:this.cellView,cell:this.cellView.cell,btn:this})}}}])}($p.ToolItem);!function(e){e.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})}(sy||(sy={})),function(e){e.Remove=e.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick:function(e){var t=e.view,n=e.btn;n.parent.remove(),t.cell.remove({ui:!0,toolId:n.cid})}})}(sy||(sy={}));var ly=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},uy=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"onRender",value:function(){if(wf(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){var e=this.options.attrs,t=e.class,n=ly(e,["class"]);qf(this.container,Jf(n)),t&&wf(this.container,t)}this.update()}},{key:"update",value:function(){var e=this.cellView,t=this.options,n=t.useCellGeometry,i=t.rotate,r=Jh(t.padding),o=ay(e,n).moveAndExpand({x:-r.left,y:-r.top,width:r.left+r.right,height:r.top+r.bottom}),a=e.cell;if(a.isNode()){var s=a.getAngle();if(s)if(i){var l=a.getBBox().getCenter();Rd(this.container,s,l.x,l.y,{absolute:!0})}else o=o.bbox(s)}return qf(this.container,o.toJSON()),this}}])}($p.ToolItem);!function(e){e.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})}(uy||(uy={}));var cy=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).handles=[],e}return h(t,e),P(t,[{key:"vertices",get:function(){return this.cellView.cell.getVertices()}},{key:"onRender",value:function(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}},{key:"update",value:function(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}},{key:"resetHandles",value:function(){var e=this,t=this.handles;this.handles=[],t&&t.forEach((function(t){e.stopHandleListening(t),t.remove()}))}},{key:"renderHandles",value:function(){for(var e=this,t=this.vertices,n=0,i=t.length;n<i;n+=1){var r=t[n],o=this.options.createHandle,a=this.options.processHandle,s=o({index:n,graph:this.graph,guard:function(t){return e.guard(t)},attrs:this.options.attrs||{}});a&&a(s),s.updatePosition(r.x,r.y),this.stamp(s.container),this.container.appendChild(s.container),this.handles.push(s),this.startHandleListening(s)}}},{key:"updateHandles",value:function(){for(var e=this.vertices,t=0,n=e.length;t<n;t+=1){var i=e[t],r=this.handles[t];r&&r.updatePosition(i.x,i.y)}}},{key:"updatePath",value:function(){var e=this.childNodes.connection;e&&e.setAttribute("d",this.cellView.getConnectionPathData())}},{key:"startHandleListening",value:function(e){var t=this.cellView;t.can("vertexMovable")&&(e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.on("remove",this.onHandleRemove,this)}},{key:"stopHandleListening",value:function(e){var t=this.cellView;t.can("vertexMovable")&&(e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.off("remove",this.onHandleRemove,this)}},{key:"getNeighborPoints",value:function(e){var t=this.cellView,n=this.vertices,i=e>0?n[e-1]:t.sourceAnchor,r=e<n.length-1?n[e+1]:t.targetAnchor;return{prev:av.create(i),next:av.create(r)}}},{key:"getMouseEventArgs",value:function(e){var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);return{e:t,x:n.x,y:n.y}}},{key:"onHandleChange",value:function(e){var t=e.e;this.focus();var n=this.cellView;if(n.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){var i=this.getMouseEventArgs(t),r=i.e,o=i.x,a=i.y;this.eventData(r,{start:{x:o,y:a}}),n.notifyMouseDown(r,o,a)}}},{key:"onHandleChanging",value:function(e){var t=e.handle,n=e.e,i=this.cellView,r=t.options.index,o=this.getMouseEventArgs(n),a=o.e,s=o.x,l=o.y,u={x:s,y:l};this.snapVertex(u,r),i.cell.setVertexAt(r,u,{ui:!0,toolId:this.cid}),t.updatePosition(u.x,u.y),this.options.stopPropagation||i.notifyMouseMove(a,s,l)}},{key:"stopBatch",value:function(e){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),e&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}},{key:"onHandleChanged",value:function(e){var t=e.e,n=this.options,i=this.cellView;if(n.addable&&this.updatePath(),n.removeRedundancies){i.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(t).vertexAdded);var r=this.getMouseEventArgs(t),o=r.e,a=r.x,s=r.y;if(!this.options.stopPropagation){i.notifyMouseUp(o,a,s);var l=this.eventData(o).start;if(l){var u=l.x,c=l.y;u===a&&c===s&&i.onClick(o,a,s)}}i.checkMouseleave(o),n.onChanged&&n.onChanged({edge:i.cell,edgeView:i})}else this.stopBatch(this.eventData(t).vertexAdded)}},{key:"snapVertex",value:function(e,t){var n=this.options.snapRadius||0;if(n>0){var i=this.getNeighborPoints(t),r=i.prev,o=i.next;Math.abs(e.x-r.x)<n?e.x=r.x:Math.abs(e.x-o.x)<n&&(e.x=o.x),Math.abs(e.y-r.y)<n?e.y=i.prev.y:Math.abs(e.y-o.y)<n&&(e.y=o.y)}}},{key:"onHandleRemove",value:function(e){var t=e.handle,n=e.e;if(this.options.removable){var i=t.options.index,r=this.cellView;r.cell.removeVertexAt(i,{ui:!0}),this.options.addable&&this.updatePath(),r.checkMouseleave(this.normalizeEvent(n))}}},{key:"allowAddVertex",value:function(e){var t=this.guard(e),n=this.options.addable&&this.cellView.can("vertexAddable"),i=!this.options.modifiers||$d.isMatch(e,this.options.modifiers);return!t&&n&&i}},{key:"onPathMouseDown",value:function(e){var t=this.cellView;if(this.allowAddVertex(e)){e.stopPropagation(),e.preventDefault();var n=this.normalizeEvent(e),i=this.graph.snapToGrid(n.clientX,n.clientY).toJSON();t.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});var r=t.getVertexIndex(i.x,i.y);this.snapVertex(i,r),t.cell.insertVertex(i,r,{ui:!0,toolId:this.cid}),this.render();var o=this.handles[r];this.eventData(n,{vertexAdded:!0}),o.onMouseDown(n)}}},{key:"onRemove",value:function(){this.resetHandles()}}])}($p.ToolItem);!function(e){var t=function(t){function n(e){var t;return A(this,n),(t=s(this,n)).options=e,t.render(),t.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"}),t}return h(n,t),P(n,[{key:"graph",get:function(){return this.options.graph}},{key:"render",value:function(){this.container=qp.createElement("circle",!0);var t=this.options.attrs;if("function"==typeof t){var n=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),t(this)))}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-vertex"))}},{key:"updatePosition",value:function(e,t){this.setAttrs({cx:e,cy:t})}},{key:"onMouseDown",value:function(e){this.options.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data),this.emit("change",{e:e,handle:this}))}},{key:"onMouseMove",value:function(e){this.emit("changing",{e:e,handle:this})}},{key:"onMouseUp",value:function(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}},{key:"onDoubleClick",value:function(e){this.emit("remove",{e:e,handle:this})}}])}(qp);e.Handle=t}(cy||(cy={})),function(e){var t=yp.prefix("edge-tool-vertex-path");e.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:function(t){return new e.Handle(t)},markup:[{tagName:"path",selector:"connection",className:t,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:O(O({},"mousedown .".concat(t),"onPathMouseDown"),"touchstart .".concat(t),"onPathMouseDown")})}(cy||(cy={}));var hy=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).handles=[],e}return h(t,e),P(t,[{key:"vertices",get:function(){return this.cellView.cell.getVertices()}},{key:"update",value:function(){return this.render(),this}},{key:"onRender",value:function(){wf(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();var e=this.cellView,t=v(this.vertices);t.unshift(e.sourcePoint),t.push(e.targetPoint);for(var n=0,i=t.length;n<i-1;n+=1){var r=t[n],o=t[n+1],a=this.renderHandle(r,o,n);this.stamp(a.container),this.handles.push(a)}return this}},{key:"renderHandle",value:function(e,t,n){var i=this,r=this.options.createHandle({index:n,graph:this.graph,guard:function(e){return i.guard(e)},attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(r),this.updateHandle(r,e,t),this.container.appendChild(r.container),this.startHandleListening(r),r}},{key:"startHandleListening",value:function(e){e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)}},{key:"stopHandleListening",value:function(e){e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)}},{key:"resetHandles",value:function(){var e=this,t=this.handles;this.handles=[],t&&t.forEach((function(t){e.stopHandleListening(t),t.remove()}))}},{key:"shiftHandleIndexes",value:function(e){for(var t=this.handles,n=0,i=t.length;n<i;n+=1)t[n].options.index+=e}},{key:"resetAnchor",value:function(e,t){var n=this.cellView.cell,i={ui:!0,toolId:this.cid};t?n.prop([e,"anchor"],t,i):n.removeProp([e,"anchor"],i)}},{key:"snapHandle",value:function(e,t,n){var i=e.options.axis,r=e.options.index,o=this.cellView.cell.getVertices(),a=o[r-2]||n.sourceAnchor,s=o[r+1]||n.targetAnchor,l=this.options.snapRadius;return Math.abs(t[i]-a[i])<l?t[i]=a[i]:Math.abs(t[i]-s[i])<l&&(t[i]=s[i]),t}},{key:"onHandleChanging",value:function(e){var t=e.handle,n=e.e,i=this.graph,r=this.options,o=this.cellView,a=r.anchor,s=t.options.axis,l=t.options.index-1,u=this.getEventData(n),c=this.normalizeEvent(n),h=i.snapToGrid(c.clientX,c.clientY),f=this.snapHandle(t,h.clone(),u),d=Ke(this.vertices),v=d[l],g=d[l+1],p=o.sourceView,y=o.sourceBBox,m=!1,w=!1;if(v?0===l?y.containsPoint(v)?(d.shift(),this.shiftHandleIndexes(-1),m=!0):(v[s]=f[s],w=!0):v[s]=f[s]:((v=o.sourceAnchor.toJSON())[s]=f[s],y.containsPoint(v)?m=!0:(d.unshift(v),this.shiftHandleIndexes(1),w=!0)),"function"==typeof a&&p){if(m){var b=u.sourceAnchor.clone();b[s]=f[s];var k=Eh(a,o,b,p,o.sourceMagnet||p.container,"source",o,this);this.resetAnchor("source",k)}w&&this.resetAnchor("source",u.sourceAnchorDef)}var x=o.targetView,C=o.targetBBox,E=!1,S=!1;if(g?l===d.length-2?C.containsPoint(g)?(d.pop(),E=!0):(g[s]=f[s],S=!0):g[s]=f[s]:((g=o.targetAnchor.toJSON())[s]=f[s],C.containsPoint(g)?E=!0:(d.push(g),S=!0)),"function"==typeof a&&x){if(E){var M=u.targetAnchor.clone();M[s]=f[s];var A=Eh(a,o,M,x,o.targetMagnet||x.container,"target",o,this);this.resetAnchor("target",A)}S&&this.resetAnchor("target",u.targetAnchorDef)}av.equalPoints(d,this.vertices)||this.cellView.cell.setVertices(d,{ui:!0,toolId:this.cid}),this.updateHandle(t,v,g,0),r.stopPropagation||o.notifyMouseMove(c,h.x,h.y)}},{key:"onHandleChange",value:function(e){var t=e.handle,n=e.e,i=this.options,r=this.handles,o=this.cellView,a=t.options.index;if(Array.isArray(r)){for(var s=0,l=r.length;s<l;s+=1)s!==a&&r[s].hide();if(this.focus(),this.setEventData(n,{sourceAnchor:o.sourceAnchor.clone(),targetAnchor:o.targetAnchor.clone(),sourceAnchorDef:Ke(this.cell.prop(["source","anchor"])),targetAnchorDef:Ke(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!i.stopPropagation){var u=this.normalizeEvent(n),c=this.graph.snapToGrid(u.clientX,u.clientY);o.notifyMouseDown(u,c.x,c.y)}}}},{key:"onHandleChanged",value:function(e){var t=e.e,n=this.options,i=this.cellView;n.removeRedundancies&&i.removeRedundantLinearVertices({ui:!0,toolId:this.cid});var r=this.normalizeEvent(t),o=this.graph.snapToGrid(r.clientX,r.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),n.stopPropagation||i.notifyMouseUp(r,o.x,o.y),i.checkMouseleave(r),n.onChanged&&n.onChanged({edge:i.cell,edgeView:i})}},{key:"updateHandle",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.options.precision||0,o=Math.abs(t.x-n.x)<r,a=Math.abs(t.y-n.y)<r;if(o||a){var s=new lv(t,n);if(s.length()<this.options.threshold)e.hide();else{var l=s.getCenter(),u=o?"x":"y";l[u]+=i||0;var c=s.vector().vectorAngle(new av(1,0));e.updatePosition(l.x,l.y,c,this.cellView),e.show(),e.options.axis=u}}else e.hide()}},{key:"onRemove",value:function(){this.resetHandles()}}])}($p.ToolItem);!function(e){var t=function(t){function n(e){var t;return A(this,n),(t=s(this,n)).options=e,t.render(),t.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"}),t}return h(n,t),P(n,[{key:"render",value:function(){this.container=qp.createElement("rect",!0);var t=this.options.attrs;if("function"==typeof t){var n=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),t(this)))}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-segment"))}},{key:"updatePosition",value:function(e,t,n,i){var r=i.getClosestPoint(new av(e,t))||new av(e,t),o=Pd().translate(r.x,r.y);if(r.equals({x:e,y:t}))o=o.rotate(n);else{var a=new lv(e,t,r.x,r.y).vector().vectorAngle(new av(1,0));0!==a&&(a+=90),o=o.rotate(a)}this.setAttrs({transform:Ld(o),cursor:n%180==0?"row-resize":"col-resize"})}},{key:"onMouseDown",value:function(e){this.options.guard(e)||(this.trigger("change",{e:e,handle:this}),e.stopPropagation(),e.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data))}},{key:"onMouseMove",value:function(e){this.emit("changing",{e:e,handle:this})}},{key:"onMouseUp",value:function(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}},{key:"show",value:function(){this.container.style.display=""}},{key:"hide",value:function(){this.container.style.display="none"}}])}(qp);e.Handle=t}(hy||(hy={})),function(e){e.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:function(t){return new e.Handle(t)},anchor:oy})}(hy||(hy={}));var fy=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"type",get:function(){return this.options.type}},{key:"onRender",value:function(){wf(this.container,this.prefixClassName("edge-tool-".concat(this.type,"-anchor"))),this.toggleArea(!1),this.update()}},{key:"update",value:function(){var e=this.type;return this.cellView.getTerminalView(e)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}},{key:"updateAnchor",value:function(){var e=this.childNodes;if(e){var t=e.anchor;if(t){var n=this.type,i=this.cellView,r=this.options,o=i.getTerminalAnchor(n),a=i.cell.prop([n,"anchor"]);t.setAttribute("transform","translate(".concat(o.x,", ").concat(o.y,")"));var s=a?r.customAnchorAttrs:r.defaultAnchorAttrs;s&&Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])}))}}}},{key:"updateArea",value:function(){var e=this.childNodes;if(e){var t=e.area;if(t){var n=this.type,i=this.cellView,r=i.getTerminalView(n);if(r){var o,a,s,l=r.cell,u=i.getTerminalMagnet(n),c=this.options.areaPadding||0;Number.isFinite(c)||(c=0),r.isEdgeElement(u)?(a=0,s=(o=r.getBBox()).getCenter()):(o=r.getUnrotatedBBoxOfElement(u),a=l.getAngle(),s=o.getCenter(),a&&s.rotate(-a,l.getBBox().getCenter())),o.inflate(c),qf(t,{x:-o.width/2,y:-o.height/2,width:o.width,height:o.height,transform:"translate(".concat(s.x,", ").concat(s.y,") rotate(").concat(a,")")})}}}}},{key:"toggleArea",value:function(e){if(this.childNodes){var t=this.childNodes.area;t&&(t.style.display=e?"":"none")}}},{key:"onMouseDown",value:function(e){this.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}},{key:"resetAnchor",value:function(e){var t=this.type,n=this.cell;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([t,"anchor"],{ui:!0,toolId:this.cid})}},{key:"onMouseMove",value:function(e){var t=this.type,n=this.cellView,i=n.getTerminalView(t);if(null!=i){var r,o=this.normalizeEvent(e),a=i.cell,s=n.getTerminalMagnet(t),l=this.graph.coord.clientToLocalPoint(o.clientX,o.clientY),u=this.options.snap;if("function"==typeof u){var c=Eh(u,n,l,i,s,t,n,this);l=av.create(c)}if(this.options.restrictArea)if(i.isEdgeElement(s)){var h=i.getClosestPoint(l);h&&(l=h)}else{var f=i.getUnrotatedBBoxOfElement(s),d=a.getAngle(),v=a.getBBox().getCenter(),g=l.clone().rotate(d,v);f.containsPoint(g)||(l=f.getNearestPointToPoint(g).rotate(-d,v))}var p=this.options.anchor;"function"==typeof p&&(r=Eh(p,n,l,i,s,t,n,this)),this.resetAnchor(r),this.update()}}},{key:"onMouseUp",value:function(e){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);var t=this.cellView;this.options.removeRedundancies&&t.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}},{key:"onDblClick",value:function(){var e=this.options.resetAnchor;e&&this.resetAnchor(!0===e?void 0:e),this.update()}}])}($p.ToolItem);!function(e){e.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:oy,snap:function(e,t,n,i,r,o){var a=o.options.snapRadius||0,s="source"===i,l=s?0:-1,u=this.cell.getVertexAt(l)||this.getTerminalAnchor(s?"target":"source");return u&&(Math.abs(u.x-e.x)<a&&(e.x=u.x),Math.abs(u.y-e.y)<a&&(e.y=u.y)),e}})}(fy||(fy={}));var dy=fy.define({name:"source-anchor",type:"source"}),vy=fy.define({name:"target-anchor",type:"target"}),gy=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},py=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"type",get:function(){return this.options.type}},{key:"ratio",get:function(){return this.options.ratio}},{key:"init",value:function(){if(this.options.attrs){var e=this.options.attrs,t=e.class,n=gy(e,["class"]);this.setAttrs(n,this.container),t&&wf(this.container,t)}}},{key:"onRender",value:function(){wf(this.container,this.prefixClassName("edge-tool-".concat(this.type,"-arrowhead"))),this.update()}},{key:"update",value:function(){var e=this.ratio,t=this.cellView,n=t.getTangentAtRatio(e),i=n?n.start:t.getPointAtRatio(e),r=n&&n.vector().vectorAngle(new av(1,0))||0;if(!i)return this;var o=Pd().translate(i.x,i.y).rotate(r);return Dd(this.container,o,{absolute:!0}),this}},{key:"onMouseDown",value:function(e){if(!this.guard(e)){e.stopPropagation(),e.preventDefault();var t=this.cellView;if(t.can("arrowheadMovable")){t.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});var n=this.graph.snapToGrid(e.clientX,e.clientY),i=t.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(e,i),this.delegateDocumentEvents(this.options.documentEvents,e.data),t.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}}},{key:"onMouseMove",value:function(e){var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);this.cellView.onMouseMove(t,n.x,n.y),this.update()}},{key:"onMouseUp",value:function(e){this.undelegateDocumentEvents();var t=this.normalizeEvent(e),n=this.cellView,i=this.graph.snapToGrid(t.clientX,t.clientY);n.onMouseUp(t,i.x,i.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",n.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}])}($p.ToolItem);!function(e){e.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})}(py||(py={}));var yy=py.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),my=py.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),wy=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).labelIndex=-1,e.distance=.5,e.dblClick=e.onCellDblClick.bind(e),e}return h(t,e),P(t,[{key:"onRender",value:function(){var e=this.cellView;e&&e.on("cell:dblclick",this.dblClick)}},{key:"createElement",value:function(){var e=[this.prefixClassName("".concat(this.cell.isEdge()?"edge":"node","-tool-editor")),this.prefixClassName("cell-tool-editor")];this.editor=$p.createElement("div",!1),this.addClass(e,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}},{key:"removeElement",value:function(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}},{key:"updateEditor",value:function(){var e=this.cell,t=this.editor;if(t){var n=t.style;e.isNode()?this.updateNodeEditorTransform():e.isEdge()&&this.updateEdgeEditorTransform();var i=this.options.attrs;n.fontSize="".concat(i.fontSize,"px"),n.fontFamily=i.fontFamily,n.color=i.color,n.backgroundColor=i.backgroundColor;var r=this.getCellText()||"";return t.innerText=r,this.setCellText(""),this}}},{key:"updateNodeEditorTransform",value:function(){var e=this.graph,t=this.cell,n=this.editor;if(n){var i=av.create(),r=20,o="",a=this.options,s=a.x,l=a.y,u=this.options,c=u.width,h=u.height;if(void 0!==s&&void 0!==l){var f=t.getBBox();s=Gh(s,f.width),l=Gh(l,f.height),i=f.topLeft.translate(s,l),r=f.width-2*s}else{var d=t.getBBox();i=d.center,r=d.width-4,o="translate(-50%, -50%)"}var v=e.scale(),g=n.style;i=e.localToGraph(i),g.left="".concat(i.x,"px"),g.top="".concat(i.y,"px"),g.transform="scale(".concat(v.sx,", ").concat(v.sy,") ").concat(o),g.minWidth="".concat(r,"px"),"number"==typeof c&&(g.width="".concat(c,"px")),"number"==typeof h&&(g.height="".concat(h,"px"))}}},{key:"updateEdgeEditorTransform",value:function(){if(this.event){var e=this.graph,t=this.editor;if(t){var n=av.create(),i=20,r=t.style,o=this.event.target,a=o.parentElement;if(a&&mf(a,this.prefixClassName("edge-label"))){var s=a.getAttribute("data-index")||"0";this.labelIndex=parseInt(s,10);var l=jd(a.getAttribute("transform")).translation;n=new av(l.tx,l.ty),i=pp.getBBox(o).width}else{if(!this.options.labelAddable)return this;n=e.clientToLocal(av.create(this.event.clientX,this.event.clientY));var u=this.cellView.path.closestPointLength(n);this.distance=u,this.labelIndex=-1}n=e.localToGraph(n);var c=e.scale();r.left="".concat(n.x,"px"),r.top="".concat(n.y,"px"),r.minWidth="".concat(i,"px"),r.transform="scale(".concat(c.sx,", ").concat(c.sy,") translate(-50%, -50%)")}}}},{key:"onDocumentMouseUp",value:function(e){if(this.editor&&e.target!==this.editor){var t=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(""!==t?t:null),this.removeElement()}}},{key:"onCellDblClick",value:function(e){var t=e.e;this.editor||(t.stopPropagation(),this.removeElement(),this.event=t,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}},{key:"onMouseDown",value:function(e){e.stopPropagation()}},{key:"autoFocus",value:function(){var e=this;setTimeout((function(){e.editor&&(e.editor.focus(),e.selectText())}))}},{key:"selectText",value:function(){if(window.getSelection&&this.editor){var e=document.createRange(),t=window.getSelection();e.selectNodeContents(this.editor),t.removeAllRanges(),t.addRange(e)}}},{key:"getCellText",value:function(){var e=this.options.getText;if("function"==typeof e)return Eh(e,this.cellView,{cell:this.cell,index:this.labelIndex});if("string"==typeof e){if(this.cell.isNode())return this.cell.attr(e);if(this.cell.isEdge()&&-1!==this.labelIndex)return this.cell.prop("labels/".concat(this.labelIndex,"/attrs/").concat(e))}}},{key:"setCellText",value:function(e){var t=this.options.setText;if("function"!=typeof t){if("string"==typeof t){if(this.cell.isNode())return void(null!==e&&this.cell.attr(t,e));if(this.cell.isEdge()){var n=this.cell;if(-1===this.labelIndex){if(e){var i={position:{distance:this.distance},attrs:{}};Nh(i,"attrs/".concat(t),e),n.appendLabel(i)}}else null!==e?n.prop("labels/".concat(this.labelIndex,"/attrs/").concat(t),e):"number"==typeof this.labelIndex&&n.removeLabelAt(this.labelIndex)}}}else Eh(t,this.cellView,{cell:this.cell,value:e,index:this.labelIndex,distance:this.distance})}},{key:"onRemove",value:function(){var e=this.cellView;e&&e.off("cell:dblclick",this.dblClick),this.removeElement()}}])}($p.ToolItem);!function(e){e.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}})}(wy||(wy={})),function(e){e.NodeEditor=e.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),e.EdgeEditor=e.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"})}(wy||(wy={}));var by,ky,xy=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};!function(e){e.presets={boundary:uy,button:sy,"button-remove":sy.Remove,"node-editor":wy.NodeEditor},e.registry=Ov.create({type:"node tool",process:function(e,t){if("function"==typeof t)return t;var n=$p.ToolItem,i=t.inherit,r=xy(t,["inherit"]);if(i){var o=this.get(i);null==o?this.onNotFound(i,"inherited"):n=o}return null==r.name&&(r.name=e),n.define.call(n,r)}}),e.registry.register(e.presets,!0)}(by||(by={})),function(e){e.presets={boundary:uy,vertices:cy,segments:hy,button:sy,"button-remove":sy.Remove,"source-anchor":dy,"target-anchor":vy,"source-arrowhead":yy,"target-arrowhead":my,"edge-editor":wy.EdgeEditor},e.registry=Ov.create({type:"edge tool",process:function(e,t){if("function"==typeof t)return t;var n=$p.ToolItem,i=t.inherit,r=xy(t,["inherit"]);if(i){var o=this.get(i);null==o?this.onNotFound(i,"inherited"):n=o}return null==r.name&&(r.name=e),n.define.call(n,r)}}),e.registry.register(e.presets,!0)}(ky||(ky={}));var Cy=Ly("center"),Ey=Ly("topCenter"),Sy=Ly("bottomCenter"),My=Ly("leftMiddle"),Ay=Ly("rightMiddle"),_y=Ly("topLeft"),Py=Ly("topRight"),Oy=Ly("bottomLeft"),Ty=Ly("bottomRight");function Ly(e){return function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.rotate?t.getUnrotatedBBoxOfElement(n):t.getBBoxOfElement(n),a=o[e];a.x+=Gh(r.dx,o.width),a.y+=Gh(r.dy,o.height);var s=t.cell;return r.rotate?a.rotate(-s.getAngle(),s.getBBox().getCenter()):a}}function jy(e){return function(t,n,i,r){if(i instanceof Element){var o,a=this.graph.findViewByElem(i);if(a)if(a.isEdgeElement(i))o=Ny(a,null!=r.fixedAt?r.fixedAt:"50%");else o=a.getBBoxOfElement(i).getCenter();else o=new av;return e.call(this,t,n,o,r)}return e.apply(this,arguments)}}function Ny(e,t){var n=qh(t),i="string"==typeof t?parseFloat(t):t;return n?e.getPointAtRatio(i/100):e.getPointAtLength(i)}var Dy,Iy=jy((function(e,t,n,i){var r=nv.normalize(e.cell.getAngle()),o=e.getBBoxOfElement(t),a=o.getCenter(),s=o.getTopLeft(),l=o.getBottomRight(),u=i.padding;if(Number.isFinite(u)||(u=0),s.y+u<=n.y&&n.y<=l.y-u){var c=n.y-a.y;a.x+=0===r||180===r?0:1*c/Math.tan(nv.toRad(r)),a.y+=c}else if(s.x+u<=n.x&&n.x<=l.x-u){var h=n.x-a.x;a.y+=90===r||270===r?0:h*Math.tan(nv.toRad(r)),a.x+=h}return a})),Ry=jy((function(e,t,n,i){var r,o,a=0,s=e.cell;i.rotate?(r=e.getUnrotatedBBoxOfElement(t),o=s.getBBox().getCenter(),a=s.getAngle()):r=e.getBBoxOfElement(t);var l=i.padding;null!=l&&Number.isFinite(l)&&r.inflate(l),i.rotate&&n.rotate(a,o);var u,c=r.getNearestSideToPoint(n);switch(c){case"left":u=r.getLeftMiddle();break;case"right":u=r.getRightMiddle();break;case"top":u=r.getTopCenter();break;case"bottom":u=r.getBottomCenter()}var h=i.direction;return"H"===h?"top"!==c&&"bottom"!==c||(u=n.x<=r.x+r.width?r.getLeftMiddle():r.getRightMiddle()):"V"===h&&(u=n.y<=r.y+r.height?r.getTopCenter():r.getBottomCenter()),i.rotate?u.rotate(-a,o):u})),By=Object.freeze(Object.defineProperty({__proto__:null,bottom:Sy,bottomLeft:Oy,bottomRight:Ty,center:Cy,left:My,midSide:Ry,nodeCenter:function(e,t,n,i,r){var o=e.cell.getConnectionPoint(this.cell,r);return(i.dx||i.dy)&&o.translate(i.dx||0,i.dy||0),o},orth:Iy,right:Ay,top:Ey,topLeft:_y,topRight:Py},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=By,e.registry=Ov.create({type:"node endpoint"}),e.registry.register(e.presets,!0)}(Dy||(Dy={}));var zy,Fy=function(e,t,n,i){var r=e.getClosestPoint(n);return null!=r?r:new av},Vy=jy(Fy),Hy=jy((function(e,t,n,i){var r=1e6,o=e.getConnection(),a=e.getConnectionSubdivisions(),s=new lv(n.clone().translate(0,r),n.clone().translate(0,-r)),l=new lv(n.clone().translate(r,0),n.clone().translate(-r,0)),u=s.intersect(o,{segmentSubdivisions:a}),c=l.intersect(o,{segmentSubdivisions:a}),h=[];return u&&h.push.apply(h,v(u)),c&&h.push.apply(h,v(c)),h.length>0?n.closest(h):null!=i.fallbackAt?Ny(e,i.fallbackAt):Eh(Fy,this,e,t,n,i)})),Uy=Object.freeze(Object.defineProperty({__proto__:null,closest:Vy,length:function(e,t,n,i){var r=null!=i.length?i.length:20;return e.getPointAtLength(r)},orth:Hy,ratio:function(e,t,n,i){var r=null!=i.ratio?i.ratio:.5;return r>1&&(r/=100),e.getPointAtRatio(r)}},Symbol.toStringTag,{value:"Module"}));function qy(e,t,n){var i;if("object"===d(n)){if(Number.isFinite(n.y)){var r=new lv(t,e).parallel(n.y);t=r.start,e=r.end}i=n.x}else i=n;if(null==i||!Number.isFinite(i))return e;var o=e.distance(t);return 0===i&&o>0?e:e.move(t,-Math.min(i,o-1))}function Gy(e){var t=e.getAttribute("stroke-width");return null===t?0:parseFloat(t)||0}!function(e){e.presets=Uy,e.registry=Ov.create({type:"edge endpoint"}),e.registry.register(e.presets,!0)}(zy||(zy={}));var Jy=function(e,t,n,i){var r=t.getBBoxOfElement(n);i.stroked&&r.inflate(Gy(n)/2);var o=e.intersect(r);return qy(o&&o.length?e.start.closest(o):e.end,e.start,i.offset)};var Wy,Yy=Object.freeze(Object.defineProperty({__proto__:null,anchor:function(e,t,n,i){var r=i.alignOffset,o=i.align;return o&&function(e,t){var n,i,r,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=e.start,l=e.end;switch(t){case"left":o="x",n=l,i=s,r=-1;break;case"right":o="x",n=s,i=l,r=1;break;case"top":o="y",n=l,i=s,r=-1;break;case"bottom":o="y",n=s,i=l,r=1;break;default:return}s[o]<l[o]?n[o]=i[o]:i[o]=n[o],Number.isFinite(a)&&(n[o]+=r*a,i[o]+=r*a)}(e,o,r),qy(e.end,e.start,i.offset)},bbox:Jy,boundary:function(e,t,n,i){var r,o,a=e.end,s=i.selector;if(r="string"==typeof s?t.findOne(s):Array.isArray(s)?jh(n,s):function(e){if(null==e)return null;var t=e;do{var n=t.tagName;if("string"!=typeof n)return null;if("G"===(n=n.toUpperCase()))t=t.firstElementChild;else{if("TITLE"!==n)break;t=t.nextElementSibling}}while(t);return t}(n),!Ef(r)){if(r===n||!Ef(n))return a;r=n}var l,u=t.getShapeOfElement(r),c=t.getMatrixOfElement(r),h=t.getRootTranslatedMatrix(),f=t.getRootRotatedMatrix(),v=h.multiply(f).multiply(c),g=v.inverse(),p=pp.transformLine(e,g),y=p.start.clone(),m=t.getDataOfElement(r);if(!1===i.insideout){null==m.shapeBBox&&(m.shapeBBox=u.bbox());var w=m.shapeBBox;if(null!=w&&w.containsPoint(y))return a}if(!0===i.extrapolate&&p.setLength(1e6),Pv.isPath(u)){var b=i.precision||2;null==m.segmentSubdivisions&&(m.segmentSubdivisions=u.getSegmentSubdivisions({precision:b})),l={precision:b,segmentSubdivisions:m.segmentSubdivisions},o=p.intersect(u,l)}else o=p.intersect(u);o?Array.isArray(o)&&(o=y.closest(o)):!0===i.sticky&&(o=sv.isRectangle(u)?u.getNearestPointToPoint(y):uv.isEllipse(u)?u.intersectsWithLineFromCenterToPoint(y):u.closestPoint(y,l));var k=o?pp.transformPoint(o,v):a,x=i.offset||0;return!1!==i.stroked&&("object"===d(x)?(null==(x=Object.assign({},x)).x&&(x.x=0),x.x+=Gy(r)/2):x+=Gy(r)/2),qy(k,e.start,x)},rect:function(e,t,n,i,r){var o=t.cell,a=o.isNode()?o.getAngle():0;if(0===a)return Eh(Jy,this,e,t,n,i,r);var s=t.getUnrotatedBBoxOfElement(n);i.stroked&&s.inflate(Gy(n)/2);var l=s.getCenter(),u=e.clone().rotate(a,l),c=u.setLength(1e6).intersect(s);return qy(c&&c.length?u.start.closest(c).rotate(-a,l):e.end,e.start,i.offset)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Yy,e.registry=Ov.create({type:"connection point"}),e.registry.register(e.presets,!0)}(Wy||(Wy={}));function Zy(e){return new sv(e.x,e.y,0,0)}function Ky(){var e=Jh((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).padding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function Xy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.sourceBBox.clone().moveAndExpand(Ky(t))}function $y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.targetBBox.clone().moveAndExpand(Ky(t))}var Qy,em=function(e,t,n){var i=Xy(n,t),r=$y(n,t),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.sourceAnchor?e.sourceAnchor:Xy(e,t).getCenter()}(n,t),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.targetAnchor?e.targetAnchor:$y(e,t).getCenter()}(n,t);i=i.union(Zy(o)),r=r.union(Zy(a));var s=e.map((function(e){return av.create(e)}));s.unshift(o),s.push(a);for(var l=null,u=[],c=0,h=s.length-1;c<h;c+=1){var f=null,d=s[c],g=s[c+1],p=null!=Qy.getBearing(d,g);if(0===c)c+1===h?i.intersectsWithRect(r.clone().inflate(1))?f=Qy.insideNode(d,g,i,r):p||(f=Qy.nodeToNode(d,g,i,r)):i.containsPoint(g)?f=Qy.insideNode(d,g,i,Zy(g).moveAndExpand(Ky(t))):p||(f=Qy.nodeToVertex(d,g,i));else if(c+1===h){var y=p&&Qy.getBearing(g,d)===l;r.containsPoint(d)||y?f=Qy.insideNode(d,g,Zy(d).moveAndExpand(Ky(t)),r,l):p||(f=Qy.vertexToNode(d,g,r,l))}else p||(f=Qy.vertexToVertex(d,g,l));f?(u.push.apply(u,v(f.points)),l=f.direction):l=Qy.getBearing(d,g),c+1<h&&u.push(g)}return u};!function(e){var t={N:"S",S:"N",E:"W",W:"E"},n={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function i(e,t,n){var i=new av(e.x,t.y);return n.containsPoint(i)&&(i=new av(t.x,e.y)),i}function r(e,t){return e["W"===t||"E"===t?"width":"height"]}function o(e,t){return e.x===t.x?e.y>t.y?"N":"S":e.y===t.y?e.x>t.x?"W":"E":null}function a(e,n,i){var r=new av(e.x,n.y),a=new av(n.x,e.y),s=o(e,r),l=o(e,a),u=i?t[i]:null,c=s===i||s!==u&&(l===u||l!==i)?r:a;return{points:[c],direction:o(c,n)}}function s(e,t,n){var r=i(e,t,n);return{points:[r],direction:o(r,t)}}e.getBBoxSize=r,e.getBearing=o,e.vertexToVertex=a,e.nodeToVertex=s,e.vertexToNode=function(e,t,n,a){var s,l=[new av(e.x,t.y),new av(t.x,e.y)],u=l.filter((function(e){return!n.containsPoint(e)})),c=u.filter((function(t){return o(t,e)!==a}));if(c.length>0)return{points:[s=(s=c.filter((function(t){return o(e,t)===a})).pop())||c[0]],direction:o(s,t)};s=et(l,u)[0];var h=av.create(t).move(s,-r(n,a)/2);return{points:[i(h,e,n),h],direction:o(h,t)}},e.nodeToNode=function(e,t,n,i){var l=s(t,e,i),u=l.points[0];if(n.containsPoint(u)){var c=(l=s(e,t,n)).points[0];if(i.containsPoint(c)){var h=av.create(e).move(c,-r(n,o(e,c))/2),f=av.create(t).move(u,-r(i,o(t,u))/2),d=new lv(h,f).getCenter(),v=s(e,d,n),g=a(d,t,v.direction);l.points=[v.points[0],g.points[0]],l.direction=g.direction}}return l},e.insideNode=function(e,t,r,a,s){var l,u,c,h,f=r.union(a).inflate(1),d=f.getCenter(),v=d.distance(t)>d.distance(e),g=v?t:e,p=v?e:t;return s?(l=av.fromPolar(f.width+f.height,n[s],g),l=f.getNearestPointToPoint(l).move(l,-1)):l=f.getNearestPointToPoint(g).move(g,1),u=i(l,p,f),l.round().equals(u.round())?(u=av.fromPolar(f.width+f.height,nv.toRad(l.theta(g))+Math.PI/2,p),c=i(l,u=f.getNearestPointToPoint(u).move(p,1).round(),f),h=v?[u,c,l]:[l,c,u]):h=v?[u,l]:[l,u],{points:h,direction:o(v?l:u,t)}}}(Qy||(Qy={}));var tm={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return nm(this.step,this)},directions:function(){var e=nm(this.step,this),t=nm(this.cost,this);return[{cost:t,offsetX:e,offsetY:0},{cost:t,offsetX:-e,offsetY:0},{cost:t,offsetX:0,offsetY:e},{cost:t,offsetX:0,offsetY:-e}]},penalties:function(){var e=nm(this.step,this);return{0:0,45:e/2,90:e/2}},paddingBox:function(){var e=nm(this.step,this);return{x:-e,y:-e,width:2*e,height:2*e}},fallbackRouter:em,draggingRouter:null,snapToGrid:!0};function nm(e,t){return"function"==typeof e?e.call(t):e}var im=function(){return P((function e(){A(this,e),this.items=[],this.hash={},this.values={}}),[{key:"add",value:function(e,t){var n=this;this.hash[e]?this.items.splice(this.items.indexOf(e),1):this.hash[e]=1,this.values[e]=t;var i=tt(this.items,e,(function(e){return n.values[e]}));this.items.splice(i,0,e)}},{key:"pop",value:function(){var e=this.items.shift();return e&&(this.hash[e]=2),e}},{key:"isOpen",value:function(e){return 1===this.hash[e]}},{key:"isClose",value:function(e){return 2===this.hash[e]}},{key:"isEmpty",value:function(){return 0===this.items.length}}])}(),rm=function(){return P((function e(t){A(this,e),this.options=t,this.mapGridSize=100,this.map={}}),[{key:"build",value:function(e,t){var n=this.options,i=n.excludeTerminals.reduce((function(n,i){var r=t[i];if(r){var o=e.getCell(r.cell);o&&n.push(o)}return n}),[]),r=[],o=e.getCell(t.getSourceCellId());o&&(r=nt(r,o.getAncestors().map((function(e){return e.id}))));var a=e.getCell(t.getTargetCellId());a&&(r=nt(r,a.getAncestors().map((function(e){return e.id}))));var s=this.mapGridSize;return e.getNodes().reduce((function(e,t){var o=i.some((function(e){return e.id===t.id})),a=!!t.shape&&n.excludeShapes.includes(t.shape),l=n.excludeNodes.some((function(e){return"string"==typeof e?t.id===e:e===t})),u=r.includes(t.id),c=a||o||l||u;if(t.isVisible()&&!c)for(var h=t.getBBox().moveAndExpand(n.paddingBox),f=h.getOrigin().snapToGrid(s),d=h.getCorner().snapToGrid(s),v=f.x;v<=d.x;v+=s)for(var g=f.y;g<=d.y;g+=s){var p=new av(v,g).toString();null==e[p]&&(e[p]=[]),e[p].push(h)}return e}),this.map),this}},{key:"isAccessible",value:function(e){var t=e.clone().snapToGrid(this.mapGridSize).toString(),n=this.map[t];return!n||n.every((function(t){return!t.containsPoint(e)}))}}])}();function om(e,t){var n=e.sourceBBox.clone();return t&&t.paddingBox?n.moveAndExpand(t.paddingBox):n}function am(e,t){var n=e.targetBBox.clone();return t&&t.paddingBox?n.moveAndExpand(t.paddingBox):n}function sm(e,t){return e.sourceAnchor?e.sourceAnchor:om(e,t).getCenter()}function lm(e,t,n,i,r){var o=360/n,a=e.theta(function(e,t,n,i){var r=i.step,o=t.x-e.x,a=t.y-e.y,s=o/n.x,l=a/n.y,u=s*r,c=l*r;return new av(e.x+u,e.y+c)}(e,t,i,r)),s=nv.normalize(a+o/2);return o*Math.floor(s/o)}function um(e,t){var n=Math.abs(e-t);return n>180?360-n:n}function cm(e,t){if(!e)return t;var n=Math.abs(e),i=Math.round(n/t);return i?t+(n-i*t)/i:n}function hm(e,t){return e.round(t)}function fm(e,t,n){return hm(function(e,t){var n=t.source,i=iv.snapToGrid(e.x-n.x,t.x)+n.x,r=iv.snapToGrid(e.y-n.y,t.y)+n.y;return new av(i,r)}(e.clone(),t),n)}function dm(e){return e.toString()}function vm(e){return new av(0===e.x?0:Math.abs(e.x)/e.x,0===e.y?0:Math.abs(e.y)/e.y)}function gm(e,t){for(var n=1/0,i=0,r=t.length;i<r;i+=1){var o=e.manhattanDistance(t[i]);o<n&&(n=o)}return n}function pm(e,t,n,i,r){var o=r.precision,a=r.directionMap,s=e.diff(t.getCenter()),l=Object.keys(a).reduce((function(r,l){if(n.includes(l)){for(var u,c=a[l],h=new av(e.x+c.x*(Math.abs(s.x)+t.width),e.y+c.y*(Math.abs(s.y)+t.height)),f=new lv(e,h).intersect(t)||[],d=null,v=0;v<f.length;v+=1){var g=f[v],p=e.squaredDistance(g);(null==u||p>u)&&(u=p,d=g)}if(d){var y=fm(d,i,o);t.containsPoint(y)&&(y=fm(y.translate(c.x*i.x,c.y*i.y),i,o)),r.push(y)}}return r}),[]);return t.containsPoint(e)||l.push(fm(e,i,o)),l}function ym(e,t,n,i,r){for(var o,a=[],s=vm(r.diff(n)),l=dm(n),u=e[l];u;){var c=vm((o=t[l]).diff(u));c.equals(s)||(a.unshift(o),s=c),u=e[l=dm(u)]}var h=t[l];return vm(h.diff(i)).equals(s)||a.unshift(h),a}function mm(e,t,n,i,r){var o,a,s=r.precision;o=sv.isRectangle(t)?hm(sm(e,r).clone(),s):hm(t.clone(),s),a=sv.isRectangle(n)?hm(function(e,t){return e.targetAnchor?e.targetAnchor:am(e,t).getCenter()}(e,r).clone(),s):hm(n.clone(),s);var l,u,c,h,f,d=(l=r.step,c=a,{source:(u=o).clone(),x:cm(c.x-u.x,l),y:cm(c.y-u.y,l)}),v=o,g=a;if(h=sv.isRectangle(t)?pm(v,t,r.startDirections,d,r):[v],f=sv.isRectangle(n)?pm(a,n,r.endDirections,d,r):[g],h=h.filter((function(e){return i.isAccessible(e)})),f=f.filter((function(e){return i.isAccessible(e)})),h.length>0&&f.length>0){for(var p=new im,y={},m={},w={},b=0,k=h.length;b<k;b+=1){var x=h[b],C=dm(x);p.add(C,gm(x,f)),y[C]=x,w[C]=0}for(var E,S,M=r.previousDirectionAngle,A=void 0===M,_=function(e,t){var n=t.step;return t.directions.forEach((function(t){t.gridOffsetX=t.offsetX/n*e.x,t.gridOffsetY=t.offsetY/n*e.y})),t.directions}(d,r),P=_.length,O=f.reduce((function(e,t){var n=dm(t);return e.push(n),e}),[]),T=av.equalPoints(h,f),L=r.maxLoopCount;!p.isEmpty()&&L>0;){var j=p.pop(),N=y[j],D=m[j],I=w[j],R=N.equals(v),B=null==D,z=void 0;if(z=B?A?R?null:lm(v,N,P,d,r):M:lm(D,N,P,d,r),!(B&&T)&&O.indexOf(j)>=0)return r.previousDirectionAngle=z,ym(m,y,N,v,g);for(var F=0;F<P;F+=1){var V=(E=_[F]).angle;if(S=um(z,V),A&&R||!(S>r.maxDirectionChange)){var H=fm(N.clone().translate(E.gridOffsetX||0,E.gridOffsetY||0),d,s),U=dm(H);if(!p.isClose(U)&&i.isAccessible(H)){if(O.indexOf(U)>=0)if(!H.equals(g))if(um(V,lm(H,g,P,d,r))>r.maxDirectionChange)continue;var q=I+E.cost+(R?0:r.penalties[S]);(!p.isOpen(U)||q<w[U])&&(y[U]=H,m[U]=N,w[U]=q,p.add(U,q+gm(H,f)))}}}L-=1}}return r.fallbackRoute?Eh(r.fallbackRoute,this,v,g,r):null}var wm=function(e,t,n){for(var i,r,o=function(e){var t=Object.keys(e).reduce((function(t,n){return t[n]="fallbackRouter"===n||"draggingRouter"===n||"fallbackRoute"===n?e[n]:nm(e[n],e),t}),{});if(t.padding){var n=Jh(t.padding);t.paddingBox={x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom}}return t.directions.forEach((function(e){var t=new av(0,0),n=new av(e.offsetX,e.offsetY);e.angle=nv.normalize(t.theta(n))})),t}(t),a=om(n,o),s=am(n,o),l=sm(n,o),u=new rm(o).build(n.graph.model,n.cell),c=e.map((function(e){return av.create(e)})),h=[],f=l,d=0,g=c.length;d<=g;d+=1){var p=null;if(i=r||a,null==(r=c[d])){r=s;var y=n.cell;if((null==y.getSourceCellId()||null==y.getTargetCellId())&&"function"==typeof o.draggingRouter){var m=i===a?l:i,w=r.getOrigin();p=Eh(o.draggingRouter,n,m,w,o)}}if(null==p&&(p=mm(n,i,r,u,o)),null===p)return console.warn("Unable to execute manhattan algorithm, use orth instead"),Eh(o.fallbackRouter,this,e,o,n);var b=p[0];b&&b.equals(f)&&p.shift(),f=p[p.length-1]||f,h.push.apply(h,v(p))}return o.snapToGrid?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(e.length<=1)return e;for(var n=0,i=e.length;n<i-1;n+=1){var r=e[n],o=e[n+1];if(r.x===o.x){var a=t*Math.round(r.x/t);r.x!==a&&(r.x=a,o.x=a)}else if(r.y===o.y){var s=t*Math.round(r.y/t);r.y!==s&&(r.y=s,o.y=s)}}return e}(h,n.graph.grid.getGridSize()):h},bm=function(e,t,n){return Eh(wm,this,e,Object.assign(Object.assign({},tm),t),n)},km={maxDirectionChange:45,directions:function(){var e=nm(this.step,this),t=nm(this.cost,this),n=Math.ceil(Math.sqrt(e*e<<1));return[{cost:t,offsetX:e,offsetY:0},{cost:n,offsetX:e,offsetY:e},{cost:t,offsetX:0,offsetY:e},{cost:n,offsetX:-e,offsetY:e},{cost:t,offsetX:-e,offsetY:0},{cost:n,offsetX:-e,offsetY:-e},{cost:t,offsetX:0,offsetY:-e},{cost:n,offsetX:e,offsetY:-e}]},fallbackRoute:function(e,t,n){var i=e.theta(t),r=[],o={x:t.x,y:e.y},a={x:e.x,y:t.y};if(i%180>90){var s=o;o=a,a=s}var l=i%90<45?o:a,u=new lv(e,l),c=90*Math.ceil(i/90),h=av.fromPolar(u.squaredLength(),nv.toRad(c+135),l),f=new lv(t,h),d=u.intersectsWithLine(f),v=d||t,g=d?v:e,p=360/n.directions.length,y=g.theta(t),m=nv.normalize(y+p/2),w=p*Math.floor(m/p);return n.previousDirectionAngle=w,v&&r.push(v.round()),r.push(t),r}};function xm(e,t){if(null!=t&&!1!==t){var n="boolean"==typeof t?0:t;if(n>0){var i=av.create(e[1]).move(e[2],n),r=av.create(e[1]).move(e[0],n);return[i.toJSON()].concat(v(e),[r.toJSON()])}var o=e[1];return[Object.assign({},o)].concat(v(e),[Object.assign({},o)])}return e}var Cm,Em=Object.freeze(Object.defineProperty({__proto__:null,er:function(e,t,n){var i,r,o,a=t.offset||32,s=null==t.min?16:t.min,l=0,u=t.direction,c=n.sourceBBox,h=n.targetBBox,f=c.getCenter(),d=h.getCenter();if("number"==typeof a&&(l=a),null==u){var g=h.left-c.right,p=h.top-c.bottom;g>=0&&p>=0?u=g>=p?"L":"T":g<=0&&p>=0?u=(g=c.left-h.right)>=0&&g>=p?"R":"T":g>=0&&p<=0?u=(p=c.top-h.bottom)>=0?g>=p?"L":"B":"L":(g=c.left-h.right,p=c.top-h.bottom,u=g>=0&&p>=0?g>=p?"R":"B":g<=0&&p>=0?"B":g>=0&&p<=0||Math.abs(g)>Math.abs(p)?"R":"B")}"H"===u?u=d.x-f.x>=0?"L":"R":"V"===u&&(u=d.y-f.y>=0?"T":"B"),"center"===a&&("L"===u?l=(h.left-c.right)/2:"R"===u?l=(c.left-h.right)/2:"T"===u?l=(h.top-c.bottom)/2:"B"===u&&(l=(c.top-h.bottom)/2));var y="L"===u||"R"===u;if(y){if(d.y===f.y)return v(e);o="L"===u?1:-1,i="x",r="width"}else{if(d.x===f.x)return v(e);o="T"===u?1:-1,i="y",r="height"}var m=f.clone(),w=d.clone();if(m[i]+=o*(c[r]/2+l),w[i]-=o*(h[r]/2+l),y){var b=m.x,k=w.x,x=c.width/2+s,C=h.width/2+s;d.x>f.x?k<=b&&(m.x=Math.max(k,f.x+x),w.x=Math.min(b,d.x-C)):k>=b&&(m.x=Math.min(k,f.x-x),w.x=Math.max(b,d.x+C))}else{var E=m.y,S=w.y,M=c.height/2+s,A=h.height/2+s;d.y>f.y?S<=E&&(m.y=Math.max(S,f.y+M),w.y=Math.min(E,d.y-A)):S>=E&&(m.y=Math.min(S,f.y-M),w.y=Math.max(E,d.y+A))}return[m.toJSON()].concat(v(e),[w.toJSON()])},loop:function(e,t,n){var i=t.width||50,r=(t.height||80)/2,o=t.angle||"auto",a=n.sourceAnchor,s=n.targetAnchor,l=n.sourceBBox,u=n.targetBBox;if(a.equals(s)){var c=function(e){var t=nv.toRad(e),n=Math.sin(t),o=Math.cos(t),s=new av(a.x+o*i,a.y+n*i),l=new av(s.x-o*r,s.y-n*r),u=l.clone().rotate(-90,s),c=l.clone().rotate(90,s);return[u.toJSON(),s.toJSON(),c.toJSON()]},h=function(e){var t=a.clone().move(e,-1),n=new lv(t,e);return!l.containsPoint(e)&&!l.intersectsWithLine(n)},f=[0,90,180,270,45,135,225,315];if("number"==typeof o)return xm(c(o),t.merge);var d=l.getCenter();if(d.equals(a))return xm(c(0),t.merge);var g=d.angleBetween(a,d.clone().translate(1,0)),p=c(g);if(h(p[1]))return xm(p,t.merge);for(var y=1,m=f.length;y<m;y+=1)if(h((p=c(g+f[y]))[1]))return xm(p,t.merge);return xm(p,t.merge)}var w=new lv(a,s),b=w.parallel(-i),k=b.getCenter(),x=b.start.clone().move(b.end,r),C=b.end.clone().move(b.start,r),E=w.parallel(-1),S=new lv(E.start,k),M=new lv(E.end,k);if((l.containsPoint(k)||u.containsPoint(k)||l.intersectsWithLine(S)||l.intersectsWithLine(M)||u.intersectsWithLine(S)||u.intersectsWithLine(M))&&(k=(b=w.parallel(i)).getCenter(),x=b.start.clone().move(b.end,r),C=b.end.clone().move(b.start,r)),t.merge){var A=new lv(a,s),_=new lv(k,A.center).setLength(Number.MAX_SAFE_INTEGER),P=l.intersectsWithLine(_),O=u.intersectsWithLine(_),T=P?Array.isArray(P)?P:[P]:[];O&&(Array.isArray(O)?T.push.apply(T,v(O)):T.push(O));var L=A.center.closest(T);L?(n.sourceAnchor=L.clone(),n.targetAnchor=L.clone()):(n.sourceAnchor=A.center.clone(),n.targetAnchor=A.center.clone())}return xm([x.toJSON(),k.toJSON(),C.toJSON()],t.merge)},manhattan:bm,metro:function(e,t,n){return Eh(bm,this,e,Object.assign(Object.assign({},km),t),n)},normal:function(e){return v(e)},oneSide:function(e,t,n){var i,r,o,a=t.side||"bottom",s=Jh(t.padding||40),l=n.sourceBBox,u=n.targetBBox,c=l.getCenter(),h=u.getCenter();switch(a){case"top":o=-1,i="y",r="height";break;case"left":o=-1,i="x",r="width";break;case"right":o=1,i="x",r="width";break;default:o=1,i="y",r="height"}return c[i]+=o*(l[r]/2+s[a]),h[i]+=o*(u[r]/2+s[a]),o*(c[i]-h[i])>0?h[i]=c[i]:c[i]=h[i],[c.toJSON()].concat(v(e),[h.toJSON()])},orth:em},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Em,e.registry=Ov.create({type:"router"}),e.registry.register(e.presets,!0)}(Cm||(Cm={}));var Sm,Mm,Am=1/3,_m=2/3;function Pm(e,t){var n=[e].concat(v(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]),[t]),i=[];return n.forEach((function(e,t){var r=n[t+1];null!=r&&i.push(new lv(e,r))})),i}function Om(e,t){return new lv(e,t).squaredLength()}function Tm(e,t,n,i){var r,o=new Pv;return r=Pv.createSegment("M",e[0].start),o.appendSegment(r),e.forEach((function(a,s){if(Sm.includes(a)){var l,u,c,h;if("arc"===n){l=-90,((u=a.start.diff(a.end)).x<0||0===u.x&&u.y<0)&&(l+=180);var f,d=a.getCenter(),v=new lv(d,a.end).rotate(l,d);c=(f=new lv(a.start,d)).pointAt(2/3).rotate(l,a.start),h=v.pointAt(1/3).rotate(-l,v.end),r=Pv.createSegment("C",c,h,v.end),o.appendSegment(r),f=new lv(d,a.end),c=v.pointAt(1/3).rotate(l,v.end),h=f.pointAt(1/3).rotate(-l,a.end),r=Pv.createSegment("C",c,h,a.end),o.appendSegment(r)}else if("gap"===n)r=Pv.createSegment("M",a.end),o.appendSegment(r);else if("cubic"===n){l=a.start.theta(a.end);var g=.6*t,p=1.35*t;((u=a.start.diff(a.end)).x<0||0===u.x&&u.y<0)&&(p*=-1),c=new av(a.start.x+g,a.start.y+p).rotate(l,a.start),h=new av(a.end.x-g,a.end.y+p).rotate(l,a.end),r=Pv.createSegment("C",c,h,a.end),o.appendSegment(r)}}else{var y=e[s+1];0===i||!y||Sm.includes(y)?(r=Pv.createSegment("L",a.end),o.appendSegment(r)):function(e,t,n,i,r){var o,a=n.distance(i)/2,s=n.distance(r)/2,l=-Math.min(e,a),u=-Math.min(e,s),c=n.clone().move(i,l).round(),h=n.clone().move(r,u).round(),f=new av(Am*c.x+_m*n.x,_m*n.y+Am*c.y),d=new av(Am*h.x+_m*n.x,_m*n.y+Am*h.y);o=Pv.createSegment("L",c),t.appendSegment(o),o=Pv.createSegment("C",f,d,h),t.appendSegment(o)}(i,o,a.end,a.start,y.end)}})),o}var Lm,jm=Object.freeze(Object.defineProperty({__proto__:null,jumpover:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Sm=[],Mm=[],function(e){var t=e.graph._jumpOverUpdateList;if(null==t&&(t=e.graph._jumpOverUpdateList=[],e.graph.on("cell:mouseup",(function(){var t=e.graph._jumpOverUpdateList;setTimeout((function(){for(var e=0;e<t.length;e+=1)t[e].update()}))})),e.graph.on("model:reseted",(function(){t=e.graph._jumpOverUpdateList=[]}))),t.indexOf(e)<0){t.push(e);var n=function(){return t.splice(t.indexOf(e),1)};e.cell.once("change:connector",n),e.cell.once("removed",n)}}(this);var o=r.size||5,a=r.type||"arc",s=r.radius||0,l=r.ignoreConnectors||["smooth"],u=this.graph,c=u.model.getEdges();if(1===c.length)return Tm(Pm(e,t,n),o,a,s);var h=this.cell,f=c.indexOf(h),d=u.options.connecting.connector||{},g=c.filter((function(e,t){var n=e.getConnector()||d;return!l.includes(n.name)&&(!(t>f)||"jumpover"!==n.name)})),p=g.map((function(e){return u.findViewByCell(e)})),y=Pm(e,t,n),m=p.map((function(e){return null==e?[]:e===i?y:Pm(e.sourcePoint,e.targetPoint,e.routePoints)})),w=[];y.forEach((function(e){var t=g.reduce((function(t,n,i){if(n!==h){var r=function(e,t){var n=[];return t.forEach((function(t){var i=e.intersectsWithLine(t);i&&n.push(i)})),n}(e,m[i]);t.push.apply(t,v(r))}return t}),[]).sort((function(t,n){return Om(e.start,t)-Om(e.start,n)}));t.length>0?w.push.apply(w,v(function(e,t,n){return t.reduce((function(i,r,o){if(Mm.includes(r))return i;var a=i.pop()||e,s=av.create(r).move(a.start,-n),l=av.create(r).move(a.start,+n),u=t[o+1];if(null!=u){var c=l.distance(u);c<=n&&(l=u.move(a.start,c),Mm.push(u))}else if(s.distance(a.end)<2*n+1)return i.push(a),i;if(l.distance(a.start)<2*n+1)return i.push(a),i;var h=new lv(s,l);return Sm.push(h),i.push(new lv(a.start,s),h,new lv(l,a.end)),i}),[])}(e,t,o))):w.push(e)}));var b=Tm(w,o,a,s);return Sm=[],Mm=[],r.raw?b:b.serialize()},loop:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=3===n.length?0:1,o=av.create(n[0+r]),a=av.create(n[2+r]),s=av.create(n[1+r]);if(!av.equals(e,t)){var l=new av((e.x+t.x)/2,(e.y+t.y)/2),u=l.angleBetween(av.create(e).rotate(90,l),s);u>1&&(o.rotate(180-u,l),a.rotate(180-u,l),s.rotate(180-u,l))}var c="\n     M ".concat(e.x," ").concat(e.y,"\n     Q ").concat(o.x," ").concat(o.y," ").concat(s.x," ").concat(s.y,"\n     Q ").concat(a.x," ").concat(a.y," ").concat(t.x," ").concat(t.y,"\n  ");return i.raw?Pv.parse(c):c},normal:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=[e].concat(v(n),[t]),o=new pv(r),a=new Pv(o);return i.raw?a:a.serialize()},rounded:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=new Pv;r.appendSegment(Pv.createSegment("M",e));for(var o,a,s=1/3,l=2/3,u=i.radius||10,c=0,h=n.length;c<h;c+=1){var f=av.create(n[c]),d=n[c-1]||e,v=n[c+1]||t;o=a||f.distance(d)/2,a=f.distance(v)/2;var g=-Math.min(u,o),p=-Math.min(u,a),y=f.clone().move(d,g).round(),m=f.clone().move(v,p).round(),w=new av(s*y.x+l*f.x,l*f.y+s*y.y),b=new av(s*m.x+l*f.x,l*f.y+s*m.y);r.appendSegment(Pv.createSegment("L",y)),r.appendSegment(Pv.createSegment("C",w,b,m))}return r.appendSegment(Pv.createSegment("L",t)),i.raw?r:r.serialize()},smooth:function(e,t,n){var i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=r.direction;if(n&&0!==n.length){var a=[e].concat(v(n),[t]),s=yv.throughPoints(a);i=new Pv(s)}else if((i=new Pv).appendSegment(Pv.createSegment("M",e)),o||(o=Math.abs(e.x-t.x)>=Math.abs(e.y-t.y)?"H":"V"),"H"===o){var l=(e.x+t.x)/2;i.appendSegment(Pv.createSegment("C",l,e.y,l,t.y,t.x,t.y))}else{var u=(e.y+t.y)/2;i.appendSegment(Pv.createSegment("C",e.x,u,t.x,u,t.x,t.y))}return r.raw?i:i.serialize()}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=jm,e.registry=Ov.create({type:"connector"}),e.registry.register(e.presets,!0)}(Lm||(Lm={}));var Nm=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Dm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,t),(e=s(this,t)).pending=!1,e.changing=!1,e.data={},e.mutate(Ke(n)),e.changed={},e}return h(t,e),P(t,[{key:"mutate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!0===n.unset,r=!0===n.silent,o=[],a=this.changing;this.changing=!0,a||(this.previous=Ke(this.data),this.changed={});var s=this.data,l=this.previous,u=this.changed;if(Object.keys(e).forEach((function(t){var n=t,r=e[n];it(s[n],r)||o.push(n),it(l[n],r)?delete u[n]:u[n]=r,i?delete s[n]:s[n]=r})),!r&&o.length>0&&(this.pending=!0,this.pendingOptions=n,o.forEach((function(e){t.emit("change:*",{key:e,options:n,store:t,current:s[e],previous:l[e]})}))),a)return this;if(!r)for(;this.pending;)this.pending=!1,this.emit("changed",{current:s,previous:l,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}},{key:"get",value:function(e,t){if(null==e)return this.data;var n=this.data[e];return null==n?t:n}},{key:"getPrevious",value:function(e){if(this.previous){var t=this.previous[e];return null==t?void 0:t}}},{key:"set",value:function(e,t,n){return null!=e&&("object"===d(e)?this.mutate(e,t):this.mutate(O({},e,t),n)),this}},{key:"remove",value:function(e,t){var n,i=void 0,r={};if("string"==typeof e)r[e]=i,n=t;else if(Array.isArray(e))e.forEach((function(e){return r[e]=i})),n=t;else{for(var o in this.data)r[o]=i;n=e}return this.mutate(r,Object.assign(Object.assign({},n),{unset:!0})),this}},{key:"getByPath",value:function(e){return jh(this.data,e,"/")}},{key:"setByPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="/",r=Array.isArray(e)?v(e):e.split(i),o=Array.isArray(e)?e.join(i):e,a=r[0],s=r.length;if(n.propertyPath=o,n.propertyValue=t,n.propertyPathArray=r,1===s)this.set(a,t,n);else{for(var l={},u=l,c=a,h=1;h<s;h+=1){var f=r[h],d=Number.isFinite(Number(f));u=u[c]=d?[]:{},c=f}Nh(l,r,t,i);var g=Ke(this.data);n.rewrite&&Dh(g,e,i);var p=$e(g,l);this.set(a,p[a],n)}return this}},{key:"removeByPath",value:function(e,t){var n=Array.isArray(e)?e:e.split("/"),i=n[0];if(1===n.length)this.remove(i,t);else{var r=n.slice(1),o=Ke(this.get(i));o&&Dh(o,r),this.set(i,o,t)}return this}},{key:"hasChanged",value:function(e){return null==e?Object.keys(this.changed).length>0:e in this.changed}},{key:"getChanges",value:function(e){if(null==e)return this.hasChanged()?Ke(this.changed):null;var t,n=this.changing?this.previous:this.data,i={};for(var r in e){var o=e[r];it(n[r],o)||(i[r]=o,t=!0)}return t?Ke(i):null}},{key:"toJSON",value:function(){return Ke(this.data)}},{key:"clone",value:function(){return new(0,this.constructor)(this.data)}},{key:"dispose",value:function(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}])}(Rh);Nm([Rh.dispose()],Dm.prototype,"dispose",null);var Im=function(){function e(t){A(this,e),this.cell=t,this.ids={},this.cache={}}return P(e,[{key:"get",value:function(){return Object.keys(this.ids)}},{key:"start",value:function(t,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",a=this.cell.getPropByPath(t),s=rt(r,e.defaultOptions),l=this.getTiming(s.timing),u=this.getInterp(s.interp,a,n),c=0,h=Array.isArray(t)?t.join(o):t,f=Array.isArray(t)?t:t.split(o),d=function(){var e=(new Date).getTime();0===c&&(c=e);var t=(e-c)/s.duration;t<1?i.ids[h]=requestAnimationFrame(d):t=1;var n=u(l(t));i.cell.setPropByPath(f,n),r.progress&&r.progress(Object.assign({progress:t,currentValue:n},i.getArgs(h))),1===t&&(i.cell.notify("transition:complete",i.getArgs(h)),r.complete&&r.complete(i.getArgs(h)),i.cell.notify("transition:finish",i.getArgs(h)),r.finish&&r.finish(i.getArgs(h)),i.clean(h))};return setTimeout((function(){i.stop(t,void 0,o),i.cache[h]={startValue:a,targetValue:n,options:s},i.ids[h]=requestAnimationFrame(d),i.cell.notify("transition:start",i.getArgs(h)),r.start&&r.start(i.getArgs(h))}),r.delay),this.stop.bind(this,t,o,r)}},{key:"stop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r=Array.isArray(e)?e:e.split(i);return Object.keys(this.ids).filter((function(e){return it(r,e.split(i).slice(0,r.length))})).forEach((function(e){cancelAnimationFrame(t.ids[e]);var i=t.cache[e],r=t.getArgs(e),o=Object.assign(Object.assign({},i.options),n),a=o.jumpedToEnd;a&&null!=i.targetValue&&(t.cell.setPropByPath(e,i.targetValue),t.cell.notify("transition:end",Object.assign({},r)),t.cell.notify("transition:complete",Object.assign({},r)),o.complete&&o.complete(Object.assign({},r)));var s=Object.assign({jumpedToEnd:a},r);t.cell.notify("transition:stop",Object.assign({},s)),o.stop&&o.stop(Object.assign({},s)),t.cell.notify("transition:finish",Object.assign({},r)),o.finish&&o.finish(Object.assign({},r)),t.clean(e)})),this}},{key:"clean",value:function(e){delete this.ids[e],delete this.cache[e]}},{key:"getTiming",value:function(e){return"string"==typeof e?Qd[e]:e}},{key:"getInterp",value:function(e,t,n){return e?e(t,n):"number"==typeof n?ev.number(t,n):"string"==typeof n?"#"===n[0]?ev.color(t,n):ev.unit(t,n):ev.object(t,n)}},{key:"getArgs",value:function(e){var t=this.cache[e];return{path:e,startValue:t.startValue,targetValue:t.targetValue,cell:this.cell}}}])}();!function(e){e.defaultOptions={delay:10,duration:100,timing:"linear"}}(Im||(Im={}));var Rm,Bm=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},zm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Fm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A(this,t);var i=(e=s(this,t)).constructor.getDefaults(!0),r=$e({},e.preprocess(i),e.preprocess(n));return e.id=r.id||Hh(),e.store=new Dm(r),e.animation=new Im(e),e.setup(),e.init(),e.postprocess(n),e}return h(t,e),P(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"init",value:function(){}},{key:"model",get:function(){return this._model},set:function(e){this._model!==e&&(this._model=e)}},{key:"preprocess",value:function(e,t){var n=e.id,i=this.constructor.applyPropHooks(this,e);return null==n&&!0!==t&&(i.id=Hh()),i}},{key:"postprocess",value:function(e){}},{key:"setup",value:function(){var e=this;this.store.on("change:*",(function(t){var n=t.key,i=t.current,r=t.previous,o=t.options;e.notify("change:*",{key:n,options:o,current:i,previous:r,cell:e}),e.notify("change:".concat(n),{options:o,current:i,previous:r,cell:e});var a=n;"source"!==a&&"target"!==a||e.notify("change:terminal",{type:a,current:i,previous:r,options:o,cell:e})})),this.store.on("changed",(function(t){var n=t.options;return e.notify("changed",{options:n,cell:e})}))}},{key:"notify",value:function(e,t){this.trigger(e,t);var n=this.model;return n&&(n.notify("cell:".concat(e),t),this.isNode()?n.notify("node:".concat(e),Object.assign(Object.assign({},t),{node:this})):this.isEdge()&&n.notify("edge:".concat(e),Object.assign(Object.assign({},t),{edge:this}))),this}},{key:"isNode",value:function(){return!1}},{key:"isEdge",value:function(){return!1}},{key:"isSameStore",value:function(e){return this.store===e.store}},{key:"view",get:function(){return this.store.get("view")}},{key:"shape",get:function(){return this.store.get("shape","")}},{key:"getProp",value:function(e,t){return null==e?this.store.get():this.store.get(e,t)}},{key:"setProp",value:function(e,t,n){if("string"==typeof e)this.store.set(e,t,n);else{var i=this.preprocess(e,!0);this.store.set($e({},this.getProp(),i),t),this.postprocess(e)}return this}},{key:"removeProp",value:function(e,t){return"string"==typeof e||Array.isArray(e)?this.store.removeByPath(e,t):this.store.remove(t),this}},{key:"hasChanged",value:function(e){return null==e?this.store.hasChanged():this.store.hasChanged(e)}},{key:"getPropByPath",value:function(e){return this.store.getByPath(e)}},{key:"setPropByPath",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model&&("children"===e?this._children=t?t.map((function(e){return n.model.getCell(e)})).filter((function(e){return null!=e})):null:"parent"===e&&(this._parent=t?this.model.getCell(t):null)),this.store.setByPath(e,t,i),this}},{key:"removePropByPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:e.split("/");return"attrs"===n[0]&&(t.dirty=!0),this.store.removeByPath(n,t),this}},{key:"prop",value:function(e,t,n){return null==e?this.getProp():"string"==typeof e||Array.isArray(e)?1===arguments.length?this.getPropByPath(e):null==t?this.removePropByPath(e,n||{}):this.setPropByPath(e,t,n||{}):this.setProp(e,t||{})}},{key:"previous",value:function(e){return this.store.getPrevious(e)}},{key:"zIndex",get:function(){return this.getZIndex()},set:function(e){null==e?this.removeZIndex():this.setZIndex(e)}},{key:"getZIndex",value:function(){return this.store.get("zIndex")}},{key:"setZIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("zIndex",e,t),this}},{key:"removeZIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("zIndex",e),this}},{key:"toFront",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.model;if(t){var n,i=t.getMaxZIndex();e.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):n=[this],i=i-n.length+1;var r=t.total(),o=t.indexOf(this)!==r-n.length;o||(o=n.some((function(e,t){return e.getZIndex()!==i+t}))),o&&this.batchUpdate("to-front",(function(){i+=n.length,n.forEach((function(t,n){t.setZIndex(i+n,e)}))}))}return this}},{key:"toBack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.model;if(t){var n,i=t.getMinZIndex();e.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):n=[this];var r=0!==t.indexOf(this);r||(r=n.some((function(e,t){return e.getZIndex()!==i+t}))),r&&this.batchUpdate("to-back",(function(){i-=n.length,n.forEach((function(t,n){t.setZIndex(i+n,e)}))}))}return this}},{key:"markup",get:function(){return this.getMarkup()},set:function(e){null==e?this.removeMarkup():this.setMarkup(e)}},{key:"getMarkup",value:function(){var e=this.store.get("markup");null==e&&(e=this.constructor.getMarkup());return e}},{key:"setMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("markup",e,t),this}},{key:"removeMarkup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("markup",e),this}},{key:"attrs",get:function(){return this.getAttrs()},set:function(e){null==e?this.removeAttrs():this.setAttrs(e)}},{key:"getAttrs",value:function(){var e=this.store.get("attrs");return e?Object.assign({},e):{}}},{key:"setAttrs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)this.removeAttrs(n);else{var i=function(e){return t.store.set("attrs",e,n)};if(!0===n.overwrite)i(e);else{var r=this.getAttrs();!1===n.deep?i(Object.assign(Object.assign({},r),e)):i($e({},r,e))}}return this}},{key:"replaceAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setAttrs(e,Object.assign(Object.assign({},t),{overwrite:!0}))}},{key:"updateAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setAttrs(e,Object.assign(Object.assign({},t),{deep:!1}))}},{key:"removeAttrs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("attrs",e),this}},{key:"getAttrDefinition",value:function(e){if(!e)return null;var t=this.constructor.getAttrHooks()||{},n=t[e]||vp.registry.get(e);if(!n){var i=Ue(e);n=t[i]||vp.registry.get(i)}return n||null}},{key:"getAttrByPath",value:function(e){return null==e||""===e?this.getAttrs():this.getPropByPath(this.prefixAttrPath(e))}},{key:"setAttrByPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setPropByPath(this.prefixAttrPath(e),t,n),this}},{key:"removeAttrByPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removePropByPath(this.prefixAttrPath(e),t),this}},{key:"prefixAttrPath",value:function(e){return Array.isArray(e)?["attrs"].concat(e):"attrs/".concat(e)}},{key:"attr",value:function(e,t,n){return null==e?this.getAttrByPath():"string"==typeof e||Array.isArray(e)?1===arguments.length?this.getAttrByPath(e):null==t?this.removeAttrByPath(e,n||{}):this.setAttrByPath(e,t,n||{}):this.setAttrs(e,t||{})}},{key:"visible",get:function(){return this.isVisible()},set:function(e){this.setVisible(e)}},{key:"setVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("visible",e,t),this}},{key:"isVisible",value:function(){return!1!==this.store.get("visible")}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.isVisible()||this.setVisible(!0,e),this}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.isVisible()&&this.setVisible(!1,e),this}},{key:"toggleVisible",value:function(e){var t="boolean"==typeof e?arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}:e;return("boolean"==typeof e?e:!this.isVisible())?this.show(t):this.hide(t),this}},{key:"data",get:function(){return this.getData()},set:function(e){this.setData(e)}},{key:"getData",value:function(){return this.store.get("data")}},{key:"setData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)this.removeData(n);else{var i=function(e){return t.store.set("data",e,n)};if(!0===n.overwrite)i(e);else{var r=this.getData();!1===n.deep?i("object"===d(e)?Object.assign(Object.assign({},r),e):e):i($e({},r,e))}}return this}},{key:"replaceData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setData(e,Object.assign(Object.assign({},t),{overwrite:!0}))}},{key:"updateData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setData(e,Object.assign(Object.assign({},t),{deep:!1}))}},{key:"removeData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("data",e),this}},{key:"parent",get:function(){return this.getParent()}},{key:"children",get:function(){return this.getChildren()}},{key:"getParentId",value:function(){return this.store.get("parent")}},{key:"getParent",value:function(){var e=this.getParentId();if(e&&this.model){var t=this.model.getCell(e);return this._parent=t,t}return null}},{key:"getChildren",value:function(){var e=this,t=this.store.get("children");if(t&&t.length&&this.model){var n=t.map((function(t){var n;return null===(n=e.model)||void 0===n?void 0:n.getCell(t)})).filter((function(e){return null!=e}));return this._children=n,v(n)}return null}},{key:"hasParent",value:function(){return null!=this.parent}},{key:"isParentOf",value:function(e){return null!=e&&e.getParent()===this}},{key:"isChildOf",value:function(e){return null!=e&&this.getParent()===e}},{key:"eachChild",value:function(e,t){return this.children&&this.children.forEach(e,t),this}},{key:"filterChild",value:function(e,t){return this.children?this.children.filter(e,t):[]}},{key:"getChildCount",value:function(){return null==this.children?0:this.children.length}},{key:"getChildIndex",value:function(e){return null==this.children?-1:this.children.indexOf(e)}},{key:"getChildAt",value:function(e){return null!=this.children&&e>=0?this.children[e]:null}},{key:"getAncestors",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],n=this.getParent();n;)t.push(n),n=!1!==e.deep?n.getParent():null;return t}},{key:"getDescendants",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1!==e.deep){if(e.breadthFirst){for(var t=[],n=this.getChildren()||[];n.length>0;){var i=n.shift(),r=i.getChildren();t.push(i),r&&n.push.apply(n,v(r))}return t}var o=this.getChildren()||[];return o.forEach((function(t){o.push.apply(o,v(t.getDescendants(e)))})),o}return this.getChildren()||[]}},{key:"isDescendantOf",value:function(e){if(null==e)return!1;if(!1!==(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).deep){for(var t=this.getParent();t;){if(t===e)return!0;t=t.getParent()}return!1}return this.isChildOf(e)}},{key:"isAncestorOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=e&&e.isDescendantOf(this,t)}},{key:"contains",value:function(e){return this.isAncestorOf(e)}},{key:"getCommonAncestor",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.getCommonAncestor.apply(t,[this].concat(n))}},{key:"setParent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._parent=e,e?this.store.set("parent",e.id,t):this.store.remove("parent",t),this}},{key:"setChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._children=e,null!=e?this.store.set("children",e.map((function(e){return e.id})),t):this.store.remove("children",t),this}},{key:"unembed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.children;if(null!=n&&null!=e){var i=this.getChildIndex(e);-1!==i&&(n.splice(i,1),e.setParent(null,t),this.setChildren(n,t))}return this}},{key:"embed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.addTo(this,t),this}},{key:"addTo",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.isCell(e)?e.addChild(this,n):e.addCell(this,n),this}},{key:"insertTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.insertChild(this,t,n),this}},{key:"addChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertChild(e,void 0,t)}},{key:"insertChild",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&e!==this){var i=e.getParent(),r=this!==i,o=t;if(null==o&&(o=this.getChildCount(),r||(o-=1)),i){var a=i.getChildren();if(a){var s=a.indexOf(e);s>=0&&(e.setParent(null,n),a.splice(s,1),i.setChildren(a,n))}}var l=this.children;if(null==l?(l=[]).push(e):l.splice(o,0,e),e.setParent(this,n),this.setChildren(l,n),r&&this.model){var u=this.model.getIncomingEdges(this),c=this.model.getOutgoingEdges(this);u&&u.forEach((function(e){return e.updateParent(n)})),c&&c.forEach((function(e){return e.updateParent(n)}))}this.model&&this.model.addCell(e,n)}return this}},{key:"removeFromParent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getParent();if(null!=t){var n=t.getChildIndex(this);t.removeChildAt(n,e)}return this}},{key:"removeChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getChildIndex(e);return this.removeChildAt(n,t)}},{key:"removeChildAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getChildAt(e);return null!=this.children&&null!=n&&(this.unembed(n,t),n.remove(t)),n}},{key:"remove",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.batchUpdate("remove",(function(){var n=e.getParent();n&&n.removeChild(e,t),!1!==t.deep&&e.eachChild((function(e){return e.remove(t)})),e.model&&e.model.removeCell(e,t)})),this}},{key:"transition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/";return this.animation.start(e,t,n,i)}},{key:"stopTransition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";return this.animation.stop(e,t,n),this}},{key:"getTransitions",value:function(){return this.animation.get()}},{key:"translate",value:function(e,t,n){return this}},{key:"scale",value:function(e,t,n,i){return this}},{key:"addTools",value:function(e,t,n){var i=Array.isArray(e)?e:[e],r="string"==typeof t?t:null,o="object"===d(t)?t:"object"===d(n)?n:{};if(o.reset)return this.setTools({name:r,items:i,local:o.local},o);var a=Ke(this.getTools());return null==a||null==r||a.name===r?(null==a&&(a={}),a.items||(a.items=[]),a.name=r,a.items=[].concat(v(a.items),v(i)),this.setTools(Object.assign({},a),o)):void 0}},{key:"setTools",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==e?this.removeTools():this.store.set("tools",t.normalizeTools(e),n),this}},{key:"getTools",value:function(){return this.store.get("tools")}},{key:"removeTools",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("tools",e),this}},{key:"hasTools",value:function(e){var t=this.getTools();return null!=t&&(null==e||t.name===e)}},{key:"hasTool",value:function(e){var t=this.getTools();return null!=t&&t.items.some((function(t){return"string"==typeof t?t===e:t.name===e}))}},{key:"removeTool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ke(this.getTools());if(n){var i=!1,r=n.items.slice(),o=function(e){r.splice(e,1),i=!0};if("number"==typeof e)o(e);else for(var a=r.length-1;a>=0;a-=1){var s=r[a];("string"==typeof s?s===e:s.name===e)&&o(a)}i&&(n.items=r,this.setTools(n,t))}return this}},{key:"getBBox",value:function(e){return new sv}},{key:"getConnectionPoint",value:function(e,t){return new av}},{key:"toJSON",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},this.store.get()),i=Object.prototype.toString,r=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!n.shape){var o=this.constructor;throw new Error("Unable to serialize ".concat(r,' missing "shape" prop, check the ').concat(r,' "').concat(o.name||i.call(o),'"'))}var a=this.constructor,s=!0===t.diff,l=n.attrs||{},u=a.getDefaults(!0),c=s?this.preprocess(u,!0):u,h=c.attrs||{},f={};Object.entries(n).forEach((function(t){var o=p(t,2),a=o[0],l=o[1];if(null!=l&&!Array.isArray(l)&&"object"===d(l)&&!Ye(l))throw new Error("Can only serialize ".concat(r,' with plain-object props, but got a "').concat(i.call(l),'" type of key "').concat(a,'" on ').concat(r,' "').concat(e.id,'"'));if("attrs"!==a&&"shape"!==a&&s){var u=c[a];it(l,u)&&delete n[a]}})),Object.keys(l).forEach((function(e){var t=l[e],n=h[e];Object.keys(t).forEach((function(i){var r=t[i],o=n?n[i]:null;null==r||"object"!==d(r)||Array.isArray(r)?null!=n&&it(o,r)||(null==f[e]&&(f[e]={}),f[e][i]=r):Object.keys(r).forEach((function(t){var a=r[t];null!=n&&null!=o&&qe(o)&&it(o[t],a)||(null==f[e]&&(f[e]={}),null==f[e][i]&&(f[e][i]={}),f[e][i][t]=a)}))}))}));var v=Object.assign(Object.assign({},n),{attrs:ot(f)?void 0:f});null==v.attrs&&delete v.attrs;var g=v;return 0===g.angle&&delete g.angle,Ke(g)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.deep){var n=Object.assign({},this.store.get());return e.keepId||delete n.id,delete n.parent,delete n.children,new(0,this.constructor)(n)}return t.deepClone(this)[this.id]}},{key:"findView",value:function(e){return e.findViewByCell(this)}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model;return this.notify("batch:start",{name:e,data:t,cell:this}),n&&n.startBatch(e,Object.assign(Object.assign({},t),{cell:this})),this}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model;return n&&n.stopBatch(e,Object.assign(Object.assign({},t),{cell:this})),this.notify("batch:stop",{name:e,data:t,cell:this}),this}},{key:"batchUpdate",value:function(e,t,n){var i=this.model;this.startBatch(e,n,i);var r=t();return this.stopBatch(e,n,i),r}},{key:"dispose",value:function(){this.removeFromParent(),this.store.dispose()}}],[{key:"config",value:function(e){var t,n=this,i=e.markup,r=e.propHooks,o=e.attrHooks,a=zm(e,["markup","propHooks","attrHooks"]);(null!=i&&(this.markup=i),r)&&(this.propHooks=this.propHooks.slice(),Array.isArray(r)?(t=this.propHooks).push.apply(t,v(r)):"function"==typeof r?this.propHooks.push(r):Object.values(r).forEach((function(e){"function"==typeof e&&n.propHooks.push(e)})));o&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),o)),this.defaults=$e({},this.defaults,a)}},{key:"getMarkup",value:function(){return this.markup}},{key:"getDefaults",value:function(e){return e?this.defaults:Ke(this.defaults)}},{key:"getAttrHooks",value:function(){return this.attrHooks}},{key:"applyPropHooks",value:function(e,t){return this.propHooks.reduce((function(t,n){return n?Eh(n,e,t):t}),t)}}])}(Rh);Fm.defaults={},Fm.attrHooks={},Fm.propHooks=[],Bm([Rh.dispose()],Fm.prototype,"dispose",null),function(e){e.normalizeTools=function(e){return"string"==typeof e?{items:[e]}:Array.isArray(e)?{items:e}:e.items?e:{items:[e]}}}(Fm||(Fm={})),function(e){e.toStringTag="X6.".concat(e.name),e.isCell=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNode&&"function"==typeof i.isEdge&&"function"==typeof i.prop&&"function"==typeof i.attr}}(Fm||(Fm={})),function(e){e.getCommonAncestor=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.filter((function(e){return null!=e})).map((function(e){return e.getAncestors()})).sort((function(e,t){return e.length-t.length}));return i.shift().find((function(e){return i.every((function(t){return t.includes(e)}))}))||null},e.getCellsBBox=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=0,r=e.length;i<r;i+=1){var o=e[i],a=o.getBBox(t);if(a){if(o.isNode()){var s=o.getAngle();null!=s&&0!==s&&(a=a.bbox(s))}n=null==n?a:n.union(a)}}return n},e.deepClone=function(t){var n=[t].concat(v(t.getDescendants({deep:!0})));return e.cloneCells(n)},e.cloneCells=function(e){var t=Qe(e),n=t.reduce((function(e,t){return e[t.id]=t.clone(),e}),{});return t.forEach((function(e){var t=n[e.id];if(t.isEdge()){var i=t.getSourceCellId(),r=t.getTargetCellId();i&&n[i]&&t.setSource(Object.assign(Object.assign({},t.getSource()),{cell:n[i].id})),r&&n[r]&&t.setTarget(Object.assign(Object.assign({},t.getTarget()),{cell:n[r].id}))}var o=e.getParent();o&&n[o.id]&&t.setParent(n[o.id]);var a=e.getChildren();if(a&&a.length){var s=a.reduce((function(e,t){return n[t.id]&&e.push(n[t.id]),e}),[]);s.length>0&&t.setChildren(s)}})),n}}(Fm||(Fm={})),function(e){e.config({propHooks:function(t){var n=t.tools,i=zm(t,["tools"]);return n&&(i.tools=e.normalizeTools(n)),i}})}(Fm||(Fm={})),function(e){var t,n;e.exist=function(e,i){return i?null!=t&&t.exist(e):null!=n&&n.exist(e)},e.setEdgeRegistry=function(e){t=e},e.setNodeRegistry=function(e){n=e}}(Rm||(Rm={}));var Vm=function(){return P((function e(t){A(this,e),this.ports=[],this.groups={},this.init(Ke(t))}),[{key:"getPorts",value:function(){return this.ports}},{key:"getGroup",value:function(e){return null!=e?this.groups[e]:null}},{key:"getPortsByGroup",value:function(e){return this.ports.filter((function(t){return t.group===e||null==t.group&&null==e}))}},{key:"getPortsLayoutByGroup",value:function(e,t){var n,i=this,r=this.getPortsByGroup(e),o=e?this.getGroup(e):null,a=o?o.position:null,s=a?a.name:null;if(null!=s){var l=Lp.registry.get(s);if(null==l)return Lp.registry.onNotFound(s);n=l}else n=Lp.presets.left;var u=r.map((function(e){return e&&e.position&&e.position.args||{}})),c=a&&a.args||{};return n(u,t,c).map((function(e,n){var o=r[n];return{portLayout:e,portId:o.id,portSize:o.size,portAttrs:o.attrs,labelSize:o.label.size,labelLayout:i.getPortLabelLayout(o,av.create(e.position),t)}}))}},{key:"init",value:function(e){var t=this,n=e.groups,i=e.items;null!=n&&Object.keys(n).forEach((function(e){t.groups[e]=t.parseGroup(n[e])})),Array.isArray(i)&&i.forEach((function(e){t.ports.push(t.parsePort(e))}))}},{key:"parseGroup",value:function(e){return Object.assign(Object.assign({},e),{label:this.getLabel(e,!0),position:this.getPortPosition(e.position,!0)})}},{key:"parsePort",value:function(e){var t=Object.assign({},e),n=this.getGroup(e.group)||{};return t.markup=t.markup||n.markup,t.attrs=$e({},n.attrs,t.attrs),t.position=this.createPosition(n,t),t.label=$e({},n.label,this.getLabel(t)),t.zIndex=this.getZIndex(n,t),t.size=Object.assign(Object.assign({},n.size),t.size),t}},{key:"getZIndex",value:function(e,t){return"number"==typeof t.zIndex?t.zIndex:"number"==typeof e.zIndex||"auto"===e.zIndex?e.zIndex:"auto"}},{key:"createPosition",value:function(e,t){return $e({name:"left",args:{}},e.position,{args:t.args})}},{key:"getPortPosition",value:function(e){if(null==e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return{name:"left",args:{}}}else{if("string"==typeof e)return{name:e,args:{}};if(Array.isArray(e))return{name:"absolute",args:{x:e[0],y:e[1]}};if("object"===d(e))return e}return{args:{}}}},{key:"getPortLabelPosition",value:function(e){if(null==e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return{name:"left",args:{}}}else{if("string"==typeof e)return{name:e,args:{}};if("object"===d(e))return e}return{args:{}}}},{key:"getLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.label||{};return n.position=this.getPortLabelPosition(n.position,t),n}},{key:"getPortLabelLayout",value:function(e,t,n){var i=e.label.position.name||"left",r=e.label.position.args||{},o=Fp.registry.get(i)||Fp.presets.left;return o?o(t,n,r):null}}])}(),Hm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Um=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,t),(e=s(this,t,[n])).initPorts(),e}return h(t,e),P(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"preprocess",value:function(e,n){var i=e.x,r=e.y,a=e.width,s=e.height,l=Hm(e,["x","y","width","height"]);if(null!=i||null!=r){var u=l.position;l.position=Object.assign(Object.assign({},u),{x:null!=i?i:u?u.x:0,y:null!=r?r:u?u.y:0})}if(null!=a||null!=s){var c=l.size;l.size=Object.assign(Object.assign({},c),{width:null!=a?a:c?c.width:0,height:null!=s?s:c?c.height:0})}return o(t,"preprocess",this,3)([l,n])}},{key:"isNode",value:function(){return!0}},{key:"size",value:function(e,t,n){return void 0===e?this.getSize():"number"==typeof e?this.setSize(e,t,n):this.setSize(e,t)}},{key:"getSize",value:function(){var e=this.store.get("size");return e?Object.assign({},e):{width:1,height:1}}},{key:"setSize",value:function(e,t,n){return"object"===d(e)?this.resize(e.width,e.height,t):this.resize(e,t,n),this}},{key:"resize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.startBatch("resize",n);var i=n.direction;if(i){var r=this.getSize();switch(i){case"left":case"right":t=r.height;break;case"top":case"bottom":e=r.width}var o={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[i],a=nv.normalize(this.getAngle()||0);n.absolute&&(o+=Math.floor((a+45)/90),o%=4);var s=this.getBBox(),l=(0===o?s.getBottomLeft():1===o?s.getCorner():2===o?s.getTopRight():s.getOrigin()).clone().rotate(-a,s.getCenter()),u=Math.sqrt(e*e+t*t)/2,c=o*Math.PI/2;c+=Math.atan(o%2==0?t/e:e/t),c-=nv.toRad(a);var h=av.fromPolar(u,c,l).clone().translate(e/-2,t/-2);this.store.set("size",{width:e,height:t},n),this.setPosition(h.x,h.y,n)}else this.store.set("size",{width:e,height:t},n);return this.stopBatch("resize",n),this}},{key:"scale",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getBBox().scale(e,t,null==n?void 0:n);return this.startBatch("scale",i),this.setPosition(r.x,r.y,i),this.resize(r.width,r.height,i),this.stopBatch("scale"),this}},{key:"position",value:function(e,t,n){return"number"==typeof e?this.setPosition(e,t,n):this.getPosition(e)}},{key:"getPosition",value:function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).relative){var e=this.getParent();if(null!=e&&e.isNode()){var t=this.getPosition(),n=e.getPosition();return{x:t.x-n.x,y:t.y-n.y}}}var i=this.store.get("position");return i?Object.assign({},i):{x:0,y:0}}},{key:"setPosition",value:function(e,t){var n,i,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"===d(e)?(n=e.x,i=e.y,r=t||{}):(n=e,i=t,r=o||{}),r.relative){var a=this.getParent();if(null!=a&&a.isNode()){var s=a.getPosition();n+=s.x,i+=s.y}}if(r.deep){var l=this.getPosition();this.translate(n-l.x,i-l.y,r)}else this.store.set("position",{x:n,y:i},r);return this}},{key:"translate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0===e&&0===t)return this;n.translateBy=n.translateBy||this.id;var i=this.getPosition();if(null!=n.restrict&&n.translateBy===this.id){var r=this.getBBox({deep:!0}),o=n.restrict,a=i.x-r.x,s=i.y-r.y,l=Math.max(o.x+a,Math.min(o.x+o.width+a-r.width,i.x+e)),u=Math.max(o.y+s,Math.min(o.y+o.height+s-r.height,i.y+t));e=l-i.x,t=u-i.y}var c={x:i.x+e,y:i.y+t};return n.tx=e,n.ty=t,n.transition?("object"!==d(n.transition)&&(n.transition={}),this.transition("position",c,Object.assign(Object.assign({},n.transition),{interp:ev.object})),this.eachChild((function(i){var r;(null===(r=n.exclude)||void 0===r?void 0:r.includes(i))||i.translate(e,t,n)}))):(this.startBatch("translate",n),this.store.set("position",c,n),this.eachChild((function(i){var r;(null===(r=n.exclude)||void 0===r?void 0:r.includes(i))||i.translate(e,t,n)})),this.stopBatch("translate",n)),this}},{key:"angle",value:function(e,t){return null==e?this.getAngle():this.rotate(e,t)}},{key:"getAngle",value:function(){return this.store.get("angle",0)}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getAngle();if(t.center){var i=this.getSize(),r=this.getPosition(),o=this.getBBox().getCenter();o.rotate(n-e,t.center);var a=o.x-i.width/2-r.x,s=o.y-i.height/2-r.y;this.startBatch("rotate",{angle:e,options:t}),this.setPosition(r.x+a,r.y+s,t),this.rotate(e,Object.assign(Object.assign({},t),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",t.absolute?e:(n+e)%360,t);return this}},{key:"getBBox",value:function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).deep){var e=this.getDescendants({deep:!0,breadthFirst:!0});return e.push(this),Fm.getCellsBBox(e)}return sv.fromPositionAndSize(this.getPosition(),this.getSize())}},{key:"getConnectionPoint",value:function(e,t){var n=this.getBBox(),i=n.getCenter(),r=e.getTerminal(t);if(null==r)return i;var o=r.port;if(!o||!this.hasPort(o))return i;var a=this.getPort(o);if(!a||!a.group)return i;var s=this.getPortsPosition(a.group)[o].position,l=av.create(s).translate(n.getOrigin()),u=this.getAngle();return u&&l.rotate(-u,i),l}},{key:"fit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(this.getChildren()||[]).filter((function(e){return e.isNode()}));if(0===t.length)return this;this.startBatch("fit-embeds",e),e.deep&&t.forEach((function(t){return t.fit(e)}));var n=Fm.getCellsBBox(t),i=n.x,r=n.y,o=n.width,a=n.height,s=Jh(e.padding);return i-=s.left,r-=s.top,o+=s.left+s.right,a+=s.bottom+s.top,this.store.set({position:{x:i,y:r},size:{width:o,height:a}},e),this.stopBatch("fit-embeds"),this}},{key:"portContainerMarkup",get:function(){return this.getPortContainerMarkup()},set:function(e){this.setPortContainerMarkup(e)}},{key:"getDefaultPortContainerMarkup",value:function(){return this.store.get("defaultPortContainerMarkup")||Gp.getPortContainerMarkup()}},{key:"getPortContainerMarkup",value:function(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}},{key:"setPortContainerMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portContainerMarkup",Gp.clone(e),t),this}},{key:"portMarkup",get:function(){return this.getPortMarkup()},set:function(e){this.setPortMarkup(e)}},{key:"getDefaultPortMarkup",value:function(){return this.store.get("defaultPortMarkup")||Gp.getPortMarkup()}},{key:"getPortMarkup",value:function(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}},{key:"setPortMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portMarkup",Gp.clone(e),t),this}},{key:"portLabelMarkup",get:function(){return this.getPortLabelMarkup()},set:function(e){this.setPortLabelMarkup(e)}},{key:"getDefaultPortLabelMarkup",value:function(){return this.store.get("defaultPortLabelMarkup")||Gp.getPortLabelMarkup()}},{key:"getPortLabelMarkup",value:function(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}},{key:"setPortLabelMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portLabelMarkup",Gp.clone(e),t),this}},{key:"ports",get:function(){var e=this.store.get("ports",{items:[]});return null==e.items&&(e.items=[]),e}},{key:"getPorts",value:function(){return Ke(this.ports.items)}},{key:"getPortsByGroup",value:function(e){return this.getPorts().filter((function(t){return t.group===e}))}},{key:"getPort",value:function(e){return Ke(this.ports.items.find((function(t){return t.id&&t.id===e})))}},{key:"getPortAt",value:function(e){return this.ports.items[e]||null}},{key:"hasPorts",value:function(){return this.ports.items.length>0}},{key:"hasPort",value:function(e){return-1!==this.getPortIndex(e)}},{key:"getPortIndex",value:function(e){var t="string"==typeof e?e:e.id;return null!=t?this.ports.items.findIndex((function(e){return e.id===t})):-1}},{key:"getPortsPosition",value:function(e){var t=this.getSize();return this.port.getPortsLayoutByGroup(e,new sv(0,0,t.width,t.height)).reduce((function(e,t){var n=t.portLayout;return e[t.portId]={position:Object.assign({},n.position),angle:n.angle||0},e}),{})}},{key:"getPortProp",value:function(e,t){return this.getPropByPath(this.prefixPortPath(e,t))}},{key:"setPortProp",value:function(e,t,n,i){if("string"==typeof t||Array.isArray(t)){var r=this.prefixPortPath(e,t),o=n;return this.setPropByPath(r,o,i)}var a=this.prefixPortPath(e),s=t;return this.setPropByPath(a,s,n)}},{key:"removePortProp",value:function(e,t,n){return"string"==typeof t||Array.isArray(t)?this.removePropByPath(this.prefixPortPath(e,t),n):this.removePropByPath(this.prefixPortPath(e),t)}},{key:"portProp",value:function(e,t,n,i){return null==t?this.getPortProp(e):"string"==typeof t||Array.isArray(t)?2===arguments.length?this.getPortProp(e,t):null==n?this.removePortProp(e,t,i):this.setPortProp(e,t,n,i):this.setPortProp(e,t,n)}},{key:"prefixPortPath",value:function(e,t){var n=this.getPortIndex(e);if(-1===n)throw new Error('Unable to find port with id: "'.concat(e,'"'));return null==t||""===t?["ports","items","".concat(n)]:Array.isArray(t)?["ports","items","".concat(n)].concat(v(t)):"ports/items/".concat(n,"/").concat(t)}},{key:"addPort",value:function(e,t){var n=v(this.ports.items);return n.push(e),this.setPropByPath("ports/items",n,t),this}},{key:"addPorts",value:function(e,t){return this.setPropByPath("ports/items",[].concat(v(this.ports.items),v(e)),t),this}},{key:"insertPort",value:function(e,t,n){var i=v(this.ports.items);return i.splice(e,0,t),this.setPropByPath("ports/items",i,n),this}},{key:"removePort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removePortAt(this.getPortIndex(e),t)}},{key:"removePortAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e>=0){var n=v(this.ports.items);n.splice(e,1),t.rewrite=!0,this.setPropByPath("ports/items",n,t)}return this}},{key:"removePorts",value:function(e,t){var n;if(Array.isArray(e)){if(n=t||{},e.length){n.rewrite=!0;var i=v(this.ports.items).filter((function(t){return!e.some((function(e){var n="string"==typeof e?e:e.id;return t.id===n}))}));this.setPropByPath("ports/items",i,n)}}else(n=e||{}).rewrite=!0,this.setPropByPath("ports/items",[],n);return this}},{key:"getParsedPorts",value:function(){return this.port.getPorts()}},{key:"getParsedGroups",value:function(){return this.port.groups}},{key:"getPortsLayoutByGroup",value:function(e,t){return this.port.getPortsLayoutByGroup(e,t)}},{key:"initPorts",value:function(){var e=this;this.updatePortData(),this.on("change:ports",(function(){e.processRemovedPort(),e.updatePortData()}))}},{key:"processRemovedPort",value:function(){var e=this.ports,t={};e.items.forEach((function(e){e.id&&(t[e.id]=!0)}));var n={};(this.store.getPrevious("ports")||{items:[]}).items.forEach((function(e){e.id&&!t[e.id]&&(n[e.id]=!0)}));var i=this.model;i&&!ot(n)&&(i.getConnectedEdges(this,{incoming:!0}).forEach((function(e){var t=e.getTargetPortId();t&&n[t]&&e.remove()})),i.getConnectedEdges(this,{outgoing:!0}).forEach((function(e){var t=e.getSourcePortId();t&&n[t]&&e.remove()})))}},{key:"validatePorts",value:function(){var e=this,t={},n=[];return this.ports.items.forEach((function(i){"object"!==d(i)&&n.push("Invalid port ".concat(i,".")),null==i.id&&(i.id=e.generatePortId()),t[i.id]&&n.push("Duplicitied port id."),t[i.id]=!0})),n}},{key:"generatePortId",value:function(){return Hh()}},{key:"updatePortData",value:function(){var e=this.validatePorts();if(e.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(e.join(" "));var t=this.port?this.port.getPorts():null;this.port=new Vm(this.ports);var n=this.port.getPorts(),i=t?n.filter((function(e){return t.find((function(t){return t.id===e.id}))?null:e})):v(n),r=t?t.filter((function(e){return n.find((function(t){return t.id===e.id}))?null:e})):[];i.length>0&&this.notify("ports:added",{added:i,cell:this,node:this}),r.length>0&&this.notify("ports:removed",{removed:r,cell:this,node:this})}}])}(Fm);Um.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(e){e.toStringTag="X6.".concat(e.name),e.isNode=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNode&&"function"==typeof i.isEdge&&"function"==typeof i.prop&&"function"==typeof i.attr&&"function"==typeof i.size&&"function"==typeof i.position}}(Um||(Um={})),function(e){e.config({propHooks:function(e){var t=e.ports,n=Hm(e,["ports"]);return t&&(n.ports=Array.isArray(t)?{items:t}:t),n}})}(Um||(Um={})),function(e){e.registry=Ov.create({type:"node",process:function(t,n){if(Rm.exist(t,!0))throw new Error("Node with name '".concat(t,"' was registered by anthor Edge"));if("function"==typeof n)return n.config({shape:t}),n;var i=e,r=n.inherit,o=Hm(n,["inherit"]);if(r)if("string"==typeof r){var a=this.get(r);null==a?this.onNotFound(r,"inherited"):i=a}else i=r;null==o.constructorName&&(o.constructorName=t);var s=i.define.call(i,o);return s.config({shape:t}),s}}),Rm.setNodeRegistry(e.registry)}(Um||(Um={})),function(e){var t=0;e.define=function(n){var i=n.constructorName,r=n.overwrite,o=Hm(n,["constructorName","overwrite"]),a=Th(function(e){return e?Fh(e):"CustomNode".concat(t+=1)}(i||o.shape),this);return a.config(o),o.shape&&e.registry.register(o.shape,a,r),a},e.create=function(t){var n=t.shape||"rect",i=e.registry.get(n);return i?new i(t):e.registry.onNotFound(n)}}(Um||(Um={}));var qm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Gm=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,t),s(this,t,[e])}return h(t,e),P(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"preprocess",value:function(e,n){var i=e.source,r=e.sourceCell,a=e.sourcePort,s=e.sourcePoint,l=e.target,u=e.targetCell,c=e.targetPort,h=e.targetPoint,f=qm(e,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),d=function(e){return"string"==typeof e||"number"==typeof e};if(null!=i)if(Fm.isCell(i))f.source={cell:i.id};else if(d(i))f.source={cell:i};else if(av.isPoint(i))f.source=i.toJSON();else if(Array.isArray(i))f.source={x:i[0],y:i[1]};else{var v=i.cell;Fm.isCell(v)?f.source=Object.assign(Object.assign({},i),{cell:v.id}):f.source=i}if(null!=r||null!=a){var g=f.source;if(null!=r){var p=d(r)?r:r.id;g?g.cell=p:g=f.source={cell:p}}null!=a&&g&&(g.port=a)}else null!=s&&(f.source=av.create(s).toJSON());if(null!=l)if(Fm.isCell(l))f.target={cell:l.id};else if(d(l))f.target={cell:l};else if(av.isPoint(l))f.target=l.toJSON();else if(Array.isArray(l))f.target={x:l[0],y:l[1]};else{var y=l.cell;Fm.isCell(y)?f.target=Object.assign(Object.assign({},l),{cell:y.id}):f.target=l}if(null!=u||null!=c){var m=f.target;if(null!=u){var w=d(u)?u:u.id;m?m.cell=w:m=f.target={cell:w}}null!=c&&m&&(m.port=c)}else null!=h&&(f.target=av.create(h).toJSON());return o(t,"preprocess",this,3)([f,n])}},{key:"setup",value:function(){var e=this;o(t,"setup",this,3)([]),this.on("change:labels",(function(t){return e.onLabelsChanged(t)})),this.on("change:vertices",(function(t){return e.onVertexsChanged(t)}))}},{key:"isEdge",value:function(){return!0}},{key:"disconnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},e),this}},{key:"source",get:function(){return this.getSource()},set:function(e){this.setSource(e)}},{key:"getSource",value:function(){return this.getTerminal("source")}},{key:"getSourceCellId",value:function(){return this.source.cell}},{key:"getSourcePortId",value:function(){return this.source.port}},{key:"setSource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setTerminal("source",e,t,n)}},{key:"target",get:function(){return this.getTarget()},set:function(e){this.setTarget(e)}},{key:"getTarget",value:function(){return this.getTerminal("target")}},{key:"getTargetCellId",value:function(){return this.target.cell}},{key:"getTargetPortId",value:function(){return this.target.port}},{key:"setTarget",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setTerminal("target",e,t,n)}},{key:"getTerminal",value:function(e){return Object.assign({},this.store.get(e))}},{key:"setTerminal",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(Fm.isCell(t))return this.store.set(e,$e({},n,{cell:t.id}),i),this;var r=t;return av.isPoint(t)||null!=r.x&&null!=r.y?(this.store.set(e,$e({},n,{x:r.x,y:r.y}),i),this):(this.store.set(e,Ke(t),i),this)}},{key:"getSourcePoint",value:function(){return this.getTerminalPoint("source")}},{key:"getTargetPoint",value:function(){return this.getTerminalPoint("target")}},{key:"getTerminalPoint",value:function(e){var t=this[e];if(av.isPointLike(t))return av.create(t);var n=this.getTerminalCell(e);return n?n.getConnectionPoint(this,e):new av}},{key:"getSourceCell",value:function(){return this.getTerminalCell("source")}},{key:"getTargetCell",value:function(){return this.getTerminalCell("target")}},{key:"getTerminalCell",value:function(e){if(this.model){var t="source"===e?this.getSourceCellId():this.getTargetCellId();if(t)return this.model.getCell(t)}return null}},{key:"getSourceNode",value:function(){return this.getTerminalNode("source")}},{key:"getTargetNode",value:function(){return this.getTerminalNode("target")}},{key:"getTerminalNode",value:function(e){for(var t=this,n={};t&&t.isEdge();){if(n[t.id])return null;n[t.id]=!0,t=t.getTerminalCell(e)}return t&&t.isNode()?t:null}},{key:"router",get:function(){return this.getRouter()},set:function(e){null==e?this.removeRouter():this.setRouter(e)}},{key:"getRouter",value:function(){return this.store.get("router")}},{key:"setRouter",value:function(e,t,n){return"object"===d(e)?this.store.set("router",e,t):this.store.set("router",{name:e,args:t},n),this}},{key:"removeRouter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("router",e),this}},{key:"connector",get:function(){return this.getConnector()},set:function(e){null==e?this.removeConnector():this.setConnector(e)}},{key:"getConnector",value:function(){return this.store.get("connector")}},{key:"setConnector",value:function(e,t,n){return"object"===d(e)?this.store.set("connector",e,t):this.store.set("connector",{name:e,args:t},n),this}},{key:"removeConnector",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("connector",e)}},{key:"getDefaultLabel",value:function(){var e=this.constructor,t=this.store.get("defaultLabel")||e.defaultLabel||{};return Ke(t)}},{key:"labels",get:function(){return this.getLabels()},set:function(e){this.setLabels(e)}},{key:"getLabels",value:function(){var e=this;return v(this.store.get("labels",[])).map((function(t){return e.parseLabel(t)}))}},{key:"setLabels",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("labels",Array.isArray(e)?e:[e],t),this}},{key:"insertLabel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getLabels(),r=i.length,o=null!=t&&Number.isFinite(t)?t:r;return o<0&&(o=r+o+1),i.splice(o,0,this.parseLabel(e)),this.setLabels(i,n)}},{key:"appendLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertLabel(e,-1,t)}},{key:"getLabelAt",value:function(e){var t=this.getLabels();return null!=e&&Number.isFinite(e)?this.parseLabel(t[e]):null}},{key:"setLabelAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&Number.isFinite(e)){var i=this.getLabels();i[e]=this.parseLabel(t),this.setLabels(i,n)}return this}},{key:"removeLabelAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getLabels(),i=null!=e&&Number.isFinite(e)?e:-1,r=n.splice(i,1);return this.setLabels(n,t),r.length?r[0]:null}},{key:"parseLabel",value:function(e){return"string"==typeof e?this.constructor.parseStringLabel(e):e}},{key:"onLabelsChanged",value:function(e){var t=e.previous,n=e.current,i=t&&n?n.filter((function(e){return t.find((function(t){return e===t||it(e,t)}))?null:e})):n?v(n):[],r=t&&n?t.filter((function(e){return n.find((function(t){return e===t||it(e,t)}))?null:e})):t?v(t):[];i.length>0&&this.notify("labels:added",{added:i,cell:this,edge:this}),r.length>0&&this.notify("labels:removed",{removed:r,cell:this,edge:this})}},{key:"vertices",get:function(){return this.getVertices()},set:function(e){this.setVertices(e)}},{key:"getVertices",value:function(){return v(this.store.get("vertices",[]))}},{key:"setVertices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:[e];return this.store.set("vertices",n.map((function(e){return av.toJSON(e)})),t),this}},{key:"insertVertex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getVertices(),r=i.length,o=null!=t&&Number.isFinite(t)?t:r;return o<0&&(o=r+o+1),i.splice(o,0,av.toJSON(e)),this.setVertices(i,n)}},{key:"appendVertex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertVertex(e,-1,t)}},{key:"getVertexAt",value:function(e){return null!=e&&Number.isFinite(e)?this.getVertices()[e]:null}},{key:"setVertexAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&Number.isFinite(e)){var i=this.getVertices();i[e]=t,this.setVertices(i,n)}return this}},{key:"removeVertexAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getVertices(),i=null!=e&&Number.isFinite(e)?e:-1;return n.splice(i,1),this.setVertices(n,t)}},{key:"onVertexsChanged",value:function(e){var t=e.previous,n=e.current,i=t&&n?n.filter((function(e){return t.find((function(t){return av.equals(e,t)}))?null:e})):n?v(n):[],r=t&&n?t.filter((function(e){return n.find((function(t){return av.equals(e,t)}))?null:e})):t?v(t):[];i.length>0&&this.notify("vertexs:added",{added:i,cell:this,edge:this}),r.length>0&&this.notify("vertexs:removed",{removed:r,cell:this,edge:this})}},{key:"getDefaultMarkup",value:function(){return this.store.get("defaultMarkup")||Gp.getEdgeMarkup()}},{key:"getMarkup",value:function(){return o(t,"getMarkup",this,3)([])||this.getDefaultMarkup()}},{key:"translate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.translateBy=n.translateBy||this.id,n.tx=e,n.ty=t,this.applyToPoints((function(n){return{x:(n.x||0)+e,y:(n.y||0)+t}}),n)}},{key:"scale",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.applyToPoints((function(i){return av.create(i).scale(e,t,n).toJSON()}),i)}},{key:"applyToPoints",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},i=this.getSource(),r=this.getTarget();av.isPointLike(i)&&(n.source=e(i)),av.isPointLike(r)&&(n.target=e(r));var o=this.getVertices();return o.length>0&&(n.vertices=o.map(e)),this.store.set(n,t),this}},{key:"getBBox",value:function(){return this.getPolyline().bbox()}},{key:"getConnectionPoint",value:function(){return this.getPolyline().pointAt(.5)}},{key:"getPolyline",value:function(){var e=[this.getSourcePoint()].concat(v(this.getVertices().map((function(e){return av.create(e)}))),[this.getTargetPoint()]);return new pv(e)}},{key:"updateParent",value:function(e){var t=null,n=this.getSourceCell(),i=this.getTargetCell(),r=this.getParent();return n&&i&&(t=n===i||n.isDescendantOf(i)?i:i.isDescendantOf(n)?n:Fm.getCommonAncestor(n,i)),r&&t&&t.id!==r.id&&r.unembed(this,e),!t||r&&r.id===t.id||t.embed(this,e),t}},{key:"hasLoop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getSource(),n=this.getTarget(),i=t.cell,r=n.cell;if(!i||!r)return!1;var o=i===r;if(!o&&e.deep&&this._model){var a=this.getSourceCell(),s=this.getTargetCell();a&&s&&(o=a.isAncestorOf(s,e)||s.isAncestorOf(a,e))}return o}},{key:"getFragmentAncestor",value:function(){var e=[this,this.getSourceNode(),this.getTargetNode()].filter((function(e){return null!=e}));return this.getCommonAncestor.apply(this,v(e))}},{key:"isFragmentDescendantOf",value:function(e){var t=this.getFragmentAncestor();return!!t&&(t.id===e.id||t.isDescendantOf(e))}}])}(Fm);Gm.defaults={},function(e){e.equalTerminals=function(e,t){var n=e,i=t;return n.cell===i.cell&&(n.port===i.port||null==n.port&&null==i.port)}}(Gm||(Gm={})),function(e){e.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}},e.parseStringLabel=function(e){return{attrs:{label:{text:e}}}}}(Gm||(Gm={})),function(e){e.toStringTag="X6.".concat(e.name),e.isEdge=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNode&&"function"==typeof i.isEdge&&"function"==typeof i.prop&&"function"==typeof i.attr&&"function"==typeof i.disconnect&&"function"==typeof i.getSource&&"function"==typeof i.getTarget}}(Gm||(Gm={})),function(e){e.registry=Ov.create({type:"edge",process:function(t,n){if(Rm.exist(t,!1))throw new Error("Edge with name '".concat(t,"' was registered by anthor Node"));if("function"==typeof n)return n.config({shape:t}),n;var i=e,r=n.inherit,o=void 0===r?"edge":r,a=qm(n,["inherit"]);if("string"==typeof o){var s=this.get(o||"edge");null==s&&o?this.onNotFound(o,"inherited"):i=s}else i=o;null==a.constructorName&&(a.constructorName=t);var l=i.define.call(i,a);return l.config({shape:t}),l}}),Rm.setEdgeRegistry(e.registry)}(Gm||(Gm={})),function(e){var t=0;e.define=function(n){var i=n.constructorName,r=n.overwrite,o=qm(n,["constructorName","overwrite"]),a=Th(function(e){return e?Fh(e):"CustomEdge".concat(t+=1)}(i||o.shape),this);return a.config(o),o.shape&&e.registry.register(o.shape,a,r),a},e.create=function(t){var n=t.shape||"edge",i=e.registry.get(n);return i?new i(t):e.registry.onNotFound(n)}}(Gm||(Gm={})),function(e){var t="basic.edge";e.config({shape:t,propHooks:function(t){var n=t.label,i=t.vertices,r=qm(t,["label","vertices"]);if(n){null==r.labels&&(r.labels=[]);var o="string"==typeof n?e.parseStringLabel(n):n;r.labels.push(o)}return i&&Array.isArray(i)&&(r.vertices=i.map((function(e){return av.create(e).toJSON()}))),r}}),e.registry.register(t,e)}(Gm||(Gm={}));var Jm=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Wm=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return A(this,t),(n=s(this,t)).length=0,n.comparator=i.comparator||"zIndex",n.clean(),e&&n.reset(e,{silent:!0}),n}return h(t,e),P(t,[{key:"toJSON",value:function(){return this.cells.map((function(e){return e.toJSON()}))}},{key:"add",value:function(e,t,n){var i,r,o=this;"number"==typeof t?(i=t,r=Object.assign({merge:!1},n)):(i=this.length,r=Object.assign({merge:!1},t)),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var a,s=Array.isArray(e)?e:[e],l=this.comparator&&"number"!=typeof t&&!1!==r.sort,u=this.comparator||null,c=!1,h=[],f=[];(s.forEach((function(e){var t=o.get(e);t?r.merge&&!e.isSameStore(t)&&(t.setProp(e.getProp(),n),f.push(t),l&&!c&&(c=null==u||"function"==typeof u?t.hasChanged():"string"==typeof u?t.hasChanged(u):u.some((function(e){return t.hasChanged(e)})))):(h.push(e),o.reference(e))})),h.length)&&(l&&(c=!0),(a=this.cells).splice.apply(a,[i,0].concat(h)),this.length=this.cells.length);return c&&this.sort({silent:!0}),r.silent||(h.forEach((function(e,t){var n={cell:e,index:i+t,options:r};o.trigger("added",n),r.dryrun||e.notify("added",Object.assign({},n))})),c&&this.trigger("sorted"),(h.length||f.length)&&this.trigger("updated",{added:h,merged:f,removed:[],options:r})),this}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:[e],i=this.removeCells(n,t);return!t.silent&&i.length>0&&this.trigger("updated",{options:t,removed:i,added:[],merged:[]}),Array.isArray(e)?i:i[0]}},{key:"removeCells",value:function(e,t){for(var n=[],i=0;i<e.length;i+=1){var r=this.get(e[i]);if(null!=r){var o=this.cells.indexOf(r);this.cells.splice(o,1),this.length-=1,delete this.map[r.id],n.push(r),this.unreference(r),t.dryrun||r.remove(),t.silent||(this.trigger("removed",{cell:r,index:o,options:t}),t.dryrun||r.notify("removed",{cell:r,index:o,options:t}))}}return n}},{key:"reset",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.cells.slice();if(i.forEach((function(e){return t.unreference(e)})),this.clean(),this.add(e,Object.assign({silent:!0},n)),!n.silent){var r=this.cells.slice();this.trigger("reseted",{options:n,previous:i,current:r});var o=[],a=[];r.forEach((function(e){i.some((function(t){return t.id===e.id}))||o.push(e)})),i.forEach((function(e){r.some((function(t){return t.id===e.id}))||a.push(e)})),this.trigger("updated",{options:n,added:o,removed:a,merged:[]})}return this}},{key:"push",value:function(e,t){return this.add(e,this.length,t)}},{key:"pop",value:function(e){var t=this.at(this.length-1);return this.remove(t,e)}},{key:"unshift",value:function(e,t){return this.add(e,0,t)}},{key:"shift",value:function(e){var t=this.at(0);return this.remove(t,e)}},{key:"get",value:function(e){if(null==e)return null;var t="string"==typeof e||"number"==typeof e?e:e.id;return this.map[t]||null}},{key:"has",value:function(e){return null!=this.get(e)}},{key:"at",value:function(e){return e<0&&(e+=this.length),this.cells[e]||null}},{key:"first",value:function(){return this.at(0)}},{key:"last",value:function(){return this.at(-1)}},{key:"indexOf",value:function(e){return this.cells.indexOf(e)}},{key:"toArray",value:function(){return this.cells.slice()}},{key:"sort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null!=this.comparator&&(this.cells=at(this.cells,this.comparator),e.silent||this.trigger("sorted")),this}},{key:"clone",value:function(){return new(0,this.constructor)(this.cells.slice(),{comparator:this.comparator})}},{key:"reference",value:function(e){this.map[e.id]=e,e.on("*",this.notifyCellEvent,this)}},{key:"unreference",value:function(e){e.off("*",this.notifyCellEvent,this),delete this.map[e.id]}},{key:"notifyCellEvent",value:function(e,t){var n=t.cell;this.trigger("cell:".concat(e),t),n&&(n.isNode()?this.trigger("node:".concat(e),Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&this.trigger("edge:".concat(e),Object.assign(Object.assign({},t),{edge:n})))}},{key:"clean",value:function(){this.length=0,this.cells=[],this.map={}}},{key:"dispose",value:function(){this.reset([])}}])}(Rh);Jm([Wm.dispose()],Wm.prototype,"dispose",null);var Ym=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Zm=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return A(this,t),(e=s(this,t)).batches={},e.addings=new WeakMap,e.nodes={},e.edges={},e.outgoings={},e.incomings={},e.collection=new Wm(n),e.setup(),e}return h(t,e),P(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"notify",value:function(e,t){this.trigger(e,t);var n=this.graph;return n&&("sorted"===e||"reseted"===e||"updated"===e?n.trigger("model:".concat(e),t):n.trigger(e,t)),this}},{key:"setup",value:function(){var e=this,t=this.collection;t.on("sorted",(function(){return e.notify("sorted",null)})),t.on("updated",(function(t){return e.notify("updated",t)})),t.on("cell:change:zIndex",(function(){return e.sortOnChangeZ()})),t.on("added",(function(t){var n=t.cell;e.onCellAdded(n)})),t.on("removed",(function(t){var n=t.cell;e.onCellRemoved(n,t.options),e.notify("cell:removed",t),n.isNode()?e.notify("node:removed",Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&e.notify("edge:removed",Object.assign(Object.assign({},t),{edge:n}))})),t.on("reseted",(function(t){e.onReset(t.current),e.notify("reseted",t)})),t.on("edge:change:source",(function(t){var n=t.edge;return e.onEdgeTerminalChanged(n,"source")})),t.on("edge:change:target",(function(t){var n=t.edge;e.onEdgeTerminalChanged(n,"target")}))}},{key:"sortOnChangeZ",value:function(){this.collection.sort()}},{key:"onCellAdded",value:function(e){var t=e.id;e.isEdge()?(e.updateParent(),this.edges[t]=!0,this.onEdgeTerminalChanged(e,"source"),this.onEdgeTerminalChanged(e,"target")):this.nodes[t]=!0}},{key:"onCellRemoved",value:function(e,t){var n=e.id;if(e.isEdge()){delete this.edges[n];var i=e.getSource(),r=e.getTarget();if(i&&i.cell){var o=this.outgoings[i.cell],a=o?o.indexOf(n):-1;a>=0&&(o.splice(a,1),0===o.length&&delete this.outgoings[i.cell])}if(r&&r.cell){var s=this.incomings[r.cell],l=s?s.indexOf(n):-1;l>=0&&(s.splice(l,1),0===s.length&&delete this.incomings[r.cell])}}else delete this.nodes[n];t.clear||(t.disconnectEdges?this.disconnectConnectedEdges(e,t):this.removeConnectedEdges(e,t)),e.model===this&&(e.model=null)}},{key:"onReset",value:function(e){var t=this;this.nodes={},this.edges={},this.outgoings={},this.incomings={},e.forEach((function(e){return t.onCellAdded(e)}))}},{key:"onEdgeTerminalChanged",value:function(e,t){var n="source"===t?this.outgoings:this.incomings,i=e.previous(t);if(i&&i.cell){var r=Fm.isCell(i.cell)?i.cell.id:i.cell,o=n[r],a=o?o.indexOf(e.id):-1;a>=0&&(o.splice(a,1),0===o.length&&delete n[r])}var s=e.getTerminal(t);if(s&&s.cell){var l=Fm.isCell(s.cell)?s.cell.id:s.cell,u=n[l]||[];-1===u.indexOf(e.id)&&u.push(e.id),n[l]=u}}},{key:"prepareCell",value:function(e,t){return e.model||t&&t.dryrun||(e.model=this),null==e.zIndex&&e.setZIndex(this.getMaxZIndex()+1,{silent:!0}),e}},{key:"resetCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.map((function(e){return t.prepareCell(e,Object.assign(Object.assign({},n),{dryrun:!0}))})),this.collection.reset(e,n),e.map((function(e){return t.prepareCell(e,{options:n})})),this}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getCells();if(0===t.length)return this;var n=Object.assign(Object.assign({},e),{clear:!0});return this.batchUpdate("clear",(function(){for(var e=t.sort((function(e,t){return(e.isEdge()?1:2)-(t.isEdge()?1:2)}));e.length>0;){var i=e.shift();i&&i.remove(n)}}),n),this}},{key:"addNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Um.isNode(e)?e:this.createNode(e);return this.addCell(n,t),n}},{key:"updateNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.createNode(e),i=n.getProp();return n.dispose(),this.updateCell(i,t)}},{key:"createNode",value:function(e){return Um.create(e)}},{key:"addEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Gm.isEdge(e)?e:this.createEdge(e);return this.addCell(n,t),n}},{key:"createEdge",value:function(e){return Gm.create(e)}},{key:"updateEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.createEdge(e),i=n.getProp();return n.dispose(),this.updateCell(i,t)}},{key:"addCell",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(e)?this.addCells(e,n):(this.collection.has(e)||this.addings.has(e)||(this.addings.set(e,!0),this.collection.add(this.prepareCell(e,n),n),e.eachChild((function(e){return t.addCell(e,n)})),this.addings.delete(e)),this)}},{key:"addCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.length;if(0===i)return this;var r=Object.assign(Object.assign({},n),{position:i-1,maxPosition:i-1});return this.startBatch("add",Object.assign(Object.assign({},r),{cells:e})),e.forEach((function(e){t.addCell(e,r),r.position-=1})),this.stopBatch("add",Object.assign(Object.assign({},r),{cells:e})),this}},{key:"updateCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.id&&this.getCell(e.id);return!!n&&this.batchUpdate("update",(function(){return Object.entries(e).forEach((function(e){var i=p(e,2),r=i[0],o=i[1];return n.setProp(r,o,t)})),!0}),e)}},{key:"removeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"==typeof e?this.getCell(e):e;return n&&this.has(n)?this.collection.remove(n,t):null}},{key:"updateCellId",value:function(e,t){if(e.id!==t){this.startBatch("update",{id:t}),e.prop("id",t);var n=e.clone({keepId:!0});return this.addCell(n),this.getConnectedEdges(e).forEach((function(n){var i=n.getSourceCell(),r=n.getTargetCell();i===e&&n.setSource(Object.assign(Object.assign({},n.getSource()),{cell:t})),r===e&&n.setTarget(Object.assign(Object.assign({},n.getTarget()),{cell:t}))})),this.removeCell(e),this.stopBatch("update",{id:t}),n}}},{key:"removeCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.length?this.batchUpdate("remove",(function(){return e.map((function(e){return t.removeCell(e,n)}))})):[]}},{key:"removeConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getConnectedEdges(e);return n.forEach((function(e){e.remove(t)})),n}},{key:"disconnectConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"==typeof e?e:e.id;this.getConnectedEdges(e).forEach((function(e){var i=e.getSourceCellId(),r=e.getTargetCellId();i===n&&e.setSource({x:0,y:0},t),r===n&&e.setTarget({x:0,y:0},t)}))}},{key:"has",value:function(e){return this.collection.has(e)}},{key:"total",value:function(){return this.collection.length}},{key:"indexOf",value:function(e){return this.collection.indexOf(e)}},{key:"getCell",value:function(e){return this.collection.get(e)}},{key:"getCells",value:function(){return this.collection.toArray()}},{key:"getFirstCell",value:function(){return this.collection.first()}},{key:"getLastCell",value:function(){return this.collection.last()}},{key:"getMinZIndex",value:function(){var e=this.collection.first();return e&&e.getZIndex()||0}},{key:"getMaxZIndex",value:function(){var e=this.collection.last();return e&&e.getZIndex()||0}},{key:"getCellsFromCache",value:function(e){var t=this;return e?Object.keys(e).map((function(e){return t.getCell(e)})).filter((function(e){return null!=e})):[]}},{key:"getNodes",value:function(){return this.getCellsFromCache(this.nodes)}},{key:"getEdges",value:function(){return this.getCellsFromCache(this.edges)}},{key:"getOutgoingEdges",value:function(e){var t=this,n="string"==typeof e?e:e.id,i=this.outgoings[n];return i?i.map((function(e){return t.getCell(e)})).filter((function(e){return e&&e.isEdge()})):null}},{key:"getIncomingEdges",value:function(e){var t=this,n="string"==typeof e?e:e.id,i=this.incomings[n];return i?i.map((function(e){return t.getCell(e)})).filter((function(e){return e&&e.isEdge()})):null}},{key:"getConnectedEdges",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],r="string"==typeof e?this.getCell(e):e;if(null==r)return i;var o={},a=n.indirect,s=n.incoming,l=n.outgoing;null==s&&null==l&&(s=l=!0);var u=function(e,n){var r=n?t.getOutgoingEdges(e):t.getIncomingEdges(e);if(null!=r&&r.forEach((function(e){o[e.id]||(i.push(e),o[e.id]=!0,a&&(s&&u(e,!1),l&&u(e,!0)))})),a&&e.isEdge()){var c=n?e.getTargetCell():e.getSourceCell();c&&c.isEdge()&&(o[c.id]||(i.push(c),u(c,n)))}};if(l&&u(r,!0),s&&u(r,!1),n.deep){var c=r.getDescendants({deep:!0}),h={};c.forEach((function(e){e.isNode()&&(h[e.id]=!0)}));var f=function(e,r){var a=r?t.getOutgoingEdges(e.id):t.getIncomingEdges(e.id);null!=a&&a.forEach((function(e){if(!o[e.id]){var t=e.getSourceCell(),r=e.getTargetCell();if(!n.enclosed&&t&&h[t.id]&&r&&h[r.id])return;i.push(e),o[e.id]=!0}}))};c.forEach((function(e){e.isEdge()||(l&&f(e,!0),s&&f(e,!1))}))}return i}},{key:"isBoundary",value:function(e,t){var n="string"==typeof e?this.getCell(e):e,i=t?this.getIncomingEdges(n):this.getOutgoingEdges(n);return null==i||0===i.length}},{key:"getBoundaryNodes",value:function(e){var t=this,n=[];return Object.keys(this.nodes).forEach((function(i){if(t.isBoundary(i,e)){var r=t.getCell(i);r&&n.push(r)}})),n}},{key:"getRoots",value:function(){return this.getBoundaryNodes(!0)}},{key:"getLeafs",value:function(){return this.getBoundaryNodes(!1)}},{key:"isRoot",value:function(e){return this.isBoundary(e,!0)}},{key:"isLeaf",value:function(e){return this.isBoundary(e,!1)}},{key:"getNeighbors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.incoming,i=t.outgoing;null==n&&null==i&&(n=i=!0);var r=this.getConnectedEdges(e,t).reduce((function(r,o){var a=o.hasLoop(t),s=o.getSourceCell(),l=o.getTargetCell();return n&&s&&s.isNode()&&!r[s.id]&&(!a&&(s===e||t.deep&&s.isDescendantOf(e))||(r[s.id]=s)),i&&l&&l.isNode()&&!r[l.id]&&(!a&&(l===e||t.deep&&l.isDescendantOf(e))||(r[l.id]=l)),r}),{});if(e.isEdge()){if(n){var o=e.getSourceCell();o&&o.isNode()&&!r[o.id]&&(r[o.id]=o)}if(i){var a=e.getTargetCell();a&&a.isNode()&&!r[a.id]&&(r[a.id]=a)}}return Object.keys(r).map((function(e){return r[e]}))}},{key:"isNeighbor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.incoming,r=n.outgoing;return null==i&&null==r&&(i=r=!0),this.getConnectedEdges(e,n).some((function(e){var n=e.getSourceCell(),o=e.getTargetCell();return!(!i||!n||n.id!==t.id)||!(!r||!o||o.id!==t.id)}))}},{key:"getSuccessors",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];return this.search(e,(function(r,o){r!==e&&t.matchDistance(o,n.distance)&&i.push(r)}),Object.assign(Object.assign({},n),{outgoing:!0})),i}},{key:"isSuccessor",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!1;return this.search(e,(function(o,a){if(o===t&&o!==e&&n.matchDistance(a,i.distance))return r=!0,!1}),Object.assign(Object.assign({},i),{outgoing:!0})),r}},{key:"getPredecessors",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];return this.search(e,(function(r,o){r!==e&&t.matchDistance(o,n.distance)&&i.push(r)}),Object.assign(Object.assign({},n),{incoming:!0})),i}},{key:"isPredecessor",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!1;return this.search(e,(function(o,a){if(o===t&&o!==e&&n.matchDistance(a,i.distance))return r=!0,!1}),Object.assign(Object.assign({},i),{incoming:!0})),r}},{key:"matchDistance",value:function(e,t){return null==t||("function"==typeof t?t(e):!(!Array.isArray(t)||!t.includes(e))||e===t)}},{key:"getCommonAncestor",value:function(){for(var e,t=[],n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return i.forEach((function(e){e&&(Array.isArray(e)?t.push.apply(t,v(e)):t.push(e))})),(e=Fm).getCommonAncestor.apply(e,t)}},{key:"getSubGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[],r={},o=[],a=[],s=function(e){r[e.id]||(i.push(e),r[e.id]=e,e.isEdge()&&a.push(e),e.isNode()&&o.push(e))};return e.forEach((function(e){(s(e),n.deep)&&e.getDescendants({deep:!0}).forEach((function(e){return s(e)}))})),a.forEach((function(e){var t=e.getSourceCell(),n=e.getTargetCell();t&&!r[t.id]&&(i.push(t),r[t.id]=t,t.isNode()&&o.push(t)),n&&!r[n.id]&&(i.push(n),r[n.id]=n,n.isNode()&&o.push(n))})),o.forEach((function(e){t.getConnectedEdges(e,n).forEach((function(e){var t=e.getSourceCell(),n=e.getTargetCell();!r[e.id]&&t&&r[t.id]&&n&&r[n.id]&&(i.push(e),r[e.id]=e)}))})),i}},{key:"cloneSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getSubGraph(e,t);return this.cloneCells(n)}},{key:"cloneCells",value:function(e){return Fm.cloneCells(e)}},{key:"getNodesFromPoint",value:function(e,t){var n="number"==typeof e?{x:e,y:t||0}:e;return this.getNodes().filter((function(e){return e.getBBox().containsPoint(n)}))}},{key:"getNodesInArea",value:function(e,t,n,i,r){var o="number"==typeof e?new sv(e,t,n,i):sv.create(e),a="number"==typeof e?r:t,s=a&&a.strict;return this.getNodes().filter((function(e){var t=e.getBBox();return s?o.containsRect(t):o.isIntersectWithRect(t)}))}},{key:"getEdgesInArea",value:function(e,t,n,i,r){var o="number"==typeof e?new sv(e,t,n,i):sv.create(e),a="number"==typeof e?r:t,s=a&&a.strict;return this.getEdges().filter((function(e){var t=e.getBBox();return 0===t.width?t.inflate(1,0):0===t.height&&t.inflate(0,1),s?o.containsRect(t):o.isIntersectWithRect(t)}))}},{key:"getNodesUnderNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getBBox();return(null==t.by||"bbox"===t.by?this.getNodesInArea(n):this.getNodesFromPoint(n[t.by])).filter((function(t){return e.id!==t.id&&!t.isDescendantOf(e)}))}},{key:"getAllCellsBBox",value:function(){return this.getCellsBBox(this.getCells())}},{key:"getCellsBBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Fm.getCellsBBox(e,t)}},{key:"search",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.breadthFirst?this.breadthFirstSearch(e,t,n):this.depthFirstSearch(e,t,n)}},{key:"breadthFirstSearch",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o={},a={};r.push(e),a[e.id]=0;for(var s=function(){var e=r.shift();return null==e||o[e.id]?0:(o[e.id]=!0,!1===Eh(t,n,e,a[e.id])?0:void n.getNeighbors(e,i).forEach((function(t){a[t.id]=a[e.id]+1,r.push(t)})))};r.length>0;)s()}},{key:"depthFirstSearch",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o={},a={};r.push(e),a[e.id]=0;for(var s=function(){var e=r.pop();if(null==e||o[e.id])return 0;if(o[e.id]=!0,!1===Eh(t,n,e,a[e.id]))return 0;var s=n.getNeighbors(e,i),l=r.length;s.forEach((function(t){a[t.id]=a[e.id]+1,r.splice(l,0,t)}))};r.length>0;)s()}},{key:"getShortestPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={};this.getEdges().forEach((function(e){var t=e.getSourceCellId(),r=e.getTargetCellId();t&&r&&(i[t]||(i[t]=[]),i[r]||(i[r]=[]),i[t].push(r),n.directed||i[r].push(t))}));var r="string"==typeof e?e:e.id,o=Zd.run(i,r,n.weight),a=[],s="string"==typeof t?t:t.id;for(o[s]&&a.push(s);s=o[s];)a.unshift(s);return a}},{key:"translate",value:function(e,t,n){return this.getCells().filter((function(e){return!e.hasParent()})).forEach((function(i){return i.translate(e,t,n)})),this}},{key:"resize",value:function(e,t,n){return this.resizeCells(e,t,this.getCells(),n)}},{key:"resizeCells",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getCellsBBox(n);if(r){var o=Math.max(e/r.width,0),a=Math.max(t/r.height,0),s=r.getOrigin();n.forEach((function(e){return e.scale(o,a,s,i)}))}return this}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.toJSON(this.getCells(),e)}},{key:"parseJSON",value:function(e){return t.fromJSON(e)}},{key:"fromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.parseJSON(e);return this.resetCells(n,t),this}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.batches[e]=(this.batches[e]||0)+1,this.notify("batch:start",{name:e,data:t}),this}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.batches[e]=(this.batches[e]||0)-1,this.notify("batch:stop",{name:e,data:t}),this}},{key:"batchUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.startBatch(e,n);var i=t();return this.stopBatch(e,n),i}},{key:"hasActiveBatch",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(this.batches);return(Array.isArray(t)?t:[t]).some((function(t){return e.batches[t]>0}))}},{key:"dispose",value:function(){this.collection.dispose()}}])}(Rh);Ym([Zm.dispose()],Zm.prototype,"dispose",null),function(e){e.toStringTag="X6.".concat(e.name),e.isModel=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.addNode&&"function"==typeof i.addEdge&&null!=i.collection}}(Zm||(Zm={})),function(e){e.toJSON=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{cells:e.map((function(e){return e.toJSON(t)}))}},e.fromJSON=function(e){var t=[];return Array.isArray(e)?t.push.apply(t,v(e)):(e.cells&&t.push.apply(t,v(e.cells)),e.nodes&&e.nodes.forEach((function(e){null==e.shape&&(e.shape="rect"),t.push(e)})),e.edges&&e.edges.forEach((function(e){null==e.shape&&(e.shape="edge"),t.push(e)}))),t.map((function(e){var t=e.shape;if(t){if(Um.registry.exist(t))return Um.create(e);if(Gm.registry.exist(t))return Gm.create(e)}throw new Error("The `shape` should be specified when creating a node/edge instance")}))}}(Zm||(Zm={}));var Km=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Xm=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"label",get:function(){return this.getLabel()},set:function(e){this.setLabel(e)}},{key:"getLabel",value:function(){return this.getAttrByPath("text/text")}},{key:"setLabel",value:function(e,t){return null==e?this.removeLabel():this.setAttrByPath("text/text",e,t),this}},{key:"removeLabel",value:function(){return this.removeAttrByPath("text/text"),this}}])}(Um);!function(e){e.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},e.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},e.config({attrs:{text:Object.assign({},e.labelAttr)},propHooks:function(e){var t=e.label,n=Km(e,["label"]);return t&&Nh(n,"attrs/text/text",t),n},visible:!0})}(Xm||(Xm={}));var $m=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};function Qm(e){return[{tagName:e,selector:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body"},{tagName:"text",selector:"label"}]}function ew(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={constructorName:e,markup:Qm(e,n.selector),attrs:O({},e,Object.assign({},Xm.bodyAttr))};return(n.parent||Xm).define($e(i,t,{shape:e}))}ew("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});var tw=Gm.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});ew("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var nw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},iw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"points",get:function(){return this.getPoints()},set:function(e){this.setPoints(e)}},{key:"getPoints",value:function(){return this.getAttrByPath("body/refPoints")}},{key:"setPoints",value:function(e,n){return null==e?this.removePoints():this.setAttrByPath("body/refPoints",t.pointsToString(e),n),this}},{key:"removePoints",value:function(){return this.removeAttrByPath("body/refPoints"),this}}])}(Xm);!function(e){function t(e){return"string"==typeof e?e:e.map((function(e){return Array.isArray(e)?e.join(","):av.isPointLike(e)?"".concat(e.x,", ").concat(e.y):""})).join(" ")}e.pointsToString=t,e.config({propHooks:function(e){var n=e.points,i=nw(e,["points"]);if(n){var r=t(n);r&&Nh(i,"attrs/body/refPoints",r)}return i}})}(iw||(iw={})),ew("polygon",{},{parent:iw}),ew("polyline",{},{parent:iw});var rw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Xm.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks:function(e){var t=e.path,n=rw(e,["path"]);return t&&Nh(n,"attrs/body/refD",t),n}});var ow=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};Xm.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},Wh.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:Sf.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},Xm.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks:function(e){var t=e.text,n=ow(e,["text"]);return t&&Nh(n,"attrs/label/text",t),n},attrHooks:{text:{set:function(e,t){var n=t.cell,i=t.view,r=t.refBBox,o=t.elem,a=t.attrs;if(!(o instanceof HTMLElement)){var s=a.style||{},l={text:e,width:-5,height:"100%"},u=Object.assign({textVerticalAnchor:"middle"},s);return Eh(vp.presets.textWrap.set,this,l,{cell:n,view:i,elem:o,refBBox:r,attrs:u}),{fill:s.color||null}}o.textContent=e},position:function(e,t){var n=t.refBBox;if(t.elem instanceof SVGElement)return n.getCenter()}}}}),ew("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xlink:href";return function(t){var n=t.imageUrl,i=t.imageWidth,r=t.imageHeight,o=$m(t,["imageUrl","imageWidth","imageHeight"]);if(null!=n||null!=i||null!=r){var a=function(){if(o.attrs){var t=o.attrs.image;null!=n&&(t[e]=n),null!=i&&(t.width=i),null!=r&&(t.height=r),o.attrs.image=t}};o.attrs?(null==o.attrs.image&&(o.attrs.image={}),a()):(o.attrs={image:{}},a())}return o}}()},{selector:"image"}),ew("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});var aw=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).portsCache={},e}return h(t,e),P(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"getContainerClassName",value:function(){var e=[o(t,"getContainerClassName",this,3)([]),this.prefixClassName("node")];return this.can("nodeMovable")||e.push(this.prefixClassName("node-immovable")),e.join(" ")}},{key:"updateClassName",value:function(e){var t=e.target;if(t.hasAttribute("magnet")){var n=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?bf(t,n):wf(t,n)}else{var i=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(i):this.addClass(i)}}},{key:"isNodeView",value:function(){return!0}},{key:"confirmUpdate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e;return this.hasAction(i,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","resize","translate","rotate","ports","tools"])):(i=this.handleAction(i,"resize",(function(){return t.resize()}),"update"),i=this.handleAction(i,"update",(function(){return t.update()}),"ports"),i=this.handleAction(i,"translate",(function(){return t.translate()})),i=this.handleAction(i,"rotate",(function(){return t.rotate()})),i=this.handleAction(i,"ports",(function(){return t.renderPorts()})),i=this.handleAction(i,"tools",(function(){t.getFlag("tools")===e?t.renderTools():t.updateTools(n)}))),i}},{key:"update",value:function(e){this.cleanCache(),this.removePorts();var t=this.cell,n=t.getSize(),i=t.getAttrs();this.updateAttrs(this.container,i,{attrs:e===i?null:e,rootBBox:new sv(0,0,n.width,n.height),selectors:this.selectors}),this.renderPorts()}},{key:"renderMarkup",value:function(){var e=this.cell.markup;if(e){if("string"==typeof e)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(e)}throw new TypeError("Invalid node markup.")}},{key:"renderJSONMarkup",value:function(e){var t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.appendChild(t.fragment)}},{key:"render",value:function(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),this.renderTools(),this}},{key:"resize",value:function(){this.cell.getAngle()&&this.rotate(),this.update()}},{key:"translate",value:function(){this.updateTransform()}},{key:"rotate",value:function(){this.updateTransform()}},{key:"getTranslationString",value:function(){var e=this.cell.getPosition();return"translate(".concat(e.x,",").concat(e.y,")")}},{key:"getRotationString",value:function(){var e=this.cell.getAngle();if(e){var t=this.cell.getSize();return"rotate(".concat(e,",").concat(t.width/2,",").concat(t.height/2,")")}}},{key:"updateTransform",value:function(){var e=this.getTranslationString(),t=this.getRotationString();t&&(e+=" ".concat(t)),this.container.setAttribute("transform",e)}},{key:"findPortElem",value:function(e,t){var n=e?this.portsCache[e]:null;if(!n)return null;var i=n.portContentElement,r=n.portContentSelectors||{};return this.findOne(t,i,r)}},{key:"cleanPortsCache",value:function(){this.portsCache={}}},{key:"removePorts",value:function(){Object.values(this.portsCache).forEach((function(e){jf(e.portElement)}))}},{key:"renderPorts",value:function(){var e=this,t=this.container,n=[];t.childNodes.forEach((function(e){n.push(e)}));var i=this.cell.getParsedPorts(),r=st(i,"zIndex"),o="auto";r[o]&&r[o].forEach((function(i){var r=e.getPortElement(i);t.append(r),n.push(r)})),Object.keys(r).forEach((function(t){if(t!==o){var i=parseInt(t,10);e.appendPorts(r[t],i,n)}})),this.updatePorts()}},{key:"appendPorts",value:function(e,t,n){var i=this,r=e.map((function(e){return i.getPortElement(e)}));n[t]||t<0?If(n[Math.max(t,0)],r):Df(this.container,r)}},{key:"getPortElement",value:function(e){var t=this.portsCache[e.id];return t?t.portElement:this.createPortElement(e)}},{key:"createPortElement",value:function(e){var t=Gp.renderMarkup(this.cell.getPortContainerMarkup()),n=t.elem;if(null==n)throw new Error("Invalid port container markup.");var i=(t=Gp.renderMarkup(this.getPortMarkup(e))).elem,r=t.selectors;if(null==i)throw new Error("Invalid port markup.");this.setAttrs({port:e.id,"port-group":e.group},i);var o="x6-port";e.group&&(o+=" x6-port-".concat(e.group)),wf(n,o),wf(n,"x6-port"),wf(i,"x6-port-body"),n.appendChild(i);var a,s,l=r;if(this.existPortLabel(e)){if(a=(t=Gp.renderMarkup(this.getPortLabelMarkup(e.label))).elem,s=t.selectors,null==a)throw new Error("Invalid port label markup.");if(r&&s){for(var u in s)if(r[u]&&u!==this.rootSelector)throw new Error("Selectors within port must be unique.");l=Object.assign(Object.assign({},r),s)}wf(a,"x6-port-label"),n.appendChild(a)}return this.portsCache[e.id]={portElement:n,portSelectors:l,portLabelElement:a,portLabelSelectors:s,portContentElement:i,portContentSelectors:r},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:e,node:this.cell,container:n,selectors:l,labelContainer:a,labelSelectors:s,contentContainer:i,contentSelectors:r}),n}},{key:"updatePorts",value:function(){var e=this,t=this.cell.getParsedGroups(),n=Object.keys(t);0===n.length?this.updatePortGroup():n.forEach((function(t){return e.updatePortGroup(t)}))}},{key:"updatePortGroup",value:function(e){for(var t=sv.fromSize(this.cell.getSize()),n=this.cell.getPortsLayoutByGroup(e,t),i=0,r=n.length;i<r;i+=1){var o=n[i],a=o.portId,s=this.portsCache[a]||{},l=o.portLayout;if(this.applyPortTransform(s.portElement,l),null!=o.portAttrs){var u={selectors:s.portSelectors||{}};o.portSize&&(u.rootBBox=sv.fromSize(o.portSize)),this.updateAttrs(s.portElement,o.portAttrs,u)}var c=o.labelLayout;if(c&&s.portLabelElement&&(this.applyPortTransform(s.portLabelElement,c,-(l.angle||0)),c.attrs)){var h={selectors:s.portLabelSelectors||{}};o.labelSize&&(h.rootBBox=sv.fromSize(o.labelSize)),this.updateAttrs(s.portLabelElement,c.attrs,h)}}}},{key:"applyPortTransform",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=t.angle,r=t.position;Dd(e,Pd().rotate(n).translate(r.x||0,r.y||0).rotate(i||0),{absolute:!0})}},{key:"getPortMarkup",value:function(e){return e.markup||this.cell.portMarkup}},{key:"getPortLabelMarkup",value:function(e){return e.markup||this.cell.portLabelMarkup}},{key:"existPortLabel",value:function(e){return e.attrs&&e.attrs.text}},{key:"getEventArgs",value:function(e,t,n){var i=this,r=i.cell;return null==t||null==n?{e:e,view:i,node:r,cell:r}:{e:e,x:t,y:n,view:i,node:r,cell:r}}},{key:"getPortEventArgs",value:function(e,t,n){var i=this,r=i.cell,o=r;return n?{e:e,x:n.x,y:n.y,view:i,node:r,cell:o,port:t}:{e:e,view:i,node:r,cell:o,port:t}}},{key:"notifyMouseDown",value:function(e,n,i){o(t,"onMouseDown",this,3)([e,n,i]),this.notify("node:mousedown",this.getEventArgs(e,n,i))}},{key:"notifyMouseMove",value:function(e,n,i){o(t,"onMouseMove",this,3)([e,n,i]),this.notify("node:mousemove",this.getEventArgs(e,n,i))}},{key:"notifyMouseUp",value:function(e,n,i){o(t,"onMouseUp",this,3)([e,n,i]),this.notify("node:mouseup",this.getEventArgs(e,n,i))}},{key:"notifyPortEvent",value:function(e,t,n){var i=this.findAttr("port",t.target);if(i){var r=t.type;"node:port:mouseenter"===e?t.type="mouseenter":"node:port:mouseleave"===e&&(t.type="mouseleave"),this.notify(e,this.getPortEventArgs(t,i,n)),t.type=r}}},{key:"onClick",value:function(e,n,i){o(t,"onClick",this,3)([e,n,i]),this.notify("node:click",this.getEventArgs(e,n,i)),this.notifyPortEvent("node:port:click",e,{x:n,y:i})}},{key:"onDblClick",value:function(e,n,i){o(t,"onDblClick",this,3)([e,n,i]),this.notify("node:dblclick",this.getEventArgs(e,n,i)),this.notifyPortEvent("node:port:dblclick",e,{x:n,y:i})}},{key:"onContextMenu",value:function(e,n,i){o(t,"onContextMenu",this,3)([e,n,i]),this.notify("node:contextmenu",this.getEventArgs(e,n,i)),this.notifyPortEvent("node:port:contextmenu",e,{x:n,y:i})}},{key:"onMouseDown",value:function(e,t,n){this.isPropagationStopped(e)||(this.notifyMouseDown(e,t,n),this.notifyPortEvent("node:port:mousedown",e,{x:t,y:n}),this.startNodeDragging(e,t,n))}},{key:"onMouseMove",value:function(e,t,n){var i=this.getEventData(e),r=i.action;if("magnet"===r)this.dragMagnet(e,t,n);else{if("move"===r){var o=i.targetView||this;o.dragNode(e,t,n),o.notify("node:moving",{e:e,x:t,y:n,view:o,cell:o.cell,node:o.cell})}this.notifyMouseMove(e,t,n),this.notifyPortEvent("node:port:mousemove",e,{x:t,y:n})}this.setEventData(e,i)}},{key:"onMouseUp",value:function(e,t,n){var i=this.getEventData(e),r=i.action;"magnet"===r?this.stopMagnetDragging(e,t,n):(this.notifyMouseUp(e,t,n),this.notifyPortEvent("node:port:mouseup",e,{x:t,y:n}),"move"===r&&(i.targetView||this).stopNodeDragging(e,t,n));var o=i.targetMagnet;o&&this.onMagnetClick(e,o,t,n),this.checkMouseleave(e)}},{key:"onMouseOver",value:function(e){o(t,"onMouseOver",this,3)([e]),this.notify("node:mouseover",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseenter",e),this.notifyPortEvent("node:port:mouseover",e)}},{key:"onMouseOut",value:function(e){o(t,"onMouseOut",this,3)([e]),this.notify("node:mouseout",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseleave",e),this.notifyPortEvent("node:port:mouseout",e)}},{key:"onMouseEnter",value:function(e){this.updateClassName(e),o(t,"onMouseEnter",this,3)([e]),this.notify("node:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){o(t,"onMouseLeave",this,3)([e]),this.notify("node:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,n,i,r){o(t,"onMouseWheel",this,3)([e,n,i,r]),this.notify("node:mousewheel",Object.assign({delta:r},this.getEventArgs(e,n,i)))}},{key:"onMagnetClick",value:function(e,t,n,i){var r=this.graph;r.view.getMouseMovedCount(e)>r.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}},{key:"onMagnetDblClick",value:function(e,t,n,i){this.notify("node:magnet:dblclick",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}},{key:"onMagnetContextMenu",value:function(e,t,n,i){this.notify("node:magnet:contextmenu",Object.assign({magnet:t},this.getEventArgs(e,n,i)))}},{key:"onMagnetMouseDown",value:function(e,t,n,i){this.startMagnetDragging(e,n,i)}},{key:"onCustomEvent",value:function(e,n,i,r){this.notify("node:customevent",Object.assign({name:n},this.getEventArgs(e,i,r))),o(t,"onCustomEvent",this,3)([e,n,i,r])}},{key:"prepareEmbedding",value:function(e){var t=this.graph,n=this.getEventData(e).cell||this.cell,i=t.findViewByCell(n),r=t.snapToGrid(e.clientX,e.clientY);this.notify("node:embed",{e:e,node:n,view:i,cell:n,x:r.x,y:r.y,currentParent:n.getParent()})}},{key:"processEmbedding",value:function(e,t){var n=this,i=t.cell||this.cell,r=t.graph||this.graph,o=r.options.embedding,a=o.findParent,s="function"==typeof a?Eh(a,r,{view:this,node:this.cell}).filter((function(e){return Fm.isCell(e)&&n.cell.id!==e.id&&!e.isDescendantOf(n.cell)})):r.model.getNodesUnderNode(i,{by:a});if(o.frontOnly&&s.length>0){var l=st(s,"zIndex"),u=lt(Object.keys(l).map((function(e){return parseInt(e,10)})));u&&(s=l[u])}s=s.filter((function(e){return e.visible}));for(var c=null,h=t.candidateEmbedView,f=o.validate,d=s.length-1;d>=0;d-=1){var v=s[d];if(h&&h.cell.id===v.id){c=h;break}var g=v.findView(r);if(f&&Eh(f,r,{child:this.cell,parent:g.cell,childView:this,parentView:g})){c=g;break}}this.clearEmbedding(t),c&&c.highlight(null,{type:"embedding"}),t.candidateEmbedView=c;var p=r.snapToGrid(e.clientX,e.clientY);this.notify("node:embedding",{e:e,cell:i,node:i,view:r.findViewByCell(i),x:p.x,y:p.y,currentParent:i.getParent(),candidateParent:c?c.cell:null})}},{key:"clearEmbedding",value:function(e){var t=e.candidateEmbedView;t&&(t.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null)}},{key:"finalizeEmbedding",value:function(e,t){this.graph.startBatch("embedding");var n=t.cell||this.cell,i=t.graph||this.graph,r=i.findViewByCell(n),o=n.getParent(),a=t.candidateEmbedView;if(a?(a.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null,null!=o&&o.id===a.cell.id||a.cell.insertChild(n,void 0,{ui:!0})):o&&o.unembed(n,{ui:!0}),i.model.getConnectedEdges(n,{deep:!0}).forEach((function(e){e.updateParent({ui:!0})})),r&&a){var s=i.snapToGrid(e.clientX,e.clientY);r.notify("node:embedded",{e:e,cell:n,x:s.x,y:s.y,node:n,view:i.findViewByCell(n),previousParent:o,currentParent:n.getParent()})}this.graph.stopBatch("embedding")}},{key:"getDelegatedView",value:function(){for(var e=this.cell,t=this;t&&!e.isEdge();){if(!e.hasParent()||t.can("stopDelegateOnDragging"))return t;e=e.getParent(),t=this.graph.findViewByCell(e)}return null}},{key:"validateMagnet",value:function(e,t,n){if("passive"!==t.getAttribute("magnet")){var i=this.graph.options.connecting.validateMagnet;return!i||Eh(i,this.graph,{e:n,magnet:t,view:e,cell:e.cell})}return!1}},{key:"startMagnetDragging",value:function(e,t,n){if(this.can("magnetConnectable")){e.stopPropagation();var i=e.currentTarget,r=this.graph;this.setEventData(e,{targetMagnet:i}),this.validateMagnet(this,i,e)?(r.options.magnetThreshold<=0&&this.startConnectting(e,i,t,n),this.setEventData(e,{action:"magnet"}),this.stopPropagation(e)):this.onMouseDown(e,t,n),r.view.delegateDragEvents(e,this)}}},{key:"startConnectting",value:function(e,t,n,i){this.graph.model.startBatch("add-edge");var r=this.createEdgeFromMagnet(t,n,i);r.setEventData(e,r.prepareArrowheadDragging("target",{x:n,y:i,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(e,{edgeView:r}),r.notifyMouseDown(e,n,i)}},{key:"getDefaultEdge",value:function(e,t){var n,i=this.graph.options.connecting.createEdge;return i&&(n=Eh(i,this.graph,{sourceMagnet:t,sourceView:e,sourceCell:e.cell})),n}},{key:"createEdgeFromMagnet",value:function(e,t,n){var i=this.graph,r=i.model,o=this.getDefaultEdge(this,e);return o.setSource(Object.assign(Object.assign({},o.getSource()),this.getEdgeTerminal(e,t,n,o,"source"))),o.setTarget(Object.assign(Object.assign({},o.getTarget()),{x:t,y:n})),o.addTo(r,{async:!1,ui:!0}),o.findView(i)}},{key:"dragMagnet",value:function(e,t,n){var i=this.getEventData(e),r=i.edgeView;if(r)r.onMouseMove(e,t,n),this.autoScrollGraph(e.clientX,e.clientY);else{var o=this.graph,a=o.options.magnetThreshold,s=this.getEventTarget(e),l=i.targetMagnet;if("onleave"===a){if(l===s||l.contains(s))return}else if(o.view.getMouseMovedCount(e)<=a)return;this.startConnectting(e,l,t,n)}}},{key:"stopMagnetDragging",value:function(e,t,n){var i=this.eventData(e).edgeView;i&&(i.onMouseUp(e,t,n),this.graph.model.stopBatch("add-edge"))}},{key:"notifyUnhandledMouseDown",value:function(e,t,n){this.notify("node:unhandled:mousedown",{e:e,x:t,y:n,view:this,cell:this.cell,node:this.cell})}},{key:"notifyNodeMove",value:function(e,t,n,i,r){var o=this,a=[r],s=this.graph.getPlugin("selection");if(s&&s.isSelectionMovable()){var l=s.getSelectedCells();l.includes(r)&&(a=l.filter((function(e){return e.isNode()})))}a.forEach((function(r){o.notify(e,{e:t,x:n,y:i,cell:r,node:r,view:r.findView(o.graph)})}))}},{key:"getRestrictArea",value:function(e){var t=this.graph.options.translating.restrict,n="function"==typeof t?Eh(t,this.graph,e):t;return"number"==typeof n?this.graph.transform.getGraphArea().inflate(n):!0===n?this.graph.transform.getGraphArea():n||null}},{key:"startNodeDragging",value:function(e,t,n){var i=this.getDelegatedView();if(null==i||!i.can("nodeMovable"))return this.notifyUnhandledMouseDown(e,t,n);this.setEventData(e,{targetView:i,action:"move"});var r=av.create(i.cell.getPosition());i.setEventData(e,{moving:!1,offset:r.diff(t,n),restrict:this.getRestrictArea(i)})}},{key:"dragNode",value:function(e,t,n){var i=this.cell,r=this.graph,o=r.getGridSize(),a=this.getEventData(e),s=a.offset,l=a.restrict;a.moving||(a.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",e,t,n,this.cell)),this.autoScrollGraph(e.clientX,e.clientY);var u=iv.snapToGrid(t+s.x,o),c=iv.snapToGrid(n+s.y,o);i.setPosition(u,c,{restrict:l,deep:!0,ui:!0}),r.options.embedding.enabled&&(a.embedding||(this.prepareEmbedding(e),a.embedding=!0),this.processEmbedding(e,a))}},{key:"stopNodeDragging",value:function(e,t,n){var i=this.getEventData(e);i.embedding&&this.finalizeEmbedding(e,i),i.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",e,t,n,this.cell)),i.moving=!1,i.embedding=!1}},{key:"autoScrollGraph",value:function(e,t){var n=this.graph.getPlugin("scroller");n&&n.autoScroll(e,t)}}])}(Xp);!function(e){e.toStringTag="X6.".concat(e.name),e.isNodeView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNodeView&&"function"==typeof i.isEdgeView&&"function"==typeof i.confirmUpdate&&"function"==typeof i.update&&"function"==typeof i.findPortElem&&"function"==typeof i.resize&&"function"==typeof i.rotate&&"function"==typeof i.translate}}(aw||(aw={})),aw.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),aw.registry.register("node",aw,!0);var sw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},lw=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).POINT_ROUNDING=2,e.labelDestroyFn={},e}return h(t,e),P(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"getContainerClassName",value:function(){return[o(t,"getContainerClassName",this,3)([]),this.prefixClassName("edge")].join(" ")}},{key:"sourceBBox",get:function(){var e=this.sourceView;if(!e){var t=this.cell.getSource();return new sv(t.x,t.y)}var n=this.sourceMagnet;return e.isEdgeElement(n)?new sv(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(n||e.container)}},{key:"targetBBox",get:function(){var e=this.targetView;if(!e){var t=this.cell.getTarget();return new sv(t.x,t.y)}var n=this.targetMagnet;return e.isEdgeElement(n)?new sv(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(n||e.container)}},{key:"isEdgeView",value:function(){return!0}},{key:"confirmUpdate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e;if(this.hasAction(i,"source")){if(!this.updateTerminalProperties("source"))return i;i=this.removeAction(i,"source")}if(this.hasAction(i,"target")){if(!this.updateTerminalProperties("target"))return i;i=this.removeAction(i,"target")}return this.hasAction(i,"render")?(this.render(),i=this.removeAction(i,["render","update","labels","tools"])):(i=this.handleAction(i,"update",(function(){return t.update(n)})),i=this.handleAction(i,"labels",(function(){return t.onLabelsChange(n)})),i=this.handleAction(i,"tools",(function(){return t.renderTools()})))}},{key:"render",value:function(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}},{key:"renderMarkup",value:function(){var e=this.cell.markup;if(e){if("string"==typeof e)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(e)}throw new TypeError("Invalid edge markup.")}},{key:"renderJSONMarkup",value:function(e){var t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.append(t.fragment)}},{key:"customizeLabels",value:function(){if(this.labelContainer)for(var e=this.cell,t=e.labels,n=0,i=t.length;n<i;n+=1){var r=t[n],o=this.labelCache[n],a=this.labelSelectors[n],s=this.graph.options.onEdgeLabelRendered;if(s){var l=s({edge:e,label:r,container:o,selectors:a});l&&(this.labelDestroyFn[n]=l)}}}},{key:"destroyCustomizeLabels",value:function(){var e=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(var t=0,n=e.length;t<n;t+=1){var i=this.labelDestroyFn[t],r=this.labelCache[t],o=this.labelSelectors[t];i&&r&&o&&i({edge:this.cell,label:e[t],container:r,selectors:o})}this.labelDestroyFn={}}},{key:"renderLabels",value:function(){var e=this.cell,t=e.getLabels(),n=t.length,i=this.labelContainer;if(this.labelCache={},this.labelSelectors={},n<=0)return i&&i.parentNode&&i.parentNode.removeChild(i),this;i?this.empty(i):(i=_f("g"),this.addClass(this.prefixClassName("edge-labels"),i),this.labelContainer=i);for(var r=0,o=t.length;r<o;r+=1){var a=t[r],s=this.normalizeLabelMarkup(this.parseLabelMarkup(a.markup)),l=void 0,u=void 0;if(s)l=s.node,u=s.selectors;else{var c=e.getDefaultLabel(),h=this.normalizeLabelMarkup(this.parseLabelMarkup(c.markup));l=h.node,u=h.selectors}l.setAttribute("data-index","".concat(r)),i.appendChild(l);var f=this.rootSelector;if(u[f])throw new Error("Ambiguous label root selector.");u[f]=l,this.labelCache[r]=l,this.labelSelectors[r]=u}return null==i.parentNode&&this.container.appendChild(i),this.updateLabels(),this.customizeLabels(),this}},{key:"onLabelsChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.destroyCustomizeLabels(),this.shouldRerenderLabels(e)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}},{key:"shouldRerenderLabels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell.previous("labels");if(null==t)return!0;if("propertyPathArray"in e&&"propertyValue"in e){var n=e.propertyPathArray||[],i=n.length;if(i>1)if(t[n[1]]){if(2===i)return"object"===d(e.propertyValue)&&ut(e.propertyValue,"markup");if("markup"!==n[2])return!1}}return!0}},{key:"parseLabelMarkup",value:function(e){return e?"string"==typeof e?this.parseLabelStringMarkup(e):this.parseJSONMarkup(e):null}},{key:"parseLabelStringMarkup",value:function(e){for(var t=ud.createVectors(e),n=document.createDocumentFragment(),i=0,r=t.length;i<r;i+=1){var o=t[i].node;n.appendChild(o)}return{fragment:n,selectors:{}}}},{key:"normalizeLabelMarkup",value:function(e){if(null!=e){var t,n=e.fragment;if(!(n instanceof DocumentFragment&&n.hasChildNodes()))throw new Error("Invalid label markup.");var i=n.childNodes;return(t=i.length>1||"G"!==i[0].nodeName.toUpperCase()?ud.create("g").append(n):ud.create(i[0])).addClass(this.prefixClassName("edge-label")),{node:t.node,selectors:e.selectors}}}},{key:"updateLabels",value:function(){if(this.labelContainer)for(var e=this.cell,t=e.labels,n=this.can("edgeLabelMovable"),i=e.getDefaultLabel(),r=0,o=t.length;r<o;r+=1){var a=this.labelCache[r],s=this.labelSelectors[r];a.setAttribute("cursor",n?"move":"default");var l=t[r],u=$e({},i.attrs,l.attrs);this.updateAttrs(a,u,{selectors:s,rootBBox:l.size?sv.fromSize(l.size):void 0})}}},{key:"renderTools",value:function(){var e=this.cell.getTools();return this.addTools(e),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cleanCache(),this.updateConnection(e);var t=this.cell.getAttrs(),n=sw(t,["text"]);return null!=n&&this.updateAttrs(this.container,n,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(e),this}},{key:"removeRedundantLinearVertices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell,n=t.getVertices(),i=[this.sourceAnchor].concat(v(n),[this.targetAnchor]),r=i.length,o=new pv(i);o.simplify({threshold:.01});var a=o.points.map((function(e){return e.toJSON()})),s=a.length;return r===s?0:(t.setVertices(a.slice(1,s-1),e),r-s)}},{key:"getTerminalView",value:function(e){switch(e){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalAnchor",value:function(e){switch(e){case"source":return av.create(this.sourceAnchor);case"target":return av.create(this.targetAnchor);default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalConnectionPoint",value:function(e){switch(e){case"source":return av.create(this.sourcePoint);case"target":return av.create(this.targetPoint);default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalMagnet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case"source":if(t.raw)return this.sourceMagnet;var n=this.sourceView;return n?this.sourceMagnet||n.container:null;case"target":if(t.raw)return this.targetMagnet;var i=this.targetView;return i?this.targetMagnet||i.container:null;default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"updateConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell;if(e.translateBy&&t.isFragmentDescendantOf(e.translateBy)){var n=e.tx||0,i=e.ty||0;this.routePoints=new pv(this.routePoints).translate(n,i).points,this.translateConnectionPoints(n,i),this.path.translate(n,i)}else{var r=t.getVertices(),o=this.findAnchors(r);this.sourceAnchor=o.source,this.targetAnchor=o.target,this.routePoints=this.findRoutePoints(r);var a=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=a.source,this.targetPoint=a.target;var s=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,s.source||this.sourcePoint,s.target||this.targetPoint)}this.cleanCache()}},{key:"findAnchors",value:function(e){var t=this.cell,n=t.source,i=t.target,r=e[0],o=e[e.length-1];return i.priority&&!n.priority?this.findAnchorsOrdered("target",o,"source",r):this.findAnchorsOrdered("source",r,"target",o)}},{key:"findAnchorsOrdered",value:function(e,t,n,i){var r,o,a,s=this.cell,l=s[e],u=s[n],c=this.getTerminalView(e),h=this.getTerminalView(n),f=this.getTerminalMagnet(e),d=this.getTerminalMagnet(n);c?(a=t?av.create(t):h?d:av.create(u),r=this.getAnchor(l.anchor,c,f,a,e)):r=av.create(l);if(h){var v=av.create(i||r);o=this.getAnchor(u.anchor,h,d,v,n)}else o=av.isPointLike(u)?av.create(u):new av;return O(O({},e,r),n,o)}},{key:"getAnchor",value:function(e,t,n,i,r){var o,a=t.isEdgeElement(n),s=this.graph.options.connecting,l="string"==typeof e?{name:e}:e;if(!l){var u=a?("source"===r?s.sourceEdgeAnchor:s.targetEdgeAnchor)||s.edgeAnchor:("source"===r?s.sourceAnchor:s.targetAnchor)||s.anchor;l="string"==typeof u?{name:u}:u}if(!l)throw new Error("Anchor should be specified.");var c=l.name;if(a){var h=zy.registry.get(c);if("function"!=typeof h)return zy.registry.onNotFound(c);o=Eh(h,this,t,n,i,l.args||{},r)}else{var f=Dy.registry.get(c);if("function"!=typeof f)return Dy.registry.onNotFound(c);o=Eh(f,this,t,n,i,l.args||{},r)}return o?o.round(this.POINT_ROUNDING):new av}},{key:"findRoutePoints",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.graph.options.connecting.router||Cm.presets.normal,i=this.cell.getRouter()||n;if("function"==typeof i)e=Eh(i,this,t,{},this);else{var r="string"==typeof i?i:i.name,o="string"==typeof i?{}:i.args||{},a=r?Cm.registry.get(r):Cm.presets.normal;if("function"!=typeof a)return Cm.registry.onNotFound(r);e=Eh(a,this,t,o,this)}return null==e?t.map((function(e){return av.create(e)})):e.map((function(e){return av.create(e)}))}},{key:"findConnectionPoints",value:function(e,t,n){var i,r,o=this.cell,a=this.graph.options.connecting,s=o.getSource(),l=o.getTarget(),u=this.sourceView,c=this.targetView,h=e[0],f=e[e.length-1];if(u&&!u.isEdgeElement(this.sourceMagnet)){var d=this.sourceMagnet||u.container,v=new lv(h||n,t),g=s.connectionPoint||a.sourceConnectionPoint||a.connectionPoint;i=this.getConnectionPoint(g,u,d,v,"source")}else i=t;if(c&&!c.isEdgeElement(this.targetMagnet)){var p=this.targetMagnet||c.container,y=l.connectionPoint||a.targetConnectionPoint||a.connectionPoint,m=new lv(f||t,n);r=this.getConnectionPoint(y,c,p,m,"target")}else r=n;return{source:i,target:r}}},{key:"getConnectionPoint",value:function(e,t,n,i,r){var o=i.end;if(null==e)return o;var a="string"==typeof e?e:e.name,s="string"==typeof e?{}:e.args,l=Wy.registry.get(a);if("function"!=typeof l)return Wy.registry.onNotFound(a);var u=Eh(l,this,i,t,n,s||{},r);return u?u.round(this.POINT_ROUNDING):o}},{key:"findMarkerPoints",value:function(e,t,n){var i,r,o=this,a=function(e){for(var t=o.cell.getAttrs(),n=Object.keys(t),i=0,r=n.length;i<r;i+=1){var a=t[n[i]];if(a["".concat(e,"Marker")]||a["".concat(e,"-marker")]){var s=a.strokeWidth||a["stroke-width"];if(s)return parseFloat(s);break}}return null},s=e[0],l=e[e.length-1],u=a("source");u&&(i=t.clone().move(s||n,-u));var c=a("target");return c&&(r=n.clone().move(l||t,-c)),this.sourceMarkerPoint=i||t.clone(),this.targetMarkerPoint=r||n.clone(),{source:i,target:r}}},{key:"findPath",value:function(e,t,n){var i,r,o,a=this.cell.getConnector()||this.graph.options.connecting.connector;if("string"==typeof a?i=a:(i=a.name,r=a.args),i){var s=Lm.registry.get(i);if("function"!=typeof s)return Lm.registry.onNotFound(i);o=s}else o=Lm.presets.normal;var l=Eh(o,this,t,n,e,Object.assign(Object.assign({},r),{raw:!0}),this);return"string"==typeof l?Pv.parse(l):l}},{key:"translateConnectionPoints",value:function(e,t){this.sourcePoint.translate(e,t),this.targetPoint.translate(e,t),this.sourceAnchor.translate(e,t),this.targetAnchor.translate(e,t),this.sourceMarkerPoint.translate(e,t),this.targetMarkerPoint.translate(e,t)}},{key:"updateLabelPositions",value:function(){if(null==this.labelContainer)return this;if(!this.path)return this;var e=this.cell,t=e.getLabels();if(0===t.length)return this;for(var n=e.getDefaultLabel(),i=this.normalizeLabelPosition(n.position),r=0,o=t.length;r<o;r+=1){var a=t[r],s=this.labelCache[r];if(s){var l=this.normalizeLabelPosition(a.position),u=$e({},i,l),c=this.getLabelTransformationMatrix(u);s.setAttribute("transform",Ld(c))}}return this}},{key:"updateTerminalProperties",value:function(e){var t=this.cell,n=this.graph,i=t[e],r=i&&i.cell,o="".concat(e,"View");if(!r)return this[o]=null,this.updateTerminalMagnet(e),!0;var a=n.getCellById(r);if(!a)throw new Error("Edge's ".concat(e,' node with id "').concat(r,'" not exists'));var s=a.findView(n);return!!s&&(this[o]=s,this.updateTerminalMagnet(e),!0)}},{key:"updateTerminalMagnet",value:function(e){var t="".concat(e,"Magnet"),n=this.getTerminalView(e);if(n){var i=n.getMagnetFromEdgeTerminal(this.cell[e]);i===n.container&&(i=null),this[t]=i}else this[t]=null}},{key:"getLabelPositionAngle",value:function(e){var t=this.cell.getLabelAt(e);return t&&t.position&&"object"===d(t.position)&&t.position.angle||0}},{key:"getLabelPositionArgs",value:function(e){var t=this.cell.getLabelAt(e);if(t&&t.position&&"object"===d(t.position))return t.position.options}},{key:"getDefaultLabelPositionArgs",value:function(){var e=this.cell.getDefaultLabel();if(e&&e.position&&"object"===d(e.position))return e.position.options}},{key:"mergeLabelPositionArgs",value:function(e,t){return null===e?null:void 0===e?null===t?null:t:$e({},t,e)}},{key:"getConnection",value:function(){return null!=this.path?this.path.clone():null}},{key:"getConnectionPathData",value:function(){if(null==this.path)return"";var e=this.cache.pathCache;return ut(e,"data")||(e.data=this.path.serialize()),e.data||""}},{key:"getConnectionSubdivisions",value:function(){if(null==this.path)return null;var e=this.cache.pathCache;return ut(e,"segmentSubdivisions")||(e.segmentSubdivisions=this.path.getSegmentSubdivisions()),e.segmentSubdivisions}},{key:"getConnectionLength",value:function(){if(null==this.path)return 0;var e=this.cache.pathCache;return ut(e,"length")||(e.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),e.length}},{key:"getPointAtLength",value:function(e){return null==this.path?null:this.path.pointAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getPointAtRatio",value:function(e){return null==this.path?null:(qh(e)&&(e=parseFloat(e)/100),this.path.pointAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()}))}},{key:"getTangentAtLength",value:function(e){return null==this.path?null:this.path.tangentAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getTangentAtRatio",value:function(e){return null==this.path?null:this.path.tangentAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPoint",value:function(e){return null==this.path?null:this.path.closestPoint(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPointLength",value:function(e){return null==this.path?null:this.path.closestPointLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPointRatio",value:function(e){return null==this.path?null:this.path.closestPointNormalizedLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getLabelPosition",value:function(e,t,n,i){var r,o={distance:0},a=0;"number"==typeof n?(a=n,r=i):r=n,null!=r&&(o.options=r);var s,l,u=r&&r.absoluteOffset,c=!(r&&r.absoluteDistance),h=r&&r.absoluteDistance&&r.reverseDistance,f=this.path,d={segmentSubdivisions:this.getConnectionSubdivisions()},v=new av(e,t),g=f.closestPointT(v,d),p=this.getConnectionLength()||0,y=f.lengthAtT(g,d);if(c&&(y=p>0?y/p:0),h&&(y=-1*(p-y)||1),o.distance=y,u||(s=f.tangentAtT(g)),s)l=s.pointOffset(v);else{var m=f.pointAtT(g),w=v.diff(m);l={x:w.x,y:w.y}}return o.offset=l,o.angle=a,o}},{key:"normalizeLabelPosition",value:function(e){return"number"==typeof e?{distance:e}:e}},{key:"getLabelTransformationMatrix",value:function(e){var t=this.normalizeLabelPosition(e),n=t.options||{},i=t.angle||0,r=t.distance,o=r>0&&r<=1,a=0,s={x:0,y:0},l=t.offset;l&&("number"==typeof l?a=l:(null!=l.x&&(s.x=l.x),null!=l.y&&(s.y=l.y)));var u,c=0!==s.x||0!==s.y||0===a,h=n.keepGradient,f=n.ensureLegibility,d=this.path,v={segmentSubdivisions:this.getConnectionSubdivisions()},g=o?r*this.getConnectionLength():r,p=d.tangentAtLength(g,v),y=i;if(p){if(c)(u=p.start).translate(s);else{var m=p.clone();m.rotate(-90,p.start),m.setLength(a),u=m.end}h&&(y=p.angle()+i,f&&(y=nv.normalize((y+90)%180-90)))}else u=d.start,c&&u.translate(s);return Pd().translate(u.x,u.y).rotate(y)}},{key:"getVertexIndex",value:function(e,t){var n=this.cell.getVertices(),i=this.getClosestPointLength(new av(e,t)),r=0;if(null!=i)for(var o=n.length;r<o;r+=1){var a=n[r],s=this.getClosestPointLength(a);if(null!=s&&i<s)break}return r}},{key:"getEventArgs",value:function(e,t,n){var i=this,r=i.cell;return null==t||null==n?{e:e,view:i,edge:r,cell:r}:{e:e,x:t,y:n,view:i,edge:r,cell:r}}},{key:"notifyUnhandledMouseDown",value:function(e,t,n){this.notify("edge:unhandled:mousedown",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}},{key:"notifyMouseDown",value:function(e,n,i){o(t,"onMouseDown",this,3)([e,n,i]),this.notify("edge:mousedown",this.getEventArgs(e,n,i))}},{key:"notifyMouseMove",value:function(e,n,i){o(t,"onMouseMove",this,3)([e,n,i]),this.notify("edge:mousemove",this.getEventArgs(e,n,i))}},{key:"notifyMouseUp",value:function(e,n,i){o(t,"onMouseUp",this,3)([e,n,i]),this.notify("edge:mouseup",this.getEventArgs(e,n,i))}},{key:"onClick",value:function(e,n,i){o(t,"onClick",this,3)([e,n,i]),this.notify("edge:click",this.getEventArgs(e,n,i))}},{key:"onDblClick",value:function(e,n,i){o(t,"onDblClick",this,3)([e,n,i]),this.notify("edge:dblclick",this.getEventArgs(e,n,i))}},{key:"onContextMenu",value:function(e,n,i){o(t,"onContextMenu",this,3)([e,n,i]),this.notify("edge:contextmenu",this.getEventArgs(e,n,i))}},{key:"onMouseDown",value:function(e,t,n){this.notifyMouseDown(e,t,n),this.startEdgeDragging(e,t,n)}},{key:"onMouseMove",value:function(e,t,n){var i=this.getEventData(e);switch(i.action){case"drag-label":this.dragLabel(e,t,n);break;case"drag-arrowhead":this.dragArrowhead(e,t,n);break;case"drag-edge":this.dragEdge(e,t,n)}return this.notifyMouseMove(e,t,n),i}},{key:"onMouseUp",value:function(e,t,n){var i=this.getEventData(e);switch(i.action){case"drag-label":this.stopLabelDragging(e,t,n);break;case"drag-arrowhead":this.stopArrowheadDragging(e,t,n);break;case"drag-edge":this.stopEdgeDragging(e,t,n)}return this.notifyMouseUp(e,t,n),this.checkMouseleave(e),i}},{key:"onMouseOver",value:function(e){o(t,"onMouseOver",this,3)([e]),this.notify("edge:mouseover",this.getEventArgs(e))}},{key:"onMouseOut",value:function(e){o(t,"onMouseOut",this,3)([e]),this.notify("edge:mouseout",this.getEventArgs(e))}},{key:"onMouseEnter",value:function(e){o(t,"onMouseEnter",this,3)([e]),this.notify("edge:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){o(t,"onMouseLeave",this,3)([e]),this.notify("edge:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,n,i,r){o(t,"onMouseWheel",this,3)([e,n,i,r]),this.notify("edge:mousewheel",Object.assign({delta:r},this.getEventArgs(e,n,i)))}},{key:"onCustomEvent",value:function(e,n,i,r){if(Tf(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if("edge:remove"===n)return void this.cell.remove({ui:!0});this.notify("edge:customevent",Object.assign({name:n},this.getEventArgs(e,i,r)))}this.notifyMouseDown(e,i,r)}else this.notify("edge:customevent",Object.assign({name:n},this.getEventArgs(e,i,r))),o(t,"onCustomEvent",this,3)([e,n,i,r])}},{key:"onLabelMouseDown",value:function(e,t,n){this.notifyMouseDown(e,t,n),this.startLabelDragging(e,t,n),this.getEventData(e).stopPropagation&&e.stopPropagation()}},{key:"startEdgeDragging",value:function(e,t,n){this.can("edgeMovable")?this.setEventData(e,{x:t,y:n,moving:!1,action:"drag-edge"}):this.notifyUnhandledMouseDown(e,t,n)}},{key:"dragEdge",value:function(e,t,n){var i=this.getEventData(e);i.moving||(i.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(t-i.x,n-i.y,{ui:!0}),this.setEventData(e,{x:t,y:n}),this.notify("edge:moving",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}},{key:"stopEdgeDragging",value:function(e,t,n){var i=this.getEventData(e);i.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),i.moving=!1}},{key:"prepareArrowheadDragging",value:function(e,t){var n=this.getTerminalMagnet(e),i={action:"drag-arrowhead",x:t.x,y:t.y,isNewEdge:!0===t.isNewEdge,terminalType:e,initialMagnet:n,initialTerminal:ct(this.cell[e]),fallbackAction:t.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(e),options:t.options};return this.beforeArrowheadDragging(i),i}},{key:"createValidateConnectionArgs",value:function(e){var t,n=[];n[4]=e,n[5]=this;var i=0,r=0;"source"===e?(i=2,t="target"):(r=2,t="source");var o=this.cell[t],a=o.cell;if(a){var s,l=n[i]=this.graph.findViewByCell(a);l&&(s=l.getMagnetFromEdgeTerminal(o))===l.container&&(s=void 0),n[i+1]=s}return function(e,t){return n[r]=e,n[r+1]=e.container===t?void 0:t,n}}},{key:"beforeArrowheadDragging",value:function(e){e.zIndex=this.cell.zIndex,this.cell.toFront();var t=this.container.style;e.pointerEvents=t.pointerEvents,t.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(e)}},{key:"afterArrowheadDragging",value:function(e){null!=e.zIndex&&(this.cell.setZIndex(e.zIndex,{ui:!0}),e.zIndex=null),this.container.style.pointerEvents=e.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(e)}},{key:"validateConnection",value:function(e,n,i,r,o,a,s){var l=this,u=this.graph.options.connecting,c=u.allowLoop,h=u.allowNode,f=u.allowEdge,d=u.allowPort,v=u.allowMulti,g=u.validateConnection,p=a?a.cell:null,y="target"===o?i:e,m="target"===o?r:n,w=!0,b=function(t){var u="source"===o?s?s.port:null:p?p.getSourcePortId():null,c="target"===o?s?s.port:null:p?p.getTargetPortId():null;return Eh(t,l.graph,{edge:p,edgeView:a,sourceView:e,targetView:i,sourcePort:u,targetPort:c,sourceMagnet:n,targetMagnet:r,sourceCell:e?e.cell:null,targetCell:i?i.cell:null,type:o})};if(null!=c&&("boolean"==typeof c?c||e!==i||(w=!1):w=b(c)),w&&null!=d&&("boolean"==typeof d?!d&&m&&(w=!1):w=b(d)),w&&null!=f&&("boolean"==typeof f?!f&&t.isEdgeView(y)&&(w=!1):w=b(f)),w&&null!=h&&null==m&&("boolean"==typeof h?!h&&aw.isNodeView(y)&&(w=!1):w=b(h)),w&&null!=v&&a){var k=a.cell,x="source"===o?s:k.getSource(),C="target"===o?s:k.getTarget(),E=s?this.graph.getCellById(s.cell):null;if(x&&C&&x.cell&&C.cell&&E)if("function"==typeof v)w=b(v);else{var S=this.graph.model.getConnectedEdges(E,{outgoing:"source"===o,incoming:"target"===o});if(S.length)if("withPort"===v){var M=S.some((function(e){var t=e.getSource(),n=e.getTarget();return t&&n&&t.cell===x.cell&&n.cell===C.cell&&null!=t.port&&t.port===x.port&&null!=n.port&&n.port===C.port}));M&&(w=!1)}else if(!v){var A=S.some((function(e){var t=e.getSource(),n=e.getTarget();return t&&n&&t.cell===x.cell&&n.cell===C.cell}));A&&(w=!1)}}}return w&&null!=g&&(w=b(g)),w}},{key:"allowConnectToBlank",value:function(e){var t=this.graph,n=t.options.connecting.allowBlank;if("function"!=typeof n)return!!n;var i=t.findViewByCell(e),r=e.getSourceCell(),o=e.getTargetCell(),a=t.findViewByCell(r),s=t.findViewByCell(o);return Eh(n,t,{edge:e,edgeView:i,sourceCell:r,targetCell:o,sourceView:a,targetView:s,sourcePort:e.getSourcePortId(),targetPort:e.getTargetPortId(),sourceMagnet:i.sourceMagnet,targetMagnet:i.targetMagnet})}},{key:"validateEdge",value:function(e,t,n){var i=this.graph;if(!this.allowConnectToBlank(e)){var r=e.getSourceCellId(),o=e.getTargetCellId();if(!r||!o)return!1}var a=i.options.connecting.validateEdge;return!a||Eh(a,i,{edge:e,type:t,previous:n})}},{key:"arrowheadDragging",value:function(e,t,n,i){i.x=t,i.y=n,i.currentTarget!==e&&(i.currentMagnet&&i.currentView&&i.currentView.unhighlight(i.currentMagnet,{type:"magnetAdsorbed"}),i.currentView=this.graph.findViewByElem(e),i.currentView?(i.currentMagnet=i.currentView.findMagnet(e),i.currentMagnet&&this.validateConnection.apply(this,v(i.getValidateConnectionArgs(i.currentView,i.currentMagnet)).concat([i.currentView.getEdgeTerminal(i.currentMagnet,t,n,this.cell,i.terminalType)]))?i.currentView.highlight(i.currentMagnet,{type:"magnetAdsorbed"}):i.currentMagnet=null):i.currentMagnet=null),i.currentTarget=e,this.cell.prop(i.terminalType,{x:t,y:n},Object.assign(Object.assign({},i.options),{ui:!0}))}},{key:"arrowheadDragged",value:function(e,t,n){var i=e.currentView,r=e.currentMagnet;if(r&&i){i.unhighlight(r,{type:"magnetAdsorbed"});var o=e.terminalType,a=i.getEdgeTerminal(r,t,n,this.cell,o);this.cell.setTerminal(o,a,{ui:!0})}}},{key:"snapArrowhead",value:function(e,t,n){var i=this,r=this.graph,o=r.options.connecting,a=o.snap,s=o.allowEdge,l="object"===d(a)&&a.radius||50,u="object"===d(a)&&a.anchor||"center",c=r.renderer.findViewsInArea({x:e-l,y:t-l,width:2*l,height:2*l},{nodeOnly:!0});if(s){var h=r.renderer.findEdgeViewsFromPoint({x:e,y:t},l).filter((function(e){return e!==i}));c.push.apply(c,v(h))}var f,g=n.closestView||null,p=n.closestMagnet||null;n.closestView=null,n.closestMagnet=null;var y,m=Number.MAX_SAFE_INTEGER,w=new av(e,t);c.forEach((function(r){if("false"!==r.container.getAttribute("magnet")){if(r.isNodeView())f="center"===u?r.cell.getBBox().getCenter().distance(w):r.cell.getBBox().getNearestPointToPoint(w).distance(w);else if(r.isEdgeView()){var o=r.getClosestPoint(w);f=o?o.distance(w):Number.MAX_SAFE_INTEGER}f<l&&f<m&&(p===r.container||i.validateConnection.apply(i,v(n.getValidateConnectionArgs(r,null)).concat([r.getEdgeTerminal(r.container,e,t,i.cell,n.terminalType)])))&&(m=f,n.closestView=r,n.closestMagnet=r.container)}r.container.querySelectorAll("[magnet]").forEach((function(o){if("false"!==o.getAttribute("magnet")){var a=r.getBBoxOfElement(o);(f=w.distance(a.getCenter()))<l&&f<m&&(p===o||i.validateConnection.apply(i,v(n.getValidateConnectionArgs(r,o)).concat([r.getEdgeTerminal(o,e,t,i.cell,n.terminalType)])))&&(m=f,n.closestView=r,n.closestMagnet=o)}}))}));var b=n.terminalType,k=n.closestView,x=n.closestMagnet,C=p!==x;if(g&&C&&g.unhighlight(p,{type:"magnetAdsorbed"}),k){if(!C)return;k.highlight(x,{type:"magnetAdsorbed"}),y=k.getEdgeTerminal(x,e,t,this.cell,b)}else y={x:e,y:t};this.cell.setTerminal(b,y,{},Object.assign(Object.assign({},n.options),{ui:!0}))}},{key:"snapArrowheadEnd",value:function(e){var t=e.closestView,n=e.closestMagnet;t&&n&&(t.unhighlight(n,{type:"magnetAdsorbed"}),e.currentMagnet=t.findMagnet(n)),e.closestView=null,e.closestMagnet=null}},{key:"finishEmbedding",value:function(e){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(e.zIndex=null)}},{key:"fallbackConnection",value:function(e){if("remove"===e.fallbackAction)this.cell.remove({ui:!0});else this.cell.prop(e.terminalType,e.initialTerminal,{ui:!0})}},{key:"notifyConnectionEvent",value:function(e,t){var n=e.terminalType,i=e.initialTerminal,r=this.cell[n];if(r&&!Gm.equalTerminals(i,r)){var o=this.graph,a=i,s=a.cell?o.getCellById(a.cell):null,l=a.port,u=s?o.findViewByCell(s):null,c=s||e.isNewEdge?null:av.create(i).toJSON(),h=r,f=h.cell?o.getCellById(h.cell):null,d=h.port,v=f?o.findViewByCell(f):null,g=f?null:av.create(r).toJSON();this.notify("edge:connected",{e:t,previousCell:s,previousPort:l,previousView:u,previousPoint:c,currentCell:f,currentView:v,currentPort:d,currentPoint:g,previousMagnet:e.initialMagnet,currentMagnet:e.currentMagnet,edge:this.cell,view:this,type:n,isNew:e.isNewEdge})}}},{key:"highlightAvailableMagnets",value:function(e){var t=this,n=this.graph,i=n.model.getCells();e.marked={};for(var r=function(){var r=n.findViewByCell(i[o]);if(!r||r.cell.id===t.cell.id)return 1;var a=Array.prototype.slice.call(r.container.querySelectorAll("[magnet]"));"false"!==r.container.getAttribute("magnet")&&a.push(r.container);var s=a.filter((function(n){return t.validateConnection.apply(t,v(e.getValidateConnectionArgs(r,n)).concat([r.getEdgeTerminal(n,e.x,e.y,t.cell,e.terminalType)]))}));if(s.length>0){for(var l=0,u=s.length;l<u;l+=1)r.highlight(s[l],{type:"magnetAvailable"});r.highlight(null,{type:"nodeAvailable"}),e.marked[r.cell.id]=s}},o=0,a=i.length;o<a;o+=1)r()}},{key:"unhighlightAvailableMagnets",value:function(e){var t=this,n=e.marked||{};Object.keys(n).forEach((function(e){var i=t.graph.findViewByCell(e);i&&(n[e].forEach((function(e){i.unhighlight(e,{type:"magnetAvailable"})})),i.unhighlight(null,{type:"nodeAvailable"}))})),e.marked=null}},{key:"startArrowheadDragging",value:function(e,t,n){if(this.can("arrowheadMovable")){var i=e.target.getAttribute("data-terminal"),r=this.prepareArrowheadDragging(i,{x:t,y:n});this.setEventData(e,r)}else this.notifyUnhandledMouseDown(e,t,n)}},{key:"dragArrowhead",value:function(e,t,n){var i=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(t,n,i):this.arrowheadDragging(this.getEventTarget(e),t,n,i)}},{key:"stopArrowheadDragging",value:function(e,t,n){var i=this.graph,r=this.getEventData(e);i.options.connecting.snap?this.snapArrowheadEnd(r):this.arrowheadDragged(r,t,n),this.validateEdge(this.cell,r.terminalType,r.initialTerminal)?(this.finishEmbedding(r),this.notifyConnectionEvent(r,e)):this.fallbackConnection(r),this.afterArrowheadDragging(r)}},{key:"startLabelDragging",value:function(e,t,n){if(this.can("edgeLabelMovable")){var i=e.currentTarget,r=parseInt(i.getAttribute("data-index"),10),o=this.getLabelPositionAngle(r),a=this.getLabelPositionArgs(r),s=this.getDefaultLabelPositionArgs(),l=this.mergeLabelPositionArgs(a,s);this.setEventData(e,{index:r,positionAngle:o,positionArgs:l,stopPropagation:!0,action:"drag-label"})}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this)}},{key:"dragLabel",value:function(e,t,n){var i=this.getEventData(e),r=this.cell.getLabelAt(i.index),o=$e({},r,{position:this.getLabelPosition(t,n,i.positionAngle,i.positionArgs)});this.cell.setLabelAt(i.index,o)}},{key:"stopLabelDragging",value:function(e,t,n){}}])}(Xp);!function(e){e.toStringTag="X6.".concat(e.name),e.isEdgeView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],i=t;return(null==n||n===e.toStringTag)&&"function"==typeof i.isNodeView&&"function"==typeof i.isEdgeView&&"function"==typeof i.confirmUpdate&&"function"==typeof i.update&&"function"==typeof i.getConnection}}(lw||(lw={})),lw.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),lw.registry.register("edge",lw,!0);var uw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},cw=function(e){function t(e){var n;A(this,t),(n=s(this,t)).graph=e;var i=Gp.parseJSONMarkup(t.markup),r=i.selectors,o=i.fragment;return n.background=r.background,n.grid=r.grid,n.svg=r.svg,n.defs=r.defs,n.viewport=r.viewport,n.primer=r.primer,n.stage=r.stage,n.decorator=r.decorator,n.overlay=r.overlay,n.container=n.options.container,n.restore=t.snapshoot(n.container),wf(n.container,n.prefixClassName("graph")),Df(n.container,o),n.delegateEvents(),n}return h(t,e),P(t,[{key:"disposeContainer",get:function(){return!1}},{key:"options",get:function(){return this.graph.options}},{key:"delegateEvents",value:function(){var e=this.constructor;return o(t,"delegateEvents",this,3)([e.events]),this}},{key:"guard",value:function(e,t){return"mousedown"===e.type&&2===e.button||(!(!this.options.guard||!this.options.guard(e,t))||(e.data&&void 0!==e.data.guarded?e.data.guarded:!(t&&t.cell&&Fm.isCell(t.cell))&&(this.svg!==e.target&&this.container!==e.target&&!this.svg.contains(e.target))))}},{key:"findView",value:function(e){return this.graph.findViewByElem(e)}},{key:"onDblClick",value:function(e){this.options.preventDefaultDblClick&&e.preventDefault();var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onDblClick(t,i.x,i.y):this.graph.trigger("blank:dblclick",{e:t,x:i.x,y:i.y})}}},{key:"onClick",value:function(e){if(this.getMouseMovedCount(e)<=this.options.clickThreshold){var t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;var i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onClick(t,i.x,i.y):this.graph.trigger("blank:click",{e:t,x:i.x,y:i.y})}}},{key:"isPreventDefaultContextMenu",value:function(e){var t=this.options.preventDefaultContextMenu;return"function"==typeof t&&(t=Eh(t,this.graph,{view:e})),t}},{key:"onContextMenu",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(this.isPreventDefaultContextMenu(n)&&e.preventDefault(),!this.guard(t,n)){var i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onContextMenu(t,i.x,i.y):this.graph.trigger("blank:contextmenu",{e:t,x:i.x,y:i.y})}}},{key:"delegateDragEvents",value:function(e,t){null==e.data&&(e.data={}),this.setEventData(e,{currentView:t||null,mouseMovedCount:0,startPosition:{x:e.clientX,y:e.clientY}});var n=this.constructor;this.delegateDocumentEvents(n.documentEvents,e.data),this.undelegateEvents()}},{key:"getMouseMovedCount",value:function(e){return this.getEventData(e).mouseMovedCount||0}},{key:"onMouseDown",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){this.options.preventDefaultMouseDown&&e.preventDefault();var i=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onMouseDown(t,i.x,i.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(t.type)&&e.preventDefault(),this.graph.trigger("blank:mousedown",{e:t,x:i.x,y:i.y})),this.delegateDragEvents(t,n)}}},{key:"onMouseMove",value:function(e){var t=this.getEventData(e),n=t.startPosition;if((!n||n.x!==e.clientX||n.y!==e.clientY)&&(null==t.mouseMovedCount&&(t.mouseMovedCount=0),t.mouseMovedCount+=1,!(t.mouseMovedCount<=this.options.moveThreshold))){var i=this.normalizeEvent(e),r=this.graph.snapToGrid(i.clientX,i.clientY),o=t.currentView;o?o.onMouseMove(i,r.x,r.y):this.graph.trigger("blank:mousemove",{e:i,x:r.x,y:r.y}),this.setEventData(i,t)}}},{key:"onMouseUp",value:function(e){this.undelegateDocumentEvents();var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY),i=this.getEventData(e).currentView;if(i?i.onMouseUp(t,n.x,n.y):this.graph.trigger("blank:mouseup",{e:t,x:n.x,y:n.y}),!e.isPropagationStopped()){var r=new Fd(e,{type:"click",data:e.data});this.onClick(r)}e.stopImmediatePropagation(),this.delegateEvents()}},{key:"onMouseOver",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOver(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseover",{e:t})}}},{key:"onMouseOut",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOut(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseout",{e:t})}}},{key:"onMouseEnter",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var i=this.graph.findViewByElem(t.relatedTarget);if(n){if(i===n)return;n.onMouseEnter(t)}else{if(i)return;this.graph.trigger("graph:mouseenter",{e:t})}}}},{key:"onMouseLeave",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var i=this.graph.findViewByElem(t.relatedTarget);if(n){if(i===n)return;n.onMouseLeave(t)}else{if(i)return;this.graph.trigger("graph:mouseleave",{e:t})}}}},{key:"onMouseWheel",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var i=t.originalEvent,r=this.graph.snapToGrid(i.clientX,i.clientY),o=Math.max(-1,Math.min(1,i.wheelDelta||-i.detail));n?n.onMouseWheel(t,r.x,r.y,o):this.graph.trigger("blank:mousewheel",{e:t,delta:o,x:r.x,y:r.y})}}},{key:"onCustomEvent",value:function(e){var t=e.currentTarget,n=t.getAttribute("event")||t.getAttribute("data-event");if(n){var i=this.findView(t);if(i){var r=this.normalizeEvent(e);if(this.guard(r,i))return;var o=this.graph.snapToGrid(r.clientX,r.clientY);i.onCustomEvent(r,n,o.x,o.y)}}}},{key:"handleMagnetEvent",value:function(e,t){var n=e.currentTarget,i=n.getAttribute("magnet");if(i&&"false"!==i.toLowerCase()){var r=this.findView(n);if(r){var o=this.normalizeEvent(e);if(this.guard(o,r))return;var a=this.graph.snapToGrid(o.clientX,o.clientY);Eh(t,this.graph,r,o,n,a.x,a.y)}}}},{key:"onMagnetMouseDown",value:function(e){this.handleMagnetEvent(e,(function(e,t,n,i,r){e.onMagnetMouseDown(t,n,i,r)}))}},{key:"onMagnetDblClick",value:function(e){this.handleMagnetEvent(e,(function(e,t,n,i,r){e.onMagnetDblClick(t,n,i,r)}))}},{key:"onMagnetContextMenu",value:function(e){var t=this.findView(e.target);this.isPreventDefaultContextMenu(t)&&e.preventDefault(),this.handleMagnetEvent(e,(function(e,t,n,i,r){e.onMagnetContextMenu(t,n,i,r)}))}},{key:"onLabelMouseDown",value:function(e){var t=e.currentTarget,n=this.findView(t);if(n){var i=this.normalizeEvent(e);if(this.guard(i,n))return;var r=this.graph.snapToGrid(i.clientX,i.clientY);n.onLabelMouseDown(i,r.x,r.y)}}},{key:"onImageDragStart",value:function(){return!1}},{key:"dispose",value:function(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=function(){}}}])}(qp);uw([qp.dispose()],cw.prototype,"dispose",null),function(e){var t="".concat(yp.prefixCls,"-graph");e.markup=[{ns:Sf.xhtml,tagName:"div",selector:"background",className:"".concat(t,"-background")},{ns:Sf.xhtml,tagName:"div",selector:"grid",className:"".concat(t,"-grid")},{ns:Sf.svg,tagName:"svg",selector:"svg",className:"".concat(t,"-svg"),attrs:{width:"100%",height:"100%","xmlns:xlink":Sf.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:"".concat(t,"-svg-viewport"),children:[{tagName:"g",selector:"primer",className:"".concat(t,"-svg-primer")},{tagName:"g",selector:"stage",className:"".concat(t,"-svg-stage")},{tagName:"g",selector:"decorator",className:"".concat(t,"-svg-decorator")},{tagName:"g",selector:"overlay",className:"".concat(t,"-svg-overlay")}]}]}],e.snapshoot=function(e){var t=e.cloneNode();return e.childNodes.forEach((function(e){return t.appendChild(e)})),function(){for(Nf(e);e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);for(var n=0,i=t.attributes.length;n<i;n+=1){var r=t.attributes[n];e.setAttribute(r.name,r.value)}t.childNodes.forEach((function(t){return e.appendChild(t)}))}}}(cw||(cw={})),function(e,t){var n=yp.prefixCls;e.events=(O(O(O(O(O(O(O(O(O(O(t={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel"},"mouseenter  .".concat(n,"-cell"),"onMouseEnter"),"mouseleave  .".concat(n,"-cell"),"onMouseLeave"),"mouseenter  .".concat(n,"-cell-tools"),"onMouseEnter"),"mouseleave  .".concat(n,"-cell-tools"),"onMouseLeave"),"mousedown   .".concat(n,"-cell [event]"),"onCustomEvent"),"touchstart  .".concat(n,"-cell [event]"),"onCustomEvent"),"mousedown   .".concat(n,"-cell [data-event]"),"onCustomEvent"),"touchstart  .".concat(n,"-cell [data-event]"),"onCustomEvent"),"dblclick    .".concat(n,"-cell [magnet]"),"onMagnetDblClick"),"contextmenu .".concat(n,"-cell [magnet]"),"onMagnetContextMenu"),O(O(O(O(O(O(O(O(O(t,"mousedown   .".concat(n,"-cell [magnet]"),"onMagnetMouseDown"),"touchstart  .".concat(n,"-cell [magnet]"),"onMagnetMouseDown"),"dblclick    .".concat(n,"-cell [data-magnet]"),"onMagnetDblClick"),"contextmenu .".concat(n,"-cell [data-magnet]"),"onMagnetContextMenu"),"mousedown   .".concat(n,"-cell [data-magnet]"),"onMagnetMouseDown"),"touchstart  .".concat(n,"-cell [data-magnet]"),"onMagnetMouseDown"),"dragstart   .".concat(n,"-cell image"),"onImageDragStart"),"mousedown   .".concat(n,"-edge .").concat(n,"-edge-label"),"onLabelMouseDown"),"touchstart  .".concat(n,"-edge .").concat(n,"-edge-label"),"onLabelMouseDown")),e.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(cw||(cw={}));var hw=function(e){function t(e){var n;return A(this,t),(n=s(this,t)).graph=e,n.init(),n}return h(t,e),P(t,[{key:"options",get:function(){return this.graph.options}},{key:"model",get:function(){return this.graph.model}},{key:"view",get:function(){return this.graph.view}},{key:"init",value:function(){}}])}(kh),fw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},dw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"init",value:function(){!function(e,t){var n=rv.find((function(t){return t.name===e}));if(!(n&&(n.loadTimes+=1,n.loadTimes>1)||Wh.isApplyingHMR())){var i=document.createElement("style");i.setAttribute("type","text/css"),i.textContent=t;var r=document.querySelector("head");r&&r.insertBefore(i,r.firstChild),rv.push({name:e,loadTimes:1,styleElement:i})}}("core",".x6-graph {\n  position: relative;\n  overflow: hidden;\n  outline: none;\n  touch-action: none;\n}\n.x6-graph-background,\n.x6-graph-grid,\n.x6-graph-svg {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-background-stage,\n.x6-graph-grid-stage,\n.x6-graph-svg-stage {\n  user-select: none;\n}\n.x6-graph.x6-graph-pannable {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph.x6-graph-panning {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-node {\n  cursor: move;\n  /* stylelint-disable-next-line */\n}\n.x6-node.x6-node-immovable {\n  cursor: default;\n}\n.x6-node * {\n  -webkit-user-drag: none;\n}\n.x6-node .scalable * {\n  vector-effect: non-scaling-stroke;\n}\n.x6-node [magnet='true'] {\n  cursor: crosshair;\n  transition: opacity 0.3s;\n}\n.x6-node [magnet='true']:hover {\n  opacity: 0.7;\n}\n.x6-node foreignObject {\n  display: block;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-node foreignObject > body {\n  position: static;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-edge .source-marker,\n.x6-edge .target-marker {\n  vector-effect: non-scaling-stroke;\n}\n.x6-edge .connection {\n  stroke-linejoin: round;\n  fill: none;\n}\n.x6-edge .connection-wrap {\n  cursor: move;\n  opacity: 0;\n  fill: none;\n  stroke: #000;\n  stroke-width: 15;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n.x6-edge .connection-wrap:hover {\n  opacity: 0.4;\n  stroke-opacity: 0.4;\n}\n.x6-edge .vertices {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .vertices .vertex {\n  fill: #1abc9c;\n}\n.x6-edge .vertices .vertex :hover {\n  fill: #34495e;\n  stroke: none;\n}\n.x6-edge .vertices .vertex-remove {\n  cursor: pointer;\n  fill: #fff;\n}\n.x6-edge .vertices .vertex-remove-area {\n  cursor: pointer;\n  opacity: 0.1;\n}\n.x6-edge .vertices .vertex-group:hover .vertex-remove-area {\n  opacity: 1;\n}\n.x6-edge .arrowheads {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .arrowheads .arrowhead {\n  fill: #1abc9c;\n}\n.x6-edge .arrowheads .arrowhead :hover {\n  fill: #f39c12;\n  stroke: none;\n}\n.x6-edge .tools {\n  cursor: pointer;\n  opacity: 0;\n}\n.x6-edge .tools .tool-options {\n  display: none;\n}\n.x6-edge .tools .tool-remove circle {\n  fill: #f00;\n}\n.x6-edge .tools .tool-remove path {\n  fill: #fff;\n}\n.x6-edge:hover .vertices,\n.x6-edge:hover .arrowheads,\n.x6-edge:hover .tools {\n  opacity: 1;\n}\n.x6-highlight-opacity {\n  opacity: 0.3;\n}\n.x6-cell-tool-editor {\n  position: relative;\n  display: inline-block;\n  min-height: 1em;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n  white-space: normal;\n  text-align: center;\n  vertical-align: top;\n  overflow-wrap: normal;\n  outline: none;\n  transform-origin: 0 0;\n  -webkit-user-drag: none;\n}\n.x6-edge-tool-editor {\n  border: 1px solid #275fc5;\n  border-radius: 2px;\n}\n")}},{key:"dispose",value:function(){!function(e){var t=rv.findIndex((function(t){return t.name===e}));if(t>-1){var n=rv[t];if(n.loadTimes-=1,n.loadTimes>0)return;var i=n.styleElement;i&&i.parentNode&&i.parentNode.removeChild(i),i=null,rv.splice(t,1)}}("core")}}])}(hw);fw([dw.dispose()],dw.prototype,"dispose",null);var vw,gw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};!function(e){e.get=function(t){var n=t.grid,i=(t.panning,t.mousewheel,t.embedding,gw(t,["grid","panning","mousewheel","embedding"])),r=t.container;if(null==r)throw new Error("Ensure the container of the graph is specified and valid");null==i.width&&(i.width=r.clientWidth),null==i.height&&(i.height=r.clientHeight);var o=$e({},e.defaults,i),a={size:10,visible:!1};return o.grid="number"==typeof n?{size:n,visible:!1}:"boolean"==typeof n?Object.assign(Object.assign({},a),{visible:n}):Object.assign(Object.assign({},a),n),["panning","mousewheel","embedding"].forEach((function(e){var n=t[e];"boolean"==typeof n?o[e].enabled=n:o[e]=Object.assign(Object.assign({},o[e]),n)})),o}}(vw||(vw={})),function(e){e.defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:yp.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:yp.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection:function(e){var t=e.type,n=e.sourceView,i=e.targetView;return null!=("target"===t?i:n)},createEdge:function(){return new tw}},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:function(){return!0}},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:function(){return!1}}}(vw||(vw={}));var pw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},yw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},mw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"elem",get:function(){return this.view.grid}},{key:"grid",get:function(){return this.options.grid}},{key:"init",value:function(){this.startListening(),this.draw(this.grid)}},{key:"startListening",value:function(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}},{key:"stopListening",value:function(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}},{key:"setVisible",value:function(e){this.grid.visible!==e&&(this.grid.visible=e,this.update())}},{key:"getGridSize",value:function(){return this.grid.size}},{key:"setGridSize",value:function(e){this.grid.size=Math.max(e,1),this.update()}},{key:"show",value:function(){this.setVisible(!0),this.update()}},{key:"hide",value:function(){this.setVisible(!1),this.update()}},{key:"clear",value:function(){this.elem.style.backgroundImage=""}},{key:"draw",value:function(e){this.clear(),this.instance=null,Object.assign(this.grid,e),this.patterns=this.resolveGrid(e),this.update()}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.grid.size;if(t<=1||!this.grid.visible)return this.clear();var n=this.graph.matrix(),i=this.getInstance(),r=Array.isArray(e)?e:[e];this.patterns.forEach((function(e,o){var a="pattern_".concat(o),s=n.a||1,l=n.d||1,u=e.update,c=e.markup,h=yw(e,["update","markup"]),f=Object.assign(Object.assign(Object.assign({},h),r[o]),{sx:s,sy:l,ox:n.e||0,oy:n.f||0,width:t*s,height:t*l});i.has(a)||i.add(a,ud.create("pattern",{id:a,patternUnits:"userSpaceOnUse"},ud.createVectors(c)).node);var d=i.get(a);"function"==typeof u&&u(d.childNodes[0],f);var v=f.ox%f.width;v<0&&(v+=f.width);var g=f.oy%f.height;g<0&&(g+=f.height),qf(d,{x:v,y:g,width:f.width,height:f.height})}));var o=(new XMLSerializer).serializeToString(i.root),a="url(data:image/svg+xml;base64,".concat(btoa(o),")");this.elem.style.backgroundImage=a}},{key:"getInstance",value:function(){return this.instance||(this.instance=new Iv),this.instance}},{key:"resolveGrid",value:function(e){if(!e)return[];var t=e.type;if(null==t)return[Object.assign(Object.assign({},Iv.presets.dot),e.args)];var n=Iv.registry.get(t);if(n){var i=e.args||[];return Array.isArray(i)||(i=[i]),Array.isArray(n)?n.map((function(e,t){return Object.assign(Object.assign({},e),i[t])})):[Object.assign(Object.assign({},n),i[0])]}return Iv.registry.onNotFound(t)}},{key:"dispose",value:function(){this.stopListening(),this.clear()}}])}(hw);pw([hw.dispose()],mw.prototype,"dispose",null);var ww=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"container",get:function(){return this.graph.view.container}},{key:"viewport",get:function(){return this.graph.view.viewport}},{key:"stage",get:function(){return this.graph.view.stage}},{key:"init",value:function(){this.resize()}},{key:"getMatrix",value:function(){var e=this.viewport.getAttribute("transform");return e!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=e),Pd(this.viewportMatrix)}},{key:"setMatrix",value:function(e){var t=Pd(e),n=Ld(t);this.viewport.setAttribute("transform",n),this.viewportMatrix=t,this.viewportTransformString=n}},{key:"resize",value:function(e,t){var n=void 0===e?this.options.width:e,i=void 0===t?this.options.height:t;this.options.width=n,this.options.height=i,"number"==typeof n&&(n=Math.round(n)),"number"==typeof i&&(i=Math.round(i)),this.container.style.width=null==n?"":"".concat(n,"px"),this.container.style.height=null==i?"":"".concat(i,"px");var r=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},r)),this}},{key:"getComputedSize",value:function(){var e=this.options.width,t=this.options.height;return ht(e)||(e=this.container.clientWidth),ht(t)||(t=this.container.clientHeight),{width:e,height:t}}},{key:"getScale",value:function(){return(e=this.getMatrix())?(t=null==e.a?1:e.a,r=null==e.d?1:e.d,n=e.b,i=e.c):t=r=1,{sx:n?Math.sqrt(t*t+n*n):t,sy:i?Math.sqrt(i*i+r*r):r};var e,t,n,i,r}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e=this.clampScale(e),t=this.clampScale(t),n||i){var r=this.getTranslation(),o=r.tx-n*(e-1),a=r.ty-i*(t-1);o===r.tx&&a===r.ty||this.translate(o,a)}var s=this.getMatrix();return s.a=e,s.d=t,this.setMatrix(s),this.graph.trigger("scale",{sx:e,sy:t,ox:n,oy:i}),this}},{key:"clampScale",value:function(e){var t=this.graph.options.scaling;return Ge(e,t.min||.01,t.max||16)}},{key:"getZoom",value:function(){return this.getScale().sx}},{key:"zoom",value:function(e,t){t=t||{};var n=e,i=e,r=this.getScale(),o=this.getComputedSize(),a=o.width/2,s=o.height/2;if(t.absolute||(n+=r.sx,i+=r.sy),t.scaleGrid&&(n=Math.round(n/t.scaleGrid)*t.scaleGrid,i=Math.round(i/t.scaleGrid)*t.scaleGrid),t.maxScale&&(n=Math.min(t.maxScale,n),i=Math.min(t.maxScale,i)),t.minScale&&(n=Math.max(t.minScale,n),i=Math.max(t.minScale,i)),t.center&&(a=t.center.x,s=t.center.y),n=this.clampScale(n),i=this.clampScale(i),a||s){var l=this.getTranslation(),u=a-(a-l.tx)*(n/r.sx),c=s-(s-l.ty)*(i/r.sy);u===l.tx&&c===l.ty||this.translate(u,c)}return this.scale(n,i),this}},{key:"getRotation",value:function(){return function(e){var t={x:0,y:1};e&&(t=Nd(e,t));var n=180*Math.atan2(t.y,t.x)/Math.PI%360-90;return{angle:n%360+(n<0?360:0)}}(this.getMatrix())}},{key:"rotate",value:function(e,t,n){if(null==t||null==n){var i=pp.getBBox(this.stage);t=i.width/2,n=i.height/2}var r=this.getMatrix().translate(t,n).rotate(e).translate(-t,-n);return this.setMatrix(r),this}},{key:"getTranslation",value:function(){return{tx:(e=this.getMatrix())&&e.e||0,ty:e&&e.f||0};var e}},{key:"translate",value:function(e,t){var n=this.getMatrix();n.e=e||0,n.f=t||0,this.setMatrix(n);var i=this.getTranslation();return this.options.x=i.tx,this.options.y=i.ty,this.graph.trigger("translate",Object.assign({},i)),this}},{key:"setOrigin",value:function(e,t){return this.translate(e||0,t||0)}},{key:"fitToContent",value:function(e,t,n,i){if("object"===d(e)){var r=e;e=r.gridWidth||1,t=r.gridHeight||1,n=r.padding||0,i=r}else e=e||1,t=t||1,n=n||0,null==i&&(i={});var o=Jh(n),a=i.border||0,s=i.contentArea?sv.create(i.contentArea):this.getContentArea(i);a>0&&s.inflate(a);var l=this.getScale(),u=this.getTranslation(),c=l.sx,h=l.sy;s.x*=c,s.y*=h,s.width*=c,s.height*=h;var f=Math.max(Math.ceil((s.width+s.x)/e),1)*e,v=Math.max(Math.ceil((s.height+s.y)/t),1)*t,g=0,p=0;("negative"===i.allowNewOrigin&&s.x<0||"positive"===i.allowNewOrigin&&s.x>=0||"any"===i.allowNewOrigin)&&(g=Math.ceil(-s.x/e)*e,f+=g+=o.left),("negative"===i.allowNewOrigin&&s.y<0||"positive"===i.allowNewOrigin&&s.y>=0||"any"===i.allowNewOrigin)&&(p=Math.ceil(-s.y/t)*t,v+=p+=o.top),f+=o.right,v+=o.bottom,f=Math.max(f,i.minWidth||0),v=Math.max(v,i.minHeight||0),f=Math.min(f,i.maxWidth||Number.MAX_SAFE_INTEGER),v=Math.min(v,i.maxHeight||Number.MAX_SAFE_INTEGER);var y=this.getComputedSize(),m=f!==y.width||v!==y.height;return(g!==u.tx||p!==u.ty)&&this.translate(g,p),m&&this.resize(f,v),new sv(-g/c,-p/h,f/c,v/h)}},{key:"scaleContentToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scaleContentToFitImpl(e)}},{key:"scaleContentToFitImpl",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n.contentArea){var r=n.contentArea;e=this.graph.localToGraph(r),t=av.create(r)}else e=this.getContentBBox(n),t=this.graph.graphToLocal(e);if(e.width&&e.height){var o,a=Jh(n.padding),s=n.minScale||0,l=n.maxScale||Number.MAX_SAFE_INTEGER,u=n.minScaleX||s,c=n.maxScaleX||l,h=n.minScaleY||s,f=n.maxScaleY||l;if(n.viewportArea)o=n.viewportArea;else{var d=this.getComputedSize(),v=this.getTranslation();o={x:v.tx,y:v.ty,width:d.width,height:d.height}}o=sv.create(o).moveAndExpand({x:a.left,y:a.top,width:-a.left-a.right,height:-a.top-a.bottom});var g=this.getScale(),p=o.width/e.width*g.sx,y=o.height/e.height*g.sy;!1!==n.preserveAspectRatio&&(p=y=Math.min(p,y));var m=n.scaleGrid;if(m&&(p=m*Math.floor(p/m),y=m*Math.floor(y/m)),p=Ge(p,u,c),y=Ge(y,h,f),this.scale(p,y),i){var w=this.options,b=o.x-t.x*p-w.x,k=o.y-t.y*y-w.y;this.translate(b,k)}}}},{key:"getContentArea",value:function(){return!1!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).useCellGeometry?this.model.getAllCellsBBox()||new sv:pp.getBBox(this.stage)}},{key:"getContentBBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.graph.localToGraph(this.getContentArea(e))}},{key:"getGraphArea",value:function(){var e=sv.fromSize(this.getComputedSize());return this.graph.graphToLocal(e)}},{key:"zoomToRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=sv.create(e),i=this.graph;t.contentArea=n,null==t.viewportArea&&(t.viewportArea={x:i.options.x,y:i.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(t,!1);var r=n.getCenter();return this.centerPoint(r.x,r.y),this}},{key:"zoomToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.zoomToRect(this.getContentArea(e),e)}},{key:"centerPoint",value:function(e,t){var n=this.getComputedSize(),i=this.getScale(),r=this.getTranslation(),o=n.width/2,a=n.height/2;t="number"==typeof t?t:a,e=o-(e="number"==typeof e?e:o)*i.sx,t=a-t*i.sy,r.tx===e&&r.ty===t||this.translate(e,t)}},{key:"centerContent",value:function(e){var t=this.graph.getContentArea(e).getCenter();this.centerPoint(t.x,t.y)}},{key:"centerCell",value:function(e){return this.positionCell(e,"center")}},{key:"positionPoint",value:function(e,t,n){var i=this.getComputedSize();(t=Gh(t,Math.max(0,i.width)))<0&&(t=i.width+t),(n=Gh(n,Math.max(0,i.height)))<0&&(n=i.height+n);var r=this.getTranslation(),o=this.getScale(),a=t-e.x*o.sx,s=n-e.y*o.sy;r.tx===a&&r.ty===s||this.translate(a,s)}},{key:"positionRect",value:function(e,t){var n=sv.create(e);switch(t){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}},{key:"positionCell",value:function(e,t){var n=e.getBBox();return this.positionRect(n,t)}},{key:"positionContent",value:function(e,t){var n=this.graph.getContentArea(t);return this.positionRect(n,e)}}])}(hw),bw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},kw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"elem",get:function(){return this.view.background}},{key:"init",value:function(){this.startListening(),this.options.background&&this.draw(this.options.background)}},{key:"startListening",value:function(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}},{key:"stopListening",value:function(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}},{key:"updateBackgroundImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.size||"auto auto",n=e.position||"center",i=this.graph.transform.getScale(),r=this.graph.translate();if("object"===d(n)){var o=r.tx+i.sx*(n.x||0),a=r.ty+i.sy*(n.y||0);n="".concat(o,"px ").concat(a,"px")}"object"===d(t)&&(t=sv.fromSize(t).scale(i.sx,i.sy),t="".concat(t.width,"px ").concat(t.height,"px")),this.elem.style.backgroundSize=t,this.elem.style.backgroundPosition=n}},{key:"drawBackgroundImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e instanceof HTMLImageElement){var n=this.optionsCache;if(!n||n.image===t.image){var i,r=t.opacity,o=t.size,a=t.repeat||"no-repeat",s=Rv.registry.get(a);if("function"==typeof s){var l=t.quality||1;e.width*=l,e.height*=l;var u=s(e,t);if(!(u instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");i=u.toDataURL("image/png"),a=t.repeat&&a!==t.repeat?t.repeat:"repeat","object"===d(o)?(o.width*=u.width/e.width,o.height*=u.height/e.height):void 0===o&&(t.size={width:u.width/l,height:u.height/l})}else i=e.src,void 0===o&&(t.size={width:e.width,height:e.height});null!=n&&"object"===d(t.size)&&t.image===n.image&&t.repeat===n.repeat&&t.quality===n.quality&&(n.size=ct(t.size));var c=this.elem.style;c.backgroundImage="url(".concat(i,")"),c.backgroundRepeat=a,c.opacity=null==r||r>=1?"":"".concat(r),this.updateBackgroundImage(t)}}else this.elem.style.backgroundImage=""}},{key:"updateBackgroundColor",value:function(e){this.elem.style.backgroundColor=e||""}},{key:"updateBackgroundOptions",value:function(e){this.graph.options.background=e}},{key:"update",value:function(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}},{key:"draw",value:function(e){var t=this,n=e||{};if(this.updateBackgroundOptions(e),this.updateBackgroundColor(n.color),n.image){this.optionsCache=ct(n);var i=document.createElement("img");i.onload=function(){return t.drawBackgroundImage(i,e)},i.setAttribute("crossorigin","anonymous"),i.src=n.image}else this.drawBackgroundImage(null),this.optionsCache=null}},{key:"clear",value:function(){this.draw()}},{key:"dispose",value:function(){this.clear(),this.stopListening()}}])}(hw);bw([hw.dispose()],kw.prototype,"dispose",null);var xw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Cw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"widgetOptions",get:function(){return this.options.panning}},{key:"pannable",get:function(){return this.widgetOptions&&!0===this.widgetOptions.enabled}},{key:"init",value:function(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}},{key:"startListening",value:function(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),Hd.on(this.graph.container,"mousedown",this.onRightMouseDown),Hd.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new Gd(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}},{key:"stopListening",value:function(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),Hd.off(this.graph.container,"mousedown",this.onRightMouseDown),Hd.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}},{key:"allowPanning",value:function(e,t){return e.spaceKey=this.isSpaceKeyPressed,this.pannable&&$d.isMatch(e,this.widgetOptions.modifiers,t)}},{key:"startPanning",value:function(e){var t=this.view.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.panning=!0,this.updateClassName(),Hd.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),Hd.on(window,"mouseup.panning",this.stopPanning.bind(this))}},{key:"pan",value:function(e){var t=this.view.normalizeEvent(e),n=t.clientX-this.clientX,i=t.clientY-this.clientY;this.clientX=t.clientX,this.clientY=t.clientY,this.graph.translateBy(n,i)}},{key:"stopPanning",value:function(e){this.panning=!1,this.updateClassName(),Hd.off(document.body,".panning"),Hd.off(window,".panning")}},{key:"updateClassName",value:function(){var e=this.view.container,t=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(wf(e,t),bf(e,n)):(bf(e,t),wf(e,n)):(bf(e,t),bf(e,n))}},{key:"onMouseDown",value:function(e){var t=e.e;if(this.allowBlankMouseDown(t)){var n=this.graph.getPlugin("selection"),i=n&&n.allowRubberband(t,!0);(this.allowPanning(t,!0)||this.allowPanning(t)&&!i)&&this.startPanning(t)}}},{key:"onRightMouseDown",value:function(e){var t=this.widgetOptions.eventTypes;(null==t?void 0:t.includes("rightMouseDown"))&&2===e.button&&this.allowPanning(e,!0)&&this.startPanning(e)}},{key:"onMouseWheel",value:function(e,t,n){this.graph.translateBy(-t,-n)}},{key:"onSpaceKeyDown",value:function(e){32===e.which&&(this.isSpaceKeyPressed=!0)}},{key:"onSpaceKeyUp",value:function(e){32===e.which&&(this.isSpaceKeyPressed=!1)}},{key:"allowBlankMouseDown",value:function(e){var t=this.widgetOptions.eventTypes;return(null==t?void 0:t.includes("leftMouseDown"))&&0===e.button||(null==t?void 0:t.includes("mouseWheelDown"))&&1===e.button}},{key:"allowMouseWheel",value:function(e){var t;return this.pannable&&!e.ctrlKey&&(null===(t=this.widgetOptions.eventTypes)||void 0===t?void 0:t.includes("mouseWheel"))}},{key:"autoPanning",value:function(e,t){var n=10,i=this.graph.getGraphArea(),r=0,o=0;e<=i.left+n&&(r=-10),t<=i.top+n&&(o=-10),e>=i.right-n&&(r=n),t>=i.bottom-n&&(o=n),0===r&&0===o||this.graph.translateBy(-r,-o)}},{key:"enablePanning",value:function(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}},{key:"disablePanning",value:function(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}},{key:"dispose",value:function(){this.stopListening()}}])}(hw);xw([hw.dispose()],Cw.prototype,"dispose",null);var Ew=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Sw=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).cumulatedFactor=1,e}return h(t,e),P(t,[{key:"widgetOptions",get:function(){return this.options.mousewheel}},{key:"init",value:function(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new Gd(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}},{key:"disabled",get:function(){return!0!==this.widgetOptions.enabled}},{key:"enable",value:function(e){(this.disabled||e)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}},{key:"disable",value:function(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}},{key:"allowMouseWheel",value:function(e){var t=this.widgetOptions.guard;return(null==t||t(e))&&$d.isMatch(e,this.widgetOptions.modifiers)}},{key:"onMouseWheel",value:function(e){var t=this.widgetOptions.guard;if((null==t||t(e))&&$d.isMatch(e,this.widgetOptions.modifiers)){var n=this.widgetOptions.factor||1.2;null==this.currentScale&&(this.startPos={x:e.clientX,y:e.clientY},this.currentScale=this.graph.transform.getScale().sx),e.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*n*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/n)*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);var i=this.currentScale,r=this.graph.transform.clampScale(i*this.cumulatedFactor),o=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,a=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER;if((r=Ge(r,o,a))!==i)if(this.widgetOptions.zoomAtMousePosition){var s=!!this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(r,{absolute:!0,center:s.clone()})}else this.graph.zoom(r,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}},{key:"dispose",value:function(){this.disable()}}])}(hw);Ew([kh.dispose()],Sw.prototype,"dispose",null);var Mw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Aw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"init",value:function(){this.resetRenderArea=ft(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}},{key:"startListening",value:function(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}},{key:"stopListening",value:function(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}},{key:"enableVirtualRender",value:function(){this.options.virtual=!0,this.resetRenderArea()}},{key:"disableVirtualRender",value:function(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}},{key:"resetRenderArea",value:function(){if(this.options.virtual){var e=this.graph.getGraphArea();this.graph.renderer.setRenderArea(e)}}},{key:"dispose",value:function(){this.stopListening()}}])}(hw);Mw([hw.dispose()],Aw.prototype,"dispose",null);var _w,Pw=function(){return P((function e(){A(this,e),this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}),[{key:"queueJob",value:function(e){if(e.priority&_w.PRIOR)e.cb();else{var t=this.findInsertionIndex(e);t>=0&&this.queue.splice(t,0,e)}}},{key:"queueFlush",value:function(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.scheduleJob())}},{key:"queueFlushSync",value:function(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.flushJobsSync())}},{key:"clearJobs",value:function(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}},{key:"flushJobs",value:function(){this.isFlushPending=!1,this.isFlushing=!0;for(var e,t=this.getCurrentTime();(e=this.queue.shift())&&(e.cb(),!(this.getCurrentTime()-t>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}},{key:"flushJobsSync",value:function(){var e;for(this.isFlushPending=!1,this.isFlushing=!0;e=this.queue.shift();)try{e.cb()}catch(t){console.log(t)}this.isFlushing=!1}},{key:"findInsertionIndex",value:function(e){for(var t=0,n=this.queue.length,i=n-1,r=e.priority;t<=i;){var o=(i-t>>1)+t;r<=this.queue[o].priority?t=o+1:(n=o,i=o-1)}return n}},{key:"scheduleJob",value:function(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}},{key:"cancelScheduleJob",value:function(){"cancelIdleCallback"in window?(this.scheduleId&&window.cancelIdleCallback(this.scheduleId),this.scheduleId=0):(this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0)}},{key:"getCurrentTime",value:function(){return"object"===("undefined"==typeof performance?"undefined":d(performance))&&"function"==typeof performance.now?performance.now():Date.now()-this.initialTime}}])}();!function(e){e[e.Update=2]="Update",e[e.RenderEdge=4]="RenderEdge",e[e.RenderNode=8]="RenderNode",e[e.PRIOR=1048576]="PRIOR"}(_w||(_w={}));var Ow=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Tw=function(e){function t(e){var n;return A(this,t),(n=s(this,t)).views={},n.willRemoveViews={},n.queue=new Pw,n.graph=e,n.init(),n}return h(t,e),P(t,[{key:"model",get:function(){return this.graph.model}},{key:"container",get:function(){return this.graph.view.stage}},{key:"init",value:function(){this.startListening(),this.renderViews(this.model.getCells())}},{key:"startListening",value:function(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}},{key:"stopListening",value:function(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}},{key:"onModelReseted",value:function(e){var t=e.options;this.queue.clearJobs(),this.removeZPivots(),this.resetViews();var n=this.model.getCells();this.renderViews(n,Object.assign(Object.assign({},t),{queue:n.map((function(e){return e.id}))}))}},{key:"onCellAdded",value:function(e){var t=e.cell,n=e.options;this.renderViews([t],n)}},{key:"onCellRemoved",value:function(e){var t=e.cell;this.removeViews([t])}},{key:"onCellZIndexChanged",value:function(e){var n=e.cell,i=e.options,r=this.views[n.id];r&&this.requestViewUpdate(r.view,t.FLAG_INSERT,i,_w.Update,!0)}},{key:"onCellVisibleChanged",value:function(e){var t=e.cell,n=e.current;this.toggleVisible(t,!!n)}},{key:"requestViewUpdate",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_w.Update,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=e.cell.id,s=this.views[a];s&&(s.flag=t,s.options=i,(e.hasAction(t,["translate","resize","rotate"])||!1===i.async)&&(r=_w.PRIOR,o=!1),this.queue.queueJob({id:a,priority:r,cb:function(){n.renderViewInArea(e,t,i);var r=i.queue;if(r){var o=r.indexOf(e.cell.id);o>=0&&r.splice(o,1),0===r.length&&n.graph.trigger("render:done")}}}),this.getEffectedEdges(e).forEach((function(e){n.requestViewUpdate(e.view,e.flag,i,r,!1)})),o&&this.flush())}},{key:"setRenderArea",value:function(e){this.renderArea=e,this.flushWaitingViews()}},{key:"isViewMounted",value:function(e){if(null==e)return!1;var n=this.views[e.cell.id];return!!n&&n.state===t.ViewState.MOUNTED}},{key:"renderViews",value:function(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.sort((function(e,t){return e.isNode()&&t.isEdge()?-1:0})),e.forEach((function(e){var r=e.id,o=0,a=n.views[r];if(a)o=t.FLAG_INSERT;else{var s=n.createCellView(e);s&&(s.graph=n.graph,o=t.FLAG_INSERT|s.getBootstrapFlag(),a={view:s,flag:o,options:i,state:t.ViewState.CREATED},n.views[r]=a)}a&&n.requestViewUpdate(a.view,o,i,n.getRenderPriority(a.view),!1)})),this.flush()}},{key:"renderViewInArea",value:function(e,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e.cell,a=o.id,s=this.views[a];if(s){var l=0;this.isUpdatable(e)||s.state===t.ViewState.MOUNTED?(l=this.updateView(e,n,r),s.flag=l):s.state=t.ViewState.WAITING,l&&o.isEdge()&&0==(l&e.getFlag(["source","target"]))&&this.queue.queueJob({id:a,priority:_w.RenderEdge,cb:function(){i.updateView(e,n,r)}})}}},{key:"removeViews",value:function(e){var t=this;e.forEach((function(e){var n=e.id,i=t.views[n];i&&(t.willRemoveViews[n]=i,delete t.views[n],t.queue.queueJob({id:n,priority:t.getRenderPriority(i.view),cb:function(){t.removeView(i.view)}}))})),this.flush()}},{key:"flush",value:function(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}},{key:"flushWaitingViews",value:function(){var e=this;Object.values(this.views).forEach((function(n){if(n&&n.state===t.ViewState.WAITING){var i=n.view,r=n.flag,o=n.options;e.requestViewUpdate(i,r,o,e.getRenderPriority(i),!1)}})),this.flush()}},{key:"updateView",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==e)return 0;if(Xp.isCellView(e)){if(n&t.FLAG_REMOVE)return this.removeView(e.cell),0;n&t.FLAG_INSERT&&(this.insertView(e),n^=t.FLAG_INSERT)}return n?e.confirmUpdate(n,i):0}},{key:"insertView",value:function(e){var n=this.views[e.cell.id];if(n){var i=e.cell.getZIndex(),r=this.addZPivot(i);this.container.insertBefore(e.container,r),e.cell.isVisible()||this.toggleVisible(e.cell,!1),n.state=t.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:e})}}},{key:"resetViews",value:function(){var e=this;this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach((function(t){t&&e.removeView(t.view)})),this.views={},this.willRemoveViews={}}},{key:"removeView",value:function(e){var t=e.cell,n=this.willRemoveViews[t.id];n&&e&&(n.view.remove(),delete this.willRemoveViews[t.id],this.graph.trigger("view:unmounted",{view:e}))}},{key:"toggleVisible",value:function(e,t){for(var n=this.model.getConnectedEdges(e),i=0,r=n.length;i<r;i+=1){var o=n[i];if(t){var a=o.getSourceCell(),s=o.getTargetCell();if(a&&!a.isVisible()||s&&!s.isVisible())continue;this.toggleVisible(o,!0)}else this.toggleVisible(o,!1)}var l=this.views[e.id];l&&od(l.view.container,{display:t?"unset":"none"})}},{key:"addZPivot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null==this.zPivots&&(this.zPivots={});var t=this.zPivots,n=t[e];if(n)return n;n=t[e]=document.createComment("z-index:".concat(e+1));var i=-1/0;for(var r in t){var o=+r;o<e&&o>i&&(i=o)}var a=this.container;if(i!==-1/0){var s=t[i];a.insertBefore(n,s.nextSibling)}else a.insertBefore(n,a.firstChild);return n}},{key:"removeZPivots",value:function(){this.zPivots&&Object.values(this.zPivots).forEach((function(e){e&&e.parentNode&&e.parentNode.removeChild(e)})),this.zPivots={}}},{key:"createCellView",value:function(e){var t={graph:this.graph},n=this.graph.options.createCellView;if(n){var i=Eh(n,this.graph,e);if(i)return new i(e,t);if(null===i)return null}var r=e.view;if(null!=r&&"string"==typeof r){var o=Xp.registry.get(r);return o?new o(e,t):Xp.registry.onNotFound(r)}return e.isNode()?new aw(e,t):e.isEdge()?new lw(e,t):null}},{key:"getEffectedEdges",value:function(e){for(var t=[],n=e.cell,i=this.model.getConnectedEdges(n),r=0,o=i.length;r<o;r+=1){var a=i[r],s=this.views[a.id];if(s){var l=s.view;if(this.isViewMounted(l)){var u=["update"];a.getTargetCell()===n&&u.push("target"),a.getSourceCell()===n&&u.push("source"),t.push({id:a.id,view:l,flag:l.getFlag(u)})}}}return t}},{key:"isUpdatable",value:function(e){if(e.isNodeView())return!this.renderArea||this.renderArea.isIntersectWithRect(e.cell.getBBox());if(e.isEdgeView()){var t=e.cell,n=t.getSourceCell(),i=t.getTargetCell();if(this.renderArea&&n&&i)return this.renderArea.isIntersectWithRect(n.getBBox())||this.renderArea.isIntersectWithRect(i.getBBox())}return!0}},{key:"getRenderPriority",value:function(e){return e.cell.isNode()?_w.RenderNode:_w.RenderEdge}},{key:"dispose",value:function(){var e=this;this.stopListening(),Object.keys(this.views).forEach((function(t){e.views[t].view.dispose()})),this.views={}}}])}(kh);Ow([kh.dispose()],Tw.prototype,"dispose",null),function(e){e.FLAG_INSERT=1<<30,e.FLAG_REMOVE=1<<29,e.FLAG_RENDER=67108863}(Tw||(Tw={})),function(e){var t;(t=e.ViewState||(e.ViewState={}))[t.CREATED=0]="CREATED",t[t.MOUNTED=1]="MOUNTED",t[t.WAITING=2]="WAITING"}(Tw||(Tw={}));var Lw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},jw=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).schedule=new Tw(e.graph),e}return h(t,e),P(t,[{key:"requestViewUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.schedule.requestViewUpdate(e,t,n)}},{key:"isViewMounted",value:function(e){return this.schedule.isViewMounted(e)}},{key:"setRenderArea",value:function(e){this.schedule.setRenderArea(e)}},{key:"findViewByElem",value:function(e){if(null==e)return null;var t=this.options.container,n="string"==typeof e?t.querySelector(e):e instanceof Element?e:e[0];if(n){var i=this.graph.view.findAttr("data-cell-id",n);if(i){var r=this.schedule.views;if(r[i])return r[i].view}}return null}},{key:"findViewByCell",value:function(e){if(null==e)return null;var t=Fm.isCell(e)?e.id:e,n=this.schedule.views;return n[t]?n[t].view:null}},{key:"findViewsFromPoint",value:function(e){var t=this,n={x:e.x,y:e.y};return this.model.getCells().map((function(e){return t.findViewByCell(e)})).filter((function(e){return null!=e&&pp.getBBox(e.container,{target:t.view.stage}).containsPoint(n)}))}},{key:"findEdgeViewsFromPoint",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return this.model.getEdges().map((function(e){return t.findViewByCell(e)})).filter((function(t){if(null!=t){var i=t.getClosestPoint(e);if(i)return i.distance(e)<=n}return!1}))}},{key:"findViewsInArea",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=sv.create(e);return this.model.getCells().map((function(e){return t.findViewByCell(e)})).filter((function(e){if(e){if(n.nodeOnly&&!e.isNodeView())return!1;var r=pp.getBBox(e.container,{target:t.view.stage});return 0===r.width?r.inflate(1,0):0===r.height&&r.inflate(0,1),n.strict?i.containsRect(r):i.isIntersectWithRect(r)}return!1}))}},{key:"dispose",value:function(){this.schedule.dispose()}}])}(hw);Lw([hw.dispose()],jw.prototype,"dispose",null);var Nw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Dw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"cid",get:function(){return this.graph.view.cid}},{key:"svg",get:function(){return this.view.svg}},{key:"defs",get:function(){return this.view.defs}},{key:"isDefined",value:function(e){return null!=this.svg.getElementById(e)}},{key:"filter",value:function(e){var t=e.id,n=e.name;if(t||(t="filter-".concat(n,"-").concat(this.cid,"-").concat(Vh(JSON.stringify(e)))),!this.isDefined(t)){var i=qv.registry.get(n);if(null==i)return qv.registry.onNotFound(n);var r=i(e.args||{}),o=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},e.attrs),{id:t});ud.create(Gp.sanitize(r),o).appendTo(this.defs)}return t}},{key:"gradient",value:function(e){var t=e.id,n=e.type;if(t||(t="gradient-".concat(n,"-").concat(this.cid,"-").concat(Vh(JSON.stringify(e)))),!this.isDefined(t)){var i=e.stops.map((function(e){var t=null!=e.opacity&&Number.isFinite(e.opacity)?e.opacity:1;return'<stop offset="'.concat(e.offset,'" stop-color="').concat(e.color,'" stop-opacity="').concat(t,'"/>')})),r="<".concat(n,">").concat(i.join(""),"</").concat(n,">"),o=Object.assign({id:t},e.attrs);ud.create(r,o).appendTo(this.defs)}return t}},{key:"marker",value:function(e){var t=e.id,n=e.refX,i=e.refY,r=e.markerUnits,o=e.markerOrient,a=e.tagName,s=e.children,l=Nw(e,["id","refX","refY","markerUnits","markerOrient","tagName","children"]),u=t;if(u||(u="marker-".concat(this.cid,"-").concat(Vh(JSON.stringify(e)))),!this.isDefined(u)){"path"!==a&&delete l.d;var c=ud.create("marker",{refX:n,refY:i,id:u,overflow:"visible",orient:null!=o?o:"auto",markerUnits:r||"userSpaceOnUse"},s?s.map((function(e){var t=e.tagName,n=Nw(e,["tagName"]);return ud.create("".concat(t)||"path",Jf(Object.assign(Object.assign({},l),n)))})):[ud.create(a||"path",Jf(l))]);this.defs.appendChild(c.node)}return u}},{key:"remove",value:function(e){var t=this.svg.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)}}])}(hw),Iw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"getClientMatrix",value:function(){return Pd(this.view.stage.getScreenCTM())}},{key:"getClientOffset",value:function(){var e=this.view.svg.getBoundingClientRect();return new av(e.left,e.top)}},{key:"getPageOffset",value:function(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}},{key:"snapToGrid",value:function(e,t){return("number"==typeof e?this.clientToLocalPoint(e,t):this.clientToLocalPoint(e.x,e.y)).snapToGrid(this.graph.getGridSize())}},{key:"localToGraphPoint",value:function(e,t){var n=av.create(e,t);return pp.transformPoint(n,this.graph.matrix())}},{key:"localToClientPoint",value:function(e,t){var n=av.create(e,t);return pp.transformPoint(n,this.getClientMatrix())}},{key:"localToPagePoint",value:function(e,t){return("number"==typeof e?this.localToGraphPoint(e,t):this.localToGraphPoint(e)).translate(this.getPageOffset())}},{key:"localToGraphRect",value:function(e,t,n,i){var r=sv.create(e,t,n,i);return pp.transformRectangle(r,this.graph.matrix())}},{key:"localToClientRect",value:function(e,t,n,i){var r=sv.create(e,t,n,i);return pp.transformRectangle(r,this.getClientMatrix())}},{key:"localToPageRect",value:function(e,t,n,i){return("number"==typeof e?this.localToGraphRect(e,t,n,i):this.localToGraphRect(e)).translate(this.getPageOffset())}},{key:"graphToLocalPoint",value:function(e,t){var n=av.create(e,t);return pp.transformPoint(n,this.graph.matrix().inverse())}},{key:"clientToLocalPoint",value:function(e,t){var n=av.create(e,t);return pp.transformPoint(n,this.getClientMatrix().inverse())}},{key:"clientToGraphPoint",value:function(e,t){var n=av.create(e,t);return pp.transformPoint(n,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}},{key:"pageToLocalPoint",value:function(e,t){var n=av.create(e,t).diff(this.getPageOffset());return this.graphToLocalPoint(n)}},{key:"graphToLocalRect",value:function(e,t,n,i){var r=sv.create(e,t,n,i);return pp.transformRectangle(r,this.graph.matrix().inverse())}},{key:"clientToLocalRect",value:function(e,t,n,i){var r=sv.create(e,t,n,i);return pp.transformRectangle(r,this.getClientMatrix().inverse())}},{key:"clientToGraphRect",value:function(e,t,n,i){var r=sv.create(e,t,n,i);return pp.transformRectangle(r,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}},{key:"pageToLocalRect",value:function(e,t,n,i){var r=sv.create(e,t,n,i),o=this.getPageOffset();return r.x-=o.x,r.y-=o.y,this.graphToLocalRect(r)}}])}(hw),Rw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Bw=function(e){function t(){var e;return A(this,t),(e=s(this,t,arguments)).highlights={},e}return h(t,e),P(t,[{key:"init",value:function(){this.startListening()}},{key:"startListening",value:function(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}},{key:"stopListening",value:function(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}},{key:"onCellHighlight",value:function(e){var t=e.view,n=e.magnet,i=e.options,r=void 0===i?{}:i,o=this.resolveHighlighter(r);if(o){var a=this.getHighlighterId(n,o);if(!this.highlights[a]){var s=o.highlighter;s.highlight(t,n,Object.assign({},o.args)),this.highlights[a]={cellView:t,magnet:n,highlighter:s,args:o.args}}}}},{key:"onCellUnhighlight",value:function(e){var t=e.magnet,n=e.options,i=void 0===n?{}:n,r=this.resolveHighlighter(i);if(r){var o=this.getHighlighterId(t,r);this.unhighlight(o)}}},{key:"resolveHighlighter",value:function(e){var t=this.options,n=e.highlighter;if(null==n){var i=e.type;n=i&&t.highlighting[i]||t.highlighting.default}if(null==n)return null;var r="string"==typeof n?{name:n}:n,o=r.name,a=Sp.registry.get(o);return null==a?Sp.registry.onNotFound(o):(Sp.check(o,a),{name:o,highlighter:a,args:r.args||{}})}},{key:"getHighlighterId",value:function(e,t){return Cf(e),t.name+e.id+JSON.stringify(t.args)}},{key:"unhighlight",value:function(e){var t=this.highlights[e];t&&(t.highlighter.unhighlight(t.cellView,t.magnet,t.args),delete this.highlights[e])}},{key:"dispose",value:function(){var e=this;Object.keys(this.highlights).forEach((function(t){return e.unhighlight(t)})),this.stopListening()}}])}(hw);Rw([Bw.dispose()],Bw.prototype,"dispose",null);var zw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Fw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"getScroller",value:function(){var e=this.graph.getPlugin("scroller");return e&&e.options.enabled?e:null}},{key:"getContainer",value:function(){var e=this.getScroller();return e?e.container.parentElement:this.graph.container.parentElement}},{key:"getSensorTarget",value:function(){var e=this.options.autoResize;if(e)return"boolean"==typeof e?this.getContainer():e}},{key:"init",value:function(){var e=this;if(this.options.autoResize){var t=this.getSensorTarget();t&&Wd.bind(t,(function(){var n=t.offsetWidth,i=t.offsetHeight;e.resize(n,i)}))}}},{key:"resize",value:function(e,t){var n=this.getScroller();n?n.resize(e,t):this.graph.transform.resize(e,t)}},{key:"dispose",value:function(){Wd.clear(this.graph.container)}}])}(hw);zw([hw.dispose()],Fw.prototype,"dispose",null);var Vw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Hw=function(e){function t(e){var n;return A(this,t),(n=s(this,t)).installedPlugins=new Set,n.options=vw.get(e),n.css=new dw(n),n.view=new cw(n),n.defs=new Dw(n),n.coord=new Iw(n),n.transform=new ww(n),n.highlight=new Bw(n),n.grid=new mw(n),n.background=new kw(n),n.options.model?n.model=n.options.model:(n.model=new Zm,n.model.graph=n),n.renderer=new jw(n),n.panning=new Cw(n),n.mousewheel=new Sw(n),n.virtualRender=new Aw(n),n.size=new Fw(n),n}return h(t,e),P(t,[{key:"container",get:function(){return this.options.container}},{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"isNode",value:function(e){return e.isNode()}},{key:"isEdge",value:function(e){return e.isEdge()}},{key:"resetCells",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.resetCells(e,t),this}},{key:"clearCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.model.clear(e),this}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.model.toJSON(e)}},{key:"parseJSON",value:function(e){return this.model.parseJSON(e)}},{key:"fromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.fromJSON(e,t),this}},{key:"getCellById",value:function(e){return this.model.getCell(e)}},{key:"addNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addNode(e,t)}},{key:"addNodes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addCell(e.map((function(e){return Um.isNode(e)?e:t.createNode(e)})),n)}},{key:"createNode",value:function(e){return this.model.createNode(e)}},{key:"removeNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"addEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addEdge(e,t)}},{key:"addEdges",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addCell(e.map((function(e){return Gm.isEdge(e)?e:t.createEdge(e)})),n)}},{key:"removeEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"createEdge",value:function(e){return this.model.createEdge(e)}},{key:"addCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addCell(e,t),this}},{key:"removeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"removeCells",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCells(e,t)}},{key:"removeConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeConnectedEdges(e,t)}},{key:"disconnectConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.disconnectConnectedEdges(e,t),this}},{key:"hasCell",value:function(e){return this.model.has(e)}},{key:"getCells",value:function(){return this.model.getCells()}},{key:"getCellCount",value:function(){return this.model.total()}},{key:"getNodes",value:function(){return this.model.getNodes()}},{key:"getEdges",value:function(){return this.model.getEdges()}},{key:"getOutgoingEdges",value:function(e){return this.model.getOutgoingEdges(e)}},{key:"getIncomingEdges",value:function(e){return this.model.getIncomingEdges(e)}},{key:"getConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getConnectedEdges(e,t)}},{key:"getRootNodes",value:function(){return this.model.getRoots()}},{key:"getLeafNodes",value:function(){return this.model.getLeafs()}},{key:"isRootNode",value:function(e){return this.model.isRoot(e)}},{key:"isLeafNode",value:function(e){return this.model.isLeaf(e)}},{key:"getNeighbors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getNeighbors(e,t)}},{key:"isNeighbor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isNeighbor(e,t,n)}},{key:"getSuccessors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getSuccessors(e,t)}},{key:"isSuccessor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isSuccessor(e,t,n)}},{key:"getPredecessors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getPredecessors(e,t)}},{key:"isPredecessor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isPredecessor(e,t,n)}},{key:"getCommonAncestor",value:function(){var e;return(e=this.model).getCommonAncestor.apply(e,arguments)}},{key:"getSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getSubGraph(e,t)}},{key:"cloneSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.cloneSubGraph(e,t)}},{key:"cloneCells",value:function(e){return this.model.cloneCells(e)}},{key:"getNodesFromPoint",value:function(e,t){return this.model.getNodesFromPoint(e,t)}},{key:"getNodesInArea",value:function(e,t,n,i,r){return this.model.getNodesInArea(e,t,n,i,r)}},{key:"getNodesUnderNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getNodesUnderNode(e,t)}},{key:"searchCell",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.search(e,t,n),this}},{key:"getShortestPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.getShortestPath(e,t,n)}},{key:"getAllCellsBBox",value:function(){return this.model.getAllCellsBBox()}},{key:"getCellsBBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getCellsBBox(e,t)}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.model.startBatch(e,t)}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.model.stopBatch(e,t)}},{key:"batchUpdate",value:function(e,t,n){var i="string"==typeof e?e:"update",r="string"==typeof e?t:e,o="function"==typeof t?n:t;this.startBatch(i,o);var a=r();return this.stopBatch(i,o),a}},{key:"updateCellId",value:function(e,t){return this.model.updateCellId(e,t)}},{key:"findView",value:function(e){return Fm.isCell(e)?this.findViewByCell(e):this.findViewByElem(e)}},{key:"findViews",value:function(e){return sv.isRectangleLike(e)?this.findViewsInArea(e):av.isPointLike(e)?this.findViewsFromPoint(e):[]}},{key:"findViewByCell",value:function(e){return this.renderer.findViewByCell(e)}},{key:"findViewByElem",value:function(e){return this.renderer.findViewByElem(e)}},{key:"findViewsFromPoint",value:function(e,t){var n="number"==typeof e?{x:e,y:t}:e;return this.renderer.findViewsFromPoint(n)}},{key:"findViewsInArea",value:function(e,t,n,i,r){var o="number"==typeof e?{x:e,y:t,width:n,height:i}:e,a="number"==typeof e?r:t;return this.renderer.findViewsInArea(o,a)}},{key:"matrix",value:function(e){return void 0===e?this.transform.getMatrix():(this.transform.setMatrix(e),this)}},{key:"resize",value:function(e,t){var n=this.getPlugin("scroller");return n?n.resize(e,t):this.transform.resize(e,t),this}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===e?this.transform.getScale():(this.transform.scale(e,t,n,i),this)}},{key:"zoom",value:function(e,t){var n=this.getPlugin("scroller");if(n){if(void 0===e)return n.zoom();n.zoom(e,t)}else{if(void 0===e)return this.transform.getZoom();this.transform.zoom(e,t)}return this}},{key:"zoomTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPlugin("scroller");return n?n.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})):this.transform.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})),this}},{key:"zoomToRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPlugin("scroller");return n?n.zoomToRect(e,t):this.transform.zoomToRect(e,t),this}},{key:"zoomToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getPlugin("scroller");return t?t.zoomToFit(e):this.transform.zoomToFit(e),this}},{key:"rotate",value:function(e,t,n){return void 0===e?this.transform.getRotation():(this.transform.rotate(e,t,n),this)}},{key:"translate",value:function(e,t){return void 0===e?this.transform.getTranslation():(this.transform.translate(e,t),this)}},{key:"translateBy",value:function(e,t){var n=this.translate(),i=n.tx+e,r=n.ty+t;return this.translate(i,r)}},{key:"getGraphArea",value:function(){return this.transform.getGraphArea()}},{key:"getContentArea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.getContentArea(e)}},{key:"getContentBBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.getContentBBox(e)}},{key:"fitToContent",value:function(e,t,n,i){return this.transform.fitToContent(e,t,n,i)}},{key:"scaleContentToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.scaleContentToFit(e),this}},{key:"center",value:function(e){return this.centerPoint(e)}},{key:"centerPoint",value:function(e,t,n){var i=this.getPlugin("scroller");return i?i.centerPoint(e,t,n):this.transform.centerPoint(e,t),this}},{key:"centerContent",value:function(e){var t=this.getPlugin("scroller");return t?t.centerContent(e):this.transform.centerContent(e),this}},{key:"centerCell",value:function(e,t){var n=this.getPlugin("scroller");return n?n.centerCell(e,t):this.transform.centerCell(e),this}},{key:"positionPoint",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=this.getPlugin("scroller");return r?r.positionPoint(e,t,n,i):this.transform.positionPoint(e,t,n),this}},{key:"positionRect",value:function(e,t,n){var i=this.getPlugin("scroller");return i?i.positionRect(e,t,n):this.transform.positionRect(e,t),this}},{key:"positionCell",value:function(e,t,n){var i=this.getPlugin("scroller");return i?i.positionCell(e,t,n):this.transform.positionCell(e,t),this}},{key:"positionContent",value:function(e,t){var n=this.getPlugin("scroller");return n?n.positionContent(e,t):this.transform.positionContent(e,t),this}},{key:"snapToGrid",value:function(e,t){return this.coord.snapToGrid(e,t)}},{key:"pageToLocal",value:function(e,t,n,i){return sv.isRectangleLike(e)?this.coord.pageToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.pageToLocalRect(e,t,n,i):this.coord.pageToLocalPoint(e,t)}},{key:"localToPage",value:function(e,t,n,i){return sv.isRectangleLike(e)?this.coord.localToPageRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.localToPageRect(e,t,n,i):this.coord.localToPagePoint(e,t)}},{key:"clientToLocal",value:function(e,t,n,i){return sv.isRectangleLike(e)?this.coord.clientToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.clientToLocalRect(e,t,n,i):this.coord.clientToLocalPoint(e,t)}},{key:"localToClient",value:function(e,t,n,i){return sv.isRectangleLike(e)?this.coord.localToClientRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.localToClientRect(e,t,n,i):this.coord.localToClientPoint(e,t)}},{key:"localToGraph",value:function(e,t,n,i){return sv.isRectangleLike(e)?this.coord.localToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.localToGraphRect(e,t,n,i):this.coord.localToGraphPoint(e,t)}},{key:"graphToLocal",value:function(e,t,n,i){return sv.isRectangleLike(e)?this.coord.graphToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.graphToLocalRect(e,t,n,i):this.coord.graphToLocalPoint(e,t)}},{key:"clientToGraph",value:function(e,t,n,i){return sv.isRectangleLike(e)?this.coord.clientToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof i?this.coord.clientToGraphRect(e,t,n,i):this.coord.clientToGraphPoint(e,t)}},{key:"defineFilter",value:function(e){return this.defs.filter(e)}},{key:"defineGradient",value:function(e){return this.defs.gradient(e)}},{key:"defineMarker",value:function(e){return this.defs.marker(e)}},{key:"getGridSize",value:function(){return this.grid.getGridSize()}},{key:"setGridSize",value:function(e){return this.grid.setGridSize(e),this}},{key:"showGrid",value:function(){return this.grid.show(),this}},{key:"hideGrid",value:function(){return this.grid.hide(),this}},{key:"clearGrid",value:function(){return this.grid.clear(),this}},{key:"drawGrid",value:function(e){return this.grid.draw(e),this}},{key:"updateBackground",value:function(){return this.background.update(),this}},{key:"drawBackground",value:function(e,t){var n=this.getPlugin("scroller");return null==n||null!=this.options.background&&t?this.background.draw(e):n.drawBackground(e,t),this}},{key:"clearBackground",value:function(e){var t=this.getPlugin("scroller");return null==t||null!=this.options.background&&e?this.background.clear():t.clearBackground(e),this}},{key:"enableVirtualRender",value:function(){return this.virtualRender.enableVirtualRender(),this}},{key:"disableVirtualRender",value:function(){return this.virtualRender.disableVirtualRender(),this}},{key:"isMouseWheelEnabled",value:function(){return!this.mousewheel.disabled}},{key:"enableMouseWheel",value:function(){return this.mousewheel.enable(),this}},{key:"disableMouseWheel",value:function(){return this.mousewheel.disable(),this}},{key:"toggleMouseWheel",value:function(e){return null==e?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():e?this.enableMouseWheel():this.disableMouseWheel(),this}},{key:"isPannable",value:function(){var e=this.getPlugin("scroller");return e?e.isPannable():this.panning.pannable}},{key:"enablePanning",value:function(){var e=this.getPlugin("scroller");return e?e.enablePanning():this.panning.enablePanning(),this}},{key:"disablePanning",value:function(){var e=this.getPlugin("scroller");return e?e.disablePanning():this.panning.disablePanning(),this}},{key:"togglePanning",value:function(e){return null==e?this.isPannable()?this.disablePanning():this.enablePanning():e!==this.isPannable()&&(e?this.enablePanning():this.disablePanning()),this}},{key:"use",value:function(e){if(!this.installedPlugins.has(e)){this.installedPlugins.add(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];e.init.apply(e,[this].concat(n))}return this}},{key:"getPlugin",value:function(e){return Array.from(this.installedPlugins).find((function(t){return t.name===e}))}},{key:"getPlugins",value:function(e){return Array.from(this.installedPlugins).filter((function(t){return e.includes(t.name)}))}},{key:"enablePlugins",value:function(e){var t=e;Array.isArray(t)||(t=[t]);var n=this.getPlugins(t);return null==n||n.forEach((function(e){var t;null===(t=null==e?void 0:e.enable)||void 0===t||t.call(e)})),this}},{key:"disablePlugins",value:function(e){var t=e;Array.isArray(t)||(t=[t]);var n=this.getPlugins(t);return null==n||n.forEach((function(e){var t;null===(t=null==e?void 0:e.disable)||void 0===t||t.call(e)})),this}},{key:"isPluginEnabled",value:function(e){var t,n=this.getPlugin(e);return null===(t=null==n?void 0:n.isEnabled)||void 0===t?void 0:t.call(n)}},{key:"disposePlugins",value:function(e){var t=this,n=e;Array.isArray(n)||(n=[n]);var i=this.getPlugins(n);return null==i||i.forEach((function(e){e.dispose(),t.installedPlugins.delete(e)})),this}},{key:"dispose",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach((function(e){e.dispose()}))}}])}(Rh);Vw([Rh.dispose()],Hw.prototype,"dispose",null),function(e){e.View=cw,e.Renderer=jw,e.MouseWheel=Sw,e.DefsManager=Dw,e.GridManager=mw,e.CoordManager=Iw,e.TransformManager=ww,e.HighlightManager=Bw,e.BackgroundManager=kw,e.PanningManager=Cw}(Hw||(Hw={})),function(e){e.toStringTag="X6.".concat(e.name),e.isGraph=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag];return null==n||n===e.toStringTag}}(Hw||(Hw={})),function(e){e.render=function(t,n){var i=t instanceof HTMLElement?new e({container:t}):new e(t);return null!=n&&i.fromJSON(n),i}}(Hw||(Hw={})),function(e){e.registerNode=Um.registry.register,e.registerEdge=Gm.registry.register,e.registerView=Xp.registry.register,e.registerAttr=vp.registry.register,e.registerGrid=Iv.registry.register,e.registerFilter=qv.registry.register,e.registerNodeTool=by.registry.register,e.registerEdgeTool=ky.registry.register,e.registerBackground=Rv.registry.register,e.registerHighlighter=Sp.registry.register,e.registerPortLayout=Lp.registry.register,e.registerPortLabelLayout=Fp.registry.register,e.registerMarker=qg.registry.register,e.registerRouter=Cm.registry.register,e.registerConnector=Lm.registry.register,e.registerAnchor=Dy.registry.register,e.registerEdgeAnchor=zy.registry.register,e.registerConnectionPoint=Wy.registry.register}(Hw||(Hw={})),function(e){e.unregisterNode=Um.registry.unregister,e.unregisterEdge=Gm.registry.unregister,e.unregisterView=Xp.registry.unregister,e.unregisterAttr=vp.registry.unregister,e.unregisterGrid=Iv.registry.unregister,e.unregisterFilter=qv.registry.unregister,e.unregisterNodeTool=by.registry.unregister,e.unregisterEdgeTool=ky.registry.unregister,e.unregisterBackground=Rv.registry.unregister,e.unregisterHighlighter=Sp.registry.unregister,e.unregisterPortLayout=Lp.registry.unregister,e.unregisterPortLabelLayout=Fp.registry.unregister,e.unregisterMarker=qg.registry.unregister,e.unregisterRouter=Cm.registry.unregister,e.unregisterConnector=Lm.registry.unregister,e.unregisterAnchor=Dy.registry.unregister,e.unregisterEdgeAnchor=zy.registry.unregister,e.unregisterConnectionPoint=Wy.registry.unregister}(Hw||(Hw={}));var Uw=globalThis&&globalThis.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},qw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},Gw=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t)}(Um);!function(e){var t=function(t){function n(){return A(this,n),s(this,n,arguments)}return h(n,t),P(n,[{key:"init",value:function(){o(n,"init",this,3)([]),this.cell.on("change:*",this.onCellChangeAny,this)}},{key:"onCellChangeAny",value:function(t){var n=t.key,i=e.shapeMaps[this.cell.shape];if(i){var r=i.effect;r&&!r.includes(n)||this.renderHTMLComponent()}}},{key:"confirmUpdate",value:function(e){var t=this,i=o(n,"confirmUpdate",this,3)([e]);return this.handleAction(i,n.action,(function(){return t.renderHTMLComponent()}))}},{key:"renderHTMLComponent",value:function(){var t=this.selectors&&this.selectors.foContent;if(t){Nf(t);var n=e.shapeMaps[this.cell.shape];if(!n)return;var i=n.html;"function"==typeof i&&(i=i(this.cell)),i&&("string"==typeof i?t.innerHTML=i:Df(t,i))}}},{key:"dispose",value:function(){this.cell.off("change:*",this.onCellChangeAny,this)}}])}(aw);Uw([t.dispose()],t.prototype,"dispose",null),e.View=t,function(e){e.action="html",e.config({bootstrap:[e.action],actions:{html:e.action}}),aw.registry.register("html-view",e,!0)}(t=e.View||(e.View={}))}(Gw||(Gw={})),function(e){e.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},Gp.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),Um.registry.register("html",e,!0)}(Gw||(Gw={})),function(e){e.shapeMaps={},e.register=function(t){var n=t.shape,i=t.html,r=t.effect,o=t.inherit,a=qw(t,["shape","html","effect","inherit"]);if(!n)throw new Error("should specify shape in config");e.shapeMaps[n]={html:i,effect:r},Hw.registerNode(n,Object.assign({inherit:o||"html"},a),!0)}}(Gw||(Gw={}));a("c","undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{});function Jw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ww={assign:Object.assign,getHeight:function(e,t,n,i){return void 0===i&&(i="height"),"center"===n?(e[i]+t[i])/2:e.height}},Yw=Ww,Zw={getId:function(e){return e.id||e.name},getPreH:function(e){return e.preH||0},getPreV:function(e){return e.preV||0},getHGap:function(e){return e.hgap||18},getVGap:function(e){return e.vgap||18},getChildren:function(e){return e.children},getHeight:function(e){return e.height||36},getWidth:function(e){var t=e.label||" ";return e.width||18*t.split("").length}};function Kw(e,t){var n=this;if(n.vgap=n.hgap=0,e instanceof Kw)return e;n.data=e;var i=t.getHGap(e),r=t.getVGap(e);return n.preH=t.getPreH(e),n.preV=t.getPreV(e),n.width=t.getWidth(e),n.height=t.getHeight(e),n.width+=n.preH,n.height+=n.preV,n.id=t.getId(e),n.x=n.y=0,n.depth=0,n.children||(n.children=[]),n.addGap(i,r),n}Yw.assign(Kw.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(e,t){var n=this;n.hgap+=e,n.vgap+=t,n.width+=2*e,n.height+=2*t},eachNode:function(e){for(var t,n=[this];t=n.shift();)e(t),n=t.children.concat(n)},DFTraverse:function(e){this.eachNode(e)},BFTraverse:function(e){for(var t,n=[this];t=n.shift();)e(t),n=n.concat(t.children)},getBoundingBox:function(){var e={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode((function(t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.width=Math.max(e.width,t.x+t.width),e.height=Math.max(e.height,t.y+t.height)})),e},translate:function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.eachNode((function(n){n.x+=e,n.y+=t,n.x+=n.preH,n.y+=n.preV}))},right2left:function(){var e=this,t=e.getBoundingBox();e.eachNode((function(e){e.x=e.x-2*(e.x-t.left)-e.width})),e.translate(t.width,0)},bottom2top:function(){var e=this,t=e.getBoundingBox();e.eachNode((function(e){e.y=e.y-2*(e.y-t.top)-e.height})),e.translate(0,t.height)}});var Xw=function(e,t,n){void 0===t&&(t={});var i,r=new Kw(e,t=Yw.assign({},Zw,t)),o=[r];if(!n&&!e.collapsed)for(;i=o.shift();)if(!i.data.collapsed){var a=t.getChildren(i.data),s=a?a.length:0;if(i.children=new Array(s),a&&s)for(var l=0;l<s;l++){var u=new Kw(a[l],t);i.children[l]=u,o.push(u),u.parent=i,u.depth=i.depth+1}}return r},$w=Xw,Qw=function(){function e(e,t){void 0===t&&(t={});this.options=t,this.rootNode=$w(e,t)}return e.prototype.execute=function(){throw new Error("please override this method")},e}(),eb=Qw;function tb(e,t,n,i){void 0===i&&(i=[]);var r=this;r.w=e||0,r.h=t||0,r.y=n||0,r.x=0,r.c=i||[],r.cs=i.length,r.prelim=0,r.mod=0,r.shift=0,r.change=0,r.tl=null,r.tr=null,r.el=null,r.er=null,r.msel=0,r.mser=0}function nb(e,t,n){n?e.y+=t:e.x+=t,e.children.forEach((function(e){nb(e,t,n)}))}function ib(e,t){var n=t?e.y:e.x;return e.children.forEach((function(e){n=Math.min(ib(e,t),n)})),n}function rb(e,t){nb(e,-ib(e,t),t)}function ob(e,t,n){n?t.y=e.x:t.x=e.x,e.c.forEach((function(e,i){ob(e,t.children[i],n)}))}function ab(e,t,n){void 0===n&&(n=0),t?(e.x=n,n+=e.width):(e.y=n,n+=e.height),e.children.forEach((function(e){ab(e,t,n)}))}tb.fromNode=function(e,t){if(!e)return null;var n=[];return e.children.forEach((function(e){n.push(tb.fromNode(e,t))})),t?new tb(e.height,e.width,e.x,n):new tb(e.width,e.height,e.y,n)};var sb=Xw,lb=function(e,t){for(var n=sb(e.data,t,!0),i=sb(e.data,t,!0),r=e.children.length,o=Math.round(r/2),a=t.getSide||function(e,t){return t<o?"right":"left"},s=0;s<r;s++){var l=e.children[s];"right"===a(l,s)?i.children.push(l):n.children.push(l)}return n.eachNode((function(e){e.isRoot()||(e.side="left")})),i.eachNode((function(e){e.isRoot()||(e.side="right")})),{left:n,right:i}},ub=lb,cb=["LR","RL","TB","BT","H","V"],hb=["LR","RL","H"],fb=cb[0],db=function(e,t,n){var i=t.direction||fb;if(t.isHorizontal=function(e){return hb.indexOf(e)>-1}(i),i&&-1===cb.indexOf(i))throw new TypeError("Invalid direction: "+i);if(i===cb[0])n(e,t);else if(i===cb[1])n(e,t),e.right2left();else if(i===cb[2])n(e,t);else if(i===cb[3])n(e,t),e.bottom2top();else if(i===cb[4]||i===cb[5]){var r=ub(e,t),o=r.left,a=r.right;n(o,t),n(a,t),t.isHorizontal?o.right2left():o.bottom2top(),a.translate(o.x-a.x,o.y-a.y),e.x=o.x,e.y=a.y;var s=e.getBoundingBox();t.isHorizontal?s.top<0&&e.translate(0,-s.top):s.left<0&&e.translate(-s.left,0)}var l=t.fixedRoot;return void 0===l&&(l=!0),l&&e.translate(-(e.x+e.width/2+e.hgap),-(e.y+e.height/2+e.vgap)),e};function vb(e,t){return vb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},vb(e,t)}var gb=function(e,t){void 0===t&&(t={});var n=t.isHorizontal;function i(e){0===e.cs?(e.el=e,e.er=e,e.msel=e.mser=0):(e.el=e.c[0].el,e.msel=e.c[0].msel,e.er=e.c[e.cs-1].er,e.mser=e.c[e.cs-1].mser)}function r(e,t,n){for(var i=e.c[t-1],r=i.mod,u=e.c[t],c=u.mod;null!==i&&null!==u;){l(i)>n.low&&(n=n.nxt);var h=r+i.prelim+i.w-(c+u.prelim);h>0&&(c+=h,o(e,t,n.index,h));var f=l(i),d=l(u);f<=d&&null!==(i=s(i))&&(r+=i.mod),f>=d&&null!==(u=a(u))&&(c+=u.mod)}!i&&u?function(e,t,n,i){var r=e.c[0].el;r.tl=n;var o=i-n.mod-e.c[0].msel;r.mod+=o,r.prelim-=o,e.c[0].el=e.c[t].el,e.c[0].msel=e.c[t].msel}(e,t,u,c):i&&!u&&function(e,t,n,i){var r=e.c[t].er;r.tr=n;var o=i-n.mod-e.c[t].mser;r.mod+=o,r.prelim-=o,e.c[t].er=e.c[t-1].er,e.c[t].mser=e.c[t-1].mser}(e,t,i,r)}function o(e,t,n,i){e.c[t].mod+=i,e.c[t].msel+=i,e.c[t].mser+=i,function(e,t,n,i){if(n!==t-1){var r=t-n;e.c[n+1].shift+=i/r,e.c[t].shift-=i/r,e.c[t].change-=i-i/r}}(e,t,n,i)}function a(e){return 0===e.cs?e.tl:e.c[0]}function s(e){return 0===e.cs?e.tr:e.c[e.cs-1]}function l(e){return e.y+e.h}function u(e,t,n){for(;null!==n&&e>=n.low;)n=n.nxt;return{low:e,index:t,nxt:n}}ab(e,n);var c=tb.fromNode(e,n);return function e(t){if(0!==t.cs){e(t.c[0]);for(var n=u(l(t.c[0].el),0,null),o=1;o<t.cs;++o){e(t.c[o]);var a=l(t.c[o].er);r(t,o,n),n=u(a,o,n)}!function(e){e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2}(t),i(t)}else i(t)}(c),function e(t,n){n+=t.mod,t.x=t.prelim+n,function(e){for(var t=0,n=0,i=0;i<e.cs;i++)n+=(t+=e.c[i].shift)+e.c[i].change,e.c[i].mod+=n}(t);for(var i=0;i<t.cs;i++)e(t.c[i],n)}(c,0),ob(c,e,n),rb(e,n),e},pb=db,yb=Ww,mb=function(e){function t(){return e.apply(this,arguments)||this}var n,i;return i=e,(n=t).prototype=Object.create(i.prototype),n.prototype.constructor=n,vb(n,i),t.prototype.execute=function(){return pb(this.rootNode,this.options,gb)},t}(eb),wb={};var bb=function(e,t){return t=yb.assign({},wb,t),new mb(e,t).execute()},kb=Ww;function xb(e,t){void 0===t&&(t=[]);var n=this;n.x=n.y=0,n.leftChild=n.rightChild=null,n.height=0,n.children=t}var Cb={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function Eb(e,t,n){n?(t.x=e.x,t.y=e.y):(t.x=e.y,t.y=e.x),e.children.forEach((function(e,i){Eb(e,t.children[i],n)}))}function Sb(e,t){return Sb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Sb(e,t)}var Mb=function(e,t){void 0===t&&(t={}),t=kb.assign({},Cb,t);var n,i=0;var r=function e(t){if(!t)return null;t.width=0,t.depth&&t.depth>i&&(i=t.depth);var n=t.children,r=n.length,o=new xb(t.height,[]);return n.forEach((function(t,n){var i=e(t);o.children.push(i),0===n&&(o.leftChild=i),n===r-1&&(o.rightChild=i)})),o.originNode=t,o.isLeaf=t.isLeaf(),o}(e);return function e(t){if(t.isLeaf||0===t.children.length)t.drawingDepth=i;else{var n=t.children.map((function(t){return e(t)})),r=Math.min.apply(null,n);t.drawingDepth=r-1}return t.drawingDepth}(r),function e(i){i.x=i.drawingDepth*t.rankSep,i.isLeaf?(i.y=0,n&&(i.y=n.y+n.height+t.nodeSep,i.originNode.parent!==n.originNode.parent&&(i.y+=t.subTreeSep)),n=i):(i.children.forEach((function(t){e(t)})),i.y=(i.leftChild.y+i.rightChild.y)/2)}(r),Eb(r,e,t.isHorizontal),e},Ab=db,_b=Ww,Pb=function(e){function t(){return e.apply(this,arguments)||this}var n,i;return i=e,(n=t).prototype=Object.create(i.prototype),n.prototype.constructor=n,Sb(n,i),t.prototype.execute=function(){var e=this;return e.rootNode.width=0,Ab(e.rootNode,e.options,Mb)},t}(eb),Ob={};var Tb=function(e,t){return t=_b.assign({},Ob,t),new Pb(e,t).execute()},Lb=Ww;function jb(e,t){return jb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},jb(e,t)}var Nb=eb,Db=function(e,t,n,i){var r=null;e.eachNode((function(e){!function(e,t,n,i,r){var o="function"==typeof n?n(e):n*e.depth;if(!i)try{if(e.id===e.parent.children[0].id)return e.x+=o,void(e.y=t?t.y:0)}catch(dx){}if(e.x+=o,t){if(e.y=t.y+Lb.getHeight(t,e,r),t.parent&&e.parent.id!==t.parent.id){var a=t.parent,s=a.y+Lb.getHeight(a,e,r);e.y=s>e.y?s:e.y}}else e.y=0}(e,r,t,n,i),r=e}))},Ib=lb,Rb=Ww,Bb=["LR","RL","H"],zb=Bb[0],Fb=function(e){function t(){return e.apply(this,arguments)||this}var n,i;return i=e,(n=t).prototype=Object.create(i.prototype),n.prototype.constructor=n,jb(n,i),t.prototype.execute=function(){var e=this.options,t=this.rootNode;e.isHorizontal=!0;var n=e.indent,i=void 0===n?20:n,r=e.dropCap,o=void 0===r||r,a=e.direction,s=void 0===a?zb:a,l=e.align;if(s&&-1===Bb.indexOf(s))throw new TypeError("Invalid direction: "+s);if(s===Bb[0])Db(t,i,o,l);else if(s===Bb[1])Db(t,i,o,l),t.right2left();else if(s===Bb[2]){var u=Ib(t,e),c=u.left,h=u.right;Db(c,i,o,l),c.right2left(),Db(h,i,o,l);var f=c.getBoundingBox();h.translate(f.width,0),t.x=h.x-t.width/2}return t},t}(Nb),Vb={};var Hb=function(e,t){return t=Rb.assign({},Vb,t),new Fb(e,t).execute()},Ub=Ww;function qb(e,t){var n=0;return e.children.length?e.children.forEach((function(e){n+=qb(e,t)})):n=e.height,e._subTreeSep=t.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,n)+2*e._subTreeSep,e.totalHeight}function Gb(e){var t=e.children,n=t.length;if(n){t.forEach((function(e){Gb(e)}));var i=t[0],r=t[n-1],o=r.y-i.y+r.height,a=0;if(t.forEach((function(e){a+=e.totalHeight})),o>e.height)e.y=i.y+o/2-e.height/2;else if(1!==t.length||e.height>a){var s=e.y+(e.height-o)/2-i.y;t.forEach((function(e){e.translate(0,s)}))}else e.y=(i.y+i.height/2+r.y+r.height/2)/2-e.height/2}}var Jb={getSubTreeSep:function(){return 0}};function Wb(e,t){return Wb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wb(e,t)}var Yb=function(e,t){void 0===t&&(t={}),t=Ub.assign({},Jb,t),e.parent={x:0,width:0,height:0,y:0},e.BFTraverse((function(e){e.x=e.parent.x+e.parent.width})),e.parent=null,qb(e,t),e.startY=0,e.y=e.totalHeight/2-e.height/2,e.eachNode((function(e){var t=e.children,n=t.length;if(n){var i=t[0];if(i.startY=e.startY+e._subTreeSep,1===n)i.y=e.y+e.height/2-i.height/2;else{i.y=i.startY+i.totalHeight/2-i.height/2;for(var r=1;r<n;r++){var o=t[r];o.startY=t[r-1].startY+t[r-1].totalHeight,o.y=o.startY+o.totalHeight/2-o.height/2}}}})),Gb(e)},Zb=db,Kb=Ww,Xb=function(e){function t(){return e.apply(this,arguments)||this}var n,i;return i=e,(n=t).prototype=Object.create(i.prototype),n.prototype.constructor=n,Wb(n,i),t.prototype.execute=function(){return Zb(this.rootNode,this.options,Yb)},t}(eb),$b={};var Qb=function(e,t){return t=Kb.assign({},$b,t),new Xb(e,t).execute()},ek=Jw({compactBox:bb,dendrogram:Tb,indented:Hb,mindmap:Qb}),tk=function(){return P((function e(t){A(this,e),O(this,"g",void 0),this.g=t}),[{key:"init",value:function(){return this.onInit()}},{key:"onInit",value:function(){}},{key:"onMessageChange",value:function(e){}},{key:"destroy",value:function(){}},{key:"load",value:function(){}},{key:"initData",value:function(e){var t=this;return e&&e.length?e.map((function(e){return"mind-map"===e.shape?t.getMindMap(e):e})):[]}},{key:"getMindMap",value:function(e){return ek.mindmap(e,{direction:"H",getHeight:function(e){return e.height},getWidth:function(e){return e.width},getHGap:function(){return 40},getVGap:function(){return 20},getSide:function(){return"right"}})}}])}(),nk=function(e){function t(e,n,i){var r;return A(this,t),O(r=s(this,t,[e]),"ns",void 0),O(r,"nodeModel",{}),O(r,"opt",{}),O(r,"items",[]),O(r,"nodeKey",void 0),O(r,"x6Ctrl",void 0),r.nodeModel=i,r.x6Ctrl=n,r.nodeKey=r.nodeModel.nodeKey,r.ns=r.nodeModel.ns,r.register(),r.init(),r}return h(t,e),P(t,[{key:"onInit",value:function(){o(t,"onInit",this,3)([])}},{key:"register",value:function(){var e=this,t=this,n=this.nodeModel.readonly;Gw.register(M(M({effect:["data"]},t.opt),{},{shape:"mind-map-".concat(t.nodeKey),html:function(e){var i=e.getData(),r=document.createElement("div");if(r.className=t.ns.b("custom-html-node"),!n){r.onclick=function(e){t.prevent(e),t.g.emit("mind-map:click",e,i)},r.ondblclick=function(e){t.prevent(e),t.g.emit("mind-map:dblclick",e,i)};var o=document.createElement("div");o.innerHTML='<svg t="1721380398285" class="add-node-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1711" width="1em" height="1em"><path d="M512 170.67c-23.56 0-42.67 19.1-42.67 42.67v256h-256c-23.56 0-42.67 19.1-42.67 42.67s19.1 42.67 42.67 42.67h256v256c0 23.56 19.1 42.67 42.67 42.67s42.67-19.1 42.67-42.67v-256h256c23.56 0 42.67-19.1 42.67-42.67s-19.1-42.67-42.67-42.67h-256v-256c0-23.57-19.11-42.67-42.67-42.67z" p-id="1712"></path></svg>',o.className=t.ns.be("custom-html-node","add-item-icon-box"),o.onclick=function(e){t.prevent(e),t.g.emit("mind-map:add-topic",e,i)},r.appendChild(o)}var a=t.createReadonlyNode.bind(t)(i);return r.append(a),r}})),this.g.on("mind-map:dblclick",(function(t,n){var i=t.target,r=i.parentNode;r.classList.add("is-activated");var o=e.createEditNode(n);o.onblur=function(t){e.prevent(t),e.onNodeEditBlur(t,n)},o.onclick=e.prevent,o.ondblclick=e.prevent,r.appendChild(o),o.focus(),o.focus(),o.setSelectionRange(0,n.label.length),i.remove(),i=null,r=null})),this.g.on("mind-map:click",(function(e){e.target.parentNode.classList.add("is-activated")}))}},{key:"load",value:function(){var e=this.x6Ctrl.getData();this.items=this.initData(e),this.g.addNodes(this.addNodes(this.items))}},{key:"addNodes",value:function(e){var t=this,n=[];return e.forEach((function(e){e.data&&"mind-map"===e.data.shape?t.createMindMapCell(e).forEach((function(e){n.push(e)})):n.push(e)})),n}},{key:"createMindMapCell",value:function(e){var t=this,n=[];if(e){var i=e.children;n.push(this.getMindMapCellItem(e)),i&&null!=i&&i.length&&i.forEach((function(e){n.push.apply(n,v(t.createMindMapCell(e)))}))}return n}},{key:"getMindMapCellItem",value:function(e){var t=e.data;return{id:t.id,shape:"mind-map-".concat(this.nodeKey),x:e.x,y:e.y,width:t.width,height:t.height,label:t.label,type:t.type,data:t,attrs:{body:{strokeWidth:1,fill:"#fff",rx:6,ry:6}}}}},{key:"getStyle",value:function(e,t){return{width:"".concat(e,"px"),height:"".concat(t,"px"),lineHeight:"".concat(t,"px")}}},{key:"createReadonlyNode",value:function(e){var t=e.label,n=e.width,i=e.height,r=this.getStyle(n,i),o=document.createElement("div");return o.className=this.ns.be("custom-html-node","readonly-node"),Object.assign(o.style,M({},r)),o.textContent=t,"".concat(t).length>5&&(o.title=t),o}},{key:"createEditNode",value:function(e){var t=document.createElement("input");return t.setAttribute("value",e.label),t.setAttribute("type","text"),Object.assign(t.style,M(M({},this.getStyle(e.width,e.height)),{},{textAlign:"center",lineHeight:"100%"})),t.className=this.ns.be("custom-html-node","edit-node"),t}},{key:"onNodeEditBlur",value:function(e,t){var n=e.target,i=n.value||"",r=n.parentNode;n.remove();var o=this.createReadonlyNode(t);o.textContent=i,this.g.emit("mind-map:blur",e,t,i),r.appendChild(o)}},{key:"prevent",value:function(e){e.stopPropagation(),e.preventDefault()}}])}(tk),ik=function(e){function t(e,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return A(this,t),O(i=s(this,t,[e]),"linkModel",{}),O(i,"opt",{inherit:"edge"}),O(i,"items",[]),O(i,"x6Ctrl",void 0),i.linkModel=r,i.x6Ctrl=n,i.register(),i}return h(t,e),P(t,[{key:"onInit",value:function(){o(t,"onInit",this,3)([])}},{key:"register",value:function(){Hw.registerEdge("mind-map-edge",M({connector:{name:"mind-map"},attrs:{line:{targetMarker:"",stroke:"var(--ibiz-color-primary)",strokeWidth:2}},zIndex:0},this.opt),!0),Hw.registerConnector("mind-map-connector",this.MindMapConnector,!0)}},{key:"MindMapConnector",value:function(e,t){var n=Math.abs(t.x-e.x),i=new Pv;i.appendSegment(Pv.createSegment("M",e.x,e.y)),i.appendSegment(Pv.createSegment("L",e.x,e.y));var r=e.x<t.x?e.x+n/2:e.x-n/2,o=e.y,a=e.x<t.x?t.x-n/2:t.x+n/2,s=t.y;return i.appendSegment(Pv.createSegment("C",r,o,a,s,t.x,t.y)),i.serialize()}},{key:"load",value:function(){var e=this.x6Ctrl.getData();this.items=this.initData(e);var t=this.addEdges(this.items);this.g.addEdges(t)}},{key:"addEdges",value:function(e){var t=this,n=[];return e.forEach((function(e){e.data&&"mind-map"===e.data.shape?e.children&&e.children.length&&n.push.apply(n,v(t.handleMindMap(e))):n.push(e)})),n}},{key:"handleMindMap",value:function(e){var t=this,n=[];return e&&e.children&&e.children.forEach((function(i){n.push(t.createMinMapCell(i,e)),i.children&&i.children&&n.push.apply(n,v(t.handleMindMap(i)))})),n}},{key:"createMinMapCell",value:function(e,t){if(e.data&&"mind-map"===e.data.shape){var n=e.id;return{shape:"mind-map-edge",source:{cell:t.id,anchor:{name:"right",args:{dx:0}}},target:{cell:n,anchor:{name:"left"}},connector:{name:"mind-map-connector"},data:e}}return e}}])}(tk),rk=function(){return P((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};A(this,e),O(this,"evt",new Z(this.getEventArgs.bind(this))),O(this,"g",void 0),O(this,"node",void 0),O(this,"link",void 0),O(this,"defaultParams",void 0),O(this,"backupData",[]),O(this,"selection",[]),O(this,"internalFocus",!1),O(this,"defaultData",[]),O(this,"graphOptions",{connecting:{connectionPoint:"anchor"},interacting:{nodeMovable:!1},panning:!0}),this.defaultParams=i,this.defaultData=i.defaultData,this.backupData=Ne(this.defaultData),Object.assign(this.graphOptions,n),this.graphOptions.container=t,this.graphOptions.mousewheel={enabled:!0,global:!0,modifiers:["ctrl","meta"],zoomAtMousePosition:!0,guard:function(e){var t;return(null===(t=e.target)||void 0===t||null===(t=t.parentNode)||void 0===t?void 0:t.id)==="diagram-".concat(i.nodeKey)}},this.g=new Hw(this.graphOptions),this.link=new ik(this.g,this,{}),this.node=new nk(this.g,this,{nodeKey:this.defaultParams.nodeKey,ns:this.defaultParams.ns,readonly:this.defaultParams.readonly}),this.defaultParams.readonly||this.g.disablePanning(),this.init()}),[{key:"getEventArgs",value:function(){return{context:{},params:{},data:[],targetName:"",view:{}}}},{key:"init",value:function(){this.initEvents(),this.load()}},{key:"initEvents",value:function(){var e=this;this.g.on("mind-map:add-topic",(function(t,n){var i=n.id;e.addChildNode(i)&&e.refresh()})),this.g.on("mind-map:click",(function(t,n){e.clearSelection(),e.selection=[{data:n,node:t.target.parentNode}],t.target.parentNode.classList.add("is-activated"),e.internalFocus=!0})),this.g.on("mind-map:blur",(function(t,n,i){e.updateNode(n.id,i||"")||e.refresh(),e.internalFocus=!1,e.evt.emit("onNodeBlur",void 0)}))}},{key:"clearSelection",value:function(){this.selection&&this.selection.length>0&&(this.selection[0].node.classList.remove("is-activated"),this.selection[0].node=null,this.selection=[])}},{key:"addChildNode",value:function(e){var t=this.findItem(this.backupData,e),n=null==t?void 0:t.node;if(n){var i=n.children?n.children.length:0,r={id:"".concat(e,"-").concat(i+1),type:"topic-child",shape:"mind-map",label:"",width:120,height:30};if(r)return n.children?n.children.push(r):Object.assign(n,{children:[r]}),this.defaultData=Ne(this.backupData),r}return null}},{key:"updateNode",value:function(e,t){var n=this.findItem(this.backupData,e),i=null==n?void 0:n.parent;if(i&&i.children){var r=i.children,o=r.findIndex((function(t){return t.id===e}));return r[o].label=t,this.defaultData=Ne(this.backupData),!0}return!1}},{key:"findItem",value:function(e,t){var n=this,i=null;return e&&e.length&&e.forEach((function(e){if(e.id===t&&(i={parent:null,node:e}),e.children&&e.children){var r=n.findItem(e.children,t);r&&(i={parent:r.parent||e,node:r.node})}})),i}},{key:"removeNode",value:function(e){var t=this.findItem(this.backupData,e),n=null==t?void 0:t.parent;if(n&&n.children){var i=n.children,r=i.findIndex((function(t){return t.id===e}));return i.splice(r,1),this.defaultData=Ne(this.backupData),!0}return!1}},{key:"togglePanning",value:function(){this.g.togglePanning()}},{key:"disablePanning",value:function(){this.g.disablePanning()}},{key:"getData",value:function(){return this.defaultData}},{key:"load",value:(t=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.node.load(),this.link.load(),this.g.centerContent();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"refresh",value:(e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.g.clearCells({refresh:!0}),e.next=3,this.load();case 3:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"destroy",value:function(){this.g.dispose(),this.node.destroy(),this.link.destroy()}}]);var e,t}(),ok=c({name:"IBizDiagramBoard",props:jc(),emits:["change"],setup:function(e){var t,n=ne("diagram-board"),i=f(),r=f(),o=f(!1),a=f();a.value=[{type:"panning",icon:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g stroke-width="1" fill-rule="evenodd"><path d="M8.446.5c.628.01 1.101.34 1.416.843.035.056.067.112.096.167l.063.132.041-.018c.135-.056.282-.092.44-.106l.163-.008c.823 0 1.356.483 1.637 1.154.088.21.132.436.132.662l.002.479.08-.022c.096-.022.198-.036.304-.04l.163-.001c.63.024 1.082.338 1.326.82.143.282.19.551.19.772l-.107 6.715a3.688 3.688 0 0 1-.87 2.334 4.249 4.249 0 0 1-.364.377c-.695.637-1.403.894-1.968.94l-3.718-.02a3.014 3.014 0 0 1-.977-.333 3.486 3.486 0 0 1-.608-.398l-3.335-3.448a4.423 4.423 0 0 1-.597-.587c-.376-.443-.62-.9-.652-1.386a1.437 1.437 0 0 1 .28-.96c.242-.33.546-.547.892-.638.483-.128.952-.005 1.39.257.18.108.317.216.397.292l.352.318-.042-5.204.004-.131c.014-.228.065-.505.183-.792.251-.609.738-1.023 1.455-1.062a1.75 1.75 0 0 1 .623.073l.027.009c.021-.054.044-.108.07-.163l.085-.167C7.315.832 7.795.49 8.446.5zm-.02 1.2c-.158-.002-.263.072-.361.248-.025.044-.047.09-.064.13l-.052.126-.005.003-.001.954h.029V7.61h-1.2L6.77 3.338h-.027a.861.861 0 0 0-.044-.227l-.036-.092c-.074-.161-.166-.224-.386-.213-.208.012-.322.108-.41.321-.07.172-.096.36-.096.463l.064 7.935-2.417-2.19-.103-.075-.068-.043c-.187-.113-.355-.157-.466-.127-.072.019-.146.071-.231.188a.24.24 0 0 0-.05.172c.011.173.144.423.369.688.163.191.328.343.486.475l3.329 3.444c.026.02.063.047.109.077l.16.098.097.052c.209.11.412.183.506.201l3.584.017c.01 0 .022-.002.037-.005l.121-.028a2.606 2.606 0 0 0 1.048-.594c.09-.082.177-.172.26-.27.369-.433.576-.991.585-1.575l.108-6.702a.596.596 0 0 0-.061-.224c-.055-.107-.126-.156-.301-.163-.257-.01-.404.17-.462.454v2.132h-1.2V5.688h-.03l-.012-2.36a.513.513 0 0 0-.038-.2c-.114-.27-.276-.418-.531-.418-.208 0-.345.164-.413.403l.001 4.4h-1.2V3.288h-.037l-.028-.989-.025-.076a1.36 1.36 0 0 0-.07-.16l-.049-.084c-.116-.187-.245-.276-.417-.279z" id="arj形状结合"></path></g></svg>',text:"平移"},{type:"separator",text:"|"},{type:"delete",icon:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g stroke-width="1" fill-rule="evenodd"><path d="M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z" id="azk删除"></path></g></svg>',text:"删除"}];var s=[{id:"1",type:"topic",shape:"mind-map",label:"思维导图",width:120,height:40,children:[{id:"1-1",type:"topic-child",shape:"mind-map",label:"新建节点",width:120,height:30},{id:"1-2",type:"topic-child",shape:"mind-map",label:"新建节点",width:120,height:30}]}];if(e.data){var l=e.data.data;s=l}var u=function(){var e=E(x().mark((function e(){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(n=t)||void 0===n||n.destroy();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var o;e.isFocus&&(null===(o=i.value)||void 0===o||o.focus());var a=i.value,l=a.offsetWidth,u=a.offsetHeight;(t=new rk(r.value,{width:l,height:u},{ns:n,nodeKey:e.nodeKey,readonly:e.readonly,defaultData:s})).g.zoomToFit(),t.g.zoom(-.2),t.evt.on("onNodeBlur",(function(){var n;e.change({data:null===(n=t)||void 0===n?void 0:n.defaultData},{isUpdate:!0})}))},h=function(n){switch(n.type){case"delete":u(),t.internalFocus=!0,e.change("",{isDelete:!0});break;case"panning":t.togglePanning()}},d=function(){var e=E(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.value||(o.value=!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=this,g=new ResizeObserver((function(){i.value&&0!==i.value.offsetWidth&&(c.bind(v)(),g.disconnect(),g=null)}));return _((function(){r.value&&(g.observe(r.value),i.value.addEventListener("click",(function(){var e;t.clearSelection(),null===(e=i.value)||void 0===e||e.focus()})),i.value.addEventListener("keydown",(function(e){t.internalFocus=!1,"Backspace"!==e.key&&"Delete"!==e.key||t&&t.selection&&t.selection.length>0&&t.removeNode(t.selection[0].data.id)&&(t.clearSelection(),t.refresh())})))})),R((function(){u()})),{ns:n,diagramRef:r,diagramBoxRef:i,diagramBoxActivate:o,onFocus:d,onBlur:function(){if(t){var n;if(t.clearSelection(),t.internalFocus)return;e.change({data:null===(n=t)||void 0===n?void 0:n.defaultData}),o.value=!1}},renderTopToolBar:function(){return L("div",{class:n.b("top-tool-bar")},[a.value.map((function(e){return L("div",{class:[n.be("top-tool-bar","item"),n.be("top-tool-bar","item-".concat(e.type))],title:e.text,onClick:function(){return h(e)}},[L("div",{class:n.bem("top-tool-bar","item","content"),innerHTML:e.icon||e.text},null)])}))])}}},render:function(){return L("div",{ref:"diagramBoxRef",class:[this.ns.b(),this.readonly?this.ns.m("readonly"):"",this.ns.is("activated",this.diagramBoxActivate)],tabindex:"0",onFocus:this.onFocus,onBlur:this.onBlur},[!this.readonly&&this.diagramBoxActivate?this.renderTopToolBar():"",L("div",{id:"diagram-".concat(this.nodeKey),ref:"diagramRef"},null)])}}),ak=c({name:"IBizAudio",props:jc(),setup:function(e){var t=ne("audio"),n=f(""),i=f(0),r=f("");if(e.data){var o=e.data,a=o.name,s=o.size,l=o.url;n.value=a,i.value=s,r.value=l}var u=f(!1),c=f("00:00"),h=f("00:00"),d=f(),v=f(),g=f(),p=f(0),y=f(0),m=f(0),w=D((function(){var e=i.value<=0?0:Math.round(i.value/1048576*10)/10;return"".concat(e," MB")})),b=function(){if(d.value){p.value=d.value.duration,Number.isNaN(p.value)&&(p.value=0);var e=parseInt((p.value/60).toString(),10),t=e.toString();e<10&&(t="0".concat(e.toString()));var n=Math.round(p.value%60),i=n.toString();n<10&&(i="0".concat(n.toString())),h.value="".concat(t,":").concat(i)}},k=function(){d.value.addEventListener("timeupdate",(function(){!function(){y.value=d.value.currentTime;var e=Math.floor(y.value),t=parseInt((e/60).toString(),10),n=t.toString();t<10&&(n="0".concat(t.toString()));var i=Math.round(e%60),r=i.toString();i<10&&(r="0".concat(i.toString())),c.value="".concat(n,":").concat(r),"00:00"===h.value&&b()}(),d.value&&(m.value=function(e,t){if(0===e||0===t)return 0;var n=e/t*100;return n<0?n=0:n>100&&(n=100),n}(y.value,p.value))}),!1),d.value.addEventListener("ended",(function(){u.value=!1,d.value.load(),c.value="00:00"})),d.value.oncanplaythrough=function(){b()}};_((function(){d.value&&k()}));return{ns:t,realAudioTime:c,totalAudioTime:h,isPlay:u,audioRef:d,bar:v,slid:g,percentage:m,fileName:n,fileSizeText:w,audioSrc:r,play:function(){d.value.paused?(d.value.play(),u.value=!0):(d.value.pause(),u.value=!1)},renderStop:function(){return L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http:// www.w3.org/2000/svg","p-id":"3144",width:"1em",height:"1em"},[L("path",{d:"M209.645253 863.934444l201.049992 0 0-703.866842L209.645253 160.067602 209.645253 863.934444zM611.804588 863.934444l201.113437 0 0-703.866842L611.804588 160.067602 611.804588 863.934444z","p-id":"3145"},null)])},renderArrowSvg:function(){return L("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http:// www.w3.org/2000/svg","p-id":"2304",width:"1em",height:"1em"},[L("path",{d:"M768 512 256 0 256 1024Z","p-id":"2305"},null)])},renderAudioSvg:function(){return L("svg",{class:"icon audio-icon",viewBox:"0 0 1092 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4287",width:"1em",height:"1em"},[L("path",{d:"M394.24 429.056v378.368c0 83.456-67.584 150.528-150.528 150.528-83.456 0-150.528-67.584-150.528-150.528 0-83.456 67.584-150.528 150.528-150.528 25.6 0 49.152 6.144 70.144 17.408V395.776 194.048c0-19.456 13.824-36.352 33.28-39.424l550.4-95.232c24.576-4.096 47.104 14.848 47.104 39.424v611.84c0 83.456-67.584 150.528-150.528 150.528-83.456 0-150.528-67.584-150.528-150.528 0-83.456 67.584-150.528 150.528-150.528 25.6 0 49.152 6.144 70.144 17.408V347.648L394.24 429.056z m0-81.408L864.256 266.24V146.432L394.24 228.352v119.296zM243.2 877.568c38.912 0 70.144-31.744 70.144-70.144 0-38.912-31.744-70.144-70.144-70.144s-70.144 31.744-70.144 70.144c0 38.4 31.744 70.144 70.144 70.144z m550.912-96.256c38.912 0 70.144-31.744 70.144-70.144 0-38.912-31.744-70.144-70.144-70.144-38.912 0-70.144 31.744-70.144 70.144 0 38.4 31.232 70.144 70.144 70.144z","p-id":"4288"},null)])},onSliderChange:function(e){}}},render:function(){var e=this,t=L("div",{class:[this.ns.e("content")],ref:"componentRef"},[L("div",{class:this.ns.e("left")},[L("div",{class:[this.ns.e("play"),this.ns.is("active",this.isPlay)],onClick:function(){return e.play()}},[this.isPlay?this.renderStop():this.renderArrowSvg()])]),L("div",{class:this.ns.e("wrapper")},[L("div",{class:this.ns.em("wrapper","top")},[L("span",null,[this.fileName]),L("span",{class:this.ns.em("wrapper","file-size")},[this.fileSizeText])]),L("div",{class:this.ns.em("wrapper","time-bar")},[L("div",{class:this.ns.em("wrapper","time")},[this.realAudioTime]),L("div",{class:this.ns.em("wrapper","slider")},[L(j("el-slider"),{modelValue:this.percentage,"onUpdate:modelValue":function(t){return e.percentage=t},max:100,min:0,disabled:!0,onChange:this.onSliderChange},null)]),L("div",{class:this.ns.em("wrapper","time")},[this.totalAudioTime])])]),L("audio",{ref:"audioRef",src:this.audioSrc},null)]);return L("div",{ref:"audio",class:[this.ns.b(),this.disabled?this.ns.m("disabled"):"",this.readonly?this.ns.m("readonly"):""]},[t])}}),sk=c({name:"IBizFiles",props:jc(),setup:function(e){var t=ne("files"),n=f(""),i=f(!1),r=D((function(){var t={};return e.data&&Object.assign(t,e.data),t}));return{ns:t,file:r,toolBars:[{type:"download",text:"下载",color:"rgb(245,108,108,0.2)",icon:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g stroke-width="1" fill-rule="evenodd"><path d="M7.393 9.953V1.02h1.2v9.06l2.717-2.716.88-.817.817.817-4.95 4.95-4.95-4.95.847-.847 1.16 1.165.004-.004 2.275 2.275zM16 9v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V9h1.2v5.8h13.6V9H16z" id="ajb下载"></path></g></svg>'},{type:"separator",text:"|"},{type:"delete",text:"删除",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z'></path> </g></svg>"}],visible:i,hoverToolBarItemKey:n,onToolItemClick:function(t){var n;if("separator"!==t.type)switch(t.type){case"download":(n=r.value.url||"")&&ibiz.util.file.fileDownload(n,r.value.name);break;case"delete":e.change("",{isDelete:!0})}},onMouseover:function(e){n.value=e.type},onMouseout:function(){n.value=""},onShow:function(){i.value=!0},onHide:function(){i.value=!1}}},render:function(){var e=this,t=L("div",{ref:"referenceRef",class:this.ns.e("reference")},[L("span",{class:this.ns.em("reference","file-type")},[_c(this.file.type)]),this.file.name&&L("span",{class:this.ns.em("reference","file-name")},[this.file.name])]),n=L(j("el-popover"),{trigger:"click",ref:"popoverRef",width:"auto","hide-after":0,placement:"top-start","popper-class":[this.ns.e("popover"),"".concat(this.nodeKey)],onShow:this.onShow,onHide:this.onHide},{default:function(){return L("div",{class:e.ns.be("popover","content")},[e.toolBars.map((function(t){return L("div",{class:[e.ns.be("popover","tool-item"),e.ns.be("popover","tool-item-".concat(t.type)),e.ns.is(t.type,!!t.type)],title:t.text,onClick:function(){return e.onToolItemClick(t)},onMouseover:function(){return e.onMouseover(t)},onMouseout:function(){return e.onMouseout()}},[L("div",{class:e.ns.bem("popover","tool-item","content"),innerHTML:t.icon||t.text},null)])}))])},reference:function(){return t}});return L("div",{ref:"files",class:[this.ns.b(),this.readonly?this.ns.m("readonly"):"",this.ns.is("hover-tool-bar-item",!!this.hoverToolBarItemKey||this.visible),this.ns.is(this.hoverToolBarItemKey,!!this.hoverToolBarItemKey)]},[n])}}),lk=c({name:"IBizLayoutToolBar",props:{modal:{type:Object,required:!0}},setup:function(e){var t=ne("layout-toolbar"),n=[{type:"delete",text:"删除",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z'></path> </g></svg>"}],i=function(){var t=E(x().mark((function t(){var n,i;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.modal&&(i={ok:!0,data:[{value:"",params:{isDelete:!0}}]},null===(n=e.modal)||void 0===n||n.dismiss(i));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{ns:t,renderToolBar:function(){return L("div",{class:t.e("content")},[n.map((function(e){return L("div",{class:[t.e("tool-item"),t.e("tool-item-".concat(e.type))],title:e.text,onClick:function(){return function(e){"separator"!==e.type&&"delete"===e.type&&i()}(e)}},[L("div",{class:t.em("tool-item","content"),innerHTML:e.icon||e.text},null)])}))])}}},render:function(){return L("div",{class:[this.ns.b()]},[this.renderToolBar()])}}),uk=function(e){function t(){var e;A(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return O(e=s(this,t,[].concat(i)),"vueAppKey",be()),O(e,"vueApp",void 0),e}return h(t,e),P(t,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount(),Nc(this.vueAppKey)}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){var r,o,a,s,l,u,c,h,f,d,v=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(i),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e){var t=new CustomEvent("dateElemEvent",{detail:{type:a,value:e},bubbles:!0,composed:!0});v.dispatchEvent(t)},null===(r=this.vueApp)||void 0===r||r.unmount(),this.vueApp=q(Dc,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e){return f(e)}}),this.innerHTML="",(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.use(Re,{locale:Tc}),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),ck=function(e){function t(){var e;A(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return O(e=s(this,t,[].concat(i)),"vueAppKey",be()),O(e,"vueApp",void 0),e}return h(t,e),P(t,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount(),Nc(this.vueAppKey)}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){var r,o,a,s,l,u,c,h,f,d,v=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(i),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e,t){var n=new CustomEvent("labelElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});v.dispatchEvent(n)},null===(r=this.vueApp)||void 0===r||r.unmount(),this.vueApp=q(Ic,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e,t){return f(e,t)}}),this.innerHTML="",(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.use(Re),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),hk=function(e){function t(){var e;A(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return O(e=s(this,t,[].concat(i)),"vueAppKey",be()),O(e,"vueApp",void 0),e}return h(t,e),P(t,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount()}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){var r,o,a,s,l,u,c,h,f,d,v=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(i),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e,t){var n=new CustomEvent("promptBoxElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});v.dispatchEvent(n)},null===(r=this.vueApp)||void 0===r||r.unmount(),this.innerHTML="",this.vueApp=q(Fc,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e,t){return f(e,t)}}),(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.component(Be.name,Be),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),fk=function(e){function t(){var e;A(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return O(e=s(this,t,[].concat(i)),"vueAppKey",be()),O(e,"vueApp",void 0),e}return h(t,e),P(t,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount()}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){var r,o,a,s,l,u,c,h,f,d,v,g=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=15;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(i),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).isUpdate,h=u.readonly,f=u.isAdd,d=function(e,t){var n=new CustomEvent("mindMapElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});g.dispatchEvent(n)},null===(r=this.vueApp)||void 0===r||r.unmount(),this.vueApp=q(ok,{data:s,nodeKey:this.vueAppKey,isFocus:!!f||!!c,readonly:!!h,change:function(e,t){return d(e,t)}}),this.innerHTML="",(v=document.createElement("span")).classList.add("elem-box"),v.part.add("container"),this.vueApp.mount(v),this.appendChild(v);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),dk=function(e){function t(){var e;A(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return O(e=s(this,t,[].concat(i)),"vueAppKey",be()),O(e,"vueApp",void 0),e}return h(t,e),P(t,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount()}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){var r,o,a,s,l,u,c,h,f,d,v=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(i),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e){var t=new CustomEvent("audioElemEvent",{detail:{type:a,value:e},bubbles:!0,composed:!0});v.dispatchEvent(t)},null===(r=this.vueApp)||void 0===r||r.unmount(),this.innerHTML="",this.vueApp=q(ak,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e){return f(e)}}),(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.component(ze.name,ze),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),vk=function(e){function t(){var e;A(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return O(e=s(this,t,[].concat(i)),"vueAppKey",be()),O(e,"vueApp",void 0),e}return h(t,e),P(t,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount(),Nc(this.vueAppKey)}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){var r,o,a,s,l,u,c,h,f,d,v=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(i),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e,t){var n=new CustomEvent("formulaElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});v.dispatchEvent(n)},null===(r=this.vueApp)||void 0===r||r.unmount(),this.vueApp=q(bh,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e,t){return f(e,t)}}),this.innerHTML="",(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.component(Fe.name,Fe),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),gk=function(e){function t(){var e;return A(this,t),O(e=s(this,t),"readonly",!1),O(e,"overlay",void 0),e}return h(t,e),P(t,[{key:"handleMousedown",value:function(e){0===e.button&&this.classList.remove("is-activated")}},{key:"connectedCallback",value:function(){var e=this;if(this.classList.add("layout-elem"),!this.readonly){var t=this,n=function(){var n=E(x().mark((function n(i){var r,o,a,s;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.overlay=Lc(lk,{placement:"top-start"}),n.next=3,t.overlay.present(i);case 3:return n.next=5,t.overlay.onWillDismiss();case 5:(r=n.sent).ok&&r.data&&r.data.length>0&&(o=r.data[0],a=o.value,s=o.params,l=void 0,l=new CustomEvent("labelElemEvent",{detail:{type:"insert-layout",value:a,params:s},bubbles:!0,composed:!0}),e.dispatchEvent(l)),t.overlay=null;case 8:case"end":return n.stop()}var l}),n)})));return function(e){return n.apply(this,arguments)}}();this.onclick=function(e){var t;"layout-elem"!==(null===(t="".concat(e.target.nodeName))||void 0===t?void 0:t.toLocaleLowerCase())||e.target.classList.contains("is-activated")||(e.target.classList.add("is-activated"),n(e.target))},document.addEventListener("mousedown",this.handleMousedown.bind(this))}}},{key:"disconnectedCallback",value:function(){this.overlay&&(this.overlay.dismiss(),this.overlay=null),document.removeEventListener("mousedown",this.handleMousedown.bind(this))}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){var r,o,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=7;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:r=JSON.parse(i),o=r.params,a=(void 0===o?{}:o).readonly,this.readonly=!!a;case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),pk=function(e){function t(){var e;return A(this,t),O(e=s(this,t),"vueAppKey",be()),O(e,"vueApp",void 0),e}return h(t,e),P(t,[{key:"connectedCallback",value:function(){this.classList.add("layout-column-elem")}},{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount(),Nc(this.vueAppKey)}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=3;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:case"end":return e.stop()}}),e)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),yk=function(e){function t(){var e;A(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return O(e=s(this,t,[].concat(i)),"vueAppKey",be()),O(e,"vueApp",void 0),e}return h(t,e),P(t,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount()}},{key:"attributeChangedCallback",value:(n=E(x().mark((function e(t,n,i){var r,o,a,s,l,u,c,h,f,d,v=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!i||n!==i){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(i),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e,t){var n=new CustomEvent("filesElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});v.dispatchEvent(n)},null===(r=this.vueApp)||void 0===r||r.unmount(),this.innerHTML="",this.vueApp=q(sk,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e,t){return f(e,t)}}),(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.use(Re),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return n.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]);var n}(n(HTMLElement)),mk=function(){return P((function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"quoteUrl",""),O(this,"quoteFieldMap",{id:"id",name:"name"}),O(this,"quoteCodelistMap",new Map),O(this,"quoteMethod","post"),O(this,"quoteParams",{}),O(this,"quoteScript","`#{id=${data.id},name=${data.name},identifier=${data.identifier},icon=${data.icon}}`"),O(this,"quoteInScript","value.replaceAll(/#{id=(.+?),name=(.+?),identifier=(.+?),icon=((.|[\\t\\r\\f\\n\\s])+?)}/g,(x, id, name, identifier, icon) => {return controller.getNodeInfo({ id, name, identifier, icon })})"),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"overlay",null),O(this,"evt",void 0),O(this,"execting",!1),O(this,"query",""),O(this,"curPage",0),O(this,"size",20),O(this,"presetPreventEvents",[13,38,40]),O(this,"presetPreventPropEvents",[27]),O(this,"linkViewId","plmweb.recent_redirect_view"),O(this,"codeListMap",{}),O(this,"cleanup",Oe),this.registerNode()}),[{key:"markerPlugin",value:function(e){var t=this,n=e.insertText,i=e.isInline,r=e.isVoid;return e.insertText=function(i){t.editor?t.editor.isFocused()?ge.getSelectedElems(e).some((function(t){return e.isVoid(t)}))?n(i):(n(i),"#"!==i||t.execting||setTimeout((function(){t.query="",t.showModal()}),0)):n(i):n(i)},e.isInline=function(e){return"marker"===ge.getNodeType(e)||i(e)},e.isVoid=function(e){return"marker"===ge.getNodeType(e)||r(e)},e}},{key:"registerNode",value:function(){window.markerIsRegiter||(ye.registerModule(Ru),window.markerIsRegiter=!0),ye.registerPlugin(this.markerPlugin.bind(this))}},{key:"init",value:(i=E(x().mark((function e(t,n){var i,r,o,a,s,l,u,c,h,f,d,v=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams,!this.editorParams){e.next=20;break}if(i=this.editorParams,r=i.QUOTEURL,o=i.QUOTEFIELDMAP,a=i.QUOTEMETHOD,s=i.QUOTESCRIPT,l=i.QUOTEINSCRIPT,u=i.QUOTEPARAMS,c=i.QUOTECODELISTMAP,h=i.LINKVIEWID,r&&(this.quoteUrl=r),o&&(this.quoteFieldMap=JSON.parse(o)),a&&(this.quoteMethod=a.toLowerCase()),u&&(this.quoteParams=JSON.parse(u)),s&&(this.quoteScript=s),l&&(this.quoteInScript=l),!c){e.next=19;break}return f=JSON.parse(c),e.next=19,this.setCodeListMap(f);case 19:h&&(this.linkViewId=h);case 20:(d=this.editor.getEditableContainer())&&(this.cleanup=Pe(d,"keydown",(function(e){var t;v.execting&&v.presetPreventEvents.includes(e.keyCode)&&e.preventDefault(),v.execting&&v.presetPreventPropEvents.includes(e.keyCode)&&(e.stopPropagation(),null===(t=v.overlay)||void 0===t||t.dismiss())}))),this.evt.on("openPopper",(function(){v.execting=!0})),this.evt.on("closePopper",(function(){v.execting=!1}));case 24:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"onDestroyed",value:function(){this.cleanup!==Oe&&this.cleanup(),this.overlay&&this.overlay.dismiss()}},{key:"setCodeListMap",value:(n=E(x().mark((function e(t){var n,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=x().keys(t);case 1:if((e.t1=e.t0()).done){e.next=9;break}return n=e.t1.value,e.next=5,this.loadCodeList(t[n]);case 5:(i=e.sent)&&this.quoteCodelistMap.set(n,i),e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"showModal",value:function(){var e=this;if(this.quoteUrl){var t=document.getSelection();if(t){var n=t.focusNode;n&&this.openPopover(n.parentNode).then((function(t){t.length>0&&e.insertNode(t[0])}))}}else ibiz.log.error("未配置提及项QUOTEURL编辑器参数！")}},{key:"findCodeListItem",value:function(e,t){if(e){var n=e.find((function(e){return e.value==t}));if(n)return n;for(var i=0;i<e.length;i++){var r=this.findCodeListItem(e[i].children,t);if(r)return r}}}},{key:"insertNode",value:function(e){if(this.quoteCodelistMap.has("type")&&e.owner_subtype){var t=this.quoteCodelistMap.get("type"),n=this.findCodeListItem(t.codeListItems,e.owner_subtype);n&&n.sysImage&&Object.assign(e,{icon:n.sysImage.rawContent})}var i={type:"marker",script:this.quoteScript,data:e,children:[{text:""}]};this.editor.restoreSelection(),this.editor.deleteBackward("character");for(var r=0;r<this.query.length;r++)this.editor.deleteBackward("character");this.editor.insertNode(i),this.editor.move(1)}},{key:"getNodeInfo",value:function(e){if(!e.icon&&this.quoteCodelistMap.has("type")&&e.owner_subtype){var t=this.quoteCodelistMap.get("type"),n=this.findCodeListItem(t.codeListItems,e.owner_subtype);n&&n.sysImage&&Object.assign(e,{icon:n.sysImage.rawContent})}return Object.assign(e,{script:this.quoteScript}),'<span data-w-e-type="marker" data-w-e-is-void data-w-e-is-inline data-value="'.concat(encodeURIComponent(JSON.stringify(e)),'"></span>')}},{key:"parseNode",value:function(e){return W.execScriptFn({value:e,controller:this},this.quoteInScript,{singleRowReturn:!0,isAsync:!1})}},{key:"handlePublicParams",value:function(e,t,n){var i=this.model,r=i.navigateContexts,o=i.navigateParams,a={};r&&e&&(a=K(r,e,n,t));var s=Object.assign(t.clone(),a),l={};return o&&e&&(l=K(o,e,n,t)),{context:s,params:l}}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.handlePublicParams(this.data,this.context,this.params),n=t.context,i=t.params,r=!0===e.isInitialLoad,o=!0===e.isLoadMore;r?this.curPage=0:o&&(this.curPage+=1);var a=W.execScriptFn({data:this.data,context:n,params:i},this.quoteUrl,{singleRowReturn:!0,isAsync:!1}),s=M(M({},i),{},{query:this.query,size:this.size,page:this.curPage},this.quoteParams);return ibiz.net[this.quoteMethod](a,s)}},{key:"toUIData",value:function(e){var t=this;return e.map((function(e){var n={};return Object.keys(t.quoteFieldMap).forEach((function(i){n[i]=e[t.quoteFieldMap[i]]})),n}))}},{key:"openPopover",value:(t=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.overlay=ibiz.overlay.createPopover(this.createOverlayView(),void 0,{placement:"bottom-start",autoClose:!0,width:"300px",noArrow:!0}),e.next=3,this.overlay.present(t);case 3:return this.evt.emit("openPopper",void 0),this.execting=!0,e.next=7,this.overlay.onWillDismiss();case 7:return n=e.sent,this.execting=!1,this.evt.emit("closePopper",void 0),e.abrupt("return",n.data||[]);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"createOverlayView",value:function(){var e=this;return function(t){return U(zu,{controller:e,modal:t})}}},{key:"loadCodeList",value:(e=E(x().mark((function e(t){var n,i,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ibiz.hub.getApp(this.context.srfappid),i=n.codeList.getCodeList(t),e.next=4,n.codeList.get(t,this.context,this.params);case 4:return r=e.sent,e.abrupt("return",{codeList:i,codeListItems:r});case 6:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"handleClick",value:function(e){var t=e.target,n=t.nodeName,i=t.dataset;if(n&&"MENTION-ELEM"===n){var r=i.value||"",o=this.context.clone(),a=Ce(this.params),s=JSON.parse(r);if(!s.owner_type)return;o.srfkey=s.id;var l=s.owner_subtype||s.type;a.owner_subtype=l,"page"===l?a.article_page=s.owner_id:a[l]=s.owner_id,a[s.owner_type]=s.recent_parent,delete s.script,delete s.icon,delete s.id,Object.assign(a,s),s&&this.linkViewId&&ibiz.commands.execute(X.TAG,this.linkViewId,o,a)}}},{key:"parseCommentTag",value:function(e){var t=e.icon,n=JSON.stringify(e);if(!e.icon&&e.owner_subtype&&this.quoteCodelistMap.has("type")){var i=this.quoteCodelistMap.get("type"),r=this.findCodeListItem(i.codeListItems,e.owner_subtype);r&&r.sysImage&&(t=r.sysImage.rawContent||"")}return"<span markerClick='marker' params='".concat(n,"' class='comment-tag is-click'>").concat(t," ").concat(e.identifier," ").concat(e.name,"</span>")}}]);var e,t,n,i}();var wk={type:"mention",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,i=e.data,r=void 0===i?{}:i,o=W.execScriptFn({data:r},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var bk={selector:'span[data-w-e-type="mention"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"mention",script:n.script,data:n,children:[{text:""}]}}};var kk={type:"mention",renderElem:function(e){var t=e.data,n=void 0===t?{}:t,i={name:"@".concat(n.name),id:n.id};return bu("mention-elem",{dataset:{value:JSON.stringify(i)},props:{contentEditable:!1}},[])}},xk=function(){return P((function e(){A(this,e),O(this,"title","提及成员"),O(this,"tag","button"),O(this,"iconSvg",'<svg t="1705979200437" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4218" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M23.7 555c0-339.3 247-550 533.8-550 295.6 0 442.8 165.9 442.8 401.6 0 210.8-93.5 361.7-237 361.7-63.6 0-108.5-26.2-137.2-78.6-48.6 51.1-96 79.8-174.6 79.8-116 0-178.4-77.3-178.4-193.3 0-209.5 131-323 251.9-323 64.9 0 102.3 24.9 122.2 68.6l11.2-58.6 114.7 1.2L727 510.1c-7.5 36.2-11.2 63.6-11.2 81.1 0 44.9 22.5 71.1 56.1 71.1 63.6 0 106-89.8 106-243.2 0-205.8-114.7-300.6-323-300.6-220.8 0-405.4 163.4-405.4 436.5 0 238.2 132.2 350.5 390.4 350.5 94.8 0 174.6-12.5 255.7-36.2v109.8c-88.6 26.2-177.1 39.9-263.2 39.9-329.1 0-508.7-168.4-508.7-464z m585-44.9c3.7-20 6.2-39.9 6.2-53.6 0-56.1-15-96-83.6-96-83.6 0-133.5 108.5-133.5 212 0 44.9 13.7 88.6 77.3 88.6 73.7-0.1 114.9-57.4 133.6-151z" fill="#333333" p-id="4219"></path></svg>')}),[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){e.insertText("@")}}])}(),Ck={renderElems:[kk],elemsToHtml:[wk],parseElemsHtml:[bk],menus:[{key:"mention",factory:function(){return new xk}}]},Ek=function(){return P((function e(){A(this,e),O(this,"operatorMap",new Map),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"userUrl",""),O(this,"userFieldMap",{id:"id",name:"name",title:"title"}),O(this,"userMethod","post"),O(this,"userScript","`@{userid=${data.id},name=${data.name}}`"),O(this,"userInScript","value.replaceAll(/@{userid=(.+?),name=(.+?)}/g,(x, id, name) => {return controller.getNodeInfo({ id, name })})"),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"overlay",null),O(this,"evt",void 0),O(this,"execting",!1),O(this,"query",""),O(this,"curPage",0),O(this,"size",20),O(this,"presetPreventEvents",[13,38,40]),O(this,"presetPreventPropEvents",[27]),O(this,"cleanup",Oe),this.registerNode()}),[{key:"mentionPlugin",value:function(e){var t=this,n=e.insertText,i=e.isInline,r=e.isVoid;return e.insertText=function(i){t.editor?t.editor.isFocused()?ge.getSelectedElems(e).some((function(t){return e.isVoid(t)}))?n(i):(n(i),"@"!==i||t.execting||setTimeout((function(){t.query="",t.showModal()}),0)):n(i):n(i)},e.isInline=function(e){return"mention"===ge.getNodeType(e)||i(e)},e.isVoid=function(e){return"mention"===ge.getNodeType(e)||r(e)},e}},{key:"registerNode",value:function(){window.mentionIsRegiter||(ye.registerModule(Ck),window.mentionIsRegiter=!0),ye.registerPlugin(this.mentionPlugin.bind(this))}},{key:"init",value:(n=E(x().mark((function e(t,n){var i,r,o,a,s,l,u,c,h=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams,this.editorParams&&(i=this.editorParams,r=i.USERURL,o=i.USERFIELDMAP,a=i.USERMETHOD,s=i.USERSCRIPT,l=i.USERINSCRIPT,r&&(this.userUrl=r),o&&(u=JSON.parse(o),Object.assign(this.userFieldMap,u)),a&&(this.userMethod=a.toLowerCase()),s&&(this.userScript=s),l&&(this.userInScript=l)),(c=this.editor.getEditableContainer())&&(this.cleanup=Pe(c,"keydown",(function(e){var t;h.execting&&h.presetPreventEvents.includes(e.keyCode)&&e.preventDefault(),h.execting&&h.presetPreventPropEvents.includes(e.keyCode)&&(e.stopPropagation(),null===(t=h.overlay)||void 0===t||t.dismiss())}))),e.next=12,this.getOperatorUserList();case 12:this.evt.on("openPopper",(function(){h.execting=!0})),this.evt.on("closePopper",(function(){h.execting=!1}));case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getOperatorUserList",value:(t=E(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ibiz.hub.getApp(this.context.srfappid);case 2:return t=e.sent,n=[],e.next=6,t.codeList.get("SysOperator",this.context,this.params);case 6:n=e.sent,this.operatorMap=new Map(n.map((function(e){return[e.value,e]})));case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onDestroyed",value:function(){this.cleanup!==Oe&&this.cleanup(),this.overlay&&this.overlay.dismiss()}},{key:"showModal",value:function(){var e=this;if(this.userUrl){var t=document.getSelection();if(t){var n=t.focusNode;n&&this.openUserPopover(n.parentNode).then((function(t){t.length>0&&e.insertNode(t[0])}))}}else ibiz.log.error("未配置提及用户USERURL编辑器参数！")}},{key:"insertNode",value:function(e){var t={type:"mention",script:this.userScript,data:e,children:[{text:""}]};this.editor.restoreSelection(),this.editor.deleteBackward("character");for(var n=0;n<this.query.length;n++)this.editor.deleteBackward("character");this.editor.insertNode(t),this.editor.move(1)}},{key:"getNodeInfo",value:function(e){return Object.assign(e,{script:this.userScript}),'<span data-w-e-type="mention" data-w-e-is-void data-w-e-is-inline data-value="'.concat(encodeURIComponent(JSON.stringify(e)),'"></span>')}},{key:"parseNode",value:function(e){return W.execScriptFn({value:e,controller:this},this.userInScript,{singleRowReturn:!0,isAsync:!1})}},{key:"handlePublicParams",value:function(e,t,n){var i=this.model,r=i.navigateContexts,o=i.navigateParams,a={};r&&e&&(a=K(r,e,n,t));var s=Object.assign(t.clone(),a),l={};return o&&e&&(l=K(o,e,n,t)),{context:s,params:l}}},{key:"getUsers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.handlePublicParams(this.data,this.context,this.params),n=t.context,i=t.params,r=!0===e.isInitialLoad,o=!0===e.isLoadMore;r?this.curPage=0:o&&(this.curPage+=1);var a=W.execScriptFn({data:this.data,context:n,params:i},this.userUrl,{singleRowReturn:!0,isAsync:!1}),s=M(M({},i),{},{query:this.query,size:this.size,page:this.curPage});return ibiz.net[this.userMethod](a,s)}},{key:"toUIData",value:function(e){var t=this;return e.map((function(e){var n={};return Object.keys(t.userFieldMap).forEach((function(i){n[i]=e[t.userFieldMap[i]]})),n}))}},{key:"openUserPopover",value:(e=E(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.overlay=ibiz.overlay.createPopover(this.createOverlayView(),void 0,{placement:"bottom-start",autoClose:!0,width:"300px",noArrow:!0}),e.next=3,this.overlay.present(t);case 3:return this.evt.emit("openPopper",void 0),this.execting=!0,e.next=7,this.overlay.onWillDismiss();case 7:return n=e.sent,this.execting=!1,this.evt.emit("closePopper",void 0),e.abrupt("return",n.data||[]);case 11:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"createOverlayView",value:function(){var e=this;return function(t){return U(Bu,{controller:e,modal:t})}}}]);var e,t,n}();var Sk={type:"page",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,i=e.data,r=void 0===i?{}:i,o=W.execScriptFn({data:r},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var Mk={selector:'span[data-w-e-type="page"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"page",script:n.script,data:n,children:[{text:""}]}}};var Ak={type:"Page",renderElem:function(e){var t=e.data,n=void 0===t?{}:t,i={name:"".concat(n.name),id:n.id};return bu("mention-elem",{dataset:{value:JSON.stringify(i)},props:{contentEditable:!1}},[])}},_k=function(){return P((function e(){A(this,e),O(this,"title","页面"),O(this,"tag","button"),O(this,"iconSvg",'<svg t="1707293566679" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6103" width="200" height="200"><path d="M288 512l256 0C561.92 512 576 497.92 576 480 576 462.08 561.92 448 544 448l-256 0C270.08 448 256 462.08 256 480 256 497.92 270.08 512 288 512zM768 64 192 64C121.6 64 64 121.6 64 192l0 576c0 70.4 57.6 128 128 128l576 0c70.4 0 128-57.6 128-128L896 192C896 121.6 838.4 64 768 64zM832 768c0 35.2-28.8 64-64 64L192 832c-35.2 0-64-28.8-64-64L128 192c0-35.2 28.8-64 64-64l576 0c35.2 0 64 28.8 64 64L832 768zM672 256l-384 0C270.08 256 256 270.08 256 288 256 305.92 270.08 320 288 320l384 0C689.92 320 704 305.92 704 288 704 270.08 689.92 256 672 256zM608 640l-320 0C270.08 640 256 654.08 256 672l0 0C256 689.92 270.08 704 288 704l320 0c17.92 0 32-14.08 32-32l0 0C640 654.08 625.92 640 608 640z" p-id="6104"></path></svg>')}),[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){throw new _e("暂未支持上传页面！")}}])}(),Pk={renderElems:[Ak],elemsToHtml:[Sk],parseElemsHtml:[Mk],menus:[{key:"page",factory:function(){return new _k}}]},Ok=function(){return P((function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"evt",void 0),O(this,"execting",!1),this.registerNode()}),[{key:"registerNode",value:function(){window.pageIsRegiter||(ye.registerModule(Pk),window.pageIsRegiter=!0)}},{key:"init",value:(e=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams;case 7:case"end":return e.stop()}}),e,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"onDestroyed",value:function(){}},{key:"insertNode",value:function(e){}},{key:"parseNode",value:function(e){return e}}]);var e}(),Tk={type:"emoji",renderElem:function(e){var t=e.data,n=void 0===t?{}:t;return bu("emoji-elem",{dataset:{value:n.emoji?je(n.emoji):""},props:{contentEditable:!1}},[])}},Lk=function(){return P((function e(){A(this,e),O(this,"title","表情"),O(this,"tag","button"),O(this,"iconSvg","<svg viewBox='0 0 1040 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='1490' width='1em' height='1em' stroke='var(--w-e-toolbar-color)' > <path stroke-width='38' d='M512.075261 1024A511.774217 511.774217 0 1 1 730.482434 48.769072a37.630457 37.630457 0 1 1-32.061149 68.035867 436.513303 436.513303 0 1 0 250.468323 395.270322 37.630457 37.630457 0 0 1 75.260914 0 512.526826 512.526826 0 0 1-512.075261 511.924739z' p-id='1491' ></path> <path stroke-width='38' d='M333.857416 344.0929a57.348817 57.348817 0 1 0 57.348817 57.348817 57.499339 57.499339 0 0 0-57.348817-57.348817zM686.53006 344.0929a57.348817 57.348817 0 1 0 57.348817 57.348817 57.348817 57.348817 0 0 0-57.348817-57.348817zM515.236219 783.165074c-162.864619 0-262.359547-141.942084-262.359547-219.159782a30.104366 30.104366 0 0 1 60.208731 0c0 48.618551 76.314567 158.951051 202.150816 158.951051s193.571072-134.114949 193.571072-158.951051a30.104366 30.104366 0 0 1 60.208731 0c0 54.488902-90.012054 219.159782-253.779803 219.159782zM1009.549904 207.720123h-67.132735V139.985301a30.104366 30.104366 0 1 0-60.208732 0v67.734822h-67.734822a30.104366 30.104366 0 0 0-30.104366 30.104366 30.104366 30.104366 0 0 0 30.104366 30.104366h67.734822v67.734823a30.104366 30.104366 0 0 0 60.208732 0v-67.734823h67.734823a30.104366 30.104366 0 0 0 30.104365-30.104366 30.104366 30.104366 0 0 0-30.706453-30.104366z' p-id='1492' ></path> </svg>")}),[{key:"isActive",value:function(){return!1}},{key:"getValue",value:function(){return!1}},{key:"isDisabled",value:function(){return!1}},{key:"exec",value:function(e){e.emit("openEmojiSelect")}}])}(),jk={renderElems:[Tk],elemsToHtml:[{type:"emoji",elemToHtml:function(e){var t=e.data;return"<span data-w-e-type=\"emoji\" class='emoji'>".concat(t.emoji,"</span>")}}],parseElemsHtml:[{selector:'span[data-w-e-type="emoji"]',parseElemHtml:function(e){return{data:{emoji:e.innerHTML},type:"emoji",children:[{text:""}]}}}],menus:[{key:"emoji",factory:function(){return new Lk}}]},Nk=function(){return P((function e(){A(this,e),O(this,"editor",void 0),O(this,"overlay",null),O(this,"presetPreventEvents",[13,38,40]),O(this,"presetPreventPropEvents",[27]),O(this,"evt",void 0),O(this,"cleanup",Oe),this.registerNode()}),[{key:"emojiPlugin",value:function(e){var t=e.isInline,n=e.isVoid;return e.isInline=function(e){return"emoji"===ge.getNodeType(e)||t(e)},e.isVoid=function(e){return"emoji"===ge.getNodeType(e)||n(e)},e}},{key:"registerNode",value:function(){window.emojiIsRegiter||(ye.registerModule(jk),window.emojiIsRegiter=!0),ye.registerPlugin(this.emojiPlugin.bind(this))}},{key:"init",value:(t=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.editor=t,this.evt=n.evt,this.listenEvent();case 3:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"listenEvent",value:function(){var e=this,t=this.editor.getEditableContainer();this.editor.on("openEmojiSelect",(function(){return e.openEmojiSelect()})),this.cleanup=Pe(t,"keydown",(function(t){var n;(e.overlay&&e.presetPreventEvents.includes(t.keyCode)&&t.preventDefault(),e.overlay&&e.presetPreventPropEvents.includes(t.keyCode))&&(t.stopPropagation(),null===(n=e.overlay)||void 0===n||n.dismiss())})),this.evt.on("onChange",(function(t){var n,i=t.eventArg,r=/(?:[\u2600-\u27BF]|\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF])/g;if(i&&null!==(n=i.match(r))&&void 0!==n&&n.length){var o=i.replaceAll(/<span((?:[\0-=\?-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+?)>((?:[\0-;=-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)((?:[\u2600-\u27BF]|\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F\uDE80-\uDEFF]))((?:[\0-;=-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?)<\/span>/g,"$3").replaceAll(r,(function(e){return"<span data-w-e-type=\"emoji\" class='emoji'>".concat(Te(e),"</span>")}));e.editor.setHtml(o)}}))}},{key:"openEmojiSelect",value:(e=E(x().mark((function e(){var t,n,i=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getSelection(),!(n=t.focusNode)){e.next=7;break}return this.overlay=ibiz.overlay.createPopover((function(e){return U(Fu,{controller:i,modal:e})}),void 0,{width:"auto",noArrow:!0,autoClose:!0,placement:"bottom-start"}),e.next=6,this.overlay.present(n.parentNode);case 6:this.overlay.onWillDismiss().then((function(e){var t,n=e,r=null===(t=n.data)||void 0===t?void 0:t[0];n.ok&&r&&i.addEmojiNode(r),i.overlay=null}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"addEmojiNode",value:function(e){var t={data:e,type:"emoji",children:[{text:""}]};this.editor.restoreSelection(),this.editor.insertNode(t),this.editor.move(1)}},{key:"parseNode",value:function(e){return W.execScriptFn({value:e,controller:this},'value.replaceAll(/\\{\\"\\emoji\\":\\"(.+?)\\"\\}/g,(x, emoji) => {return \'<span data-w-e-type="emoji" class="emoji">\'+emoji+\'</span>\'})',{singleRowReturn:!0,isAsync:!1})}},{key:"onDestroyed",value:function(){this.cleanup!==Oe&&this.cleanup(),this.overlay&&this.overlay.dismiss()}}]);var e,t}(),Dk=function(){return P((function e(){A(this,e),O(this,"title","本地文件"),O(this,"tag","button"),O(this,"iconSvg",'<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit=""> <title>本地文件</title> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" id="矩形" fill-rule="nonzero"></path> <g transform="translate(2.331723, 6.223395)"> <path d="M10.8586379,9.82567869 C10.8586379,11.3135682 9.65287619,12.519741 8.16549379,12.519741 C6.6781114,12.519741 5.47234973,11.3135682 5.47237295,9.83060072 L5.43152142,5.5040927 C5.4288277,5.21612692 5.65998761,4.98048085 5.94785525,4.97776249 C6.23572289,4.97504413 6.47128863,5.20628285 6.47400607,5.49424863 L6.51485711,9.82567869 C6.51485711,10.737611 7.25387232,11.4768781 8.16549379,11.4768781 C9.07711526,11.4768781 9.81613048,10.737611 9.81613048,9.82567869 L9.81613048,5.02838197 C9.81613048,3.65522549 8.5992671,2.52563899 7.0795486,2.52563899 C5.55983011,2.52563899 4.34296673,3.65522549 4.34296673,5.02838197 L4.34296673,10.0065309 C4.34296673,12.103884 6.05369893,13.8053486 8.16549379,13.8053486 C10.2772887,13.8053486 11.9880209,12.103884 11.9880209,10.0065309 L11.9880209,5.5222302 C11.9880209,5.23425158 12.2213941,5.00079879 12.5092745,5.00079879 C12.797155,5.00079879 13.0305282,5.23425158 13.0305282,5.5222302 L13.0305282,10.0065309 C13.0305282,12.6811932 10.8517067,14.8482114 8.16549379,14.8482114 C5.47928093,14.8482114 3.30045935,12.6811932 3.30045935,10.0065309 L3.30045935,5.02838197 C3.30045935,3.06112766 5.0007613,1.48277617 7.0795486,1.48277617 C9.15833591,1.48277617 10.8586379,3.06112766 10.8586379,5.02838197 Z" id="形状结合" transform="translate(8.165494, 8.165494) rotate(-315.000000) translate(-8.165494, -8.165494) "></path> <path d="M16.8515613,7.68286899 L19.1408313,7.68286899 C19.3985642,7.68286899 19.6074979,7.89180277 19.6074979,8.14953566 C19.6074979,8.40726854 19.3985642,8.61620232 19.1408313,8.61620232 L16.8515613,8.61620232 C16.5938284,8.61620232 16.3848947,8.40726854 16.3848947,8.14953566 C16.3848947,7.89180277 16.5938284,7.68286899 16.8515613,7.68286899 Z" id="矩形备份-74"></path> <path d="M16.8515613,3.33760726 L21.3127216,3.33760726 C21.5704545,3.33760726 21.7793883,3.54654104 21.7793883,3.80427393 C21.7793883,4.06200681 21.5704545,4.27094059 21.3127216,4.27094059 L16.8515613,4.27094059 C16.5938284,4.27094059 16.3848947,4.06200681 16.3848947,3.80427393 C16.3848947,3.54654104 16.5938284,3.33760726 16.8515613,3.33760726 Z" id="矩形备份-75"></path> <path d="M16.8515613,12.0281307 L21.3127216,12.0281307 C21.5704545,12.0281307 21.7793883,12.2370645 21.7793883,12.4947974 C21.7793883,12.7525303 21.5704545,12.9614641 21.3127216,12.9614641 L16.8515613,12.9614641 C16.5938284,12.9614641 16.3848947,12.7525303 16.3848947,12.4947974 C16.3848947,12.2370645 16.5938284,12.0281307 16.8515613,12.0281307 Z" id="矩形备份-77"></path> </g> </g> </g></svg>')}),[{key:"isActive",value:function(){return!1}},{key:"getValue",value:function(){return!1}},{key:"isDisabled",value:function(){return!1}},{key:"exec",value:function(e){e.emit("openFilesUpload")}}])}(),Ik={type:"insert",renderElem:function(e,t){var n=e.data,i=void 0===n?{}:n;return bu("".concat(i.type||"","-elem"),{dataset:{value:JSON.stringify(i)},props:{contentEditable:!1}},t)}},Rk={type:"insert",elemToHtml:function(e){var t=e.data,n=void 0===t?{}:t;return"<span data-w-e-type=\"insert\" class='insert'>".concat(JSON.stringify({type:n.type,value:n.value}),"</span>")}},Bk={selector:'span[data-w-e-type="insert"]',parseElemHtml:function(e){return{data:JSON.parse(e.innerHTML)||{},type:"insert",children:[{text:""}]}}},zk={type:"layout",renderElem:function(e,t){return bu("layout-elem",{props:{class:"layout"}},t||[])}},Fk={type:"layout-column",renderElem:function(e,t){return bu("layout-column-elem",{props:{class:"layout-column"}},t||[])}},Vk=function(){return P((function e(){A(this,e),O(this,"title","插入"),O(this,"tag","button"),O(this,"iconSvg","<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' class='insert-icon' fill='var(--ibiz-color-primary)'><g stroke-width='1' fill-rule='evenodd'> <path d='M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm-.6-8.6H4v1.2h3.4V12h1.2V8.6H12V7.4H8.6V4H7.4v3.4z'></path></g></svg>")}),[{key:"isActive",value:function(){return!1}},{key:"getValue",value:function(){return!1}},{key:"isDisabled",value:function(){return!1}},{key:"exec",value:function(e){e.emit("openInsertSelect")}}])}(),Hk={renderElems:[Ik,zk,Fk],elemsToHtml:[Rk,{type:"layout",elemToHtml:function(e,t){return"<layout-elem data-w-e-type=\"layout\" class='layout'>".concat(t,"</layout-elem>")}},{type:"layout-column",elemToHtml:function(e,t){return"<layout-column-elem data-w-e-type=\"layout-column\" class='layout-column'>".concat(t,"</layout-column-elem>")}}],parseElemsHtml:[Bk,{selector:'layout-elem[data-w-e-type="layout"]',parseElemHtml:function(e,t){return{type:"layout",children:t}}},{selector:'layout-column-elem[data-w-e-type="layout-column"]',parseElemHtml:function(e,t){return{type:"layout-column",children:t}}}],menus:[{key:"insert",factory:function(){return new Vk}},{key:"files",factory:function(){return new Dk}}]};function Uk(e,t,n){if(e.length>0){var i=t[e[0]];if(i&&i.type===n)return!0;if(i&&i.children)return e.splice(0,1),Uk(e,i.children,n)}return!1}function qk(e,t){var n=e.selection,i=e.children;return!!n&&Uk(v(n.anchor.path),i,t)}function Gk(e,t,n){var i,r,o=!1,a=w(null===(i=le)||void 0===i?void 0:i.nodes(e,{at:t,match:function(e){return ge.getNodeType(e)===n}}));try{for(a.s();!(r=a.n()).done;){r.value;o=!0}}catch(gx){a.e(gx)}finally{a.f()}return o}function Jk(e,t){if(e.length>0)for(var n=0;n<e.length;n++){var i=e[n];if(i.type===t||i.data&&i.data&&i.data.type===t)return i;if(i.children)return Jk(i.children||[],t)}}function Wk(e,t,n){var i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=w(e.values());try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.isInline===r&&Jk([n[t[0]]],a.type))return!0}}catch(gx){o.e(gx)}finally{o.f()}return!1}function Yk(e){var t=e.selection,n=e.children;if(t){var i=n[t.anchor.path[0]]||{};return i&&i.children&&1===i.children.length?!i.children[0].text:!(i&&i.children&&i.children.length>1)}return!0}function Zk(e){var t=e.selection,n=e.children;if(t){var i=n[t.anchor.path[0]+1]||{};return i&&i.children&&1===i.children.length?!i.children[0].text:!(i&&i.children&&i.children.length>1)}return!0}function Kk(e,t){de.removeNodes(e,{at:t});var n=setTimeout((function(){e.move(1),e.focus(),clearTimeout(n),n=null}),0)}function Xk(e,t){var n=e.selection;if(null==n)return!1;if(ve.isExpanded(n))return!1;var i=ge.getSelectedNodeByType(e,t);if(null===i)return!1;var r=i.children;return 1===r.length&&""===r[0].text}var $k=function(e){var t=e.selection;return t&&ve.isCollapsed(t)?le.above(e,{match:function(e){return ue.isElementType(e,"layout-column")}}):null},Qk=function(e){var t=$k(e);if(t){var n=p(t,2)[1],i=le.start(e,n);return pe.equals(e.selection.anchor,i)}return!1},ex=function(){return P((function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"editorParams",void 0),O(this,"wangEditor",void 0),O(this,"container",void 0),O(this,"overlay",null),O(this,"presetPreventEvents",[13,38,40]),O(this,"presetPreventPropEvents",[27]),O(this,"insertMap",pc()),O(this,"cleanup",Oe),this.registerNode()}),[{key:"insertPlugin",value:function(e){var t=this,n=e.isInline,i=e.isVoid,r=e.insertBreak,o=e.insertNode,a=e.deleteBackward,s=e.normalizeNode,l=e.deleteForward;return e.isInline=function(e){return"insert"===ge.getNodeType(e)||n(e)},e.isVoid=function(e){return"insert"===ge.getNodeType(e)||i(e)},e.insertBreak=function(){var t=ge.getSelectedNodeByType(e,"layout");if(t){var n=function(e,t){var n=t.selection;if(null==n)return"";var i=he.string(e),r=n.anchor.offset,o=i.slice(0,r).split("\n"),a=o.length;return 0===a?"":o[a-1]}(t,e);if(n){var i=n.match(/^\s+/);if(null!==i&&null!=i[0]){var o=i[0];return void e.insertText("\n".concat(o))}}e.insertText("\n")}else r()},e.insertNode=function(n){var i=e.getConfig().maxLength,r=ge.getSelectedNodeByType(e,"layout");if(!r||!n.type||"layout"!==n.type){if(r){var a=t.insertMap.find((function(e){return e.type===n.data.type}));a&&a.isInline&&(function(e){var t=e.selection;if(t&&ve.isCollapsed(t)){var n=p(le.node(e,t),1)[0];if(ce.isText(n)&&/^(\s*\n\s*)+$/.test(n.text))return!0}return!1}(e)||Qk(e)&&function(e){var t=e.selection;if(t&&ve.isCollapsed(t)){var n=p(le.node(e,t),1)[0];if(ce.isText(n)&&""===n.text)return!0}return!1}(e))&&e.insertText(" ")}if(i){var s=ge.getLeftLengthOfMaxLength(e);if(!(s<=0))s<he.string(n).length||o(n)}else o(n)}},e.normalizeNode=function(t){var n=p(t,2),i=n[0],r=n[1];if("layout"===ge.getNodeType(i)&&ge.isLastNode(e,i)){var o=ge.genEmptyParagraph();return void de.insertNodes(e,o,{at:[r[0]+1]})}return s([i,r])},e.deleteBackward=function(n){var i=ge.getSelectedNodeByType(e,"layout"),r=e.selection;if(!i&&r){var o=le.before(e,r);if(o)if(Gk(e,o,"layout")||!i&&Wk(t.insertMap,o.path,e.children))return void Kk(e,[o.path[0]])}i&&Xk(e,"layout-column")||Qk(e)||a(n)},e.deleteForward=function(n){var i=ge.getSelectedNodeByType(e,"layout"),r=e.selection;if(!i&&r){var o=le.after(e,r);if(o){var a=Gk(e,o,"layout"),s=Yk(e),u=s?r.focus.path[0]:o.path[0];if(a)return void Kk(e,[u]);if(Wk(t.insertMap,o.path,e.children))return Kk(e,[u]),s&&e.moveReverse(1),void t.handleMove(39)}}i&&Xk(e,"layout-column")||function(e){var t=$k(e);if(t){var n=p(t,2)[1],i=le.end(e,n);return pe.equals(e.selection.anchor,i)}return!1}(e)||l(n)},e}},{key:"registerNode",value:function(){window.insertIsRegiter||(ye.registerModule(Hk),window.insertIsRegiter=!0),ye.registerPlugin(this.insertPlugin.bind(this))}},{key:"init",value:(i=E(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.data=n.data,this.editorParams=this.model.editorParams,this.wangEditor=t,this.listenEvent();case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"listenEvent",value:function(){var e=this,t=this.wangEditor.getEditableContainer();this.cleanup=Pe(t,"keydown",(function(t){var n;(e.overlay&&e.presetPreventEvents.includes(t.keyCode)&&t.preventDefault(),e.overlay&&e.presetPreventPropEvents.includes(t.keyCode))&&(t.stopPropagation(),null===(n=e.overlay)||void 0===n||n.dismiss())})),t.addEventListener("keyup",this.handleKeyup.bind(this)),t.addEventListener("mouseup",this.handleMouseup.bind(this)),this.wangEditor.on("openInsertSelect",(function(){return e.openInsertSelect()})),this.wangEditor.on("openFilesUpload",(function(){return e.openFilesUpload()})),t.addEventListener("dateElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("labelElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("promptBoxElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("mindMapElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("audioElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("filesElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("formulaElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("layoutElemEvent",this.handleInsertChange.bind(this)),this.container=t}},{key:"handleKeyup",value:function(e){this.handleMove(e.keyCode)}},{key:"handleMouseup",value:function(){this.handleMove(39)}},{key:"handleMove",value:function(e){if([37,38,39,40].includes(e)&&this.wangEditor.selection){var t=this.wangEditor,n=t.children,i=t.selection;if(i&&i.focus.path&&!Gk(this.wangEditor,i.focus.path,"layout")&&Wk(this.insertMap,i.focus.path,n)){if([37,38].includes(e)?this.wangEditor.moveReverse(2):[39,40].includes(e)&&this.wangEditor.move(2),0===i.focus.path[0])return void this.handleMove(39);this.handleMove(e)}}}},{key:"handleInsertChange",value:function(e){var t=this.getCustomNodePath(e.target),n=e.detail.params;n&&n.isDelete?Kk(this.wangEditor,t):e.detail&&function(e,t,n){de.setNodes(e,{children:[{text:""}],data:n,type:"insert"},{at:t}),e.move(1),e.focus()}(this.wangEditor,t,e.detail)}},{key:"getCustomNodePath",value:function(e){var t=ge.toSlateNode(this.wangEditor,e);return ge.findPath(this.wangEditor,t)}},{key:"openInsertSelect",value:(n=E(x().mark((function e(){var t,n,i,r,o,a=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=ge.getToolbar(this.wangEditor))&&(i=n.toolbarItems,r=i.find((function(e){var t=e.$elem[0].querySelectorAll("[data-menu-key]")[0];return"insert"===(t?t.getAttribute("data-menu-key"):"")&&t})),t=!!r&&r.$button[0]),!t){e.next=8;break}return e.next=5,this.openPopover(t);case 5:(o=e.sent).ok&&o.data&&o.data.length>0&&(o.data.length>1&&(this.wangEditor.focus(),Zk(this.wangEditor)||qk(this.wangEditor,"layout")||(this.wangEditor.insertBreak(),this.wangEditor.moveReverse(1))),o.data.forEach((function(e,t){setTimeout((function(){a.addNode(e,"insert")}),200*t)}))),this.overlay=null;case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"openFilesUpload",value:(t=E(x().mark((function e(){var t,n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ibiz.overlay.modal((function(e){return U(Pc,{modal:e,context:n.context,viewParams:n.params,actionParams:n.editorParams})}),void 0,{width:"auto",height:"auto"});case 2:(t=e.sent).ok&&t.data&&t.data.length>0&&(this.wangEditor.focus(),t.data.forEach((function(e,t){var i={type:"files",value:e,params:{isAdd:!0}};setTimeout((function(){n.addNode(i,"insert")}),200*t)})));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addNode",value:function(e,t){var n={data:e,type:t,children:[{text:""}]};switch(this.wangEditor.restoreSelection(),e.type){case"prompt-box":case"mind-map":case"audio":Yk(this.wangEditor)||qk(this.wangEditor,"layout")||this.wangEditor.insertBreak(),this.wangEditor.insertNode(n),Zk(this.wangEditor)&&!qk(this.wangEditor,"layout")&&this.wangEditor.insertBreak();break;case"layout":Object.assign(n,{type:"layout",children:[{type:"layout-column",children:[{text:""}]},{type:"layout-column",children:[{text:""}]}]}),this.wangEditor.insertNode(n);break;default:this.wangEditor.insertNode(n),this.wangEditor.move(1)}this.handleMove(39)}},{key:"openPopover",value:(e=E(x().mark((function e(t){var n,i,r=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},this.overlay=ibiz.overlay.createPopover(this.createOverlayView(),void 0,M({width:"auto",noArrow:!0,autoClose:!0,placement:"bottom-start"},n)),e.next=4,this.overlay.present(t);case 4:return e.next=6,this.overlay.onWillDismiss();case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"createOverlayView",value:function(){var e=this;return function(t){return U(Oc,{modal:t,context:e.context,viewParams:e.params,actionParams:e.editorParams})}}},{key:"parseNode",value:function(e){return e}},{key:"onDestroyed",value:function(){this.container&&(this.container.removeEventListener("keyup",this.handleKeyup.bind(this)),this.container.removeEventListener("mouseup",this.handleMouseup.bind(this)),this.container.removeEventListener("dateElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("labelElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("promptBoxElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("mindMapElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("audioElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("filesElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("formulaElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("layoutElemEvent",this.handleInsertChange.bind(this)),this.container=null),this.cleanup!==Oe&&this.cleanup(),this.overlay&&this.overlay.dismiss()}}]);var e,t,n,i}(),tx=function(){return P((function e(){A(this,e)}),null,[{key:"init",value:function(e){var t=this;this.registerMap.set("mention",Ek),this.registerMap.set("marker",mk),this.registerMap.set("attachments",Mu),this.registerMap.set("codesnippet",Lu),this.registerMap.set("page",Ok),this.registerMap.set("emoji",Nk),this.registerMap.set("insert",ex),this.presetNodes.forEach((function(n){t.registerPlugin({type:n,id:"".concat(n).concat(e)})}))}},{key:"registerPlugin",value:function(e){var t=e.type,n=e.id;if(this.customNodeMap.has(n))return this.customNodeMap.get(n);var i=this.registerMap.get(t);if(i){var r=new i;return this.customNodeMap.set(n,r),r}}},{key:"getPluginsById",value:function(e){var t=this,n=[];return this.presetNodes.forEach((function(i){t.customNodeMap.has("".concat(i).concat(e))&&n.push(t.customNodeMap.get("".concat(i).concat(e)))})),n}},{key:"getControllerById",value:function(e,t){return this.customNodeMap.get("".concat(t).concat(e))}},{key:"unregisterPlugin",value:function(e){var t=e.id;this.customNodeMap.has(t)&&this.customNodeMap.delete(t)}},{key:"destroy",value:function(e){var t=this;this.presetNodes.forEach((function(n){t.unregisterPlugin({id:"".concat(n).concat(e)})})),this.registerMap.delete("mention"),this.registerMap.delete("marker"),this.registerMap.delete("attachments"),this.registerMap.delete("codesnippet"),this.registerMap.delete("page"),this.registerMap.delete("emoji"),this.registerMap.delete("insert")}}])}();O(tx,"customNodeMap",new Map),O(tx,"registerMap",new Map),O(tx,"presetNodes",["mention","marker","attachments","codesnippet","page","emoji","insert"]);var nx=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"attributeChangedCallback",value:function(e,t,n){if("data-value"===e){if(n&&t===n)return;var i=JSON.parse(n),r=this.attachShadow({mode:"open"}),o=r.ownerDocument;if(i.icon){var a=o.createElement("span");a.part.add("svg"),a.innerHTML=i.icon,r.appendChild(a)}if(i.identifier){var s=o.createElement("span");s.part.add("identifier"),s.innerHTML=i.identifier,r.appendChild(s)}if(i.name){var l=o.createElement("span");l.part.add("name"),l.innerHTML=i.name,r.appendChild(l)}var u=o.createElement("style");u.innerHTML="\n      svg {\n        height: 1em;\n        width: 1em;\n      }\n    ",r.appendChild(u)}}}],[{key:"observedAttributes",get:function(){return["data-value"]}}])}(n(HTMLElement)),ix=function(e){function t(){return A(this,t),s(this,t,arguments)}return h(t,e),P(t,[{key:"attributeChangedCallback",value:function(e,t,n){if("data-value"===e){if(n&&t===n)return;var i=this.attachShadow({mode:"open"}),r=i.ownerDocument.createElement("span");r.innerHTML=n,r.part.add("box"),r.classList.add("emoji-elem_box"),i.appendChild(r)}}}],[{key:"observedAttributes",get:function(){return["data-value"]}}])}(n(HTMLElement)),rx=function(){return P((function e(){var t=this;A(this,e),O(this,"title","格式刷"),O(this,"tag","button"),O(this,"fragment",[]),O(this,"format",{}),O(this,"editor",null),O(this,"excting",!1),O(this,"iconSvg",'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g id="aqseditor/paintformat" stroke-width="1" fill-rule="evenodd"><path d="M3 5.24h10V2H3v3.24zM13.299 1H2.701A.701.701 0 0 0 2 1.701v3.838c0 .387.314.701.701.701h6.236L7.621 7.438h-.002v2.233h-.768v5.184L9.404 13.1V9.671h-.585V7.97l1.9-1.73h2.58A.701.701 0 0 0 14 5.539V1.701A.701.701 0 0 0 13.299 1z" id="aqsFill-1"></path></g></svg>'),O(this,"setPaintFormat",(function(){if(t.editor){var e=t.editor.getSelectionText();if(e&&Object.keys(t.format).length>0){var n=M(M({},t.format),{},{text:e});t.editor.insertNode(n),t.excting||t.clearFormat()}}})),O(this,"onPaintFormat",Se(this.setPaintFormat,500,!1)),O(this,"throttleHandle",this.throttle(this.handle,300))}),[{key:"isActive",value:function(e){return Object.keys(this.format).length>0}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"calcFormat",value:function(e){var t=this;e.length>0&&e[0].children.forEach((function(e){Object.assign(t.format,e)}))}},{key:"clearFormat",value:function(){this.format={};var e=this.editor.getEditableContainer();e&&e.classList.remove("is-paint-format");var t=document.querySelector("button[data-menu-key='paintformat']");t&&t.classList.remove("active")}},{key:"throttle",value:function(e,t){var n=null;return function(){for(var i=this,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];n||(n=setTimeout((function(){e.apply(i,o),n=null,i.excting=!0}),t))}}},{key:"handle",value:function(e){var t=this;if(this.excting)return this.clearFormat(),void(this.excting=!1);var n=e.getFragment();this.calcFormat(n),this.editor=e;var i=this.editor.getEditableContainer();i&&i.classList.add("is-paint-format"),e.deselect(),e.on("change",this.onPaintFormat),e.on("clickOutside",(function(){t.clearFormat(),t.excting=!1}))}},{key:"exec",value:function(e){this.throttleHandle(e)}}])}(),ox={key:"paintformat",factory:function(){return new rx}},ax=function(){return P((function e(){A(this,e),O(this,"title","AI询问"),O(this,"iconSvg",'<svg xmlns="http://www.w3.org/2000/svg" version="1.1"> <text x="0" y="13" font-size="16" fill="black">AI</text></svg>'),O(this,"tag","button")}),[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return"aichart"}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){e.emit("aiClick")}}])}();var sx={type:"link",elemToHtml:function(e){var t=e.url,n=e.children,i="_blank";return t.startsWith("./#/")&&(i="_self"),'<a href="'.concat(t,'" target="').concat(i,'">').concat(n[0].text,"</a>")}},lx=function(){return P((function e(){A(this,e),O(this,"title","查看连接"),O(this,"iconSvg",'<svg viewBox="0 0 1024 1024"><path d="M924.402464 1023.068211H0.679665V99.345412h461.861399v98.909208H99.596867v725.896389h725.896389V561.206811h98.909208z" p-id="10909"></path><path d="M930.805104 22.977336l69.965436 69.965436-453.492405 453.492404-69.965435-69.901489z" p-id="10910"></path><path d="M1022.464381 304.030081h-98.917201V99.345412H709.230573V0.428211h313.233808z"></path></svg>'),O(this,"tag","button")}),[{key:"getSelectedLinkElem",value:function(e){var t=ge.getSelectedNodeByType(e,"link");return null==t?null:t}},{key:"getValue",value:function(e){var t=this.getSelectedLinkElem(e);return t&&t.url||""}},{key:"isActive",value:function(){return!1}},{key:"isDisabled",value:function(e){return null==e.selection||null==this.getSelectedLinkElem(e)}},{key:"exec",value:function(e,t){if(!this.isDisabled(e)){if(!t||"string"!=typeof t)throw new Error("打开链接失败, 路径为 '".concat(t,"'"));t.toString().startsWith("./#/")?window.open("".concat(window.location.pathname).concat(t.slice(1)),"_self"):window.open(t,"_blank")}}}])}(),ux={menus:[{key:"customViewLink",factory:function(){return new lx}}],elemsToHtml:[sx]},cx=function(e){function t(){var e;A(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return O(e=s(this,t,[].concat(i)),"userAvatar",""),O(e,"uploadParams",void 0),O(e,"exportParams",void 0),O(e,"minHeight",48),O(e,"maxHeight",315),O(e,"collapsed",f(!0)),O(e,"hasFile",f(!1)),O(e,"hidden",f(!1)),O(e,"reply",f("")),O(e,"replyScript",""),O(e,"mode","comment"),O(e,"insertKeys",[]),O(e,"renderMode","HTML"),O(e,"saveInterval",3e3),O(e,"emitMode","BUTTON"),O(e,"uuid",be()),O(e,"enableRealtime",!1),O(e,"collaborateKey",void 0),O(e,"editor",void 0),O(e,"autoSaveInterval",3e4),O(e,"timer",null),O(e,"deService",void 0),O(e,"deACMode",void 0),O(e,"chatCompletion",!1),O(e,"expMenuKeys","file;code;page"),O(e,"expFields",[]),O(e,"evt",new Z(e.getEventArgs.bind(e))),e}return h(t,e),P(t,[{key:"markerController",get:function(){return tx.getControllerById(this.uuid,"marker")}},{key:"getEventArgs",value:function(){return{context:this.context,params:this.params,data:[],eventArg:"",targetName:this.model.name,view:this.getView()}}},{key:"onInit",value:(a=E(x().mark((function e(){var n,i,r,a,s,l,u,c,h,f,d,v,g,y,m,w,b,k=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(t,"onInit",this,3)([]);case 2:return e.next=4,this.getCurrentUserAvatar();case 4:if(!(n=this.model).appDEACModeId){e.next=15;break}return e.next=8,Q(n.appDEACModeId,n.appDataEntityId,this.context.srfappid);case 8:if(this.deACMode=e.sent,!this.deACMode){e.next=15;break}if("CHATCOMPLETION"!==this.deACMode.actype){e.next=15;break}return e.next=13,ibiz.hub.getApp(n.appId).deService.getService(this.context,n.appDataEntityId);case 13:this.deService=e.sent,this.chatCompletion=!0;case 15:if(this.registerCustomElem(),this.editorParams){if(i=this.editorParams,r=i.uploadParams,a=i.exportParams,s=i.MINHEIGHT,l=i.MAXHEIGHT,u=i.REPLYSCRIPT,c=i.MODE,h=i.INSERTKEYS,f=i.RENDERMODE,d=i.SAVEINTERVAL,v=i.EMITMODE,g=i.DEFAULTCOLLAPSE,y=i.ENABLEREALTIME,m=i.COLLABORATEKEY,w=i.EXPMENUKEYS,b=i.EXTFIELDVALUE,r)try{this.uploadParams=JSON.parse(r)}catch(x){ibiz.log.error("编辑器[".concat(ibiz.log.error(x),"]编辑器参数 uploadParams 非 json 格式"))}if(a)try{this.exportParams=JSON.parse(a)}catch(x){ibiz.log.error("编辑器[".concat(ibiz.log.error(x),"]编辑器参数 exportParams 非 json 格式"))}s&&(this.minHeight=Number(s)),l&&(this.maxHeight=Number(l)),u&&(this.replyScript=u),c&&(this.mode=c.toLowerCase()),h&&(this.insertKeys=JSON.parse(h)),f&&(this.renderMode=f),d&&(this.saveInterval=dt(d)),v&&(this.emitMode=v),g&&(this.collapsed.value=!Object.is(g,"TRUE")&&!Object.is(g,"true")),y&&(this.enableRealtime=Object.is(y,"TRUE")||Object.is(y,"true")),m&&(this.collaborateKey=K({collaboratekey:m},this.parent.data||{},this.params,this.context).collaboratekey),w&&(this.expMenuKeys=w),b&&(this.expFields=b.split(";").map((function(e){var t=p(e.split(":"),2);return{name:t[0],value:t[1]}})))}tx.init(this.uuid),this.evt.on("onChange",(function(){if(!k.parent.form){var e=ibiz.uiDomainManager.get(k.context.srfsessionid);e&&e.dataChange()}})),this.listenViewDestroyed();case 20:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"registerCustomElem",value:function(){window.customElements.get("mention-elem")||window.customElements.define("mention-elem",nx),window.customElements.get("emoji-elem")||window.customElements.define("emoji-elem",ix),window.paintFormatIsRegiter||(ye.registerMenu(ox),window.paintFormatIsRegiter=!0),window.aichartRegister||(ye.registerMenu({key:"aichart",factory:function(){return new ax}}),window.aichartRegister=!0),window.customLinkIsRegiter||(ye.registerModule(ux),window.customLinkIsRegiter=!0)}},{key:"onCreated",value:(r=E(x().mark((function e(t,n,i){var r,o,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=tx.getPluginsById(this.uuid),o=0;case 2:if(!(o<r.length)){e.next=9;break}return a=r[o],e.next=6,a.init(t,{model:this.model,data:n,toolbarConfig:i,controller:this,context:this.context,params:this.params,evt:this.evt});case 6:o++,e.next=2;break;case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"onDestroyed",value:function(){tx.getPluginsById(this.uuid).forEach((function(e){e.onDestroyed()})),tx.destroy(this.uuid)}},{key:"listenViewDestroyed",value:function(){var e=this,t=this.getView();t&&t.evt.on("onDestroyed",(function(){e.onDestroyed()}))}},{key:"parseNode",value:function(e){var t=e;return tx.getPluginsById(this.uuid).forEach((function(e){t=e.parseNode(t)})),t}},{key:"setValue",value:(i=E(x().mark((function e(t){var n,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.replace(/&nbsp;/g," ")).includes("&")&&(n=n.replace(/&/g,"&amp;")),this.collapsed.value=!1,this.hidden.value=!0,e.next=6,T();case 6:return this.hidden.value=!1,e.next=9,T();case 9:i=this.parseNode(n),this.evt.emit("setHtml",{eventArg:i});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"setReply",value:function(e){this.reply.value=Ds.getEmojiCustomHtml("".concat(e.name,": ").concat(e.content)),this.evt.emit("onSetReply",{eventArg:this.reply.value})}},{key:"removeReply",value:function(){this.reply.value="",this.evt.emit("onRemoveReply",{eventArg:this.reply.value})}},{key:"clear",value:function(){this.reply.value="",this.evt.emit("onRemoveReply",{eventArg:this.reply.value}),this.evt.emit("clear",{eventArg:""}),this.collapsed.value=!0}},{key:"focus",value:function(){this.evt.emit("focus",void 0),this.collapsed.value=!1}},{key:"blur",value:function(){this.evt.emit("blur",void 0),this.collapsed.value=!0}},{key:"fileDownload",value:function(e){ibiz.net.request(e.url,{method:"get",responseType:"blob",baseURL:""}).then((function(t){if(200!==t.status)throw new _e("下载文件失败");if(!t.data)throw new _e("文件流数据不存在");var n=e.name;De(t.data,n)}))}},{key:"toggleCollapse",value:function(e){this.collapsed.value=!e&&!this.collapsed.value}},{key:"jsonToHtml",value:function(e){var t="";try{var n=JSON.parse(e);t=me({content:n}).getHtml()}catch(i){t=e,ibiz.log.error("JSON字符串转换错误",i)}return t}},{key:"toJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="";try{t=JSON.stringify(e)}catch(n){ibiz.log.error("JSON字符串转换错误")}return t}},{key:"getCurrentUserAvatar",value:(n=E(x().mark((function e(){var t,n,i,r,o=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ibiz.hub.getApp(this.context.srfappid);case 2:return t=e.sent,n=[],e.next=6,t.codeList.get("SysOperator",this.context,this.params);case 6:n=e.sent,this.context.srfuserid&&(i=n.filter((function(e){return e.value===o.context.srfuserid})))&&i.length>0&&(this.userAvatar=(null===(r=i[0])||void 0===r||null===(r=r.data)||void 0===r?void 0:r.iconurl)||"");case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getView",value:function(){var e=this.parent.form||this.parent.grid||this.parent.panel;if(e)return e.view}},{key:"handleClick",value:function(e){tx.getPluginsById(this.uuid).forEach((function(t){t.handleClick&&t.handleClick(e)}))}}]);var n,i,r,a}($),hx=function(){return P((function e(){A(this,e),O(this,"formEditor","HtmlComment"),O(this,"gridEditor","HtmlComment")}),[{key:"createController",value:(e=E(x().mark((function e(t,n){var i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new cx(t,n),e.next=3,i.init();case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)}))),function(t,n){return e.apply(this,arguments)})}]);var e}(),fx=a("I",oe(gu,(function(e){window.customElements.get("layout-elem")||window.customElements.define("layout-elem",gk),window.customElements.get("layout-column-elem")||window.customElements.define("layout-column-elem",pk),window.customElements.get("date-elem")||window.customElements.define("date-elem",uk),window.customElements.get("label-elem")||window.customElements.define("label-elem",ck),window.customElements.get("prompt-box-elem")||window.customElements.define("prompt-box-elem",hk),window.customElements.get("mind-map-elem")||window.customElements.define("mind-map-elem",fk),window.customElements.get("audio-elem")||window.customElements.define("audio-elem",dk),window.customElements.get("files-elem")||window.customElements.define("files-elem",yk),window.customElements.get("formula-elem")||window.customElements.define("formula-elem",vk),e.component(vu.name,vu),e.component(mt.name,mt),e.component(gu.name,gu),ee("EDITOR_CUSTOMSTYLE_COMMENT",(function(){return new hx}))})));a("i",{install:function(e){e.use(fx),e.component("IBizHtmlContent",G((function(){return Promise.resolve().then((function(){return wt}))})))}})}}}))}();
